!function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";let e=null;let t=function(e){return e[e.debug=5]="debug",e[e.info=4]="info",e[e.log=3]="log",e[e.warn=2]="warn",e[e.error=1]="error",e}({});const r=async r=>{const{title:n,message:i,level:o,always:s}=r,a=await(e?.()?.get("logger.level"))??t.warn;if(!s&&a<o)return;const c=(e=>{const{title:t,message:r}=e;return[`\n    %c${t}\n    ============================\n\n    ${r}\n\n    ============================\n    `.replace(/\n[^\S\r\n]+/g,"\n").trim(),"font-weight:bold;font-family:monospace;"]})({title:n,message:i});switch(o){case t.debug:console.debug(...c);break;case t.info:console.info(...c);break;case t.warn:console.warn(...c);break;case t.error:console.error(...c);break;default:console.log(...c)}};function n(e,t){if(!e){const e=new Error(`INVARIANT ${t}`);e.stack=e.stack?.split("\n")?.filter(e=>!/at invariant/.test(e))?.join("\n");for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];throw console.error("\n\n---\n\n",e,"\n\n",...n,"\n\n---\n\n"),e}}let i;r.deprecate=e=>{const{pkg:n,subject:i,transition:o,level:s=t.warn,message:a="",callback:c=null}=e,l=()=>{return r({title:(n?n+" ":"")+"Deprecation Notice",message:`\n      ${i?`${e=i,e.charAt(0).toUpperCase()+e.slice(1)} is deprecated and will cease to work in future releases${n?" of "+n:""}.`:""}${a?"\n"+a:""}${o?`\nYou can learn more (including a guide on common transition paths) here: ${o}`:""}\n    `.trim(),level:s});var e};return"function"==typeof c?async function(){return await l(),await c(...arguments)}:l()};const o=new Uint8Array(16);function s(){if(!i&&(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!i))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(o)}const a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));var c={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function l(e,t,r){if(c.randomUUID&&!e)return c.randomUUID();const n=(e=e||{}).random||(e.rng||s)();return n[6]=15&n[6]|64,n[8]=63&n[8]|128,function(e,t=0){return a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]}(n)}var u=function(e){return e.UNKNOWN="UNKNOWN",e.SCRIPT="SCRIPT",e.TRANSACTION="TRANSACTION",e.GET_TRANSACTION_STATUS="GET_TRANSACTION_STATUS",e.GET_ACCOUNT="GET_ACCOUNT",e.GET_EVENTS="GET_EVENTS",e.PING="PING",e.GET_TRANSACTION="GET_TRANSACTION",e.GET_BLOCK="GET_BLOCK",e.GET_BLOCK_HEADER="GET_BLOCK_HEADER",e.GET_COLLECTION="GET_COLLECTION",e.GET_NETWORK_PARAMETERS="GET_NETWORK_PARAMETERS",e.SUBSCRIBE_EVENTS="SUBSCRIBE_EVENTS",e.GET_NODE_VERSION_INFO="GET_NODE_VERSION_INFO",e}({}),h=function(e){return e.BAD="BAD",e.OK="OK",e}({}),d=function(e){return e.AUTHORIZER="authorizer",e.PAYER="payer",e.PROPOSER="proposer",e}({}),f=function(e){return e.ARGUMENT="ARGUMENT",e.ACCOUNT="ACCOUNT",e}({}),p=function(e){return e[e.UNKNOWN_ERROR=-1]="UNKNOWN_ERROR",e[e.TX_VALIDATION_ERROR=1e3]="TX_VALIDATION_ERROR",e[e.INVALID_TX_BYTE_SIZE_ERROR=1001]="INVALID_TX_BYTE_SIZE_ERROR",e[e.INVALID_REFERENCE_BLOCK_ERROR=1002]="INVALID_REFERENCE_BLOCK_ERROR",e[e.EXPIRED_TRANSACTION_ERROR=1003]="EXPIRED_TRANSACTION_ERROR",e[e.INVALID_SCRIPT_ERROR=1004]="INVALID_SCRIPT_ERROR",e[e.INVALID_GAS_LIMIT_ERROR=1005]="INVALID_GAS_LIMIT_ERROR",e[e.INVALID_PROPOSAL_SIGNATURE_ERROR=1006]="INVALID_PROPOSAL_SIGNATURE_ERROR",e[e.INVALID_PROPOSAL_SEQ_NUMBER_ERROR=1007]="INVALID_PROPOSAL_SEQ_NUMBER_ERROR",e[e.INVALID_PAYLOAD_SIGNATURE_ERROR=1008]="INVALID_PAYLOAD_SIGNATURE_ERROR",e[e.INVALID_ENVELOPE_SIGNATURE_ERROR=1009]="INVALID_ENVELOPE_SIGNATURE_ERROR",e[e.FVM_INTERNAL_ERROR=1050]="FVM_INTERNAL_ERROR",e[e.VALUE_ERROR=1051]="VALUE_ERROR",e[e.INVALID_ARGUMENT_ERROR=1052]="INVALID_ARGUMENT_ERROR",e[e.INVALID_ADDRESS_ERROR=1053]="INVALID_ADDRESS_ERROR",e[e.INVALID_LOCATION_ERROR=1054]="INVALID_LOCATION_ERROR",e[e.ACCOUNT_AUTHORIZATION_ERROR=1055]="ACCOUNT_AUTHORIZATION_ERROR",e[e.OPERATION_AUTHORIZATION_ERROR=1056]="OPERATION_AUTHORIZATION_ERROR",e[e.OPERATION_NOT_SUPPORTED_ERROR=1057]="OPERATION_NOT_SUPPORTED_ERROR",e[e.BLOCK_HEIGHT_OUT_OF_RANGE_ERROR=1058]="BLOCK_HEIGHT_OUT_OF_RANGE_ERROR",e[e.EXECUTION_ERROR=1100]="EXECUTION_ERROR",e[e.CADENCE_RUNTIME_ERROR=1101]="CADENCE_RUNTIME_ERROR",e[e.ENCODING_UNSUPPORTED_VALUE=1102]="ENCODING_UNSUPPORTED_VALUE",e[e.STORAGE_CAPACITY_EXCEEDED=1103]="STORAGE_CAPACITY_EXCEEDED",e[e.GAS_LIMIT_EXCEEDED_ERROR=1104]="GAS_LIMIT_EXCEEDED_ERROR",e[e.EVENT_LIMIT_EXCEEDED_ERROR=1105]="EVENT_LIMIT_EXCEEDED_ERROR",e[e.LEDGER_INTERACTION_LIMIT_EXCEEDED_ERROR=1106]="LEDGER_INTERACTION_LIMIT_EXCEEDED_ERROR",e[e.STATE_KEY_SIZE_LIMIT_ERROR=1107]="STATE_KEY_SIZE_LIMIT_ERROR",e[e.STATE_VALUE_SIZE_LIMIT_ERROR=1108]="STATE_VALUE_SIZE_LIMIT_ERROR",e[e.TRANSACTION_FEE_DEDUCTION_FAILED_ERROR=1109]="TRANSACTION_FEE_DEDUCTION_FAILED_ERROR",e[e.COMPUTATION_LIMIT_EXCEEDED_ERROR=1110]="COMPUTATION_LIMIT_EXCEEDED_ERROR",e[e.MEMORY_LIMIT_EXCEEDED_ERROR=1111]="MEMORY_LIMIT_EXCEEDED_ERROR",e[e.COULD_NOT_DECODE_EXECUTION_PARAMETER_FROM_STATE=1112]="COULD_NOT_DECODE_EXECUTION_PARAMETER_FROM_STATE",e[e.SCRIPT_EXECUTION_TIMED_OUT_ERROR=1113]="SCRIPT_EXECUTION_TIMED_OUT_ERROR",e[e.SCRIPT_EXECUTION_CANCELLED_ERROR=1114]="SCRIPT_EXECUTION_CANCELLED_ERROR",e[e.EVENT_ENCODING_ERROR=1115]="EVENT_ENCODING_ERROR",e[e.INVALID_INTERNAL_STATE_ACCESS_ERROR=1116]="INVALID_INTERNAL_STATE_ACCESS_ERROR",e[e.INSUFFICIENT_PAYER_BALANCE=1118]="INSUFFICIENT_PAYER_BALANCE",e[e.ACCOUNT_ERROR=1200]="ACCOUNT_ERROR",e[e.ACCOUNT_NOT_FOUND_ERROR=1201]="ACCOUNT_NOT_FOUND_ERROR",e[e.ACCOUNT_PUBLIC_KEY_NOT_FOUND_ERROR=1202]="ACCOUNT_PUBLIC_KEY_NOT_FOUND_ERROR",e[e.ACCOUNT_ALREADY_EXISTS_ERROR=1203]="ACCOUNT_ALREADY_EXISTS_ERROR",e[e.FROZEN_ACCOUNT_ERROR=1204]="FROZEN_ACCOUNT_ERROR",e[e.ACCOUNT_STORAGE_NOT_INITIALIZED_ERROR=1205]="ACCOUNT_STORAGE_NOT_INITIALIZED_ERROR",e[e.ACCOUNT_PUBLIC_KEY_LIMIT_ERROR=1206]="ACCOUNT_PUBLIC_KEY_LIMIT_ERROR",e[e.CONTRACT_ERROR=1250]="CONTRACT_ERROR",e[e.CONTRACT_NOT_FOUND_ERROR=1251]="CONTRACT_NOT_FOUND_ERROR",e[e.CONTRACT_NAMES_NOT_FOUND_ERROR=1252]="CONTRACT_NAMES_NOT_FOUND_ERROR",e[e.EVM_EXECUTION_ERROR=1300]="EVM_EXECUTION_ERROR",e}({}),g=function(e){return e.BLOCKS="blocks",e.BLOCK_HEADERS="block_headers",e.BLOCK_DIGESTS="block_digests",e.ACCOUNT_STATUSES="account_statuses",e.TRANSACTION_STATUSES="transaction_statuses",e.EVENTS="events",e}({}),m=function(e){return e[e.UNKNOWN=0]="UNKNOWN",e[e.PENDING=1]="PENDING",e[e.FINALIZED=2]="FINALIZED",e[e.EXECUTED=3]="EXECUTED",e[e.SEALED=4]="SEALED",e[e.EXPIRED=5]="EXPIRED",e}({});const y=()=>{const e=[];let t;return{async deliver(r){e.push(r),t&&(t(e.shift()),t=void 0)},receive:()=>new Promise(function(r){const n=e.shift();if(n)return r(n);t=r})}};let w;const b="INIT",v="SUBSCRIBE",E="UNSUBSCRIBE",x="UPDATED",I="SNAPSHOT",_="EXIT",S="TERMINATE",A="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||"object"==typeof window&&window.window===window&&window||{FCL_REGISTRY:null};A.FCL_REGISTRY=null==A.FCL_REGISTRY?{}:A.FCL_REGISTRY;const O=A.FCL_REGISTRY;let C=0;function P(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{expectReply:!1};return new Promise((i,o)=>{const s=n.expectReply||!1,a=null!=n.timeout?n.timeout:5e3;s&&a&&setTimeout(()=>o(new Error(`Timeout: ${a}ms passed without a response.`)),a);const c={to:e,from:n.from,tag:t,data:r,timeout:a,reply:i,reject:o};try{O[e]&&O[e].mailbox.deliver(c),s||i(!0)}catch(t){console.error("FCL.Actor -- Could Not Deliver Message",c,O[e],t),o(t)}})}const R=function(e){const t=(e=>{if(null==e){for(;O[String(C)];)C++;return String(C)}return String(e)})(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null);if(null!=O[t])return t;O[t]={addr:t,mailbox:y(),subs:new Set,kvs:{},error:null};const r=T(t);let n;var i,o;return"object"==typeof e?(i=e,n=async e=>{"function"==typeof i[b]&&await i[b](e);e:for(;;){const t=await e.receive();try{if(t.tag===_){"function"==typeof i[S]&&await i[S](e,t,t.data||{});break e}await(i[t.tag]?.(e,t,t.data||{}))}catch(r){console.error(`${e.self()} Error`,t,r)}finally{continue e}}}):n=e,o=async()=>{await n(r),(e=>{delete O[e]})(t)},(w||(w=Promise.resolve())).then(o).catch(e=>setTimeout(()=>{throw e},0)),t},T=e=>({self:()=>e,receive:()=>O[e].mailbox.receive(),send:function(t,r,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(null!=t)return i.from=e,P(t,r,n,i)},sendSelf:function(t,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};O[e]&&P(e,t,r,n)},broadcast:function(t,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n.from=e;for(const i of O[e].subs)P(i,t,r,n)},subscribe:t=>null!=t&&O[e].subs.add(t),unsubscribe:t=>null!=t&&O[e].subs.delete(t),subscriberCount:()=>O[e].subs.size,hasSubs:()=>!!O[e].subs.size,put:(t,r)=>{null!=t&&(O[e].kvs[t]=r)},get:function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;const n=O[e].kvs[t];return null==n?r:n},delete:t=>{delete O[e].kvs[t]},update:(t,r)=>{null!=t&&(O[e].kvs[t]=r(O[e].kvs[t]))},keys:()=>Object.keys(O[e].kvs),all:()=>O[e].kvs,where:t=>Object.keys(O[e].kvs).reduce((r,n)=>t.test(n)?{...r,[n]:O[e].kvs[n]}:r,{}),merge:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(t).forEach(r=>O[e].kvs[r]=t[r])},fatalError:t=>{O[e].error=t;for(const t of O[e].subs)P(t,x)}});function k(e,t,r){t(e);const n=R(async t=>{for(t.send(e,v);;){const n=await t.receive(),i=O[e].error;if(n.tag===_)return void t.send(e,E);if(i)return r(null,i),void t.send(e,E);r(n.data,null)}});return()=>P(n,_)}function N(e,t){return t(e),P(e,I,null,{expectReply:!0,timeout:0})}const U=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>t.reduce((e,t)=>t(e),e)},B=e=>e&&"object"==typeof e&&!Array.isArray(e),L=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(!r.length)return e;const i=r.shift();if(B(e)&&B(i))for(const t in i)B(i[t])?(e[t]||Object.assign(e,{[t]:{}}),L(e[t],i[t])):Object.assign(e,{[t]:i[t]});return L(e,...r)},D=e=>Array.isArray(e)?L({},...e):e,$=e=>e.contracts?e.contracts:{},M=e=>e.dependencies?e.dependencies:{},j=(e,t)=>U(D,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>t.reduce((t,r)=>({...t,...r(e)}),{})}((e=>t=>{let{deployments:r={},accounts:n={}}=t;const i=r?.[e];return i?Object.entries(i).reduce((e,t)=>{let[r,i]=t;const o=n[r]?.address;return o?i.reduce((e,t)=>({...e,[t]:o}),{}):e},{}):{}})(t),U($,(e=>t=>Object.entries(t).reduce((t,r)=>{let[n,i]=r;const o=i?.aliases?.[e];return o&&(t[n]=o),t},{}))(t)),U(M,(e=>t=>Object.entries(t).reduce((t,r)=>{let[n,i]=r;const o=i?.aliases?.[e];return o&&(t[n]=o),t},{}))(t))))(e),F=e=>Object.entries(e?.accounts??[]).reduce((e,t)=>{let[,r]=t;return!!e||r&&Object.prototype.hasOwnProperty.call(r,"key")&&(n=r?.key,"string"==typeof n&&/^[0-9A-Fa-f]+$/.test(n));var n},!1);e=le;const H="config",z="PUT_CONFIG",q="GET_CONFIG",W="GET_ALL_CONFIG",V="UPDATE_CONFIG",K="DELETE_CONFIG",G="CLEAR_CONFIG",Z="WHERE_CONFIG",Y="CONFIG/UPDATED",J=e=>e,X={[z]:(e,t,r)=>{let{key:n,value:i}=r;if(null==n)throw new Error("Missing 'key' for config/put.");e.put(n,i),e.broadcast(Y,{...e.all()})},[q]:(e,t,r)=>{let{key:n,fallback:i}=r;if(null==n)throw new Error("Missing 'key' for config/get");t.reply(e.get(n,i))},[W]:(e,t)=>{t.reply({...e.all()})},[V]:(e,t,r)=>{let{key:n,fn:i}=r;if(null==n)throw new Error("Missing 'key' for config/update");e.update(n,i||J),e.broadcast(Y,{...e.all()})},[K]:(e,t,r)=>{let{key:n}=r;if(null==n)throw new Error("Missing 'key' for config/delete");e.delete(n),e.broadcast(Y,{...e.all()})},[G]:e=>{const t=Object.keys(e.all());for(const r of t)e.delete(r);e.broadcast(Y,{...e.all()})},[Z]:(e,t,r)=>{let{pattern:n}=r;if(null==n)throw new Error("Missing 'pattern' for config/where");t.reply(e.where(n))},[v]:(e,t)=>{e.subscribe(t.from),e.send(t.from,Y,{...e.all()})},[E]:(e,t)=>{e.unsubscribe(t.from)}};function Q(e,t){return P(H,z,{key:e,value:t}),le()}function ee(e,t){return P(H,q,{key:e,fallback:t},{expectReply:!0,timeout:10})}async function te(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(!e.length)return t;const[r,...n]=e,i=await ee(r);return null==i?te(n,t):i}function re(){return P(H,W,null,{expectReply:!0,timeout:10})}function ne(e){return P(H,V,{key:e,fn:arguments.length>1&&void 0!==arguments[1]?arguments[1]:J}),le()}function ie(e){return P(H,K,{key:e}),le()}function oe(e){return P(H,Z,{pattern:e},{expectReply:!0,timeout:10})}function se(e){return k(H,()=>R(X,H),e)}async function ae(e){return async function(){await P(H,G)}().then(()=>le(e))}async function ce(e){let{ignoreConflicts:i=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=(e=>{const t="local"===e?.toLowerCase()?"emulator":e?.toLowerCase();if("emulator"===t||"testnet"===t||"mainnet"===t||"previewnet"===t)return t;throw new Error(`Invalid network "${e}". Must be one of "emulator", "local", "testnet", or "mainnet"`)})(await ee("flow.network")),{flowJSON:s}=e;if(n(Boolean(s),"config.load -- 'flowJSON' must be defined"),n(!!o,'Flow Network Required -- In order for FCL to load your contracts please define "flow.network" to "emulator", "local", "testnet", or "mainnet" in your config. See more here: https://developers.flow.com/tools/fcl-js/reference/configure-fcl'),a=s,Array.isArray(a)?a.some(F):F(a)){const e="emulator"===o;r({title:"Private Keys Detected",message:"Private keys should be stored in a separate flow.json file for security. See more here: https://developers.flow.com/tools/flow-cli/security",level:e?t.warn:t.error}),n(e,"Private keys should be stored in a separate flow.json file for security. See more here: https://developers.flow.com/tools/flow-cli/security")}var a;for(const[e,n]of Object.entries(j(s,o))){const o=`0x${e}`,s=await ee(o);s&&s!==n&&!i?r({title:"Contract Placeholder Conflict Detected",message:"A generated contract placeholder from config.load conflicts with a placeholder you've set manually in config have the same name.",level:t.warn}):Q(o,n);const a=`system.contracts.${e}`,c=await ee(a);c&&c!==n&&!i?r({title:"Contract Placeholder Conflict Detected",message:"A generated contract placeholder from config.load conflicts with a placeholder you've set manually in config have the same name.",level:t.warn}):Q(a,n)}}function le(e){return null!=e&&"object"==typeof e&&Object.keys(e).map(t=>Q(t,e[t])),{put:Q,get:ee,all:re,first:te,update:ne,delete:ie,where:oe,subscribe:se,overload:ue,load:ce}}async function ue(e,t){const r=await re();try{le(e);return await t(await re())}finally{await ae(r)}}R(X,H),le.put=Q,le.get=ee,le.all=re,le.first=te,le.update=ne,le.delete=ie,le.where=oe,le.subscribe=se,le.overload=ue,le.load=ce;var he="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function de(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function fe(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var r=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}),r}for(var pe={},ge={byteLength:function(e){var t=Ee(e),r=t[0],n=t[1];return 3*(r+n)/4-n},toByteArray:function(e){var t,r,n=Ee(e),i=n[0],o=n[1],s=new we(function(e,t,r){return 3*(t+r)/4-r}(0,i,o)),a=0,c=o>0?i-4:i;for(r=0;r<c;r+=4)t=ye[e.charCodeAt(r)]<<18|ye[e.charCodeAt(r+1)]<<12|ye[e.charCodeAt(r+2)]<<6|ye[e.charCodeAt(r+3)],s[a++]=t>>16&255,s[a++]=t>>8&255,s[a++]=255&t;2===o&&(t=ye[e.charCodeAt(r)]<<2|ye[e.charCodeAt(r+1)]>>4,s[a++]=255&t);1===o&&(t=ye[e.charCodeAt(r)]<<10|ye[e.charCodeAt(r+1)]<<4|ye[e.charCodeAt(r+2)]>>2,s[a++]=t>>8&255,s[a++]=255&t);return s},fromByteArray:function(e){for(var t,r=e.length,n=r%3,i=[],o=16383,s=0,a=r-n;s<a;s+=o)i.push(Ie(e,s,s+o>a?a:s+o));1===n?(t=e[r-1],i.push(me[t>>2]+me[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],i.push(me[t>>10]+me[t>>4&63]+me[t<<2&63]+"="));return i.join("")}},me=[],ye=[],we="undefined"!=typeof Uint8Array?Uint8Array:Array,be="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ve=0;ve<64;++ve)me[ve]=be[ve],ye[be.charCodeAt(ve)]=ve;function Ee(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function xe(e){return me[e>>18&63]+me[e>>12&63]+me[e>>6&63]+me[63&e]}function Ie(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(xe(n));return i.join("")}ye["-".charCodeAt(0)]=62,ye["_".charCodeAt(0)]=63;var _e={};
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Se(e){if(Array.isArray(e)){const t=[];for(let r=0;r<e.length;r++)t.push(Se(e[r]));const r=pe.Buffer.concat(t);return pe.Buffer.concat([Ae(r.length,192),r])}{const t=function(e){if(!pe.Buffer.isBuffer(e)){if("string"==typeof e)return Oe(e)?pe.Buffer.from(function(e){return e.length%2?"0"+e:e}(function(e){if("string"!=typeof e)return e;return Oe(e)?e.slice(2):e}(e)),"hex"):pe.Buffer.from(e);if("number"==typeof e)return e?function(e){const t=Ce(e);return pe.Buffer.from(t,"hex")}(e):pe.Buffer.from([]);if(null==e)return pe.Buffer.from([]);if(e instanceof Uint8Array)return pe.Buffer.from(e);throw new Error("invalid type")}return e}(e);return 1===t.length&&t[0]<128?t:pe.Buffer.concat([Ae(t.length,128),t])}}function Ae(e,t){if(e<56)return pe.Buffer.from([e+t]);{const r=Ce(e),n=Ce(t+55+r.length/2);return pe.Buffer.from(n+r,"hex")}}function Oe(e){return"0x"===e.slice(0,2)}function Ce(e){if(e<0)throw new Error("Invalid integer as argument, must be unsigned!");const t=e.toString(16);return t.length%2?"0"+t:t}function Pe(e){return null==e?null:e.replace(/^0x/,"").replace(/^Fx/,"")}function Re(e){return null==e?null:"0x"+Pe(e)}_e.read=function(e,t,r,n,i){var o,s,a=8*i-n-1,c=(1<<a)-1,l=c>>1,u=-7,h=r?i-1:0,d=r?-1:1,f=e[t+h];for(h+=d,o=f&(1<<-u)-1,f>>=-u,u+=a;u>0;o=256*o+e[t+h],h+=d,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=n;u>0;s=256*s+e[t+h],h+=d,u-=8);if(0===o)o=1-l;else{if(o===c)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),o-=l}return(f?-1:1)*s*Math.pow(2,o-n)},_e.write=function(e,t,r,n,i,o){var s,a,c,l=8*o-i-1,u=(1<<l)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,p=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+h>=1?d/c:d*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(t*c-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[r+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;e[r+f]=255&s,f+=p,s/=256,l-=8);e[r+f-p]|=128*g},
/*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   */
function(e){const t=ge,r=_e,n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=s,e.SlowBuffer=function(e){+e!=e&&(e=0);return s.alloc(+e)},e.INSPECT_MAX_BYTES=50;const i=2147483647;function o(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,s.prototype),t}function s(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return l(e)}return a(e,t,r)}function a(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!s.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|f(e,t);let n=o(r);const i=n.write(e,t);i!==r&&(n=n.slice(0,i));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(K(e,Uint8Array)){const t=new Uint8Array(e);return h(t.buffer,t.byteOffset,t.byteLength)}return u(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(K(e,ArrayBuffer)||e&&K(e.buffer,ArrayBuffer))return h(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(K(e,SharedArrayBuffer)||e&&K(e.buffer,SharedArrayBuffer)))return h(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return s.from(n,t,r);const i=function(e){if(s.isBuffer(e)){const t=0|d(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||G(e.length)?o(0):u(e);if("Buffer"===e.type&&Array.isArray(e.data))return u(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return s.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function l(e){return c(e),o(e<0?0:0|d(e))}function u(e){const t=e.length<0?0:0|d(e.length),r=o(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function h(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,s.prototype),n}function d(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function f(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||K(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return W(e).length;default:if(i)return n?-1:q(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return C(this,t,r);case"utf8":case"utf-8":return _(this,t,r);case"ascii":return A(this,t,r);case"latin1":case"binary":return O(this,t,r);case"base64":return I(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function g(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),G(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=s.from(t,n)),s.isBuffer(t))return 0===t.length?-1:y(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):y(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function y(e,t,r,n,i){let o,s=1,a=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,r/=2}function l(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){let n=-1;for(o=r;o<a;o++)if(l(e,o)===l(t,-1===n?0:o-n)){if(-1===n&&(n=o),o-n+1===c)return n*s}else-1!==n&&(o-=o-n),n=-1}else for(r+c>a&&(r=a-c),o=r;o>=0;o--){let r=!0;for(let n=0;n<c;n++)if(l(e,o+n)!==l(t,n)){r=!1;break}if(r)return o}return-1}function w(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const o=t.length;let s;for(n>o/2&&(n=o/2),s=0;s<n;++s){const n=parseInt(t.substr(2*s,2),16);if(G(n))return s;e[r+s]=n}return s}function b(e,t,r,n){return V(q(t,e.length-r),e,r,n)}function v(e,t,r,n){return V(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function E(e,t,r,n){return V(W(t),e,r,n)}function x(e,t,r,n){return V(function(e,t){let r,n,i;const o=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function I(e,r,n){return 0===r&&n===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(r,n))}function _(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let o=null,s=t>239?4:t>223?3:t>191?2:1;if(i+s<=r){let r,n,a,c;switch(s){case 1:t<128&&(o=t);break;case 2:r=e[i+1],128==(192&r)&&(c=(31&t)<<6|63&r,c>127&&(o=c));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(c=(15&t)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:r=e[i+1],n=e[i+2],a=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),i+=s}return function(e){const t=e.length;if(t<=S)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=S));return r}(n)}e.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(e,t,r){return a(e,t,r)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(e,t,r){return function(e,t,r){return c(e),e<=0?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)}(e,t,r)},s.allocUnsafe=function(e){return l(e)},s.allocUnsafeSlow=function(e){return l(e)},s.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==s.prototype},s.compare=function(e,t){if(K(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),K(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=s.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if(K(t,Uint8Array))i+t.length>n.length?(s.isBuffer(t)||(t=s.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!s.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},s.byteLength=f,s.prototype._isBuffer=!0,s.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)g(this,t,t+1);return this},s.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},s.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},s.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?_(this,0,e):p.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){let t="";const r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},n&&(s.prototype[n]=s.prototype.inspect),s.prototype.compare=function(e,t,r,n,i){if(K(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0);const c=Math.min(o,a),l=this.slice(n,i),u=e.slice(t,r);for(let e=0;e<c;++e)if(l[e]!==u[e]){o=l[e],a=u[e];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},s.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},s.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)},s.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return w(this,e,t,r);case"utf8":case"utf-8":return b(this,e,t,r);case"ascii":case"latin1":case"binary":return v(this,e,t,r);case"base64":return E(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const S=4096;function A(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function O(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function C(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=Z[e[n]];return i}function P(e,t,r){const n=e.slice(t,r);let i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}function R(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function T(e,t,r,n,i,o){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function k(e,t,r,n,i){j(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,r}function N(e,t,r,n,i){j(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r+7]=o,o>>=8,e[r+6]=o,o>>=8,e[r+5]=o,o>>=8,e[r+4]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=s,s>>=8,e[r+2]=s,s>>=8,e[r+1]=s,s>>=8,e[r]=s,r+8}function U(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function B(e,t,n,i,o){return t=+t,n>>>=0,o||U(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function L(e,t,n,i,o){return t=+t,n>>>=0,o||U(e,0,n,8),r.write(e,t,n,i,52,8),n+8}s.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,s.prototype),n},s.prototype.readUintLE=s.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return n},s.prototype.readUintBE=s.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},s.prototype.readUint8=s.prototype.readUInt8=function(e,t){return e>>>=0,t||R(e,1,this.length),this[e]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(e,t){return e>>>=0,t||R(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(e,t){return e>>>=0,t||R(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(e,t){return e>>>=0,t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(e,t){return e>>>=0,t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readBigUInt64LE=Y(function(e){F(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||H(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))}),s.prototype.readBigUInt64BE=Y(function(e){F(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||H(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)}),s.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},s.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);let n=t,i=1,o=this[e+--n];for(;n>0&&(i*=256);)o+=this[e+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},s.prototype.readInt8=function(e,t){return e>>>=0,t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){e>>>=0,t||R(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt16BE=function(e,t){e>>>=0,t||R(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt32LE=function(e,t){return e>>>=0,t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e>>>=0,t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readBigInt64LE=Y(function(e){F(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||H(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)}),s.prototype.readBigInt64BE=Y(function(e){F(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||H(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)}),s.prototype.readFloatLE=function(e,t){return e>>>=0,t||R(e,4,this.length),r.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e>>>=0,t||R(e,4,this.length),r.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e>>>=0,t||R(e,8,this.length),r.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e>>>=0,t||R(e,8,this.length),r.read(this,e,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){T(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){T(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},s.prototype.writeUint8=s.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||T(this,e,t,1,255,0),this[t]=255&e,t+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||T(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||T(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||T(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||T(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeBigUInt64LE=Y(function(e,t=0){return k(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeBigUInt64BE=Y(function(e,t=0){return N(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);T(this,e,t,r,n-1,-n)}let i=0,o=1,s=0;for(this[t]=255&e;++i<r&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o|0)-s&255;return t+r},s.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);T(this,e,t,r,n-1,-n)}let i=r-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o|0)-s&255;return t+r},s.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||T(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||T(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||T(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||T(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||T(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeBigInt64LE=Y(function(e,t=0){return k(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeBigInt64BE=Y(function(e,t=0){return N(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeFloatLE=function(e,t,r){return B(this,e,t,!0,r)},s.prototype.writeFloatBE=function(e,t,r){return B(this,e,t,!1,r)},s.prototype.writeDoubleLE=function(e,t,r){return L(this,e,t,!0,r)},s.prototype.writeDoubleBE=function(e,t,r){return L(this,e,t,!1,r)},s.prototype.copy=function(e,t,r,n){if(!s.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},s.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!s.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const o=s.isBuffer(e)?e:s.from(e,n),a=o.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=o[i%a]}return this};const D={};function $(e,t,r){D[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function M(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function j(e,t,r,n,i,o){if(e>r||e<t){const r="bigint"==typeof t?"n":"";let n;throw n=0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(o+1)}${r}`:`>= -(2${r} ** ${8*(o+1)-1}${r}) and < 2 ** ${8*(o+1)-1}${r}`,new D.ERR_OUT_OF_RANGE("value",n,e)}!function(e,t,r){F(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||H(t,e.length-(r+1))}(n,i,o)}function F(e,t){if("number"!=typeof e)throw new D.ERR_INVALID_ARG_TYPE(t,"number",e)}function H(e,t,r){if(Math.floor(e)!==e)throw F(e,r),new D.ERR_OUT_OF_RANGE("offset","an integer",e);if(t<0)throw new D.ERR_BUFFER_OUT_OF_BOUNDS;throw new D.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${t}`,e)}$("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),$("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError),$("ERR_OUT_OF_RANGE",function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=M(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=M(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n},RangeError);const z=/[^+/0-9A-Za-z-_]/g;function q(e,t){let r;t=t||1/0;const n=e.length;let i=null;const o=[];for(let s=0;s<n;++s){if(r=e.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function W(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(z,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function K(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function G(e){return e!=e}const Z=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function Y(e){return"undefined"==typeof BigInt?J:e}function J(){throw new Error("BigInt not supported")}}(pe);var Te,ke={exports:{}},Ne="object"==typeof Reflect?Reflect:null,Ue=Ne&&"function"==typeof Ne.apply?Ne.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};Te=Ne&&"function"==typeof Ne.ownKeys?Ne.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var Be=Number.isNaN||function(e){return e!=e};function Le(){Le.init.call(this)}ke.exports=Le,ke.exports.once=function(e,t){return new Promise(function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}Ve(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&Ve(e,"error",t,r)}(e,i,{once:!0})})},Le.EventEmitter=Le,Le.prototype._events=void 0,Le.prototype._eventsCount=0,Le.prototype._maxListeners=void 0;var De=10;function $e(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function Me(e){return void 0===e._maxListeners?Le.defaultMaxListeners:e._maxListeners}function je(e,t,r,n){var i,o,s,a;if($e(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=Me(e))>0&&s.length>i&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return e}function Fe(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function He(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=Fe.bind(n);return i.listener=r,n.wrapFn=i,i}function ze(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):We(i,i.length)}function qe(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function We(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function Ve(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function i(o){n.once&&e.removeEventListener(t,i),r(o)})}}Object.defineProperty(Le,"defaultMaxListeners",{enumerable:!0,get:function(){return De},set:function(e){if("number"!=typeof e||e<0||Be(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");De=e}}),Le.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Le.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||Be(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},Le.prototype.getMaxListeners=function(){return Me(this)},Le.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[e];if(void 0===a)return!1;if("function"==typeof a)Ue(a,this,t);else{var c=a.length,l=We(a,c);for(r=0;r<c;++r)Ue(l[r],this,t)}return!0},Le.prototype.addListener=function(e,t){return je(this,e,t,!1)},Le.prototype.on=Le.prototype.addListener,Le.prototype.prependListener=function(e,t){return je(this,e,t,!0)},Le.prototype.once=function(e,t){return $e(t),this.on(e,He(this,e,t)),this},Le.prototype.prependOnceListener=function(e,t){return $e(t),this.prependListener(e,He(this,e,t)),this},Le.prototype.removeListener=function(e,t){var r,n,i,o,s;if($e(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},Le.prototype.off=Le.prototype.removeListener,Le.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},Le.prototype.listeners=function(e){return ze(this,e,!0)},Le.prototype.rawListeners=function(e){return ze(this,e,!1)},Le.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):qe.call(e,t)},Le.prototype.listenerCount=qe,Le.prototype.eventNames=function(){return this._eventsCount>0?Te(this._events):[]};var Ke=ke.exports,Ge=de(Ke),Ze={exports:{}};!function(e,t){var r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==he&&he,n=function(){function e(){this.fetch=!1,this.DOMException=r.DOMException}return e.prototype=r,new e}();!function(e){!function(t){var r=void 0!==e&&e||"undefined"!=typeof self&&self||void 0!==he&&he||{},n="URLSearchParams"in r,i="Symbol"in r&&"iterator"in Symbol,o="FileReader"in r&&"Blob"in r&&function(){try{return new Blob,!0}catch(e){return!1}}(),s="FormData"in r,a="ArrayBuffer"in r;if(a)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(e){return e&&c.indexOf(Object.prototype.toString.call(e))>-1};function u(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function h(e){return"string"!=typeof e&&(e=String(e)),e}function d(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return i&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){if(2!=e.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function p(e){if(!e._noBody)return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function g(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function m(e){var t=new FileReader,r=g(t);return t.readAsArrayBuffer(e),r}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function w(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:o&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:s&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():a&&o&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a&&(ArrayBuffer.prototype.isPrototypeOf(e)||l(e))?this._bodyArrayBuffer=y(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=p(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}if(o)return this.blob().then(m);throw new Error("could not read as ArrayBuffer")},this.text=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,r=g(t),n=/charset=([A-Za-z0-9_-]+)/.exec(e.type),i=n?n[1]:"utf-8";return t.readAsText(e,i),r}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(E)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(e,t){e=u(e),t=h(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},f.prototype.delete=function(e){delete this.map[u(e)]},f.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},f.prototype.set=function(e,t){this.map[u(e)]=h(t)},f.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},f.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),d(e)},f.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),d(e)},f.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),d(e)},i&&(f.prototype[Symbol.iterator]=f.prototype.entries);var b=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function v(e,t){if(!(this instanceof v))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n,i,o=(t=t||{}).body;if(e instanceof v){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=(n=t.method||this.method||"GET",i=n.toUpperCase(),b.indexOf(i)>-1?i:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal||function(){if("AbortController"in r)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(o),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var s=/([?&])_=[^&]*/;if(s.test(this.url))this.url=this.url.replace(s,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function E(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}}),t}function x(e,t){if(!(this instanceof x))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}v.prototype.clone=function(){return new v(this,{body:this._bodyInit})},w.call(v.prototype),w.call(x.prototype),x.prototype.clone=function(){return new x(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},x.error=function(){var e=new x(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var I=[301,302,303,307,308];x.redirect=function(e,t){if(-1===I.indexOf(t))throw new RangeError("Invalid status code");return new x(null,{status:t,headers:{location:e}})},t.DOMException=r.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function _(e,n){return new Promise(function(i,s){var c=new v(e,n);if(c.signal&&c.signal.aborted)return s(new t.DOMException("Aborted","AbortError"));var l=new XMLHttpRequest;function d(){l.abort()}if(l.onload=function(){var e,t,r={statusText:l.statusText,headers:(e=l.getAllResponseHeaders()||"",t=new f,e.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e}).forEach(function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();try{t.append(n,i)}catch(e){console.warn("Response "+e.message)}}}),t)};0===c.url.indexOf("file://")&&(l.status<200||l.status>599)?r.status=200:r.status=l.status,r.url="responseURL"in l?l.responseURL:r.headers.get("X-Request-URL");var n="response"in l?l.response:l.responseText;setTimeout(function(){i(new x(n,r))},0)},l.onerror=function(){setTimeout(function(){s(new TypeError("Network request failed"))},0)},l.ontimeout=function(){setTimeout(function(){s(new TypeError("Network request timed out"))},0)},l.onabort=function(){setTimeout(function(){s(new t.DOMException("Aborted","AbortError"))},0)},l.open(c.method,function(e){try{return""===e&&r.location.href?r.location.href:e}catch(t){return e}}(c.url),!0),"include"===c.credentials?l.withCredentials=!0:"omit"===c.credentials&&(l.withCredentials=!1),"responseType"in l&&(o?l.responseType="blob":a&&(l.responseType="arraybuffer")),n&&"object"==typeof n.headers&&!(n.headers instanceof f||r.Headers&&n.headers instanceof r.Headers)){var p=[];Object.getOwnPropertyNames(n.headers).forEach(function(e){p.push(u(e)),l.setRequestHeader(e,h(n.headers[e]))}),c.headers.forEach(function(e,t){-1===p.indexOf(t)&&l.setRequestHeader(t,e)})}else c.headers.forEach(function(e,t){l.setRequestHeader(t,e)});c.signal&&(c.signal.addEventListener("abort",d),l.onreadystatechange=function(){4===l.readyState&&c.signal.removeEventListener("abort",d)}),l.send(void 0===c._bodyInit?null:c._bodyInit)})}_.polyfill=!0,r.fetch||(r.fetch=_,r.Headers=f,r.Request=v,r.Response=x),t.Headers=f,t.Request=v,t.Response=x,t.fetch=_}({})}(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var i=r.fetch?r:n;(t=i.fetch).default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,e.exports=t}(Ze,Ze.exports);var Ye=de(Ze.exports),Je=null;"undefined"!=typeof WebSocket?Je=WebSocket:"undefined"!=typeof MozWebSocket?Je=MozWebSocket:"undefined"!=typeof global?Je=global.WebSocket||global.MozWebSocket:"undefined"!=typeof window?Je=window.WebSocket||window.MozWebSocket:"undefined"!=typeof self&&(Je=self.WebSocket||self.MozWebSocket);var Xe=Je;function Qe(e){try{return JSON.parse(e)}catch{return null}}function et(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}const tt=globalThis.AbortController||require("abort-controller");class rt extends Error{constructor(e){let{error:t,hostname:r,path:n,method:i,requestBody:o,responseBody:s,responseStatusText:a,statusCode:c}=e;super(`\n      HTTP Request Error: An error occurred when interacting with the Access API.\n      ${t?`error=${t}`:""}\n      ${r?`hostname=${r}`:""}\n      ${n?`path=${n}`:""}\n      ${i?`method=${i}`:""}\n      ${o?`requestBody=${o}`:""}\n      ${s?`responseBody=${s}`:""}\n      ${a?`responseStatusText=${a}`:""}\n      ${c?`statusCode=${c}`:""}\n    `),this.name="HTTP Request Error",this.statusCode=c,this.errorMessage=t}}async function nt(e){let{hostname:n,path:i,method:o,body:s,headers:a,retryLimit:c=5,retryIntervalMs:l=1e3,timeoutLimit:u=3e4,enableRequestLogging:h=!0}=e;const d=s?JSON.stringify(s):null;return await async function e(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;try{const e=await function(){const e=new tt,s=setTimeout(()=>{e.abort()},u);return Ye(et(n,i).toString(),{method:o,body:d,headers:a,signal:e.signal}).then(async e=>{if(e.ok)return e.json();const t=await e.text().catch(()=>null),r=Qe(t);throw new rt({error:r?.message,hostname:n,path:i,method:o,requestBody:d,responseBody:t,responseStatusText:e.statusText,statusCode:e.status})}).catch(async e=>{if(e instanceof rt)throw e;if("AbortError"===e.name)throw e;throw h&&await r({title:"Access Node Error",message:`The provided access node ${n} does not appear to be a valid REST/HTTP access node.\n  Please verify that you are not unintentionally using a GRPC access node.\n  See more here: https://docs.onflow.org/fcl/reference/sdk-guidelines/#connect`,level:t.error}),new rt({error:e?.message,hostname:n,path:i,method:o,requestBody:d})}).finally(()=>{clearTimeout(s)})}();return e}catch(t){const r=[408,429,500,502,503,504];if("AbortError"===t.name||r.includes(t.statusCode))return await new Promise((r,n)=>{s<c?(h&&console.warn(`Access node unavailable, retrying in ${l} ms...`),setTimeout(()=>{r(e(s+1))},l)):n(t)});throw t}}()}function it(e,t,r){let n=t.response();return n.tag=e.tag,n.encodedData=JSON.parse(t.Buffer.from(r,"base64").toString()),n}async function ot(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n(r.node,"SDK Send Execute Script Error: opts.node must be defined."),n(t.response,"SDK Send Execute Script Error: context.response must be defined."),n(t.Buffer,"SDK Send Execute Script Error: context.Buffer must be defined."),(e=await e).block.id?await async function(e,t,r){const n=r.httpRequest||nt,i=await n({hostname:r.node,path:`/v1/scripts?block_id=${e.block.id}`,method:"POST",body:{script:t.Buffer.from(e.message.cadence).toString("base64"),arguments:e.message.arguments.map(r=>t.Buffer.from(JSON.stringify(e.arguments[r].asArgument)).toString("base64"))}});return it(e,t,i)}(e,t,r):e.block.height?await async function(e,t,r){const n=r.httpRequest||nt,i=await n({hostname:r.node,path:`/v1/scripts?block_height=${e.block.height}`,method:"POST",body:{script:t.Buffer.from(e.message.cadence).toString("base64"),arguments:e.message.arguments.map(r=>t.Buffer.from(JSON.stringify(e.arguments[r].asArgument)).toString("base64"))}});return it(e,t,i)}(e,t,r):await async function(e,t,r){const n=r.httpRequest||nt,i=await n({hostname:r.node,path:"/v1/scripts?block_height="+(e.block.isSealed?"sealed":"final"),method:"POST",body:{script:t.Buffer.from(e.message.cadence).toString("base64"),arguments:e.message.arguments.map(r=>t.Buffer.from(JSON.stringify(e.arguments[r].asArgument)).toString("base64"))}});return it(e,t,i)}(e,t,r)}const st={SHA2_256:1,SHA2_384:2,SHA3_256:3,SHA3_384:4,KMAC128_BLS_BLS12_381:5},at={ECDSA_P256:1,ECDSA_secp256k1:2,BLS_BLS12_381:3};function ct(e,t,r){let n=t.response();n.tag=e.tag;return n.account={address:r.address,balance:Number(r.balance),code:"",contracts:(e=>{const r={};if(!e)return r;for(let n of Object.keys(e))r[n]=t.Buffer.from(e[n],"base64").toString();return r})(r.contracts),keys:r.keys?.map(e=>({index:Number(e.index),publicKey:e.public_key.replace(/^0x/,""),signAlgo:at[e.signing_algorithm],signAlgoString:e.signing_algorithm,hashAlgo:st[e.hashing_algorithm],hashAlgoString:e.hashing_algorithm,sequenceNumber:Number(e.sequence_number),weight:Number(e.weight),revoked:e.revoked}))??[]},n}async function lt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n(r.node,"SDK Send Get Account Error: opts.node must be defined."),n(t.response,"SDK Send Get Account Error: context.response must be defined."),n(t.Buffer,"SDK Send Get Account Error: context.Buffer must be defined."),null!==(e=await e).block.height?await async function(e,t,r){const n=r.httpRequest||nt;return ct(e,t,await n({hostname:r.node,path:`/v1/accounts/${e.account.addr}?block_height=${e.block.height}&expand=contracts,keys`,method:"GET",body:null}))}(e,t,r):await async function(e,t,r){const n=r.httpRequest||nt;return ct(e,t,await n({hostname:r.node,path:`/v1/accounts/${e.account.addr}?block_height=${e.block.isSealed?"sealed":"final"}&expand=contracts,keys`,method:"GET",body:null}))}(e,t,r)}function ut(e,t,r){const n=r.length?r[0]:null,i=t.response();return i.tag=e.tag,i.blockHeader={id:n.header.id,parentId:n.header.parent_id,height:Number(n.header.height),timestamp:n.header.timestamp},i}async function ht(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n(r.node,"SDK Send Get Block Header Error: opts.node must be defined."),n(t.response,"SDK Send Get Block Header Error: context.response must be defined.");const i=null!==(e=await e).block.id,o=null!==e.block.height;return i?await async function(e,t,r){const n=r.httpRequest||nt;return ut(e,t,await n({hostname:r.node,path:`/v1/blocks/${e.block.id}`,method:"GET",body:null}))}(e,t,r):o?await async function(e,t,r){const n=r.httpRequest||nt;return ut(e,t,await n({hostname:r.node,path:`/v1/blocks?height=${e.block.height}`,method:"GET",body:null}))}(e,t,r):await async function(e,t,r){const n=r.httpRequest||nt,i=e.block?.isSealed?"sealed":"final";return ut(e,t,await n({hostname:r.node,path:`/v1/blocks?height=${i}`,method:"GET",body:null}))}(e,t,r)}function dt(e,t,r){const n=r.length?r[0]:null,i=t.response();return i.tag=e.tag,i.block={id:n.header.id,parentId:n.header.parent_id,height:Number(n.header.height),timestamp:n.header.timestamp,parentVoterSignature:n.header.parent_voter_signature,collectionGuarantees:n.payload.collection_guarantees.map(e=>({collectionId:e.collection_id,signerIds:e.signer_ids})),blockSeals:n.payload.block_seals.map(e=>({blockId:e.block_id,executionReceiptId:e.result_id}))},i}async function ft(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n(r.node,"SDK Send Get Block Error: opts.node must be defined."),n(t.response,"SDK Send Get Block Error: context.response must be defined.");const i=null!==(e=await e).block.id,o=null!==e.block.height;return i?await async function(e,t,r){const n=r.httpRequest||nt;return dt(e,t,await n({hostname:r.node,path:`/v1/blocks/${e.block.id}?expand=payload`,method:"GET",body:null}))}(e,t,r):o?await async function(e,t,r){const n=r.httpRequest||nt;return dt(e,t,await n({hostname:r.node,path:`/v1/blocks?height=${e.block.height}&expand=payload`,method:"GET",body:null}))}(e,t,r):await async function(e,t,r){const n=r.httpRequest||nt,i=e.block?.isSealed?"sealed":"final";return dt(e,t,await n({hostname:r.node,path:`/v1/blocks?height=${i}&expand=payload`,method:"GET",body:null}))}(e,t,r)}function pt(e,t,r){let n=t.response();return n.tag=e.tag,n.events=[],r.forEach(e=>e.events?e.events.forEach(r=>n.events.push({blockId:e.block_id,blockHeight:Number(e.block_height),blockTimestamp:e.block_timestamp,type:r.type,transactionId:r.transaction_id,transactionIndex:Number(r.transaction_index),eventIndex:Number(r.event_index),payload:JSON.parse(t.Buffer.from(r.payload,"base64").toString())})):null),n}async function gt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n(r.node,"SDK Send Get Events Error: opts.node must be defined."),n(t.response,"SDK Send Get Events Error: context.response must be defined."),n(t.Buffer,"SDK Send Get Events Error: context.Buffer must be defined.");const i=null!==(e=await e).events.start,o=Array.isArray(e.events.blockIds)&&e.events.blockIds.length>0;return n(i||o,"SendGetEventsError: Unable to determine which get events request to send. Either a block height range, or block IDs must be specified."),i?await async function(e,t,r){const n=r.httpRequest||nt;return pt(e,t,await n({hostname:r.node,path:`/v1/events?type=${e.events.eventType}&start_height=${e.events.start}&end_height=${e.events.end}`,method:"GET",body:null}))}(e,t,r):await async function(e,t,r){const n=r.httpRequest||nt,i=await n({hostname:r.node,path:`/v1/events?type=${e.events.eventType}&block_ids=${e.events.blockIds.join(",")}`,method:"GET",body:null});return pt(e,t,i)}(e,t,r)}const mt={UNKNOWN:0,PENDING:1,FINALIZED:2,EXECUTED:3,SEALED:4,EXPIRED:5};const yt=e=>`${withPrefix(e.addr)}-${e.keyId}`;const wt=Xe;class bt extends Error{constructor(e){let{code:t,reason:r,message:n,wasClean:i}=e;super(`\n      connectWs: connection closed with error${n?`: ${n}`:""}\n      ${t?`code: ${t}`:""}\n      ${r?`reason: ${r}`:""}\n      ${i?`wasClean: ${i}`:""}\n    `),this.name="WebsocketError",this.code=t,this.reason=r,this.wasClean=!1}}function vt(e){let{hostname:t,path:r,params:n,getParams:i,retryLimit:o=5,retryIntervalMs:s=1e3}=e;if(i&&n)throw new Error("connectWs: cannot specify both params and getParams");let a=new Ke.EventEmitter,c=0;const l=i||(()=>n);let u=()=>{};return function e(){let n=!1,i=!1;const h=function(e,t,r){const n=new URL(t||"",e);"https:"===n.protocol?n.protocol="wss:":"http:"===n.protocol&&(n.protocol="ws:");return Object.entries(r||{}).forEach(e=>{let[t,r]=e;if(r){let e;e=Array.isArray(r)?r.join(","):r.toString(),n.searchParams.append(t,e)}}),n.toString()}(t,r,l()),d=new wt(h);d.onmessage=function(e){const t=Qe(e.data);t?a.emit("data",t):(a.emit("error",new bt({message:"invalid JSON data"})),this.close())},d.onclose=function(t){if(n)return a.emit("close"),void a.removeAllListeners();i?setTimeout(e,s):c<o?(c++,setTimeout(e,s)):(a.emit("error",new bt({wasClean:t.wasClean,code:t.code,reason:t.reason,message:"failed to connect"})),setTimeout(()=>{a.emit("close"),a.removeAllListeners()}))},d.onopen=function(){i=!0,c=0},u=()=>{n=!0,d.close()}}(),{on(e,t){return a.on(e,t),this},off(e,t){return a.off(e,t),this},close(){u()}}}async function Et(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n(r.node,"SDK Send Get Events Error: opts.node must be defined."),n(t.response,"SDK Send Get Events Error: context.response must be defined."),n(t.Buffer,"SDK Send Get Events Error: context.Buffer must be defined.");const i=await e,o=r.connectWs||vt,s=new Ke.EventEmitter;let a=null;const c=o({hostname:r.node,path:"/v1/subscribe_events",getParams:()=>{const e={event_types:i.subscribeEvents?.eventTypes,addresses:i.subscribeEvents?.addresses,contracts:i.subscribeEvents?.contracts,heartbeat_interval:i.subscribeEvents?.heartbeatInterval};return a?e.start_height=a+1:(e.start_block_id=i.subscribeEvents?.startBlockId,e.start_height=i.subscribeEvents?.startHeight),e}});c.on("data",e=>{const r=function(e,t,r){const n=t.response();return n.tag=e.tag,n.events=r.Events?.length>0?r.Events.map(e=>({blockId:r.BlockID,blockHeight:Number(r.Height),blockTimestamp:r.BlockTimestamp,type:e.Type,transactionId:e.TransactionID,transactionIndex:Number(e.TransactionIndex),eventIndex:Number(e.EventIndex),payload:JSON.parse(t.Buffer.from(e.Payload,"base64").toString())})):null,n.heartbeat={blockId:r.BlockID,blockHeight:Number(r.Height),blockTimestamp:r.BlockTimestamp},n}(i,t,e);a=r.heartbeat.blockHeight,s.emit("data",r)}),c.on("error",e=>{s.emit("error",e)}),c.on("close",()=>{s.emit("close")});return function(e,t,r){const n=t.response();return n.tag=e.tag,n.streamConnection=r,n}(i,t,{on(e,t){return s.on(e,t),this},off(e,t){return s.off(e,t),this},close(){c.close()}})}let xt=function(e){return e.LIST_SUBSCRIPTIONS="list_subscriptions",e.SUBSCRIBE="subscribe",e.UNSUBSCRIBE="unsubscribe",e}({});class It extends Error{constructor(e,t){super(t),this.name="SocketError",this.code=e}static fromMessage(e){return new It(e.code,e.message)}}class _t{counter=0;socket=null;subscriptions=[];reconnectAttempts=0;connectPromise=null;closeConnection=null;constructor(e,t){this.config={...t,reconnectOptions:{initialReconnectDelay:500,reconnectAttempts:5,maxReconnectDelay:5e3,...t.reconnectOptions}},this.handlers=e}subscribe(e){const t=this._subscribe(e);return{unsubscribe:()=>{t.then(e=>e&&this.unsubscribe(e))}}}async _subscribe(e){const t=this.getHandler(e.topic).createSubscriber(e.args,e.onData,e.onError);let r=null;try{await this.connect(),r={id:String(this.counter++),topic:e.topic,subscriber:t},this.subscriptions.push(r);const n=await this.sendSubscribe(r);if(n.error)throw new Error(`Failed to subscribe to topic ${r.topic}`,{cause:It.fromMessage(n.error)})}catch(e){return t.onError(e instanceof Error?e:new Error(String(e))),r&&this.unsubscribe(r.id),null}return r.id}unsubscribe(e){const t=this.subscriptions.find(t=>t.id===e);t&&(this.subscriptions=this.subscriptions.filter(t=>t.id!==e),0!==this.subscriptions.length?this.sendUnsubscribe(t).catch(e=>{console.error(`Error while unsubscribing from topic: ${e}`)}):this.closeConnection?.())}async connect(){return this.connectPromise||(this.connectPromise=new Promise((e,t)=>{if(1===this.socket?.readyState)return void e();this.socket=new wt(this.config.node);const r=e=>{const t=JSON.parse(e.data);if("action"in t&&t.error){const e=this.subscriptions.find(e=>e.id===t.subscription_id);return void(e&&(e.subscriber.onError(new Error(`Failed to subscribe to topic ${e.topic}: ${t.error.message}`)),this.subscriptions=this.subscriptions.filter(e=>e.id!==t.subscription_id)))}const r=this.subscriptions.find(e=>e.id===t.subscription_id);r&&("action"in t||t.subscription_id!==r.id||r.subscriber.onData(t.payload))},n=()=>{this.handleSocketError(new Error("WebSocket closed")).then(()=>{e()}).catch(e=>{t(e)})},i=()=>{e()};this.socket.addEventListener("message",r),this.socket.addEventListener("close",n),this.socket.addEventListener("open",i),this.closeConnection=()=>{this.socket?.removeEventListener("message",r),this.socket?.removeEventListener("close",n),this.socket?.removeEventListener("open",i),this.socket?.close(),this.socket=null,this.closeConnection=null,this.connectPromise=null}})),this.connectPromise}async handleSocketError(e){if(this.closeConnection?.(),++this.reconnectAttempts>=this.config.reconnectOptions.reconnectAttempts)throw r({level:t.error,title:"WebSocket Error",message:`Failed to reconnect to the server after ${this.reconnectAttempts+1} attempts: ${e}`}),this.subscriptions.forEach(t=>{t.subscriber.onError(new Error(`Failed to reconnect to the server after ${this.reconnectAttempts+1} attempts: ${e}`))}),this.subscriptions=[],this.reconnectAttempts=0,e;r({level:t.warn,title:"WebSocket Error",message:`WebSocket error, reconnecting in ${this.backoffInterval}ms: ${e}`}),await new Promise(e=>setTimeout(e,this.backoffInterval)),await this.connect(),await Promise.all(this.subscriptions.map(async e=>{await this.sendSubscribe(e).catch(t=>{e.subscriber.onError(new Error(`Failed to restore subscription: ${t}`)),this.subscriptions=this.subscriptions.filter(t=>t.id!==e.id)})})),this.reconnectAttempts=0}async sendSubscribe(e){const t={action:xt.SUBSCRIBE,topic:e.topic,arguments:e.subscriber.getConnectionArgs(),subscription_id:String(e.id)},r=await this.request(t);if(r.error)throw new Error(`Failed to subscribe to topic ${e.topic}`,{cause:It.fromMessage(r.error)});return r}async sendUnsubscribe(e){const t={action:xt.UNSUBSCRIBE,subscription_id:e.id};this.socket?.send(JSON.stringify(t));const r=await this.request(t);if(r.error)throw new Error(`Failed to unsubscribe from topic ${e.topic}`,{cause:It.fromMessage(r.error)});return r}async request(e){let t=()=>{};return await new Promise((r,n)=>{function i(e){n(new Error(`WebSocket error: ${e}`))}function o(){n(new Error("WebSocket closed"))}function s(t){const n=JSON.parse(t.data);n.subscription_id===e.subscription_id&&r(n)}this.socket?(t=()=>{this.socket?.removeEventListener("error",i),this.socket?.removeEventListener("message",s),this.socket?.removeEventListener("close",o)},this.socket.addEventListener("error",i),this.socket.addEventListener("message",s),this.socket.addEventListener("close",o),this.socket.send(JSON.stringify(e))):n(new Error("WebSocket is not connected"))}).finally(()=>{t()})}getHandler(e){const t=this.handlers.find(t=>t.topic===e);if(!t)throw new Error(`No handler found for topic ${e}`);return t}get backoffInterval(){return Math.min(this.config.reconnectOptions.maxReconnectDelay,this.config.reconnectOptions.initialReconnectDelay*2**this.reconnectAttempts)}}const St={topic:g.BLOCKS,createSubscriber:(e,t,r)=>{let n={...e};return{onData(e){const r={block:{id:e.header.id,parentId:e.header.parent_id,height:Number(e.header.height),timestamp:e.header.timestamp,parentVoterSignature:e.header.parent_voter_signature,collectionGuarantees:e.payload.collection_guarantees.map(e=>({collectionId:e.collection_id,signerIds:e.signer_indices})),blockSeals:e.payload.block_seals.map(e=>({blockId:e.block_id,executionReceiptId:e.result_id}))}};n={blockStatus:n.blockStatus,startBlockHeight:Number(BigInt(e.header.height)+BigInt(1))},t(r)},onError(e){r(e)},getConnectionArgs(){let e={block_status:n.blockStatus};return"startBlockHeight"in n&&n.startBlockHeight?{...e,start_block_height:String(n.startBlockHeight)}:"startBlockId"in n&&n.startBlockId?{...e,start_block_id:n.startBlockId}:e}}}},At={topic:g.BLOCK_HEADERS,createSubscriber:(e,t,r)=>{let n={...e};return{onData(e){const r={blockHeader:{id:e.id,parentId:e.parent_id,height:Number(e.height),timestamp:e.timestamp,parentVoterSignature:e.parent_voter_signature}};n={blockStatus:n.blockStatus,startBlockHeight:Number(BigInt(e.height)+BigInt(1))},t(r)},onError(e){r(e)},getConnectionArgs(){let e={block_status:n.blockStatus};return"startBlockHeight"in n&&n.startBlockHeight?{...e,start_block_height:n.startBlockHeight}:"startBlockId"in n&&n.startBlockId?{...e,start_block_id:n.startBlockId}:e}}}},Ot={topic:g.BLOCK_DIGESTS,createSubscriber:(e,t,r)=>{let n={...e};return{onData(e){const r={blockDigest:{id:e.block_id,height:Number(e.height),timestamp:e.timestamp}};n={blockStatus:n.blockStatus,startBlockId:String(BigInt(e.height)+BigInt(1))},t(r)},onError(e){r(e)},getConnectionArgs(){let e={block_status:n.blockStatus};return"startBlockHeight"in n&&n.startBlockHeight?{...e,start_block_height:n.startBlockHeight}:"startBlockId"in n&&n.startBlockId?{...e,start_block_id:n.startBlockId}:e}}}},Ct={topic:g.ACCOUNT_STATUSES,createSubscriber:(e,t,r)=>{let n={...e};return{onData(e){const r=[];for(const[i,o]of Object.entries(e.account_events)){for(const t of o){const n={accountStatusEvent:{accountAddress:i,blockId:e.block_id,blockHeight:Number(e.height),type:t.type,transactionId:t.transaction_id,transactionIndex:Number(t.transaction_index),eventIndex:Number(t.event_index),payload:JSON.parse(Buffer.from(t.payload,"base64").toString())}};r.push(n)}r.sort((e,t)=>{const r=e.accountStatusEvent.transactionIndex-t.accountStatusEvent.transactionIndex;return 0!==r?r:e.accountStatusEvent.eventIndex-t.accountStatusEvent.eventIndex});for(const e of r)t(e);n={...n,startBlockHeight:Number(BigInt(e.height)+BigInt(1)),startBlockId:void 0}}},onError(e){r(e)},getConnectionArgs(){let e={event_types:n.eventTypes,addresses:n.addresses,account_addresses:n.accountAddresses};return"startBlockHeight"in n&&n.startBlockHeight?{...e,start_block_height:n.startBlockHeight}:"startBlockId"in n&&n.startBlockId?{...e,start_block_id:n.startBlockId}:e}}}},Pt={UNKNOWN:0,PENDING:1,FINALIZED:2,EXECUTED:3,SEALED:4,EXPIRED:5},Rt={topic:g.TRANSACTION_STATUSES,createSubscriber:(e,t,r)=>{let n={...e};return{onData(e){const r={transactionStatus:{blockId:e.transaction_result.block_id,status:Pt[e.transaction_result.status.toUpperCase()],statusString:e.transaction_result.status.toUpperCase(),statusCode:e.transaction_result.status_code,errorMessage:e.transaction_result.error_message,events:e.transaction_result.events.map(e=>({type:e.type,transactionId:e.transaction_id,transactionIndex:Number(e.transaction_index),eventIndex:Number(e.event_index),payload:JSON.parse(pe.Buffer.from(e.payload,"base64").toString())}))}};t(r)},onError(e){r(e)},getConnectionArgs:()=>({tx_id:n.transactionId})}}},Tt=[St,At,Ot,Ct,Rt,{topic:g.EVENTS,createSubscriber:(e,t,r)=>{let n={...e};return{onData(e){for(const r of e.events){const n={event:{blockId:e.block_id,blockHeight:Number(e.block_height),blockTimestamp:e.block_timestamp,type:r.type,transactionId:r.transaction_id,transactionIndex:Number(r.transaction_index),eventIndex:Number(r.event_index),payload:JSON.parse(Buffer.from(r.payload,"base64").toString())}};t(n)}n={...n,startHeight:Number(BigInt(e.block_height)+BigInt(1)),startBlockId:void 0}},onError(e){r(e)},getConnectionArgs(){let e={event_types:n.eventTypes,addresses:n.addresses,contracts:n.contracts};return"startBlockHeight"in n&&n.startBlockHeight?{...e,start_block_height:n.startBlockHeight}:"startBlockId"in n&&n.startBlockId?{...e,start_block_id:n.startBlockId}:e}}}}];let kt=new Map;const Nt={send:async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};switch(n(Boolean(r?.node),'SDK Send Error: Either opts.node or "accessNode.api" in config must be defined.'),n(Boolean(t.ix),"SDK Send Error: context.ix must be defined."),e=await e,!0){case t.ix.isTransaction(e):return r.sendTransaction?r.sendTransaction(e,t,r):async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n(r.node,"SDK Send Transaction Error: opts.node must be defined."),n(t.response,"SDK Send Transaction Error: context.response must be defined."),n(t.Buffer,"SDK Send Transaction Error: context.Buffer must be defined.");const i=r.httpRequest||nt;e=await e;let o=[];for(let r of Object.values(e.accounts))try{if(!r.role.payer&&null!=r.signature){const e={address:Pe(r.addr),key_index:String(r.keyId),signature:t.Buffer.from(r.signature,"hex").toString("base64")};o.find(t=>t.address===e.address&&t.key_index===e.key_index&&t.signature===e.signature)||o.push(e)}}catch(t){throw console.error("SDK HTTP Send Error: Trouble applying payload signature",{acct:r,ix:e}),t}let s={};for(let r of Object.values(e.accounts))try{if(r.role.payer&&null!=r.signature){let e=r.tempId||yt(r);s[e]=s[e]||{address:Pe(r.addr),key_index:String(r.keyId),signature:t.Buffer.from(r.signature,"hex").toString("base64")}}}catch(t){throw console.error("SDK HTTP Send Error: Trouble applying envelope signature",{acct:r,ix:e}),t}s=Object.values(s);var a=Date.now();const c=await i({hostname:r.node,path:"/v1/transactions",method:"POST",body:{script:t.Buffer.from(e.message.cadence).toString("base64"),arguments:[...e.message.arguments.map(r=>t.Buffer.from(JSON.stringify(e.arguments[r].asArgument)).toString("base64"))],reference_block_id:e.message.refBlock?e.message.refBlock:null,gas_limit:String(e.message.computeLimit),payer:Pe(e.accounts[Array.isArray(e.payer)?e.payer[0]:e.payer].addr),proposal_key:{address:Pe(e.accounts[e.proposer].addr),key_index:String(e.accounts[e.proposer].keyId),sequence_number:String(e.accounts[e.proposer].sequenceNum)},authorizers:e.authorizations.map(t=>e.accounts[t].addr).reduce((e,t)=>e.find(e=>e===t)?e:[...e,t],[]).map(Pe),payload_signatures:o,envelope_signatures:s}});var l=Date.now();let u=t.response();return u.tag=e.tag,u.transactionId=c.id,"undefined"!=typeof window&&"undefined"!=typeof CustomEvent&&window.dispatchEvent(new CustomEvent("FLOW::TX",{detail:{txId:u.transactionId,delta:l-a}})),u}(e,t,r);case t.ix.isGetTransactionStatus(e):return r.sendGetTransactionStatus?r.sendGetTransactionStatus(e,t,r):async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n(r.node,"SDK Send Get Transaction Status Error: opts.node must be defined."),n(t.response,"SDK Send Get Transaction Status Error: context.response must be defined."),n(t.Buffer,"SDK Send Get Transaction Status Error: context.Buffer must be defined.");const i=r.httpRequest||nt;e=await e;const o=await i({hostname:r.node,path:`/v1/transaction_results/${e.transaction.id}`,method:"GET",body:null});let s=t.response();return s.tag=e.tag,s.transactionStatus={blockId:o.block_id,status:mt[o.status.toUpperCase()]||"",statusString:o.status.toUpperCase(),statusCode:o.status_code,errorMessage:o.error_message,events:o.events.map(e=>({type:e.type,transactionId:e.transaction_id,transactionIndex:Number(e.transaction_index),eventIndex:Number(e.event_index),payload:JSON.parse(t.Buffer.from(e.payload,"base64").toString())}))},s}(e,t,r);case t.ix.isGetTransaction(e):return r.sendGetTransaction?r.sendGetTransaction(e,t,r):async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n(r.node,"SDK Send Get Transaction Error: opts.node must be defined."),n(t.response,"SDK Send Get Transaction Error: context.response must be defined."),n(t.Buffer,"SDK Send Get Transaction Error: context.Buffer must be defined.");const i=r.httpRequest||nt;e=await e;const o=await i({hostname:r.node,path:`/v1/transactions/${e.transaction.id}`,method:"GET",body:null}),s=e=>({address:e.address,keyId:Number(e.key_index),signature:e.signature});let a=t.response();var c;return a.tag=e.tag,a.transaction={script:t.Buffer.from(o.script,"base64").toString(),args:[...o.arguments.map(e=>JSON.parse(t.Buffer.from(e,"base64").toString()))],referenceBlockId:o.reference_block_id,gasLimit:Number(o.gas_limit),payer:o.payer,proposalKey:o.proposal_key?(c=o.proposal_key,{address:c.address,keyId:Number(c.key_index),sequenceNumber:Number(c.sequence_number)}):o.proposal_key,authorizers:o.authorizers,payloadSignatures:[...o.payload_signatures.map(s)],envelopeSignatures:[...o.envelope_signatures.map(s)]},a}(e,t,r);case t.ix.isScript(e):return r.sendExecuteScript?r.sendExecuteScript(e,t,r):ot(e,t,r);case t.ix.isGetAccount(e):return r.sendGetAccount?r.sendGetAccount(e,t,r):lt(e,t,r);case t.ix.isGetEvents(e):return r.sendGetEvents?r.sendGetEvents(e,t,r):gt(e,t,r);case t.ix.isSubscribeEvents?.(e):return r.connectSubscribeEvents?r.connectSubscribeEvents(e,t,r):Et(e,t,r);case t.ix.isGetBlock(e):return r.sendGetBlock?r.sendGetBlock(e,t,r):ft(e,t,r);case t.ix.isGetBlockHeader(e):return r.sendGetBlockHeader?r.sendGetBlockHeader(e,t,r):ht(e,t,r);case t.ix.isGetCollection(e):return r.sendGetCollection?r.sendGetCollection(e,t,r):async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n(r.node,"SDK Send Get Collection Error: opts.node must be defined."),n(t.response,"SDK Send Get Collection Error: context.response must be defined.");const i=r.httpRequest||nt,o=await i({hostname:r.node,path:`/v1/collections/${e.collection.id}?expand=transactions`,method:"GET",body:null}),s=t.response();return s.tag=e.tag,s.collection={id:o.id,transactionIds:o.transactions.map(e=>e.id)},s}(e,t,r);case t.ix.isPing(e):return r.sendPing?r.sendPing(e,t,r):async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n(Boolean(r.node),"SDK Send Ping Error: opts.node must be defined."),n(Boolean(t.response),"SDK Send Ping Error: context.response must be defined.");const i=r.httpRequest||nt;await i({hostname:r.node,path:"/v1/blocks?height=sealed",method:"GET",body:null});let o="function"==typeof t?.response?t.response():{};return o.tag=e.tag,o}(e,t,r);case t.ix.isGetNetworkParameters(e):return r.sendGetNetworkParameters?r.sendGetNetworkParameters(e,t,r):async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n(r.node,"SDK Send Get Network Parameters Error: opts.node must be defined."),n(t.response,"SDK Send Get Network Parameters Error: context.response must be defined.");const i=r.httpRequest||nt;e=await e;const o=await i({hostname:r.node,path:"/v1/network/parameters",method:"GET",body:null,enableRequestLogging:r.enableRequestLogging??!0});let s=t.response();return s.tag=e.tag,s.networkParameters={chainId:o.chain_id},s}(e,t,r);case t.ix.isGetNodeVersionInfo?.(e):return r.sendGetNodeVersionInfo?r.sendGetNodeVersionInfo(e,t,r):async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n(r.node,"SDK Send Get Node Version Info Error: opts.node must be defined."),n(t.response,"SDK Send Get Node Verison Info Error: context.response must be defined.");const i=r.httpRequest||nt;e=await e;const o=await i({hostname:r.node,path:"/v1/node_version_info",method:"GET"});let s=t.response();return s.tag=e.tag,s.nodeVersionInfo={semver:o.semver,commit:o.commit,sporkId:o.spork_id,protocolVersion:parseInt(o.protocol_version),sporkRootBlockHeight:parseInt(o.spork_root_block_height),nodeRootBlockHeight:parseInt(o.node_root_block_height)},s}(e,t,r);default:return e}},subscribe:function(e,t){let{topic:r,args:n,onData:i,onError:o}=e;const s=function(e){const t=new URL(et(e,"/v1/ws"));"https:"===t.protocol?t.protocol="wss:":"http:"===t.protocol&&(t.protocol="ws:");return t.toString()}(t.node),a=kt.get(s)||new _t(Tt,{node:s});return kt.set(s,a),a.subscribe({topic:r,args:n,onData:i,onError:o})}};var Ut={},Bt={},Lt={},Dt={},$t=function(e,t){return function(r,n){var i=2*n,o=2*t;r[i]=e[o],r[i+1]=e[o+1]}};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t,r=(t=$t)&&t.__esModule?t:{default:t};var n=function(e){for(var t=e.A,n=e.C,i=0;i<25;i+=5){for(var o=0;o<5;o++)(0,r.default)(t,i+o)(n,o);for(var s=0;s<5;s++){var a=2*(i+s),c=(s+1)%5*2,l=(s+2)%5*2;t[a]^=~n[c]&n[l],t[a+1]^=~n[c+1]&n[l+1]}}};e.default=n}(Dt);var Mt={},jt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=new Uint32Array([0,1,0,32898,2147483648,32906,2147483648,2147516416,0,32907,0,2147483649,2147483648,2147516545,2147483648,32777,0,138,0,136,0,2147516425,0,2147483658,0,2147516555,2147483648,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,0,32778,2147483648,2147483658,2147483648,2147516545,2147483648,32896,0,2147483649,2147483648,2147516424]);e.default=t}(jt),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t,r=(t=jt)&&t.__esModule?t:{default:t};var n=function(e){var t=e.A,n=2*e.roundIndex;t[0]^=r.default[n],t[1]^=r.default[n+1]};e.default=n}(Mt);var Ft={},Ht={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=[10,7,11,17,18,3,5,16,8,21,24,4,15,23,19,13,12,2,20,14,22,9,6,1];e.default=t}(Ht);var zt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=[1,3,6,10,15,21,28,36,45,55,2,14,27,41,56,8,25,43,62,18,39,61,20,44];e.default=t}(zt),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=i(Ht),r=i(zt),n=i($t);function i(e){return e&&e.__esModule?e:{default:e}}var o=function(e){var i=e.A,o=e.C,s=e.W;(0,n.default)(i,1)(s,0);for(var a=0,c=0,l=0,u=32,h=0;h<24;h++){var d=t.default[h],f=r.default[h];(0,n.default)(i,d)(o,0),a=s[0],c=s[1],u=32-f,s[l=f<32?0:1]=a<<f|c>>>u,s[(l+1)%2]=c<<f|a>>>u,(0,n.default)(s,0)(i,d),(0,n.default)(o,0)(s,0)}};e.default=o}(Ft);var qt={};function Wt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!e.length&&!t.length)return r;if(!e.length)return r;if(!t.length)return r.push(...e),r;const[n,...i]=e,[o,...s]=t;return void 0!==n&&r.push(n),void 0!==o&&r.push(o),Wt(i,s,r)}function Vt(e){return function(t){return"function"==typeof t?(r.deprecate({pkg:"FCL/SDK",subject:"Interopolation of functions into template literals",transition:"https://github.com/onflow/flow-js-sdk/blob/master/packages/sdk/TRANSITIONS.md#0001-deprecate-params"}),Vt(e)(t(e))):String(t)}}function Kt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return"string"==typeof e?()=>e:"function"==typeof e?e:t=>Wt([...e],r.map(Vt(t))).join("").trim()}!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t,r=(t=$t)&&t.__esModule?t:{default:t};var n=function(e){for(var t=e.A,n=e.C,i=e.D,o=e.W,s=0,a=0,c=0;c<5;c++){var l=2*c,u=2*(c+5),h=2*(c+10),d=2*(c+15),f=2*(c+20);n[l]=t[l]^t[u]^t[h]^t[d]^t[f],n[l+1]=t[l+1]^t[u+1]^t[h+1]^t[d+1]^t[f+1]}for(var p=0;p<5;p++){(0,r.default)(n,(p+1)%5)(o,0),s=o[0],a=o[1],o[0]=s<<1|a>>>31,o[1]=a<<1|s>>>31,i[2*p]=n[(p+4)%5*2]^o[0],i[2*p+1]=n[(p+4)%5*2+1]^o[1];for(var g=0;g<25;g+=5)t[2*(g+p)]^=i[2*p],t[2*(g+p)+1]^=i[2*p+1]}};e.default=n}(qt),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=o(Dt),r=o(Mt),n=o(Ft),i=o(qt);function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){var e=new Uint32Array(10),o=new Uint32Array(10),s=new Uint32Array(2);return function(a){for(var c=0;c<24;c++)(0,i.default)({A:a,C:e,D:o,W:s}),(0,n.default)({A:a,C:e,W:s}),(0,t.default)({A:a,C:e}),(0,r.default)({A:a,roundIndex:c});e.fill(0),o.fill(0),s.fill(0)}};e.default=s}(Lt),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t,r=pe,n=(t=Lt)&&t.__esModule?t:{default:t};var i=function(e,t){for(var r=0;r<e.length;r+=8){var n=r/4;t[n]^=e[r+7]<<24|e[r+6]<<16|e[r+5]<<8|e[r+4],t[n+1]^=e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]}return t},o=function(e,t){for(var r=0;r<t.length;r+=8){var n=r/4;t[r]=e[n+1],t[r+1]=e[n+1]>>>8,t[r+2]=e[n+1]>>>16,t[r+3]=e[n+1]>>>24,t[r+4]=e[n],t[r+5]=e[n]>>>8,t[r+6]=e[n]>>>16,t[r+7]=e[n]>>>24}return t},s=function(e){var t=this,s=e.capacity,a=e.padding,c=(0,n.default)(),l=s/8,u=200-s/4,h=0,d=new Uint32Array(50),f=r.Buffer.allocUnsafe(u);return this.absorb=function(e){for(var r=0;r<e.length;r++)f[h]=e[r],(h+=1)>=u&&(i(f,d),c(d),h=0);return t},this.squeeze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={buffer:e.buffer||r.Buffer.allocUnsafe(l),padding:e.padding||a,queue:r.Buffer.allocUnsafe(f.length),state:new Uint32Array(d.length)};f.copy(t.queue);for(var n=0;n<d.length;n++)t.state[n]=d[n];t.queue.fill(0,h),t.queue[h]|=t.padding,t.queue[u-1]|=128,i(t.queue,t.state);for(var s=0;s<t.buffer.length;s+=u)c(t.state),o(t.state,t.buffer.slice(s,s+u));return t.buffer},this.reset=function(){return f.fill(0),d.fill(0),h=0,t},this};e.default=s}(Bt),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.SHAKE=e.SHA3Hash=e.SHA3=e.Keccak=void 0;var t,r=pe,n=(t=Bt)&&t.__esModule?t:{default:t};var i=function(e){var t=e.allowedSizes,i=e.defaultSize,o=e.padding;return function e(){var s=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;if(!this||this.constructor!==e)return new e(a);if(t&&!t.includes(a))throw new Error("Unsupported hash length");var c=new n.default({capacity:a});return this.update=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";if(r.Buffer.isBuffer(e))return c.absorb(e),s;if("string"==typeof e)return s.update(r.Buffer.from(e,t));throw new TypeError("Not a string or buffer")},this.digest=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"binary",t="string"==typeof e?{format:e}:e,r=c.squeeze({buffer:t.buffer,padding:t.padding||o});return t.format&&"binary"!==t.format?r.toString(t.format):r},this.reset=function(){return c.reset(),s},this}},o=i({allowedSizes:[224,256,384,512],defaultSize:512,padding:1});e.Keccak=o;var s=i({allowedSizes:[224,256,384,512],defaultSize:512,padding:6});e.SHA3=s;var a=i({allowedSizes:[128,256],defaultSize:256,padding:31});e.SHAKE=a;var c=o;e.SHA3Hash=c,s.SHA3Hash=c;var l=s;e.default=l}(Ut);const Gt=(e,t,n)=>({label:e,asArgument:t,asInjection:t=>(r.deprecate({pkg:"@onflow/types",subject:`Passing in ${e} as value for ${e}`,message:`Going forward, use ${e} as value for ${e}.`}),n(t))}),Zt=e=>Array.isArray(e),Yt=e=>"object"==typeof e,Jt=e=>null==e,Xt=e=>"number"==typeof e,Qt=e=>Number.isInteger(e),er=e=>"string"==typeof e,tr=e=>{throw new Error("Type Error: "+e)},rr=e=>{r.deprecate({pkg:"@onflow/types",subject:`Passing in Number as value for ${e}`,message:`Going forward, use String as value for ${e}.`,transition:"https://github.com/onflow/flow-js-sdk/blob/master/packages/types/WARNINGS.md#0002-[U]Int*-and-Word*-as-Number"})};let nr=!1;const ir={label:"Identity",asArgument:e=>(nr||(r.deprecate({pkg:"@onflow/types",subject:"Identity",message:"Identity type is deprecated and will be removed in v2.0.0.  Please remove it from your code."}),nr=!0),e),asInjection:e=>e},or=Gt("UInt",e=>Xt(e)&&Qt(e)?(rr("UInt"),{type:"UInt",value:e.toString()}):er(e)?{type:"UInt",value:e}:tr("Expected Positive Integer for type Unsigned Int"),e=>e),sr=Gt("Int",e=>Xt(e)&&Qt(e)?(rr("Int"),{type:"Int",value:e.toString()}):er(e)?{type:"Int",value:e}:tr("Expected Integer for type Int"),e=>e),ar=Gt("UInt8",e=>Xt(e)&&Qt(e)?(rr("UInt8"),{type:"UInt8",value:e.toString()}):er(e)?{type:"UInt8",value:e}:tr("Expected integer for UInt8"),e=>e),cr=Gt("Int8",e=>Xt(e)&&Qt(e)?(rr("Int8"),{type:"Int8",value:e.toString()}):er(e)?{type:"Int8",value:e}:tr("Expected positive integer for Int8"),e=>e),lr=Gt("UInt16",e=>Xt(e)&&Qt(e)?(rr("UInt16"),{type:"UInt16",value:e.toString()}):er(e)?{type:"UInt16",value:e}:tr("Expected integer for UInt16"),e=>e),ur=Gt("Int16",e=>Xt(e)&&Qt(e)?(rr("Int16"),{type:"Int16",value:e.toString()}):er(e)?{type:"Int16",value:e}:tr("Expected positive integer for Int16"),e=>e),hr=Gt("UInt32",e=>Xt(e)&&Qt(e)?(rr("UInt32"),{type:"UInt32",value:e.toString()}):er(e)?{type:"UInt32",value:e}:tr("Expected integer for UInt32"),e=>e),dr=Gt("Int32",e=>Xt(e)&&Qt(e)?(rr("Int32"),{type:"Int32",value:e.toString()}):er(e)?{type:"Int32",value:e}:tr("Expected positive integer for Int32"),e=>e),fr=Gt("UInt64",e=>Xt(e)&&Qt(e)?(rr("UInt64"),{type:"UInt64",value:e.toString()}):er(e)?{type:"UInt64",value:e}:tr("Expected integer for UInt64"),e=>e),pr=Gt("Int64",e=>Xt(e)&&Qt(e)?(rr("Int64"),{type:"Int64",value:e.toString()}):er(e)?{type:"Int64",value:e}:tr("Expected positive integer for Int64"),e=>e),gr=Gt("UInt128",e=>Xt(e)&&Qt(e)?(rr("UInt128"),{type:"UInt128",value:e.toString()}):er(e)?{type:"UInt128",value:e}:tr("Expected integer for UInt128"),e=>e),mr=Gt("Int128",e=>Xt(e)&&Qt(e)?(rr("Int128"),{type:"Int128",value:e.toString()}):er(e)?{type:"Int128",value:e}:tr("Expected positive integer for Int128"),e=>e),yr=Gt("UInt256",e=>Xt(e)&&Qt(e)?(rr("UInt256"),{type:"UInt256",value:e.toString()}):er(e)?{type:"UInt256",value:e}:tr("Expected integer for UInt256"),e=>e),wr=Gt("Int256",e=>Xt(e)&&Qt(e)?(rr("Int256"),{type:"Int256",value:e.toString()}):er(e)?{type:"Int256",value:e}:tr("Expected integer for Int256"),e=>e),br=Gt("Word8",e=>Xt(e)&&Qt(e)?(rr("Word8"),{type:"Word8",value:e.toString()}):er(e)?{type:"Word8",value:e}:tr("Expected positive number for Word8"),e=>e),vr=Gt("Word16",e=>Xt(e)&&Qt(e)?(rr("Word16"),{type:"Word16",value:e.toString()}):er(e)?{type:"Word16",value:e}:tr("Expected positive number for Word16"),e=>e),Er=Gt("Word32",e=>Xt(e)&&Qt(e)?(rr("Word32"),{type:"Word32",value:e.toString()}):er(e)?{type:"Word32",value:e}:tr("Expected positive number for Word32"),e=>e),xr=Gt("Word64",e=>Xt(e)&&Qt(e)?(rr("Word64"),{type:"Word64",value:e.toString()}):er(e)?{type:"Word64",value:e}:tr("Expected positive number for Word64"),e=>e),Ir=Gt("Word128",e=>Xt(e)&&Qt(e)?(rr("Word128"),{type:"Word128",value:e.toString()}):er(e)?{type:"Word128",value:e}:tr("Expected positive number for Word128"),e=>e),_r=Gt("Word256",e=>Xt(e)&&Qt(e)?(rr("Word256"),{type:"Word256",value:e.toString()}):er(e)?{type:"Word256",value:e}:tr("Expected positive number for Word256"),e=>e),Sr=()=>{r.deprecate({subject:"Passing in Numbers as values for Fix64 and UFix64 types",pkg:"@onflow/types",transition:"https://github.com/onflow/flow-js-sdk/blob/master/packages/types/WARNINGS.md#0001-[U]Fix64-as-Number"})},Ar=Gt("UFix64",e=>{if(er(e)){const t=e.split(".");return 2!==t.length?tr(`Expected one decimal but found ${t.length} in the [U]Fix64 value. Find out more about [U]Fix64 types here: https://docs.onflow.org/cadence/json-cadence-spec/#fixed-point-numbers`):0==t[1].length||t[1].length>8?tr(`Expected at least one digit, and at most 8 digits following the decimal of the [U]Fix64 value but found ${t[1].length} digits. Find out more about [U]Fix64 types here: https://docs.onflow.org/cadence/json-cadence-spec/#fixed-point-numbers`):(t[1]=t[1].padEnd(8,"0"),{type:"UFix64",value:e=t.join(".")})}return Xt(e)?(Sr(),{type:"UFix64",value:e.toString()}):tr("Expected String for UFix64")},e=>e),Or=Gt("Fix64",e=>{if(er(e)){const t=e.split(".");return 2!==t.length?tr(`Expected one decimal but found ${t.length} in the [U]Fix64 value. Find out more about [U]Fix64 types here: https://docs.onflow.org/cadence/json-cadence-spec/#fixed-point-numbers`):0==t[1].length||t[1].length>8?tr(`Expected at least one digit, and at most 8 digits following the decimal of the [U]Fix64 value but found ${t[1].length} digits. Find out more about [U]Fix64 types here: https://docs.onflow.org/cadence/json-cadence-spec/#fixed-point-numbers`):(t[1]=t[1].padEnd(8,"0"),{type:"Fix64",value:e=t.join(".")})}return Xt(e)?(Sr(),{type:"Fix64",value:e.toString()}):tr("Expected String for Fix64")},e=>e),Cr=Gt("String",e=>er(e)?{type:"String",value:e}:tr("Expected String for type String"),e=>e),Pr=Gt("Character",e=>er(e)?{type:"Character",value:e}:tr("Expected Character for type Character"),e=>e),Rr=Gt("Bool",e=>(e=>"boolean"==typeof e)(e)?{type:"Bool",value:e}:tr("Expected Boolean for type Bool"),e=>e),Tr=Gt("Address",e=>er(e)?{type:"Address",value:e}:tr("Expected Address for type Address"),e=>e),kr=Gt("Void",e=>!e||Jt(e)?{type:"Void",value:null}:tr("Expected Void for type Void"),e=>e),Nr=Gt("Reference",e=>Yt(e)?{type:"Reference",value:e}:tr("Expected Object for type Reference"),e=>e),Ur=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Gt("Array",t=>({type:"Array",value:Zt(e)?e.map((e,r)=>e.asArgument(t[r])):t.map(t=>e.asArgument(t))}),e=>e)},Br=Gt("Path",e=>Yt(e)?er(e.domain)?"storage"!==e.domain&&"private"!==e.domain&&"public"!==e.domain?tr(`Expected either "storage", "private" or "public" as the Path domain but found ${e.domain}. Find out more about the Path type here: https://docs.onflow.org/cadence/json-cadence-spec/#path`):er(e.identifier)?{type:"Path",value:{domain:e.domain,identifier:e.identifier}}:tr(`Expected a string for the Path identifier but found ${e.identifier}. Find out more about the Path type here: https://docs.onflow.org/cadence/json-cadence-spec/#path`):tr(`Expected a string for the Path domain but found ${e.domain}. Find out more about the Path type here: https://docs.onflow.org/cadence/json-cadence-spec/#path`):tr("Expected Object for type Path"),e=>e);var Lr=Object.freeze({__proto__:null,Address:Tr,Array:Ur,Bool:Rr,Character:Pr,Dictionary:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Gt("Dictionary",t=>{const r=Zt(t),n=Zt(e);return Yt(t)?{type:"Dictionary",value:n&&r?e.map((e,r)=>({key:e.key.asArgument(t[r].key),value:e.value.asArgument(t[r].value)})):r&&!n?t.map(t=>({key:e.key.asArgument(t.key),value:e.value.asArgument(t.value)})):r||n?tr("Invalid arguments for Dictionary."):[{key:e.key.asArgument(t.key),value:e.value.asArgument(t.value)}]}:tr("Expected Object for type Dictionary")},e=>e)},Enum:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Gt("Enum",r=>Yt(r)?{type:"Enum",value:{id:e,fields:Zt(t)?t.map((e,t)=>({name:r.fields[t].name,value:e.value.asArgument(r.fields[t].value)})):r.fields.map(e=>({name:e.name,value:t.value.asArgument(e.value)}))}}:tr("Expected Object for type Enum"),e=>e)},Event:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Gt("Event",r=>Yt(r)?{type:"Event",value:{id:e,fields:Zt(t)?t.map((e,t)=>({name:r.fields[t].name,value:e.value.asArgument(r.fields[t].value)})):r.fields.map(e=>({name:e.name,value:t.value.asArgument(e.value)}))}}:tr("Expected Object for type Event"),e=>e)},Fix64:Or,Identity:ir,InclusiveRange:e=>Gt("InclusiveRange",t=>{if(Yt(t)){const{start:r,end:n,step:i}=t;return{type:"InclusiveRange",value:{start:e.asArgument(r),end:e.asArgument(n),step:e.asArgument(i)}}}return tr("Expected Object for type InclusiveRange")},e=>e),Int:sr,Int128:mr,Int16:ur,Int256:wr,Int32:dr,Int64:pr,Int8:cr,Optional:e=>Gt("Optional",t=>({type:"Optional",value:Jt(t)?null:e.asArgument(t)}),e=>e),Path:Br,Reference:Nr,Resource:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Gt("Resource",r=>Yt(r)?{type:"Resource",value:{id:e,fields:Zt(t)?t.map((e,t)=>({name:r.fields[t].name,value:e.value.asArgument(r.fields[t].value)})):r.fields.map(e=>({name:e.name,value:t.value.asArgument(e.value)}))}}:tr("Expected Object for type Resource"),e=>e)},String:Cr,Struct:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Gt("Struct",r=>Yt(r)?{type:"Struct",value:{id:e,fields:Zt(t)?t.map((e,t)=>({name:r.fields[t].name,value:e.value.asArgument(r.fields[t].value)})):r.fields.map(e=>({name:e.name,value:t.value.asArgument(e.value)}))}}:tr("Expected Object for type Struct"),e=>e)},UFix64:Ar,UInt:or,UInt128:gr,UInt16:lr,UInt256:yr,UInt32:hr,UInt64:fr,UInt8:ar,Void:kr,Word128:Ir,Word16:vr,Word256:_r,Word32:Er,Word64:xr,Word8:br,_Array:Ur});const Dr=`{\n  "kind":"${f.ACCOUNT}",\n  "tempId":null,\n  "addr":null,\n  "keyId":null,\n  "sequenceNum":null,\n  "signature":null,\n  "signingFunction":null,\n  "resolve":null,\n  "role": {\n    "proposer":false,\n    "authorizer":false,\n    "payer":false,\n    "param":false\n  }\n}`,$r=`{\n  "kind":"${f.ARGUMENT}",\n  "tempId":null,\n  "value":null,\n  "asArgument":null,\n  "xform":null,\n  "resolve": null,\n  "resolveArgument": null\n}`,Mr=`{\n  "tag":"${u.UNKNOWN}",\n  "assigns":{},\n  "status":"${h.OK}",\n  "reason":null,\n  "accounts":{},\n  "params":{},\n  "arguments":{},\n  "message": {\n    "cadence":null,\n    "refBlock":null,\n    "computeLimit":null,\n    "proposer":null,\n    "payer":null,\n    "authorizations":[],\n    "params":[],\n    "arguments":[]\n  },\n  "proposer":null,\n  "authorizations":[],\n  "payer":[],\n  "events": {\n    "eventType":null,\n    "start":null,\n    "end":null,\n    "blockIds":[]\n  },\n  "subscribeEvents": {\n    "startBlockId":null,\n    "startHeight":null,\n    "eventTypes":null,\n    "addresses":null,\n    "contracts":null,\n    "heartbeatInterval":null\n  },\n  "transaction": {\n    "id":null\n  },\n  "block": {\n    "id":null,\n    "height":null,\n    "isSealed":null\n  },\n  "account": {\n    "addr":null\n  },\n  "collection": {\n    "id":null\n  }\n}`,jr=new Set(Object.keys(JSON.parse(Mr))),Fr=()=>JSON.parse(Mr),Hr=()=>(r.deprecate({pkg:"FCL/SDK",message:"The interaction been deprecated from the Flow JS-SDK/FCL. use initInteraction instead",transition:"https://github.com/onflow/flow-js-sdk/blob/master/packages/sdk/TRANSITIONS.md#0010-deprecate-interaction",level:t.warn}),Fr()),zr=e=>"number"==typeof e,qr=e=>Array.isArray(e),Wr=e=>null!==e&&"object"==typeof e,Vr=e=>null==e,Kr=e=>"function"==typeof e,Gr=e=>{if(!Wr(e)||Vr(e)||zr(e))return!1;for(let t of jr)if(!e.hasOwnProperty(t))return!1;return!0},Zr=e=>(e.status=h.OK,e),Yr=(e,t)=>(e.status=h.BAD,e.reason=t,e),Jr=e=>t=>(t.tag=e,Zr(t)),Xr=e=>null==e.keyId?e:(n(!isNaN(parseInt(e.keyId.toString())),"account.keyId must be an integer"),{...e,keyId:parseInt(e.keyId.toString())}),Qr=()=>JSON.parse(Dr),en=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r=>{n("function"==typeof e||"object"==typeof e,"prepAccount must be passed an authorization function or an account object"),n(null!=t.role,"Account must have a role");const i=Qr(),o=t.role,s=l();let a={...e};e.authorization&&Kr(e.authorization)&&(a={resolve:e.authorization}),!e.authorization&&Kr(e)&&(a={resolve:e});const c=a.resolve;return c&&(a.resolve=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return[c,Xr].reduce(async(e,t)=>t(await e,...r),e)}),a=Xr(a),r.accounts[s]={...i,tempId:s,...a,role:{...i.role,..."object"==typeof e.role?e.role:{},...o?{[o]:!0}:{}}},o===d.AUTHORIZER?r.authorizations.push(s):o===d.PAYER?r.payer.push(s):o&&(r[o]=s),r}},tn=e=>t=>{let r=l();return t.message.arguments.push(r),t.arguments[r]=JSON.parse($r),t.arguments[r].tempId=r,t.arguments[r].value=e.value,t.arguments[r].asArgument=e.asArgument,t.arguments[r].xform=e.xform,t.arguments[r].resolve=e.resolve,t.arguments[r].resolveArgument=Kr(e.resolveArgument)?e.resolveArgument.bind(e):e.resolveArgument,Zr(t)},rn=Jr(u.UNKNOWN),nn=Jr(u.SCRIPT),on=Jr(u.TRANSACTION),sn=Jr(u.GET_TRANSACTION_STATUS),an=Jr(u.GET_TRANSACTION),cn=Jr(u.GET_ACCOUNT),ln=Jr(u.GET_EVENTS),un=Jr(u.PING),hn=Jr(u.GET_BLOCK),dn=Jr(u.GET_BLOCK_HEADER),fn=Jr(u.GET_COLLECTION),pn=Jr(u.GET_NETWORK_PARAMETERS),gn=Jr(u.SUBSCRIBE_EVENTS),mn=Jr(u.GET_NODE_VERSION_INFO),yn=e=>t=>t.tag===e,wn=yn(u.UNKNOWN),bn=yn(u.SCRIPT),vn=yn(u.TRANSACTION),En=yn(u.GET_TRANSACTION_STATUS),xn=yn(u.GET_TRANSACTION),In=yn(u.GET_ACCOUNT),_n=yn(u.GET_EVENTS),Sn=yn(u.PING),An=yn(u.GET_BLOCK),On=yn(u.GET_BLOCK_HEADER),Cn=yn(u.GET_COLLECTION),Pn=yn(u.GET_NETWORK_PARAMETERS),Rn=yn(u.GET_NODE_VERSION_INFO),Tn=yn(u.SUBSCRIBE_EVENTS),kn=e=>e.status===h.BAD,Nn=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];try{if(e=(e=>{for(let t of Object.keys(e))if(!jr.has(t))throw new Error(`"${t}" is an invalid root level Interaction property.`);return e})(await e),kn(e))throw new Error(`Interaction Error: ${e.reason}`);if(!t.length)return e;const[r,...n]=t,i=await r;if(Kr(i))return Nn(i(e),n);if(Vr(i)||!i)return Nn(e,n);if(Gr(i))return Nn(i,n);throw new Error("Invalid Interaction Composition")}catch(e){throw e}};function Un(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[n,i]=t;if(qr(n))return e=>Un(e,n);return Nn(n,i)}const Bn=function(e){return e},Ln=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return null==e.assigns[t]?r:e.assigns[t]},Dn=(e,t)=>r=>(r.assigns[e]=t,Zr(r)),$n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Bn;return r=>(r.assigns[e]=t(r.assigns[e],r),Zr(r))};var Mn=Object.freeze({__proto__:null,Bad:Yr,Ok:Zr,destroy:e=>t=>(delete t.assigns[e],Zr(t)),get:Ln,initAccount:Qr,initInteraction:Fr,interaction:Hr,isAccount:e=>e.kind===f.ACCOUNT,isArgument:e=>e.kind===f.ARGUMENT,isArray:qr,isBad:kn,isFn:Kr,isGetAccount:In,isGetBlock:An,isGetBlockHeader:On,isGetCollection:Cn,isGetEvents:_n,isGetNetworkParameters:Pn,isGetNodeVersionInfo:Rn,isGetTransaction:xn,isGetTransactionStatus:En,isInteraction:Gr,isNull:Vr,isNumber:zr,isObj:Wr,isOk:e=>e.status===h.OK,isPing:Sn,isScript:bn,isSubscribeEvents:Tn,isTransaction:vn,isUnknown:wn,makeArgument:tn,makeGetAccount:cn,makeGetBlock:hn,makeGetBlockHeader:dn,makeGetCollection:fn,makeGetEvents:ln,makeGetNetworkParameters:pn,makeGetNodeVerionInfo:mn,makeGetTransaction:an,makeGetTransactionStatus:sn,makePing:un,makeScript:nn,makeSubscribeEvents:gn,makeTransaction:on,makeUnknown:rn,pipe:Un,prepAccount:en,put:Dn,update:$n,why:e=>e.reason});function jn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Un(Fr(),e)}const Fn={tag:null,transaction:null,transactionStatus:null,transactionId:null,encodedData:null,events:null,event:null,accountStatusEvent:null,account:null,block:null,blockHeader:null,blockDigest:null,latestBlock:null,collection:null,networkParameters:null,streamConnection:null,heartbeat:null,nodeVersionInfo:null},Hn=()=>({...Fn});function zn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Un([hn,t=>(t.block.isSealed=e,Zr(t))])}function qn(e){return Un([cn,t=>(t.account.addr=Pe(e),Zr(t))])}const Wn=(e,t,r)=>{const n=new Ge;let i=function(){let e=[],t=!1;async function r(){if(!t){for(t=!0;e.length>0;){const t=e.shift();await(t?.())}t=!1}}return{push:t=>{e.push(t),r()}}}();function o(t){e.on(t,e=>{i.push(async()=>{n.emit(t,e)})})}return e.on("data",async e=>{const o=Object.keys(e).filter(t=>null!=e[t]&&"tag"!==t);let s=Promise.all(o.map(async n=>{const i={[n]:e[n]};return{channel:n,message:await t(i,r)}}));i.push(async()=>{(await s).forEach(e=>{let{channel:t,message:r}=e;n.emit(t,r)})})}),o("close"),o("error"),{on(e,t){return n.on(e,t),this},off(e,t){return n.off(e,t),this},close:()=>{e.close()}}};const Vn=async e=>e,Kn=async(e,t,r)=>{const n=await e.fields.reduce(async(e,n)=>((e=await e)[n.name]=await Yn(n.value,t,[...r,n.name]),e),Promise.resolve({})),i=e.id&&Zn(t,e.id);return i?await i(n):n},Gn={UInt:Vn,Int:Vn,UInt8:Vn,Int8:Vn,UInt16:Vn,Int16:Vn,UInt32:Vn,Int32:Vn,UInt64:Vn,Int64:Vn,UInt128:Vn,Int128:Vn,UInt256:Vn,Int256:Vn,Word8:Vn,Word16:Vn,Word32:Vn,Word64:Vn,Word128:Vn,Word256:Vn,UFix64:Vn,Fix64:Vn,String:Vn,Character:Vn,Bool:Vn,Address:Vn,Void:async()=>null,Optional:async(e,t,r)=>e?await Yn(e,t,r):null,Reference:Vn,Array:async(e,t,r)=>await Promise.all(e.map(e=>new Promise(async n=>n(await Yn(e,t,[...r,e.type]))))),Dictionary:async(e,t,r)=>await e.reduce(async(e,n)=>((e=await e)[await Yn(n.key,t,[...r,n.key])]=await Yn(n.value,t,[...r,n.key]),e),Promise.resolve({})),Event:Kn,Resource:Kn,Struct:Kn,Enum:Kn,Type:async e=>e.staticType,Path:Vn,Capability:Vn,InclusiveRange:async(e,t,r)=>{const n=["start","end","step"];return await Object.keys(e).reduce(async(i,o)=>(i=await i,n.includes(o)&&(i[o]=await Yn(e[o],t,[...r,o])),i),Promise.resolve({}))}},Zn=(e,t)=>{const r=Object.keys(e).find(e=>{if(/^\/.*\/$/.test(e)){return new RegExp(e.substring(1,e.length-1)).test(t)}return e===t});return t&&r&&e[r]},Yn=async(e,t,r)=>{let n=Zn(t,e.type);if(!n)throw new Error(`Undefined Decoder Error: ${e.type}@${r.join(".")}`);return await n(e.value,t,r)},Jn=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const n=Object.keys(Gn).filter(e=>!Object.keys(t).find(t=>new RegExp(t).test(e))).reduce((e,t)=>(e[t]=Gn[t],e),t),i={...n,...t};return Yn(e,i,r)},Xn=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.encodedData)return Jn(e.encodedData,t);if(e.transactionStatus)return{...e.transactionStatus,events:await Promise.all(e.transactionStatus.events.map(async function(e){return{type:e.type,transactionId:e.transactionId,transactionIndex:e.transactionIndex,eventIndex:e.eventIndex,data:await Jn(e.payload,t)}}))};if(e.transaction)return e.transaction;if(e.events)return await Promise.all(e.events.map(async function(e){return{blockId:e.blockId,blockHeight:e.blockHeight,blockTimestamp:e.blockTimestamp,type:e.type,transactionId:e.transactionId,transactionIndex:e.transactionIndex,eventIndex:e.eventIndex,data:await Jn(e.payload,t)}}));if(e.event){const{payload:r,...n}=e.event;return{...n,data:await Jn(r,t)}}if(e.accountStatusEvent){const{payload:r,...n}=e.accountStatusEvent;return{...n,data:await Jn(r,t)}}if(e.account)return e.account;if(e.block)return e.block;if(e.blockHeader)return e.blockHeader;if(e.blockDigest)return e.blockDigest;if(e.latestBlock)return r.deprecate({pkg:"@onflow/decode",subject:"Operating upon data of the latestBlock field of the response object",transition:"https://github.com/onflow/flow-js-sdk/blob/master/packages/decode/WARNINGS.md#0001-Deprecating-latestBlock-field"}),e.latestBlock;if(e.transactionId)return e.transactionId;if(e.collection)return e.collection;if(e.networkParameters){const t=/^flow-/,r=e.networkParameters.chainId;let n;return n="flow-emulator"===r?"local":t.test(r)?r.replace(t,""):r,{chainId:n}}return e.streamConnection?Wn(e.streamConnection,Xn,t):e.heartbeat?e.heartbeat:e.nodeVersionInfo?e.nodeVersionInfo:null};class Qn extends Error{constructor(){super("The current transport does not support subscriptions.  If you have provided a custom transport (e.g. via `sdk.transport` configuration), ensure that it implements the subscribe method."),this.name="SubscriptionsNotSupportedError"}}function ei(e){const t=e["sdk.transport"]||e["sdk.send"]||Nt;return void 0===(r=t).send||void 0===r.subscribe||"function"!=typeof r.send||"function"!=typeof r.subscribe?{send:t,subscribe:()=>{throw new Qn}}:t;var r}let ti;async function ri(){const e=await le().all();return{get transport(){return ei(e)},get accessNodeUrl(){const t=e["accessNode.api"];return n(!!t,'Either opts.node or "accessNode.api" in config must be defined.'),t},get computeLimit(){const t=e["fcl.limit"];return t||(r.deprecate({pkg:"FCL/SDK",subject:"The built-in default compute limit (DEFAULT_COMPUTE_LIMIT=10)",transition:"https://github.com/onflow/flow-js-sdk/blob/master/packages/sdk/TRANSITIONS.md#0009-deprecate-default-compute-limit"}),10)},get customResolver(){return e["sdk.resolve"]},get customDecoders(){return Object.fromEntries(Object.entries(e).filter(e=>{let[t]=e;return t.startsWith("decoder.")}))},get contracts(){return Object.fromEntries(Object.entries(e).filter(e=>{let[t]=e;return t.startsWith("system.contracts.")}).map(e=>{let[t,r]=e;return[t.replace("system.contracts.",""),r]}))},get debug(){return Object.fromEntries(Object.entries(e).filter(e=>{let[t]=e;return t.startsWith("debug.")}))},get legacyContractIdentifiers(){return Object.fromEntries(Object.entries(e).filter(e=>{let[t]=e;return t.startsWith("0x")}))}}}async function ni(){return ti||(le().subscribe(()=>{ti=ri()}),ti=ri()),ti}function ii(e){return async function(){const t=await ni();return e(t)(...arguments)}}const oi=e=>"function"==typeof e,si=e=>"string"==typeof e;function ai(e){return/\b(0x\w+)\b/g.test(e)}function ci(e){return/import\s+"(\w+)"/g.test(e)}function li(e){return async function(i){if(!vn(i)&&!bn(i))return i;var o=Ln(i,"ix.cadence");if(n(oi(o)||si(o),"Cadence needs to be a function or a string."),oi(o)&&(o=await o({})),n(si(o),"Cadence needs to be a string at this point."),n(!ai(o)||!ci(o),"Both account identifier and contract identifier syntax not simultaneously supported."),ai(o)&&(o=Object.entries(e.legacyContractIdentifiers||{}).reduce((e,t)=>{let[r,n]=t;const i=new RegExp("(\\b"+r+"\\b)","g");return e.replace(i,n)},o)),ci(o))for(const[n,i]of function(e){return e.matchAll(/import\s+"(\w+)"/g)}(o)){const s=e.contracts[i]||null;s?o=o.replace(n,`import ${i} from ${Re(s)}`):r({title:"Contract Placeholder not found",message:`Cannot find a value for contract placeholder ${i}. Please add to your flow.json or explicitly add it to the config 'contracts.*' namespace.`,level:t.warn})}return i.message.cadence=o,i}}const ui=e=>"function"==typeof e;function hi(e){return n(null!=typeof e.xform,`No type specified for argument: ${e.value}`),ui(e.xform)?e.xform(e.value):ui(e.xform.asArgument)?e.xform.asArgument(e.value):void n(!1,"Invalid Argument",e)}async function di(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(n(t>0,`Argument Resolve Recursion Limit Exceeded for Arg: ${e.tempId}`),ui(e.resolveArgument)){return di(await e.resolveArgument(),t-1)}return e}async function fi(e){if(vn(e)||bn(e))for(let[t,r]of Object.entries(e.arguments)){const n=await di(r);e.arguments[t].asArgument=hi(n)}return e}const pi=(e,t)=>pe.Buffer.from(e.padStart(2*t,"0"),"hex"),gi=((e,t)=>pe.Buffer.from(e.padEnd(2*t,"0"),"hex"))(pe.Buffer.from("FLOW-V0.0-transaction").toString("hex"),32).toString("hex"),mi=e=>gi+e,yi=e=>pi(e,8),wi=e=>pi(e,32),bi=e=>pe.Buffer.from(JSON.stringify(e),"utf8"),vi=e=>pe.Buffer.from(e,"utf8"),Ei=e=>Se(e).toString("hex"),xi=e=>(Ai(e),[vi(e.cadence||""),e.arguments.map(bi),wi(e.refBlock||""),e.computeLimit,yi(Pe(e.proposalKey.address||"")),e.proposalKey.keyId,e.proposalKey.sequenceNum,yi(Pe(e.payer)),e.authorizers.map(e=>yi(Pe(e)))]),Ii=e=>(Oi(e),[xi(e),_i(e)]),_i=e=>{const t=Si(e);return e.payloadSigs?.map(e=>({signerIndex:t.get(Pe(e.address))||"",keyId:e.keyId,sig:e.sig})).sort((e,t)=>e.signerIndex>t.signerIndex?1:e.signerIndex<t.signerIndex?-1:e.keyId>t.keyId?1:e.keyId<t.keyId?-1:0).map(e=>{return[e.signerIndex,e.keyId,(t=e.sig,pe.Buffer.from(t,"hex"))];var t})},Si=e=>{const t=new Map;let r=0;const n=e=>{t.has(e)||(t.set(e,r),r++)};return e.proposalKey.address&&n(e.proposalKey.address),n(e.payer),e.authorizers.forEach(n),t},Ai=e=>{ki.forEach(t=>Li(e,t)),Ni.forEach(t=>Li(e.proposalKey,t,"proposalKey"))},Oi=e=>{Ui.forEach(t=>Li(e,t)),e.payloadSigs?.forEach((e,t)=>{Bi.forEach(r=>Li(e,r,"payloadSigs",t))})},Ci=e=>"number"==typeof e,Pi=e=>"string"==typeof e,Ri=e=>null!==e&&"object"==typeof e,Ti=e=>Ri(e)&&e instanceof Array,ki=[{name:"cadence",check:Pi},{name:"arguments",check:Ti},{name:"refBlock",check:Pi,defaultVal:"0"},{name:"computeLimit",check:Ci},{name:"proposalKey",check:Ri},{name:"payer",check:Pi},{name:"authorizers",check:Ti}],Ni=[{name:"address",check:Pi},{name:"keyId",check:Ci},{name:"sequenceNum",check:Ci}],Ui=[{name:"payloadSigs",check:Ti}],Bi=[{name:"address",check:Pi},{name:"keyId",check:Ci},{name:"sig",check:Pi}],Li=(e,t,r,n)=>{const{name:i,check:o,defaultVal:s}=t;if(null==e[i]&&null!=s&&(e[i]=s),null==e[i])throw $i(i,r,n);if(!o(e[i]))throw Mi(i,r,n)},Di=(e,t,r)=>t?null==r?`${t}.${e}`:`${t}.${r}.${e}`:e,$i=(e,t,r)=>new Error(`Missing field ${Di(e,t,r)}`),Mi=(e,t,r)=>new Error(`Invalid field ${Di(e,t,r)}`);function ji(e){let t=new Set(e.authorizations);return e.proposer&&t.add(e.proposer),Array.isArray(e.payer)?e.payer.forEach(e=>t.delete(e)):t.delete(e.payer),Array.from(t)}function Fi(e){let t=new Set(Array.isArray(e.payer)?e.payer:[e.payer]);return Array.from(t)}const Hi=e=>{const t=e.proposer?{address:Re(e.accounts[e.proposer].addr),keyId:e.accounts[e.proposer].keyId,sequenceNum:e.accounts[e.proposer].sequenceNum}:{};return{cadence:e.message.cadence,refBlock:e.message.refBlock||null,computeLimit:e.message.computeLimit,arguments:e.message.arguments.map(t=>e.arguments[t].asArgument),proposalKey:t,payer:Re(e.accounts[Array.isArray(e.payer)?e.payer[0]:e.payer].addr),authorizers:e.authorizations.map(t=>Re(e.accounts[t].addr)).reduce((e,t)=>e.find(e=>e===t)?e:[...e,t],[]),payloadSigs:ji(e).map(t=>({address:Re(e.accounts[t].addr),keyId:e.accounts[t].keyId,sig:e.accounts[t].signature})),envelopeSigs:Fi(e).map(t=>({address:Re(e.accounts[t].addr),keyId:e.accounts[t].keyId,sig:e.accounts[t].signature}))}};var zi=function(e){return e.PAYER="payer",e.PROPOSER="proposer",e.AUTHORIZATIONS="authorizations",e}(zi||{});function qi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return t<=0?e:Array.isArray(e)?qi(e.flatMap(e=>e),t-1):e}function Wi(e,t){var r;"string"!=typeof t.addr||"number"!=typeof t.keyId&&"string"!=typeof t.keyId?t.tempId=t.tempId||l():t.tempId=`${Re((r=t).addr)}-${r.keyId}`;const n=e.accounts[t.tempId]||t;return e.accounts[t.tempId]||(e.accounts[t.tempId]=t),e.accounts[t.tempId].role.proposer=n.role.proposer||t.role.proposer,e.accounts[t.tempId].role.payer=n.role.payer||t.role.payer,e.accounts[t.tempId].role.authorizer=n.role.authorizer||t.role.authorizer,e.accounts[t.tempId]}function Vi(e){const t=qi(e),r=new Set,n=t.map(e=>{const t=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.join("-")}(e.tempId,e.role.payer,e.role.proposer,e.role.authorizer,e.role.param);return r.has(t)?null:(r.add(t),e)}).filter(e=>null!==e);return n}async function Ki(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,{debugLogger:n}=arguments.length>3?arguments[3]:void 0;if(r<=0)throw new Error("recurseResolveAccount Error: Depth limit (5) reached. Ensure your authorization functions resolve to an account after 5 resolves.");let i=e.accounts[t];if(!i)return[[],!1];if(n(`account: ${i.tempId}`,Math.max(5-r,0)),i?.resolve){if((e=>e&&("[object Function]"===Object.prototype.toString.call(e)||"function"==typeof e||e instanceof Function))(i?.resolve)){n(`account: ${i.tempId} -- cache MISS`,Math.max(5-r,0));const{resolve:t,...o}=i;let s=await t(o,function(e,t){try{return{f_type:"PreSignable",f_vsn:"1.0.1",roles:e.role,cadence:t.message.cadence,args:t.message.arguments.map(e=>t.arguments[e].asArgument),data:{},interaction:t,voucher:Hi(t)}}catch(e){throw console.error("buildPreSignable",e),e}}(o,e));s=Array.isArray(s)?s:[s];let a=qi(s);return a=a.map(t=>Wi(e,t)),i.resolve=a.map(e=>e.tempId),i=Wi(e,i),[a.map(e=>e.tempId),!0]}return n(`account: ${i.tempId} -- cache HIT`,Math.max(5-r,0)),[i.resolve,!1]}return[i.tempId?[i.tempId]:[],!1]}const Gi=e=>null===e?[]:Array.isArray(e)?e:[e];async function Zi(e,t,r){for(let n of Object.values(zi))if(n===zi.AUTHORIZATIONS||n===zi.PAYER)e[n]=Gi(e[n]).reduce((e,i)=>i===t?e.concat(...r.filter(e=>n===zi.PAYER&&e.role.payer||n===zi.AUTHORIZATIONS&&e.role.authorizer).map(e=>e.tempId)):e.concat(i),[]);else if(n===zi.PROPOSER){const t=r.filter(e=>e.role.proposer);if(t.length>1)throw new Error("replaceRoles Error: Multiple proposer keys were resolved, but only one is allowed");e[n]=t[0]?.tempId??e[n]}}async function Yi(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,{debugLogger:i}=arguments.length>3?arguments[3]:void 0;n(e&&"object"==typeof e,"resolveAccountType Error: ix not defined");let o,s=new Set;for(let o of t){let t=e.accounts[o];n(Boolean(t),"resolveAccountType Error: account not found");const[a,c]=await Ki(e,o,r,{debugLogger:i});if(c){const t=Vi(a.map(t=>e.accounts[t]));t.forEach(e=>s.add(e.tempId)),Zi(e,o,t)}}for(const t of e[zi.PAYER]){let r=e.accounts[t];if(o){if(o!==r.addr)throw new Error("resolveAccountType Error: payers from different accounts detected")}else o=r.addr}return s}async function Ji(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(vn(e)){Array.isArray(e.payer)||r.deprecate({pkg:"FCL",subject:'"ix.payer" must be an array. Support for ix.payer as a singular',message:"See changelog for more info."});let[i,o]=function(){const e=[];return[function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.push(Array(4*r).fill(" ").join("-")+t)},function(){return e.reduce((e,t)=>e+"\n"+t)}]}();try{let r=5,s=new Set([...Gi(e[zi.PAYER]),...Gi(e[zi.PROPOSER]),...Gi(e[zi.AUTHORIZATIONS])]);for(;s.size>0;){if(r<=0)throw new Error("resolveAccounts Error: Depth limit (5) reached. Ensure your authorization functions resolve to an account after 5 resolves.");s=await Yi(e,s,r,{debugLogger:i}),r--}await async function(e){const t=Array.isArray(e.payer)?e.payer:[e.payer],r=Array.isArray(e.authorizations)?e.authorizations:[e.authorizations],n=null===e.proposer?[]:Array.isArray(e.proposer)?e.proposer:[e.proposer],i=Object.keys(e.accounts),o=[...new Set(t.concat(r,n))];for(const t of i)o.find(e=>e===t)||delete e.accounts[t]}(e);for(const t of Object.values(zi))n(Gi(e[t]).length>0||t===zi.AUTHORIZATIONS,`resolveAccountType Error: no accounts for role "${t}" found`);t.enableDebug&&console.debug(o())}catch(e){throw console.error("=== SAD PANDA ===\n\n",e,"\n\n=== SAD PANDA ==="),e}}return e}async function Xi(e){if(vn(e))try{let r=ji(e);const n=(t=eo(e),mi(Ei(xi(t))));await Promise.all(r.map(Qi(e,n)));let i=Fi(e);const o=(e=>mi(Ei(Ii(e))))({...eo(e),payloadSigs:r.map(t=>({address:e.accounts[t].addr||"",keyId:e.accounts[t].keyId||0,sig:e.accounts[t].signature||""}))});await Promise.all(i.map(Qi(e,o)))}catch(t){throw console.error("Signatures",t,{ix:e}),t}var t;return e}function Qi(e,t){return async function(r){const n=e.accounts[r];if(null!=n.signature&&void 0!==n.signature)return;const{signature:i}=await n.signingFunction(function(e,t,r){try{return{f_type:"Signable",f_vsn:"1.0.1",message:t,addr:Pe(e.addr),keyId:e.keyId,roles:e.role,cadence:r.message.cadence,args:r.message.arguments.map(e=>r.arguments[e].asArgument),data:{},interaction:r,voucher:Hi(r)}}catch(e){throw console.error("buildSignable",e),e}}(n,t,e));e.accounts[r].signature=i}}function eo(e){const t=Pe((Array.isArray(e.payer)?e.accounts[e.payer[0]]:e.accounts[e.payer]).addr||""),r=e.proposer?{address:Pe(e.accounts[e.proposer].addr)||"",keyId:e.accounts[e.proposer].keyId||0,sequenceNum:e.accounts[e.proposer].sequenceNum||0}:{};return{cadence:e.message.cadence,refBlock:e.message.refBlock,computeLimit:e.message.computeLimit,arguments:e.message.arguments.map(t=>e.arguments[t].asArgument),proposalKey:r,payer:t,authorizers:e.authorizations.map(t=>Pe(e.accounts[t].addr)||"").reduce((e,t)=>e.find(e=>e===t)?e:[...e,t],[])}}async function to(e){return Un(e,Ln(e,"ix.validators",[]).map(e=>t=>e(t,{Ok:Zr,Bad:Yr})))}async function ro(e){for(let t of Object.keys(e.accounts))e.accounts[t].addr=Pe(e.accounts[t].addr);return e}async function no(e){const t=Ln(e,"ix.voucher-intercept");return Kr(t)&&await t(Hi(e)),e}function io(e){return async function(t){return vn(t)&&(t.message.computeLimit=t.message.computeLimit||e.computeLimit),t}}const oo=e=>e,so=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oo;return async r=>(await le.get(`debug.${e}`)&&await t(r,function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];console.log(`debug[${e}] ---\n`,...r,"\n\n\n---")},e=>["\nAccounts:",{proposer:e.proposer,authorizations:e.authorizations,payer:e.payer},"\n\nDetails:",e.accounts].filter(Boolean)),r)};function ao(e){return async t=>Un([li(e),so("cadence",(e,t)=>t(e.message.cadence)),io(e),so("compute limit",(e,t)=>t(e.message.computeLimit)),fi,so("arguments",(e,t)=>t(e.message.arguments,e.message)),Ji,so("accounts",(e,t,r)=>t(...r(e))),lo(e),uo(e),Xi,so("signatures",(e,t,r)=>t(...r(e))),ro,to,no,so("resolved",(e,t)=>t(e))])(t)}const co=ii(ao);function lo(e){return async function(t){if(vn(t)&&null==t.message.refBlock){const r=e.transport.send;t.message.refBlock=(await r(jn([zn()]),{response:Hn,Buffer:pe.Buffer,ix:Mn},{get node(){return e.accessNodeUrl}}).then(Xn)).id}return t}}function uo(e){return async function(t){if(vn(t)){var r=Object.values(t.accounts).find(e=>e.role.proposer);if(n(void 0!==r,"Transactions require a proposer"),r&&null==r.sequenceNum){const n=e.transport.send;t.accounts[r.tempId].sequenceNum=await n(await jn([qn(r.addr)]),{response:Hn,Buffer:pe.Buffer,ix:Mn},{get node(){return e.accessNodeUrl}}).then(Xn).then(e=>e.keys).then(e=>e.find(e=>e.index===r.keyId)).then(e=>e.sequenceNumber)}}return t}}function ho(e){return async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=r.transport||e.transport,o=i.send?.bind?.(i);n(!!o,"Required value for sdk.transport is not defined in config. See: https://github.com/onflow/fcl-js/blob/master/packages/sdk/CHANGELOG.md#0057-alpha1----2022-01-21");const s=r.resolve||e.customResolver||ao(e);return r.node=r.node||e.accessNodeUrl,Array.isArray(t)&&(t=Un(Fr(),t)),o(await s(t),{response:Hn,ix:Mn,Buffer:pe.Buffer},r)}}const fo=ii(ho);function po(e){return function(t){let{topic:r,args:i,onData:o,onError:s}=t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=async function(){try{const t=await e,c=a.transport||t.transport,l=a.node||t.accessNodeUrl;return n(!!l,'SDK Send Error: Either opts.node or "accessNode.api" in config must be defined.'),c.subscribe({topic:r,args:i,onData:o,onError:s},{node:l,...a})}catch(e){return void s(e instanceof Error?e:new Error(String(e)))}}();return{unsubscribe:()=>{c.then(e=>e?.unsubscribe?.())}}}}function go(e){let{topic:t,args:r,onData:n,onError:i}=e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return po(ni())({topic:t,args:r,onData:n,onError:i},o)}function mo(e){let{topic:t,args:r,onData:n,onError:i}=e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=po(ni())({topic:t,args:r,onData:e=>{Xn(e).then(n).catch(e=>{i(new Error(`Failed to decode response: ${e.message}`)),s?.unsubscribe?.()})},onError:i},o);return s}function yo(e){return async function(t){return Xn(t,e.customDecoders)}}const wo=ii(yo);function bo(e){return $n("ix.validators",t=>Array.isArray(t)?[...t,e]:[e])}function vo(e){return Un([t=>(t.block.height=e,t),bo(e=>{if("boolean"==typeof e.block.isSealed)throw new Error("Unable to specify both block height and isSealed.");if(e.block.id)throw new Error("Unable to specify both block height and block id.");return e})])}function Eo(e){return Un([t=>(t.block.id=e,Zr(t)),bo((e,t)=>{let{Ok:r,Bad:n}=t;return In(e)?n(e,"Unable to specify a block id with a Get Account interaction."):"boolean"==typeof e.block.isSealed?n(e,"Unable to specify both block id and isSealed."):e.block.height?n(e,"Unable to specify both block id and block height."):r(e)})])}function xo(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Un([t=>(t.block.isSealed=e,t),bo(e=>{if(e.block.id)throw new Error("Unable to specify both block finality and block id.");if(e.block.height)throw new Error("Unable to specify both block finality and block height.");return e})])}function Io(e){return async function(t){let{height:r,id:i,isSealed:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return n(!(i&&r||i&&o||r&&o),"Method: account -- Only one of the following parameters can be provided: id, height, isSealed"),i?await ho(e)([qn(t),Eo(i)],s).then(Xn):r?await ho(e)([qn(t),vo(r)],s).then(Xn):await ho(e)([qn(t),xo(o??!1)],s).then(Xn)}}const _o=ii(Io);function So(e){return async function(){let{sealed:t=!1,id:r,height:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n(!(t&&r||t&&i),'Method: block -- Cannot pass "sealed" with "id" or "height"'),n(!(r&&i),'Method: block -- Cannot pass "id" and "height" simultaneously'),r?await ho(e)([zn(),Eo(r)],o).then(Xn):i?await ho(e)([zn(),vo(i)],o).then(Xn):await ho(e)([zn(t)],o).then(Xn)}}const Ao=ii(So);function Oo(){return Un((arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(e=>en(e,{role:d.AUTHORIZER})))}function Co(e){return Un([sn,t=>(t.transaction.id=e,Zr(t))])}function Po(e){return t=>(t.message.computeLimit=e,t)}function Ro(e){return Un(e.map(tn))}function To(e,t){return{value:e,xform:t}}function ko(e){return en(e,{role:d.PROPOSER})}function No(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)||(e=[e]),Un(e.map(e=>en(e,{role:d.PAYER})))}function Uo(){return Un([nn,Dn("ix.cadence",Kt(...arguments))])}const Bo=[];function Lo(){return Un([on,Dn("ix.cadence",Kt(...arguments)),e=>(e.message.refBlock=e.message.refBlock||null,e.authorizations=e.authorizations||Bo,Zr(e))])}var Do={exports:{}};Do.exports=function(){return e={418:function(e,t){!function(e,t){for(var r in t)e[r]=t[r]}(t,function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={splitValues:!1});var r,i=this;this.headersMap={},e&&("undefined"!=typeof Headers&&e instanceof Headers?n.getHeaderKeys(e).forEach(function(r){n.getHeaderValues(e,r).forEach(function(e){t.splitValues?i.append(r,n.splitHeaderValue(e)):i.append(r,e)})}):"object"==typeof(r=e)&&"object"==typeof r.headersMap&&"function"==typeof r.forEach?e.forEach(function(e,t){i.append(e,t)}):"undefined"!=typeof Map&&e instanceof Map?e.forEach(function(e,t){i.append(t,e)}):"string"==typeof e?this.appendFromString(e):"object"==typeof e&&Object.getOwnPropertyNames(e).forEach(function(t){var r=e[t];Array.isArray(r)?r.forEach(function(e){i.append(t,e)}):i.append(t,r)}))}return e.prototype.appendFromString=function(e){for(var t=e.split("\r\n"),r=0;r<t.length;r++){var n=t[r],i=n.indexOf(":");if(i>0){var o=n.substring(0,i).trim(),s=n.substring(i+1).trim();this.append(o,s)}}},e.prototype.delete=function(e,t){var r=n.normalizeName(e);if(void 0===t)delete this.headersMap[r];else{var i=this.headersMap[r];if(i){var o=i.indexOf(t);o>=0&&i.splice(o,1),0===i.length&&delete this.headersMap[r]}}},e.prototype.append=function(e,t){var r=this,i=n.normalizeName(e);Array.isArray(this.headersMap[i])||(this.headersMap[i]=[]),Array.isArray(t)?t.forEach(function(e){r.headersMap[i].push(n.normalizeValue(e))}):this.headersMap[i].push(n.normalizeValue(t))},e.prototype.set=function(e,t){var r=n.normalizeName(e);if(Array.isArray(t)){var i=[];t.forEach(function(e){i.push(n.normalizeValue(e))}),this.headersMap[r]=i}else this.headersMap[r]=[n.normalizeValue(t)]},e.prototype.has=function(e,t){var r=this.headersMap[n.normalizeName(e)];if(!Array.isArray(r))return!1;if(void 0!==t){var i=n.normalizeValue(t);return r.indexOf(i)>=0}return!0},e.prototype.get=function(e){var t=this.headersMap[n.normalizeName(e)];return void 0!==t?t.concat():[]},e.prototype.forEach=function(e){var t=this;Object.getOwnPropertyNames(this.headersMap).forEach(function(r){e(r,t.headersMap[r])},this)},e.prototype.toHeaders=function(){if("undefined"!=typeof Headers){var e=new Headers;return this.forEach(function(t,r){r.forEach(function(r){e.append(t,r)})}),e}throw new Error("Headers class is not defined")},e}();t.BrowserHeaders=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.BrowserHeaders=n.BrowserHeaders},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.iterateHeaders=function(e,t){for(var r=e[Symbol.iterator](),n=r.next();!n.done;)t(n.value[0]),n=r.next()},t.iterateHeadersKeys=function(e,t){for(var r=e.keys(),n=r.next();!n.done;)t(n.value),n=r.next()}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.normalizeName=function(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()},t.normalizeValue=function(e){return"string"!=typeof e&&(e=String(e)),e},t.getHeaderValues=function(e,t){var r=e;if(r instanceof Headers&&r.getAll)return r.getAll(t);var n=r.get(t);return n&&"string"==typeof n?[n]:n},t.getHeaderKeys=function(e){var t=e,r={},i=[];return t.keys?n.iterateHeadersKeys(t,function(e){r[e]||(r[e]=!0,i.push(e))}):t.forEach?t.forEach(function(e,t){r[t]||(r[t]=!0,i.push(t))}):n.iterateHeaders(t,function(e){var t=e[0];r[t]||(r[t]=!0,i.push(t))}),i},t.splitHeaderValue=function(e){var t=[];return e.split(", ").forEach(function(e){e.split(",").forEach(function(e){t.push(e)})}),t}}]))},617:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ChunkParser=t.ChunkType=t.encodeASCII=t.decodeASCII=void 0;var n,i=r(65);function o(e){return 9===(t=e)||10===t||13===t||e>=32&&e<=126;var t}function s(e){for(var t=0;t!==e.length;++t)if(!o(e[t]))throw new Error("Metadata is not valid (printable) ASCII");return String.fromCharCode.apply(String,Array.prototype.slice.call(e))}function a(e){return!(128&~e.getUint8(0))}function c(e){return e.getUint32(1,!1)}function l(e,t,r){return e.byteLength-t>=r}function u(e,t,r){if(e.slice)return e.slice(t,r);var n=e.length;void 0!==r&&(n=r);for(var i=new Uint8Array(n-t),o=0,s=t;s<n;s++)i[o++]=e[s];return i}t.decodeASCII=s,t.encodeASCII=function(e){for(var t=new Uint8Array(e.length),r=0;r!==e.length;++r){var n=e.charCodeAt(r);if(!o(n))throw new Error("Metadata contains invalid ASCII");t[r]=n}return t},function(e){e[e.MESSAGE=1]="MESSAGE",e[e.TRAILERS=2]="TRAILERS"}(n=t.ChunkType||(t.ChunkType={}));var h=function(){function e(){this.buffer=null,this.position=0}return e.prototype.parse=function(e,t){if(0===e.length&&t)return[];var r,o=[];if(null==this.buffer)this.buffer=e,this.position=0;else if(this.position===this.buffer.byteLength)this.buffer=e,this.position=0;else{var h=this.buffer.byteLength-this.position,d=new Uint8Array(h+e.byteLength),f=u(this.buffer,this.position);d.set(f,0);var p=new Uint8Array(e);d.set(p,h),this.buffer=d,this.position=0}for(;;){if(!l(this.buffer,this.position,5))return o;var g=u(this.buffer,this.position,this.position+5),m=new DataView(g.buffer,g.byteOffset,g.byteLength),y=c(m);if(!l(this.buffer,this.position,5+y))return o;var w=u(this.buffer,this.position+5,this.position+5+y);if(this.position+=5+y,a(m))return o.push({chunkType:n.TRAILERS,trailers:(r=w,new i.Metadata(s(r)))}),o;o.push({chunkType:n.MESSAGE,data:w})}},e}();t.ChunkParser=h},8:function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.httpStatusToCode=t.Code=void 0,function(e){e[e.OK=0]="OK",e[e.Canceled=1]="Canceled",e[e.Unknown=2]="Unknown",e[e.InvalidArgument=3]="InvalidArgument",e[e.DeadlineExceeded=4]="DeadlineExceeded",e[e.NotFound=5]="NotFound",e[e.AlreadyExists=6]="AlreadyExists",e[e.PermissionDenied=7]="PermissionDenied",e[e.ResourceExhausted=8]="ResourceExhausted",e[e.FailedPrecondition=9]="FailedPrecondition",e[e.Aborted=10]="Aborted",e[e.OutOfRange=11]="OutOfRange",e[e.Unimplemented=12]="Unimplemented",e[e.Internal=13]="Internal",e[e.Unavailable=14]="Unavailable",e[e.DataLoss=15]="DataLoss",e[e.Unauthenticated=16]="Unauthenticated"}(r=t.Code||(t.Code={})),t.httpStatusToCode=function(e){switch(e){case 0:return r.Internal;case 200:return r.OK;case 400:return r.InvalidArgument;case 401:return r.Unauthenticated;case 403:return r.PermissionDenied;case 404:return r.NotFound;case 409:return r.Aborted;case 412:return r.FailedPrecondition;case 429:return r.ResourceExhausted;case 499:return r.Canceled;case 500:default:return r.Unknown;case 501:return r.Unimplemented;case 503:return r.Unavailable;case 504:return r.DeadlineExceeded}}},934:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.client=void 0;var n=r(65),i=r(617),o=r(8),s=r(346),a=r(57),c=r(882);t.client=function(e,t){return new l(e,t)};var l=function(){function e(e,t){this.started=!1,this.sentFirstMessage=!1,this.completed=!1,this.closed=!1,this.finishedSending=!1,this.onHeadersCallbacks=[],this.onMessageCallbacks=[],this.onEndCallbacks=[],this.parser=new i.ChunkParser,this.methodDefinition=e,this.props=t,this.createTransport()}return e.prototype.createTransport=function(){var e=this.props.host+"/"+this.methodDefinition.service.serviceName+"/"+this.methodDefinition.methodName,t={methodDefinition:this.methodDefinition,debug:this.props.debug||!1,url:e,onHeaders:this.onTransportHeaders.bind(this),onChunk:this.onTransportChunk.bind(this),onEnd:this.onTransportEnd.bind(this)};this.props.transport?this.transport=this.props.transport(t):this.transport=a.makeDefaultTransport(t)},e.prototype.onTransportHeaders=function(e,t){if(this.props.debug&&s.debug("onHeaders",e,t),this.closed)this.props.debug&&s.debug("grpc.onHeaders received after request was closed - ignoring");else if(0===t);else{this.responseHeaders=e,this.props.debug&&s.debug("onHeaders.responseHeaders",JSON.stringify(this.responseHeaders,null,2));var r=u(e);this.props.debug&&s.debug("onHeaders.gRPCStatus",r);var n=r&&r>=0?r:o.httpStatusToCode(t);this.props.debug&&s.debug("onHeaders.code",n);var i=e.get("grpc-message")||[];if(this.props.debug&&s.debug("onHeaders.gRPCMessage",i),this.rawOnHeaders(e),n!==o.Code.OK){var a=this.decodeGRPCStatus(i[0]);this.rawOnError(n,a,e)}}},e.prototype.onTransportChunk=function(e){var t=this;if(this.closed)this.props.debug&&s.debug("grpc.onChunk received after request was closed - ignoring");else{var r=[];try{r=this.parser.parse(e)}catch(e){return this.props.debug&&s.debug("onChunk.parsing error",e,e.message),void this.rawOnError(o.Code.Internal,"parsing error: "+e.message)}r.forEach(function(e){if(e.chunkType===i.ChunkType.MESSAGE){var r=t.methodDefinition.responseType.deserializeBinary(e.data);t.rawOnMessage(r)}else e.chunkType===i.ChunkType.TRAILERS&&(t.responseHeaders?(t.responseTrailers=new n.Metadata(e.trailers),t.props.debug&&s.debug("onChunk.trailers",t.responseTrailers)):(t.responseHeaders=new n.Metadata(e.trailers),t.rawOnHeaders(t.responseHeaders)))})}},e.prototype.onTransportEnd=function(){if(this.props.debug&&s.debug("grpc.onEnd"),this.closed)this.props.debug&&s.debug("grpc.onEnd received after request was closed - ignoring");else if(void 0!==this.responseTrailers){var e=u(this.responseTrailers);if(null!==e){var t=this.responseTrailers.get("grpc-message"),r=this.decodeGRPCStatus(t[0]);this.rawOnEnd(e,r,this.responseTrailers)}else this.rawOnError(o.Code.Internal,"Response closed without grpc-status (Trailers provided)")}else{if(void 0===this.responseHeaders)return void this.rawOnError(o.Code.Unknown,"Response closed without headers");var n=u(this.responseHeaders),i=this.responseHeaders.get("grpc-message");if(this.props.debug&&s.debug("grpc.headers only response ",n,i),null===n)return void this.rawOnEnd(o.Code.Unknown,"Response closed without grpc-status (Headers only)",this.responseHeaders);var a=this.decodeGRPCStatus(i[0]);this.rawOnEnd(n,a,this.responseHeaders)}},e.prototype.decodeGRPCStatus=function(e){if(!e)return"";try{return decodeURIComponent(e)}catch(t){return e}},e.prototype.rawOnEnd=function(e,t,r){var n=this;this.props.debug&&s.debug("rawOnEnd",e,t,r),this.completed||(this.completed=!0,this.onEndCallbacks.forEach(function(i){if(!n.closed)try{i(e,t,r)}catch(e){setTimeout(function(){throw e},0)}}))},e.prototype.rawOnHeaders=function(e){this.props.debug&&s.debug("rawOnHeaders",e),this.completed||this.onHeadersCallbacks.forEach(function(t){try{t(e)}catch(e){setTimeout(function(){throw e},0)}})},e.prototype.rawOnError=function(e,t,r){var i=this;void 0===r&&(r=new n.Metadata),this.props.debug&&s.debug("rawOnError",e,t),this.completed||(this.completed=!0,this.onEndCallbacks.forEach(function(n){if(!i.closed)try{n(e,t,r)}catch(e){setTimeout(function(){throw e},0)}}))},e.prototype.rawOnMessage=function(e){var t=this;this.props.debug&&s.debug("rawOnMessage",e.toObject()),this.completed||this.closed||this.onMessageCallbacks.forEach(function(r){if(!t.closed)try{r(e)}catch(e){setTimeout(function(){throw e},0)}})},e.prototype.onHeaders=function(e){this.onHeadersCallbacks.push(e)},e.prototype.onMessage=function(e){this.onMessageCallbacks.push(e)},e.prototype.onEnd=function(e){this.onEndCallbacks.push(e)},e.prototype.start=function(e){if(this.started)throw new Error("Client already started - cannot .start()");this.started=!0;var t=new n.Metadata(e||{});t.set("content-type","application/grpc-web+proto"),t.set("x-grpc-web","1"),this.transport.start(t)},e.prototype.send=function(e){if(!this.started)throw new Error("Client not started - .start() must be called before .send()");if(this.closed)throw new Error("Client already closed - cannot .send()");if(this.finishedSending)throw new Error("Client already finished sending - cannot .send()");if(!this.methodDefinition.requestStream&&this.sentFirstMessage)throw new Error("Message already sent for non-client-streaming method - cannot .send()");this.sentFirstMessage=!0;var t=c.frameRequest(e);this.transport.sendMessage(t)},e.prototype.finishSend=function(){if(!this.started)throw new Error("Client not started - .finishSend() must be called before .close()");if(this.closed)throw new Error("Client already closed - cannot .send()");if(this.finishedSending)throw new Error("Client already finished sending - cannot .finishSend()");this.finishedSending=!0,this.transport.finishSend()},e.prototype.close=function(){if(!this.started)throw new Error("Client not started - .start() must be called before .close()");if(this.closed)throw new Error("Client already closed - cannot .close()");this.closed=!0,this.props.debug&&s.debug("request.abort aborting request"),this.transport.cancel()},e}();function u(e){var t=e.get("grpc-status")||[];if(t.length>0)try{var r=t[0];return parseInt(r,10)}catch(e){return null}return null}},346:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.debug=void 0,t.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.debug?console.debug.apply(null,e):console.log.apply(null,e)}},607:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.grpc=void 0;var n,i=r(418),o=r(57),s=r(229),a=r(540),c=r(210),l=r(859),u=r(8),h=r(938),d=r(35),f=r(934);(n=t.grpc||(t.grpc={})).setDefaultTransport=o.setDefaultTransportFactory,n.CrossBrowserHttpTransport=l.CrossBrowserHttpTransport,n.FetchReadableStreamTransport=s.FetchReadableStreamTransport,n.XhrTransport=c.XhrTransport,n.WebsocketTransport=a.WebsocketTransport,n.Code=u.Code,n.Metadata=i.BrowserHeaders,n.client=function(e,t){return f.client(e,t)},n.invoke=h.invoke,n.unary=d.unary},938:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.invoke=void 0;var n=r(934);t.invoke=function(e,t){if(e.requestStream)throw new Error(".invoke cannot be used with client-streaming methods. Use .client instead.");var r=n.client(e,{host:t.host,transport:t.transport,debug:t.debug});return t.onHeaders&&r.onHeaders(t.onHeaders),t.onMessage&&r.onMessage(t.onMessage),t.onEnd&&r.onEnd(t.onEnd),r.start(t.metadata),r.send(t.request),r.finishSend(),{close:function(){r.close()}}}},65:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var n=r(418);Object.defineProperty(t,"Metadata",{enumerable:!0,get:function(){return n.BrowserHeaders}})},57:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeDefaultTransport=t.setDefaultTransportFactory=void 0;var n=r(859),i=function(e){return n.CrossBrowserHttpTransport({withCredentials:!1})(e)};t.setDefaultTransportFactory=function(e){i=e},t.makeDefaultTransport=function(e){return i(e)}},229:function(e,t,r){var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.detectFetchSupport=t.FetchReadableStreamTransport=void 0;var i=r(65),o=r(346);t.FetchReadableStreamTransport=function(e){return function(t){return function(e,t){return e.debug&&o.debug("fetchRequest",e),new s(e,t)}(t,e)}};var s=function(){function e(e,t){this.cancelled=!1,this.controller=self.AbortController&&new AbortController,this.options=e,this.init=t}return e.prototype.pump=function(e,t){var r=this;if(this.reader=e,this.cancelled)return this.options.debug&&o.debug("Fetch.pump.cancel at first pump"),void this.reader.cancel().catch(function(e){r.options.debug&&o.debug("Fetch.pump.reader.cancel exception",e)});this.reader.read().then(function(e){if(e.done)return r.options.onEnd(),t;r.options.onChunk(e.value),r.pump(r.reader,t)}).catch(function(e){r.cancelled?r.options.debug&&o.debug("Fetch.catch - request cancelled"):(r.cancelled=!0,r.options.debug&&o.debug("Fetch.catch",e.message),r.options.onEnd(e))})},e.prototype.send=function(e){var t=this;fetch(this.options.url,n(n({},this.init),{headers:this.metadata.toHeaders(),method:"POST",body:e,signal:this.controller&&this.controller.signal})).then(function(e){if(t.options.debug&&o.debug("Fetch.response",e),t.options.onHeaders(new i.Metadata(e.headers),e.status),!e.body)return e;t.pump(e.body.getReader(),e)}).catch(function(e){t.cancelled?t.options.debug&&o.debug("Fetch.catch - request cancelled"):(t.cancelled=!0,t.options.debug&&o.debug("Fetch.catch",e.message),t.options.onEnd(e))})},e.prototype.sendMessage=function(e){this.send(e)},e.prototype.finishSend=function(){},e.prototype.start=function(e){this.metadata=e},e.prototype.cancel=function(){var e=this;this.cancelled?this.options.debug&&o.debug("Fetch.cancel already cancelled"):(this.cancelled=!0,this.controller?(this.options.debug&&o.debug("Fetch.cancel.controller.abort"),this.controller.abort()):this.options.debug&&o.debug("Fetch.cancel.missing abort controller"),this.reader?(this.options.debug&&o.debug("Fetch.cancel.reader.cancel"),this.reader.cancel().catch(function(t){e.options.debug&&o.debug("Fetch.cancel.reader.cancel exception",t)})):this.options.debug&&o.debug("Fetch.cancel before reader"))},e}();t.detectFetchSupport=function(){return"undefined"!=typeof Response&&Response.prototype.hasOwnProperty("body")&&"function"==typeof Headers}},859:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.CrossBrowserHttpTransport=void 0;var n=r(229),i=r(210);t.CrossBrowserHttpTransport=function(e){if(n.detectFetchSupport()){var t={credentials:e.withCredentials?"include":"same-origin"};return n.FetchReadableStreamTransport(t)}return i.XhrTransport({withCredentials:e.withCredentials})}},210:function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.stringToArrayBuffer=t.MozChunkedArrayBufferXHR=t.XHR=t.XhrTransport=void 0;var o=r(65),s=r(346),a=r(849);t.XhrTransport=function(e){return function(t){if(a.detectMozXHRSupport())return new l(t,e);if(a.detectXHROverrideMimeTypeSupport())return new c(t,e);throw new Error("This environment's XHR implementation cannot support binary transfer.")}};var c=function(){function e(e,t){this.options=e,this.init=t}return e.prototype.onProgressEvent=function(){this.options.debug&&s.debug("XHR.onProgressEvent.length: ",this.xhr.response.length);var e=this.xhr.response.substr(this.index);this.index=this.xhr.response.length;var t=h(e);this.options.onChunk(t)},e.prototype.onLoadEvent=function(){this.options.debug&&s.debug("XHR.onLoadEvent"),this.options.onEnd()},e.prototype.onStateChange=function(){this.options.debug&&s.debug("XHR.onStateChange",this.xhr.readyState),this.xhr.readyState===XMLHttpRequest.HEADERS_RECEIVED&&this.options.onHeaders(new o.Metadata(this.xhr.getAllResponseHeaders()),this.xhr.status)},e.prototype.sendMessage=function(e){this.xhr.send(e)},e.prototype.finishSend=function(){},e.prototype.start=function(e){var t=this;this.metadata=e;var r=new XMLHttpRequest;this.xhr=r,r.open("POST",this.options.url),this.configureXhr(),this.metadata.forEach(function(e,t){r.setRequestHeader(e,t.join(", "))}),r.withCredentials=Boolean(this.init.withCredentials),r.addEventListener("readystatechange",this.onStateChange.bind(this)),r.addEventListener("progress",this.onProgressEvent.bind(this)),r.addEventListener("loadend",this.onLoadEvent.bind(this)),r.addEventListener("error",function(e){t.options.debug&&s.debug("XHR.error",e),t.options.onEnd(e.error)})},e.prototype.configureXhr=function(){this.xhr.responseType="text",this.xhr.overrideMimeType("text/plain; charset=x-user-defined")},e.prototype.cancel=function(){this.options.debug&&s.debug("XHR.abort"),this.xhr.abort()},e}();t.XHR=c;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.configureXhr=function(){this.options.debug&&s.debug("MozXHR.configureXhr: setting responseType to 'moz-chunked-arraybuffer'"),this.xhr.responseType="moz-chunked-arraybuffer"},t.prototype.onProgressEvent=function(){var e=this.xhr.response;this.options.debug&&s.debug("MozXHR.onProgressEvent: ",new Uint8Array(e)),this.options.onChunk(new Uint8Array(e))},t}(c);function u(e,t){var r=e.charCodeAt(t);if(r>=55296&&r<=56319){var n=e.charCodeAt(t+1);n>=56320&&n<=57343&&(r=65536+(r-55296<<10)+(n-56320))}return r}function h(e){for(var t=new Uint8Array(e.length),r=0,n=0;n<e.length;n++){var i=String.prototype.codePointAt?e.codePointAt(n):u(e,n);t[r++]=255&i}return t}t.MozChunkedArrayBufferXHR=l,t.stringToArrayBuffer=h},849:function(e,t){var r;function n(){if(void 0!==r)return r;if(XMLHttpRequest){r=new XMLHttpRequest;try{r.open("GET","https://localhost")}catch(e){}}return r}function i(e){var t=n();if(!t)return!1;try{return t.responseType=e,t.responseType===e}catch(e){}return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.detectXHROverrideMimeTypeSupport=t.detectMozXHRSupport=t.xhrSupportsResponseType=void 0,t.xhrSupportsResponseType=i,t.detectMozXHRSupport=function(){return"undefined"!=typeof XMLHttpRequest&&i("moz-chunked-arraybuffer")},t.detectXHROverrideMimeTypeSupport=function(){return"undefined"!=typeof XMLHttpRequest&&XMLHttpRequest.prototype.hasOwnProperty("overrideMimeType")}},540:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.WebsocketTransport=void 0;var n,i=r(346),o=r(617);!function(e){e[e.FINISH_SEND=1]="FINISH_SEND"}(n||(n={}));var s=new Uint8Array([1]);t.WebsocketTransport=function(){return function(e){return function(e){e.debug&&i.debug("websocketRequest",e);var t,r=function(e){if("https://"===e.substr(0,8))return"wss://"+e.substr(8);if("http://"===e.substr(0,7))return"ws://"+e.substr(7);throw new Error("Websocket transport constructed with non-https:// or http:// host.")}(e.url),a=[];function c(e){if(e===n.FINISH_SEND)t.send(s);else{var r=e,i=new Int8Array(r.byteLength+1);i.set(new Uint8Array([0])),i.set(r,1),t.send(i)}}return{sendMessage:function(e){t&&t.readyState!==t.CONNECTING?c(e):a.push(e)},finishSend:function(){t&&t.readyState!==t.CONNECTING?c(n.FINISH_SEND):a.push(n.FINISH_SEND)},start:function(n){(t=new WebSocket(r,["grpc-websockets"])).binaryType="arraybuffer",t.onopen=function(){var r;e.debug&&i.debug("websocketRequest.onopen"),t.send((r="",n.forEach(function(e,t){r+=e+": "+t.join(", ")+"\r\n"}),o.encodeASCII(r))),a.forEach(function(e){c(e)})},t.onclose=function(t){e.debug&&i.debug("websocketRequest.onclose",t),e.onEnd()},t.onerror=function(t){e.debug&&i.debug("websocketRequest.onerror",t)},t.onmessage=function(t){e.onChunk(new Uint8Array(t.data))}},cancel:function(){e.debug&&i.debug("websocket.abort"),t.close()}}}(e)}}},35:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.unary=void 0;var n=r(65),i=r(934);t.unary=function(e,t){if(e.responseStream)throw new Error(".unary cannot be used with server-streaming methods. Use .invoke or .client instead.");if(e.requestStream)throw new Error(".unary cannot be used with client-streaming methods. Use .client instead.");var r=null,o=null,s=i.client(e,{host:t.host,transport:t.transport,debug:t.debug});return s.onHeaders(function(e){r=e}),s.onMessage(function(e){o=e}),s.onEnd(function(e,i,s){t.onEnd({status:e,statusMessage:i,headers:r||new n.Metadata,message:o,trailers:s})}),s.start(t.metadata),s.send(t.request),s.finishSend(),{close:function(){s.close()}}}},882:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.frameRequest=void 0,t.frameRequest=function(e){var t=e.serializeBinary(),r=new ArrayBuffer(t.byteLength+5);return new DataView(r,1,4).setUint32(0,t.length,!1),new Uint8Array(r,5).set(t),new Uint8Array(r)}}},t={},function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}(607);var e,t}();var $o=Do.exports,Mo=/^[0-9]+$/,jo=function(e,t){var r=Mo.test(e),n=Mo.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1},Fo=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/;const Ho="1.21.0",zo=e=>t=>typeof t===e,qo=e=>null!=e,Wo=zo("object"),Vo=zo("string"),Ko=zo("function"),Go=zo("number");function Zo(e){return Ko(e)?e(To,Lr):[]}async function Yo(e,t,r){n(qo(r),`${t}(opts) -- opts is required`),n(Wo(r),`${t}(opts) -- opts must be an object`),n(!(r.cadence&&r.template),`${t}({ template, cadence }) -- cannot pass both cadence and template`),n(qo(r.cadence||r?.template),`${t}({ cadence }) -- cadence is required`),n(Vo(r.cadence)||r?.template,`${t}({ cadence }) -- cadence must be a string`),n(await e.config.get("accessNode.api"),`${t}(opts) -- Required value for "accessNode.api" not defined in config. See: https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/src/exec/query.md#configuration`)}async function Jo(e){let t,{url:r}=e;n(void 0!==r,"retrieve({ url }) -- url must be defined");try{t=await Ye(r)}catch(e){throw new Error("httpDocumentResolver Error: Failed to retrieve document.")}return t.ok?await t.json():null}const Xo=new Map([["http",Jo],["https",Jo]]);async function Qo(e){let{network:t,template:r}=e;n("1.1.0"===r.f_version,"deriveCadenceByNetwork110({ template }) -- template must be version 1.1.0");const i={};return r?.data?.dependencies.forEach(e=>{e.contracts.forEach(e=>{const r=e.contract;e.networks.forEach(e=>{e.network===t&&(i[r]=e.address)}),n(void 0!==i[r],`deriveCadenceByNetwork110 -- Could not find contracts Network Address: ${t} ${r}`)})}),n(Object.keys(i).length===r?.data?.dependencies.length,`deriveCadenceByNetwork110 -- Could not find contracts for import dependencies: ${i}`),n(Object.keys(i).length===Object.values(i).length,`deriveCadenceByNetwork110 -- Could not find all addresses for network ${t} dependencies:  ${i}`),n(!!r?.data?.cadence?.body,`no cadence found -- Could not replace import dependencies: ${i}`),function(e){let{cadence:t,networkDependencies:r}=e;return Object.keys(r).reduce((e,t)=>{const n=r[t],i=new RegExp(`import "\\b${t}\\b"`,"g");return e.replace(i,`import ${t} from ${n}`)},t)}({cadence:r?.data?.cadence?.body,networkDependencies:i})}async function es(e){let{network:t,template:r}=e;switch(n(null!=t,"deriveCadenceByNetwork({ network }) -- network must be defined"),n("string"==typeof t,"deriveCadenceByNetwork({ network }) -- network must be a string"),n(null!=r,"deriveCadenceByNetwork({ template }) -- template must be defined"),n("object"==typeof r,"deriveCadenceByNetwork({ template }) -- template must be an object"),n("InteractionTemplate"===r.f_type,"deriveCadenceByNetwork({ template }) -- template must be an InteractionTemplate"),r.f_version){case"1.1.0":return await Qo({network:t,template:r});case"1.0.0":return await async function(e){let{network:t,template:r}=e;return n("1.0.0"===r.f_version,"deriveCadenceByNetwork100({ template }) -- template must be version 1.0.0"),Object.keys(r?.data?.dependencies).map(e=>{const i=Object.values(r?.data?.dependencies?.[e]);n(void 0!==i,`deriveCadenceByNetwork100 -- Could not find contracts for dependency placeholder: ${e}`),n(i.length>0,`deriveCadenceByNetwork100 -- Could not find contracts for dependency placeholder: ${e}`);const o=i[0],s=o?.[t];return n(s,`deriveCadenceByNetwork100 -- Could not find ${t} network information for dependency: ${e}`),[e,s?.address]}).reduce((e,t)=>{let[r,n]=t;const i=new RegExp("(\\b"+r+"\\b)","g");return e.replace(i,n)},r.data.cadence)}({network:t,template:r});default:throw new Error("deriveCadenceByNetwork Error: Unsupported template version")}}function ts(){return{config:le(),sdk:{send:fo,decode:wo,subscribe:mo,subscribeRaw:go,account:_o,block:Ao,resolve:co}}}let rs={},ns=!1;function is(e){return async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=await e.config.get("flow.network"),i=await e.config.get("env");i&&!ns&&(r.deprecate({pkg:"FCL",subject:'Using the "env" configuration key for specifying the flow network',message:"Configuring to specify flow network is no longer required",transition:"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/TRANSITIONS.md#0001-deprecate-env-config-key"}),ns=!0);const o=t.node||await e.config.get("accessNode.api");if(!o){if(n)return n;if(i)return i;throw new Error('Either the "accessNode.api" config key or opts.node must be set')}if(rs[o])try{return await rs[o]}catch{}rs[o]||(rs[o]=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(await e.sdk.send([Un([pn,e=>Zr(e)])],t).then(e.sdk.decode)).chainId}(e,t).catch(e=>{throw rs[o]=null,e}));try{return await rs[o]}catch(e){if(n)return n;if(i)return i;throw new Error(`Error getting chainId from access node - are you using the correct access node endpoint.  If running locally, is your emulator up-to-date? ${e.message}`)}}}const os=is(ts());async function ss(e,t){Vo(t?.template)&&(t.template=await async function(e,t){let{url:r}=t;n(void 0!==r,"retrieve({ url }) -- url must be defined"),n("string"==typeof r,"retrieve({ url }) -- url must be a string");const i=await e.config.where(/^document\.resolver\./);Object.keys(i).map(e=>{const t=i[e],r=e.replace(/^document\.resolver\./,"");Xo.set(r,t)});const o=/^(.*):\/\/([A-Za-z0-9\-\.]+)(:[0-9]+)?(.*)$/.exec(r);n(o,"Failed to parse URL");const s=o[1];n(o,"Failed to parse URL protocol");const a=Xo.get(s);return n(a,`No resolver found for protcol=${s}`),await a({url:r})}(e,{url:t?.template}));const r=t.cadence||await es({template:t.template,network:await is(e)(t)});return t.cadence=r,t}function as(e){return async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await async function(e,t){return Yo(e,"query",t)}(e,t),t=await ss(e,t),e.sdk.send([Uo(t.cadence),Ro(Zo(t.args||[])),xo(t.isSealed??!1),t.limit&&"number"==typeof t.limit&&Po(t.limit)])}}function cs(e){return async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return as(e)(t).then(e.sdk.decode)}}ts(),ts();const ls={"HTTP/RPC":"HTTP/RPC","HTTP/POST":"HTTP/POST","IFRAME/RPC":"IFRAME/RPC","POP/RPC":"POP/RPC","TAB/RPC":"TAB/RPC","EXT/RPC":"EXT/RPC","DEEPLINK/RPC":"DEEPLINK/RPC"},us={f_type:"Service",f_vsn:"1.0.0"},hs={f_type:"Identity",f_vsn:"1.0.0"},ds={f_type:"USER",f_vsn:"1.0.0"},fs={f_type:"PollingResponse",f_vsn:"1.0.0"},ps={f_type:"CompositeSignature",f_vsn:"1.0.0"},gs=e=>{if(e.appIdentifier){const{appIdentifier:t,address:r,nonce:i,signatures:o}=e;return n(Vo(t),"verifyAccountProof({ appIdentifier }) -- appIdentifier must be a string"),n(Vo(r)&&16===Pe(r).length,"verifyAccountProof({ address }) -- address must be a valid address"),n(/^[0-9a-f]+$/i.test(i),"nonce must be a hex string"),n(Array.isArray(o)&&o.every((e,t,r)=>"CompositeSignature"===e.f_type),"Must include an Array of CompositeSignatures to verify"),n(o.map(e=>e.addr).every((e,t,r)=>e===r[0]),"User signatures to be verified must be from a single account address"),!0}{const{message:t,address:r,compSigs:i}=e;return n(/^[0-9a-f]+$/i.test(t),"Signed message must be a hex string"),n(Vo(r)&&16===Pe(r).length,"verifyUserSignatures({ address }) -- address must be a valid address"),n(Array.isArray(i)&&i.every((e,t,r)=>"CompositeSignature"===e.f_type),"Must include an Array of CompositeSignatures to verify"),n(i.map(e=>e.addr).every((e,t,r)=>e===r[0]),"User signatures to be verified must be from a single account address"),!0}},ms=async(e,t,r)=>{const i="ACCOUNT_PROOF"===t?"verifyAccountProofSignatures":"verifyUserSignatures",o=await is(e)(r),s=r.fclCryptoContract||{testnet:"0x74daa6f9c7ef24b1",mainnet:"0xb4b82a1c9d21d284",previewnet:"0x40b5b8b2ce81ea4a"}[o];return n(s,`${i}({ fclCryptoContract }) -- FCLCrypto contract address is unknown for network: ${o}. Please manually specify the FCLCrypto contract address.`),`\n      import FCLCrypto from ${s}\n\n      access(all) fun main(\n          address: Address, \n          message: String, \n          keyIndices: [Int], \n          signatures: [String]\n      ): Bool {\n        return FCLCrypto.${i}(address: address, message: message, keyIndices: keyIndices, signatures: signatures)\n      }\n    `};function ys(e){return async function(t,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=Re(r[0].addr);gs({message:t,address:i,compSigs:r});const o=[],s=[];for(const e of r)o.push(e.signature),s.push(e.keyId.toString());return cs(e)({cadence:await ms(e,"USER_SIGNATURE",n),args:(e,r)=>[e(i,r.Address),e(t,r.String),e(s,r.Array(r.Int)),e(o,r.Array(r.String))]})}}ts();const ws=ys(ts());r.deprecate({pkg:"FCL",subject:"fcl.verifyUserSignatures()",message:"Please use fcl.AppUtils.verifyUserSignatures()",callback:function(e,t){return ws(e,t)}}),ts();const bs=/\[Error Code: (\d+)\]/;class vs extends Error{constructor(e,t){super(e),this.code=t,this.type=p[t]}static fromErrorMessage(e){const t=e.match(bs),r=t?parseInt(t[1],10):void 0;return new vs(e,r||p.UNKNOWN_ERROR)}}async function Es(e,t){return Object.fromEntries(Object.entries(await e.config.where(t)).map(e=>{let[r,n]=e;return[r.replace(t,""),n]}))}const xs=e=>5===e.status,Is=e=>e.status>=4,_s=e=>e.status>=3,Ss=e=>e.status>=2,As=e=>e.status>=1,Os=(e,t)=>{if(e===t)return!0;if("object"!=typeof e||"object"!=typeof t)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!Os(e[r],t[r]))return!1;return!0},Cs=(e,t)=>!Os(e,t),Ps=e=>{if("object"==typeof e&&(e=e.transactionId),null==e)throw new Error("transactionId required");return e},Rs=/^[0-9a-fA-F]{64}$/,Ts="POLL",ks="TIMEOUT",Ns=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{[b]:async t=>{setTimeout(()=>t.sendSelf(ks),e.txNotFoundTimeout),t.sendSelf(Ts)},[v]:(e,t)=>{e.subscribe(t.from),e.send(t.from,x,e.all())},[E]:(e,t)=>{e.unsubscribe(t.from)},[I]:async(e,t)=>{t.reply(e.all())},[ks]:async t=>{0===Object.keys(t.all()).length&&t.fatalError(new Error(`TX status polling failed: no transaction was found within timeout interval (${e.txNotFoundTimeout}ms)`))},[Ts]:async t=>{const r=()=>setTimeout(()=>t.sendSelf(Ts),e.pollRate);let n;const i=t.all();try{n=await(async e=>fo([Co(e)]).then(wo))(t.self())}catch(e){const n=e instanceof rt&&404===e.statusCode,i=e.code===$o.grpc.Code.NotFound;return n||i?r():t.fatalError(e)}Is(n)||r(),Cs(i,n)&&t.broadcast(x,n),t.merge(n)}}},Us=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>R(Ns(e),Ps(t))};function Bs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{txNotFoundTimeout:12500,pollRate:1e3};if(!Rs.test(Ps(e)))throw new Error("Invalid transactionId");function r(r){return k(Ps(e),Us(t),r)}function n(e){return function(){const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).suppress||!1;return new Promise((n,i)=>{const o=r((r,s)=>{if(!s&&!r.statusCode||t)e(r)&&(n(r),o());else if(null!=s)i(s),o();else if(1===r.statusCode){const e=vs.fromErrorMessage(r.errorMessage);i(e),o()}})})}}return{snapshot:function(){return N(e,Us(t))},subscribe:r,onceFinalized:n(Ss),onceExecuted:n(_s),onceSealed:n(Is)}}Bs.isUnknown=e=>e.status>=0,Bs.isPending=As,Bs.isFinalized=Ss,Bs.isExecuted=_s,Bs.isSealed=Is,Bs.isExpired=xs;const Ls="local",Ds=new Map;function $s(e){function t(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{txNotFoundTimeout:12500,pollRate:1e3};if(!Rs.test(Ps(t)))throw new Error("Invalid transactionId");function n(){let n=Ds.get(t);return n||(n=function(e,t,r){const n=new Set;let i={blockId:"",status:m.UNKNOWN,statusCode:0,errorMessage:"",events:[],statusString:""};async function o(){await is(e)()===Ls?(console.warn("Events are not supported on the Flow emulator, falling back to legacy polling."),a()):s()}function s(){const r=e.sdk.subscribe({topic:g.TRANSACTION_STATUSES,args:{transactionId:t},onData:e=>{Cs(i,e)&&(i=e,c(e)),Is(e)&&new Promise(e=>setTimeout(e,0)).then(()=>{Is(e)&&r.unsubscribe()})},onError:e=>{e instanceof Qn?(console.warn("Failed to subscribe to transaction status updates using real-time streaming (are you using the deprecated GRPC transport?), falling back to polling."),a()):l(e)}})}function a(){const e=Bs(t,r).subscribe((t,r)=>{r?l(r):t&&Cs(i,t)&&(i=t,c(t),Is(t)&&new Promise(e=>setTimeout(e,0)).then(()=>{e()}))})}function c(e){for(const t of n)try{t.onData(e)}catch(e){console.error("Error in transaction observer",e)}}function l(e){for(const t of n)try{t.onError(e)}catch(e){console.error("Error in transaction observer",e)}}return o().catch(l),{subscribe(e,t){const r={onData:e,onError:t||(()=>{})};return n.add(r),e(i),{unsubscribe:()=>n.delete(r)}},get value(){return i}}}(e,t,r),Ds.set(t,n)),n}function i(e,t){const r=n(),{unsubscribe:i}=r.subscribe(e,t);return()=>i()}function o(e){return function(){const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{suppress:!1}).suppress||!1;return new Promise((r,n)=>{const o=i(t=>{if(1===t.statusCode){const e=vs.fromErrorMessage(t.errorMessage);n(e),o()}else e(t)&&(r(t),o())},e=>{t||(n(e),o())})})}}return{snapshot:function(){return Promise.resolve(n().value)},subscribe:i,onceFinalized:o(Ss),onceExecuted:o(_s),onceSealed:o(Is)}}return t.isUnknown=wn,t.isPending=As,t.isFinalized=Ss,t.isExecuted=_s,t.isSealed=Is,t.isExpired=xs,t}const Ms=$s(ts());ts();const js=()=>{throw new Error("Platform specific Core Strategies are not initialized")},Fs={[ls["EXT/RPC"]]:js,[ls["HTTP/POST"]]:js,[ls["IFRAME/RPC"]]:js,[ls["POP/RPC"]]:js,[ls["TAB/RPC"]]:js,[ls["EXT/RPC"]]:js},Hs=["ServicePlugin"],zs=["discovery-service"],qs=e=>{let{coreStrategies:i}=e,o=new Set,s=new Map(Object.entries(i));const a=e=>o=new Set([...e]);return Object.freeze({add:e=>{if(n(zs.includes(e.type),`Service Plugin type ${e.type} is not supported`),"discovery-service"===e.type){const{discoveryServices:i,serviceStrategy:o}=(e=>{const{services:t=[],serviceStrategy:r}=e;n(Array.isArray(t),"Services must be an array");for(const e of t)n(qo(e.f_type)&&"Service"===e.f_type,"Service is required"),n(qo(e.type)&&"authn"===e.type,`Service must be type authn. Received ${e.type}`),n(e.method in ls||r.method===e.method,`Service method ${e.method} is not supported`);return n(qo(r),"Service strategy is required"),n(qo(r.method)&&Vo(r.method),"Service strategy method is required"),n(qo(r.exec)&&Ko(r.exec),"Service strategy exec function is required"),{discoveryServices:t,serviceStrategy:r}})(e);a(i),s.has(o.method)?r({title:"Add Service Plugin",message:`Service strategy for ${o.method} already exists`,level:t.warn}):s.set(o.method,o.exec)}},getServices:()=>[...o],getStrategy:e=>s.get(e),getStrategies:()=>[...s.keys()]})};let Ws;const Vs=()=>void 0!==Ws,Ks=e=>{let{coreStrategies:t}=e;if(Vs())return Ws;const r=qs({coreStrategies:t});return Ws=r,r},Gs=()=>Vs()?Ws:(console.warn("Registry is not initalized, it will be initialized with stub core strategies"),Ks({coreStrategies:Fs})),Zs=(()=>{const e=new Map;return Object.freeze({add:t=>{const r=(e=>{let t;n(!!e,"No plugins supplied"),t=Array.isArray(e)?[...e]:[e];for(const e of t)n(qo(e.name),"Plugin name is required"),n(qo(e.f_type),"Plugin f_type is required"),n(Hs.includes(e.f_type),`Plugin type ${e.f_type} is not supported`);return t})(t);for(const t of r)e.set(t.name,t),"ServicePlugin"===t.f_type&&Ws.add(t)},getPlugins:()=>e})})(),Ys=async()=>[...window?.fcl_extensions||[],...Gs().getServices()];const Js=globalThis.URL;let Xs=class extends Js{constructor(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];super(e,t,...n)}};const Qs="authn",ea="SNAPSHOT",ta="UPDATED",ra="UPDATE_RESULTS",na=async e=>{try{const t=await async function(e){let{context:t,types:r}=e;const i=await t.config.get("discovery.authn.endpoint");n(Boolean(i),'"discovery.authn.endpoint" in config must be defined.');const o=await t.config.get("discovery.authn.include",[]),s=await t.config.get("discovery.authn.exclude",[]),a=new Xs(i);return fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:r,fclVersion:Ho,include:o,exclude:s,features:{suggested:await t.config.get("discovery.features.suggested",[])},clientServices:await Ys(),supportedStrategies:Gs().getStrategies(),userAgent:window?.navigator?.userAgent,network:await os()})}).then(e=>e.json())}({context:e,types:[Qs]});P(Qs,ra,{results:t})}catch(e){r({title:`${e.name} Error fetching Discovery API services.`,message:e.message,level:t.error})}};function ia(e){return{[b]:async t=>{var r,n;r="undefined"==typeof window,n='"fcl.discovery" is only available in the browser.',r&&console.warn(`\n      %cFCL Warning\n      ============================\n      ${n}\n      For more info, please see the docs: https://docs.onflow.org/fcl/\n      ============================\n      `,"font-weight:bold;font-family:monospace;"),"complete"===document.readyState?na(e):window.addEventListener("load",()=>{na(e)})},[ra]:(e,t,r)=>{e.merge(r),e.broadcast(ta,{...e.all()})},[v]:(e,t)=>{e.subscribe(t.from),e.send(t.from,ta,{...e.all()})},[E]:(e,t)=>e.unsubscribe(t.from),[ea]:async(e,t)=>t.reply({...e.all()})}}const oa=e=>R(ia(e),Qs);function sa(e){return{subscribe:t=>k(Qs,()=>oa(e),t),snapshot:()=>N(Qs,()=>oa(e)),update:()=>{"complete"===document.readyState&&na(e)}}}const aa={authn:sa(ts())};ts(),ts(),ts();const ca=e=>async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{await async function(e,t){return Yo(e,"mutate",t)}(e,t),t=await ss(e,t);const r=await e.config.get("fcl.authz",e.currentUser.authorization);return e.sdk.send([Lo(t.cadence),Ro(Zo(t.args||[])),t.limit&&Go(t.limit)&&Po(t.limit),ko(t.proposer||t.authz||r),No(t.payer||t.authz||r),Oo(t.authorizations||[t.authz||r])]).then(e.sdk.decode)}catch(e){throw e}};function la(e){return null==e?null:e.f_vsn?"1.0.0"===e.f_vsn?e:null:{...ps,addr:Pe(e.addr||e.address),signature:e.signature||e.sig,keyId:e.keyId}}function ua(e){return null==e?null:e.f_vsn?"1.0.0"===e.f_vsn?e:null:{old:e,...us,type:"frame",endpoint:e.endpoint,params:e.params||{},data:e.data||{}}}function ha(e){return null==e?null:e.f_vsn?"1.0.0"===e.f_vsn?e:null:{...us,type:"back-channel-rpc",endpoint:e.endpoint,method:e.method,params:e.params||{},data:e.data||{}}}function da(e){return null==e?null:(null==e.method&&(e={...e,type:"local-view",method:"VIEW/IFRAME"}),e.f_vsn?"1.0.0"===e.f_vsn?e:null:{...us,type:e.type||"local-view",method:e.method,endpoint:e.endpoint,data:e.data||{},params:e.params||{}})}function fa(e,t){return e.map(e=>function(e,t){try{return pa[e.type](e,t)}catch(t){return console.error(`Unrecognized FCL Service Type [${e.type}]`,e,t),e}}(e,t)).filter(Boolean)}const pa={"back-channel-rpc":ha,"pre-authz":function(e){return null==e?null:e.f_vsn?"1.0.0"===e.f_vsn?e:null:{...us,type:e.type,uid:e.id,endpoint:e.endpoint,method:e.method,identity:{...hs,address:Re(e.addr),keyId:e.keyId},params:e.params,data:e.data}},authz:function(e){return null==e?null:e.f_vsn?"1.0.0"===e.f_vsn?e:null:{...us,type:e.type,uid:e.id,endpoint:e.endpoint,method:e.method,identity:{...hs,address:Re(e.addr),keyId:e.keyId},params:e.params,data:e.data}},authn:function(e){return null==e?null:e.f_vsn?"1.0.0"===e.f_vsn?e:null:{...us,type:e.type,uid:e.id,endpoint:e.authn,id:e.pid,provider:{address:Re(e.addr),name:e.name,icon:e.icon}}},frame:ua,"open-id":function(e){return null==e?null:"1.0.0"===e.f_vsn?e:null},"user-signature":function(e){if(null==e)return null;if(!e.f_vsn)throw new Error("Invalid user-signature service");return"1.0.0"===e.f_vsn?e:null},"local-view":da,"account-proof":function(e){if(null==e)return null;if(!e.f_vsn)throw new Error("FCL Normalizer Error: Invalid account-proof service");return"1.0.0"===e.f_vsn?e:null},"authn-refresh":function(e){if(null==e)return null;if(!e.f_vsn)throw new Error("Invalid authn-refresh service");return"1.0.0"===e.f_vsn?e:null}};function ga(){let e=arguments.length>1?arguments[1]:void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((t,r)=>r.type===e&&(!t||function(e,t){if("string"!=typeof e||"string"!=typeof t)throw new Error("Invalid input");var r=e.match(Fo),n=t.match(Fo);if(!r||!n)throw new Error("Invalid input");for(var i=1;i<=3;i++){if(parseInt(r[i])>parseInt(n[i]))return 1;if(parseInt(r[i])<parseInt(n[i]))return-1}if(r[4]&&n[4])for(var o=(r[4]||"").split("."),s=(n[4]||"").split("."),a=0;a<Math.max(o.length,s.length);a++){if(void 0===o[a])return-1;if(void 0===s[a])return 1;var c=jo(o[a],s[a]);if(0!==c)return c}return 0}(r.f_vsn,t.f_vsn)>0)?r:t,null)}function ma(e){return Se([e.provider?.address||e.provider?.name||"UNSPECIFIED",e.id]).toString("hex")}async function ya(e){var t=fa(function(){return[...arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],...arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]]}((e=function(e){return e.addr=e.addr?Re(e.addr):null,e.paddr=e.paddr?Re(e.paddr):null,e}(e)).services||[],await async function(e,t){if(null==e||null==t)return[];const r=new Xs(e);r.searchParams.append("code",t);const n=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json());if(Array.isArray(n))return n;const i=[];if(Array.isArray(n.authorizations))for(let e of n.authorizations)i.push({type:"authz",keyId:n.keyId,...e});return null!=n.provider&&i.push({type:"authn",id:"wallet-provider#authn",...n.provider}),i}(e.hks,e.code)));const r=ga(t,"authn");return{...ds,addr:Re(e.addr),cid:ma(r),loggedIn:!0,services:t,expiresAt:e.expires}}const wa="undefined"==typeof window;const ba=globalThis.AbortController||require("abort-controller"),va=async e=>{let{service:t,body:r,config:n,abortSignal:i,customRpc:o,user:s,opts:a}=e;return Gs().getStrategy(t.method)({service:t,body:r,config:n,abortSignal:i,customRpc:o,opts:a,user:s})};async function Ea(e,i){let{service:o,msg:s={},config:a={},opts:c={},platform:l,abortSignal:u=(new ba).signal,execStrategy:h,user:d}=i;!function(){if(wa)return;Gs().getStrategies().includes("WC/RPC")||r({title:"FCL WalletConnect Service Plugin",level:t.error,message:"All dApps are expected to register for a WalletConnect projectId & add this to their FCL configuration.  If you do not do so, users will be unable to use certain wallets to interact with your dApp.  See https://developers.flow.com/tools/clients/fcl-js/configure-fcl for more information."})}(),s.data=o.data;const f={services:await Es(e,/^service\./),app:await Es(e,/^app\.detail\./),client:{...a.client,platform:l,fclVersion:Ho,fclLibrary:"https://github.com/onflow/fcl-js",hostname:window?.location?.hostname??null,network:await is(e)(c)}};try{const t=await(h||va)({service:o,body:s,config:f,opts:c,user:d,abortSignal:u});return"REDIRECT"===t.status?(n(o.type===t.data.type,"Cannot shift recursive service type in execService"),await Ea(e,{service:t.data,msg:s,config:f,opts:c,abortSignal:u,platform:l,user:d})):t}catch(e){throw r({title:`Error on execService ${o?.type}`,message:e,level:t.error}),e}}const xa="CURRENT_USER",Ia="CURRENT_USER/UPDATED",_a="SNAPSHOT",Sa="SET_CURRENT_USER",Aa="DEL_CURRENT_USER",Oa='{\n  "f_type": "User",\n  "f_vsn": "1.0.0",\n  "addr":null,\n  "cid":null,\n  "loggedIn":null,\n  "expiresAt":null,\n  "services":[]\n}',Ca=e=>{const t=async()=>e.getStorageProvider?await e.getStorageProvider():await e.config.first(["fcl.storage","fcl.storage.default"],void 0);return{[b]:async e=>{"undefined"==typeof window&&console.warn('\n        %cFCL Warning\n        ============================\n        "currentUser" is only available in the browser.\n        For more info, please see the docs: https://docs.onflow.org/fcl/\n        ============================\n        ',"font-weight:bold;font-family:monospace;"),e.merge(JSON.parse(Oa));const r=await t();if(r.can){const t=await(async e=>{const t=JSON.parse(Oa),r=await e.get(xa);return null!=r&&t.f_vsn!==r.f_vsn?(e.removeItem(xa),t):r||t})(r);(function(e){return null==e.expiresAt||0===e.expiresAt||e.expiresAt>Date.now()})(t)&&e.merge(t)}},[v]:(e,t)=>{e.subscribe(t.from),e.send(t.from,Ia,{...e.all()})},[E]:(e,t)=>{e.unsubscribe(t.from)},[_a]:async(e,t)=>{t.reply({...e.all()})},[Sa]:async(e,r,n)=>{e.merge(n);const i=await t();i.can&&i.put(xa,e.all()),e.broadcast(Ia,{...e.all()})},[Aa]:async(e,r)=>{e.merge(JSON.parse(Oa));const n=await t();n.can&&n.put(xa,e.all()),e.broadcast(Ia,{...e.all()})}}},Pa=e=>{R(Ca(e),e.actorName)};const Ra=async e=>{let{discoveryAuthnInclude:t,discoveryAuthnExclude:r,discoveryFeaturesSuggested:n}=e;return{client:{discoveryAuthnInclude:t,discoveryAuthnExclude:r,discoveryFeaturesSuggested:n,clientServices:await Ys(),supportedStrategies:Gs().getStrategies()}}},Ta=e=>async function(){let{service:i,redir:o=!1,forceReauth:s=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!i||i?.provider?.is_installed||!i?.provider?.requires_install)return new Promise(async(a,c)=>{Pa(e);const l={redir:o},u=await Ba(e)(),h=ga(u.services,"authn-refresh");let d;if(u.loggedIn&&!s){if(!h)return a(u);try{const t=await Ea(e,{service:h,msg:d,opts:l,platform:e.platform,user:u});P(e.actorName,Sa,await ya(t))}catch(e){r({title:`${e.name} Could not refresh wallet authentication.`,message:e.message,level:t.error})}finally{return a(await Ba(e)())}}try{d=await async function(e){let i=await e.config.get("fcl.accountProof.resolver");if(null==i)return;if(!(e=>"function"==typeof e)(i))return void r({title:"Account Proof Data Resolver must be a function",message:`Check fcl.accountProof.resolver configuration.\n                Expected: fcl.accountProof.resolver: async () => { ... }\n                Received: fcl.accountProof.resolver: ${typeof i}\n                `,level:t.warn});const o={...await i()},s=window?.location?.origin;return o.appIdentifier?s&&(r.deprecate({pkg:"FCL",subject:"appIdentifier in fcl.accountProof.resolver",message:"Manually set app identifiers in the account proof resolver function are now deprecated.  These are now automatically set to the application origin URL by FCL",transition:"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/TRANSITIONS.md#0002-deprecate-appIdentifier-field-in-account-proof-resolver"}),n("string"==typeof o.appIdentifier,"appIdentifier must be a string")):(n(s,"The appIdentifier (origin) could not be inferred from the window.location.origin.  Please set the appIdentifier manually in the fcl.accountProof.resolver function."),o.appIdentifier=s),n(/^[0-9a-f]+$/i.test(o.nonce),"Nonce must be a hex string"),o}(e)}catch(e){return r({title:`${e.name} On Authentication: Could not resolve account proof data.`,message:e.message,level:t.error}),c(e)}try{const t=await async function(e,t){const r=await e.config.get("discovery.authn.include",[]),i=await e.config.get("discovery.authn.exclude",[]),o=await e.config.get("discovery.features.suggested",[]),s=await e.config.first(["discovery.wallet.method","discovery.wallet.method.default"],void 0),a=t?.method?t.method:s,c=t?.endpoint??await e.config.first(["discovery.wallet","challenge.handshake"],void 0);return n(c,'\n    If no service is passed to "authenticate," then "discovery.wallet" must be defined in fcl config.\n    See: "https://docs.onflow.org/fcl/reference/api/#setting-configuration-values"\n    '),{...t,type:"authn",endpoint:c,method:a,discoveryAuthnInclude:r,discoveryAuthnExclude:i,discoveryFeaturesSuggested:o}}(e,i),r=await Ea(e,{service:t,msg:d,config:await Ra(t),opts:l,platform:e.platform,execStrategy:e.discovery?.execStrategy,user:u});P(e.actorName,Sa,await ya(r))}catch(e){r({title:`${e} On Authentication`,message:e,level:t.error})}finally{a(await Ba(e)())}});window.location.href=i?.provider?.install_link};function ka(e){return function(){Pa(e),P(e.actorName,Aa)}}const Na=e=>async t=>(Pa(e),{...t,tempId:"CURRENT_USER",async resolve(t,r){const n=await Ta(e)({redir:!0}),i=ga(n.services,"authz"),o=ga(n.services,"pre-authz");if(o)return(e=>(t,r)=>{let{user:n}=r;const i=(e=>({f_type:"PreAuthzResponse",f_vsn:"1.0.0",proposer:(e||{}).proposer,payer:(e||{}).payer||[],authorization:(e||{}).authorization||[]}))(t),o=[];null!=i.proposer&&o.push(["PROPOSER",i.proposer]);for(let e of i.payer||[])o.push(["PAYER",e]);for(let e of i.authorization||[])o.push(["AUTHORIZER",e]);return o.map(t=>{let[r,i]=t;return{tempId:[i.identity.address,i.identity.keyId].join("|"),addr:i.identity.address,keyId:i.identity.keyId,signingFunction:t=>Ea(e,{service:i,msg:t,platform:e.platform,user:n}),role:{proposer:"PROPOSER"===r,payer:"PAYER"===r,authorizer:"AUTHORIZER"===r}}})})(e)(await Ea(e,{service:o,msg:r,platform:e.platform,user:n}),{user:n});if(i)return{...t,tempId:"CURRENT_USER",resolve:null,addr:Pe(i.identity.address),keyId:i.identity.keyId,sequenceNum:null,signature:null,signingFunction:async t=>la(await Ea(e,{service:i,msg:t,opts:{includeOlderJsonRpcCall:!0},platform:e.platform,user:n}))};throw new Error("No Authz or PreAuthz Service configured for CURRENT_USER")}});function Ua(e){return function(t){Pa(e);const r="@EXIT",n=R(async n=>{for(n.send(e.actorName,v);;){const i=await n.receive();if(i.tag===r)return void n.send(e.actorName,E);t(i.data)}});return()=>P(n,r)}}function Ba(e){return function(){return Pa(e),P(e.actorName,_a,null,{expectReply:!0,timeout:0})}}const La=e=>async()=>{const{addr:t}=await Ta(e)();return To(Re(t),Tr)},Da=e=>(n(/^[0-9a-f]+$/i.test(e),"Message must be a hex string"),{message:e}),$a=e=>async t=>{Pa(e);const r=await Ta(e)({redir:!0}),i=ga(r.services,"user-signature");n(i,"Current user must have authorized a signing service.");try{const n=await Ea(e,{service:i,msg:Da(t),platform:e.platform,user:r});return Array.isArray(n)?n.map(e=>la(e)):[la(n)]}catch(e){return e}};function Ma(e){const t=new Xs(e.endpoint);if(window?.location?.origin&&t.searchParams.append("l6n",window.location.origin),null!=e.params)for(let[r,n]of Object.entries(e.params||{}))t.searchParams.append(r,n);return t}function ja(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=t.method||"POST",n="GET"===r?void 0:JSON.stringify(t.data||e.data||{});return fetch(Ma(e),{method:r,headers:{...e.headers||{},...t.headers||{},"Content-Type":"application/json"},body:n}).then(e=>e.json())}function Fa(e){return null==e?null:e.f_vsn?"1.0.0"===e.f_vsn?e:null:{...fs,status:e.status??"APPROVED",reason:e.reason??null,data:e.compositeSignature||e.data||{...e}||{},updates:ha(e.authorizationUpdates),local:ua((e.local||[])[0])}}const Ha={"HTTP/GET":"GET","HTTP/POST":"POST"},za=e=>(n(Ha[e.method],"Invalid Service Method for type back-channel-rpc",{service:e}),Ha[e.method]);async function qa(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>!0;n(e,"Missing Polling Service",{service:e});if(!t())throw new Error("Externally Halted");let r;try{if("undefined"!=typeof document&&"hidden"===document.visibilityState)return await new Promise(e=>setTimeout(e,500)),qa(e,t);r=await ja(e,{method:za(e)}).then(Fa)}catch(e){throw e}switch(r?.status){case"APPROVED":return r.data;case"DECLINED":throw new Error(`Declined: ${r.reason||"No reason supplied."}`);default:return await new Promise(e=>setTimeout(e,500)),qa(r?.updates,t)}}const Wa=e=>async t=>{let{service:r,body:n,config:i,opts:o}=t;const s=await ja(r,{data:{fclVersion:Ho,service:{params:r.params,data:r.data,type:r.type},config:i,...n}}).then(Fa);if("APPROVED"===s?.status)return s.data;if("DECLINED"===s?.status)throw new Error(`Declined: ${s.reason||"No reason supplied."}`);if("REDIRECT"===s?.status)return s;if("PENDING"===s?.status){let t=!0,r=!0;const[n,i]=await e(da(s.local),{serviceEndpoint:Ma,onClose:()=>r=!1}),o=()=>{try{i(),r=!1}catch(e){console.error("Frame Close Error",e)}},a=()=>{const e=t;return t=r,e};return qa(s.updates,a).then(e=>(o(),e)).catch(e=>{throw console.error(e),o(),e})}throw console.error("Auto Decline: Invalid Response",{service:r,resp:s}),new Error("Auto Decline: Invalid Response")},Va="FCL:VIEW:CLOSE",Ka="FCL:VIEW:READY",Ga="FCL:VIEW:RESPONSE",Za=e=>"string"==typeof e&&e.toLowerCase(),Ya=new Set(["monetizationstart","monetizationpending","monetizationprogress","monetizationstop"]),Ja=(e,t)=>console.warn("DEPRECATION NOTICE",`Received ${e}, please use ${t} for this and future versions of FCL`),Xa=e=>{let t,{close:r,send:n,onReady:i,onResponse:o,onMessage:s,onCustomRpc:a,getSource:c}=e;return e=>{try{t=c?.()||t}catch(e){t=null}try{if("object"!=typeof e.data)return;if(Ya.has(e.data.type))return;if(null!=t&&e.source!==t)return;Za(e.data.type)===Za(Va)&&r(),Za(e.data.type)===Za(Ka)&&(i(e,{send:n,close:r}),t||=e.source),Za(e.data.type)===Za(Ga)&&o(e,{send:n,close:r}),Za(e.data.type)===Za("FCL:VIEW:CUSTOM_RPC")&&a(e.data.payload,{send:n,close:r}),s(e,{send:n,close:r}),Za(e.data.type)===Za("FCL:FRAME:READY")&&(Ja(e.data.type,Ka),i(e,{send:n,close:r}),t||=e.source),Za(e.data.type)===Za("FCL:FRAME:RESPONSE")&&(Ja(e.data.type,Ga),o(e,{send:n,close:r})),Za(e.data.type)===Za("FCL:FRAME:CLOSE")&&(Ja(e.data.type,Va),r()),Za(e.data.type)===Za("FCL::CHALLENGE::RESPONSE")&&(Ja(e.data.type,Ga),o(e,{send:n,close:r})),Za(e.data.type)===Za("FCL::AUTHZ_READY")&&(Ja(e.data.type,Ka),i(e,{send:n,close:r}),t||=e.source),Za(e.data.type)===Za("FCL::CHALLENGE::CANCEL")&&(Ja(e.data.type,Va),r()),Za(e.data.type)===Za("FCL::CANCEL")&&(Ja(e.data.type,Va),r())}catch(e){console.error("Frame Callback Error",e),r()}}};var Qa;Qa||(Qa=ts()),Qa.config.subscribe(()=>{is(Qa)({enableRequestLogging:!1}).catch(()=>{})});const ec="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";function tc(){let e="",t=32;for(;t--;)e+=ec[62*Math.random()|0];return e}var rc=function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},nc=function(e,t,r){this.name=e,this.version=t,this.os=r,this.type="browser"},ic=function(e){this.version=e,this.type="node",this.name="node",this.os=process.platform},oc=function(e,t,r,n){this.name=e,this.version=t,this.os=r,this.bot=n,this.type="bot-device"},sc=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},ac=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},cc=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,lc=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],uc=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function hc(e){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new ac:"undefined"!=typeof navigator?function(e){var t=function(e){return""!==e&&lc.reduce(function(t,r){var n=r[0],i=r[1];if(t)return t;var o=i.exec(e);return!!o&&[n,o]},!1)}(e);if(!t)return null;var r=t[0],n=t[1];if("searchbot"===r)return new sc;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<3&&(i=rc(rc([],i,!0),function(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}(3-i.length),!0)):i=[];var o=i.join("."),s=function(e){for(var t=0,r=uc.length;t<r;t++){var n=uc[t],i=n[0];if(n[1].exec(e))return i}return null}(e),a=cc.exec(e);if(a&&a[1])return new oc(r,o,s,a[1]);return new nc(r,o,s)}(navigator.userAgent):"undefined"!=typeof process&&process.version?new ic(process.version.slice(1)):null}var dc={},fc=function(e,t){return fc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},fc(e,t)};
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var pc=function(){return pc=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},pc.apply(this,arguments)};function gc(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function mc(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function yc(e){return this instanceof yc?(this.v=e,this):new yc(e)}var wc,bc=Object.freeze({__proto__:null,get __assign(){return pc},__asyncDelegator:function(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:yc(e[n](t)),done:"return"===n}:i?i(t):t}:i}},__asyncGenerator:function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){i[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||a(e,t)})})}function a(e,t){try{!function(e){e.value instanceof yc?Promise.resolve(e.value.v).then(c,l):u(o[0][2],e)}(i[e](t))}catch(e){u(o[0][3],e)}}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}},__asyncValues:function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=gc(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,i,(t=e[r](t)).done,t.value)})}}},__await:yc,__awaiter:function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((n=n.apply(e,t||[])).next())})},__classPrivateFieldGet:function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},__classPrivateFieldSet:function(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r},__createBinding:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]},__decorate:function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},__exportStar:function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||(t[r]=e[r])},__extends:function(e,t){function r(){this.constructor=e}fc(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},__generator:function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},__importDefault:function(e){return e&&e.__esModule?e:{default:e}},__importStar:function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},__makeTemplateObject:function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__metadata:function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param:function(e,t){return function(r,n){t(r,n,e)}},__read:mc,__rest:function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r},__spread:function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(mc(arguments[t]));return e},__spreadArrays:function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n},__values:gc}),vc=fe(bc),Ec={},xc={};var Ic,_c={},Sc={},Ac={};var Oc,Cc,Pc,Rc,Tc={};function kc(){return Cc||(Cc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=vc;t.__exportStar((Ic||(Ic=1,Object.defineProperty(Ac,"__esModule",{value:!0}),Ac.ONE_THOUSAND=Ac.ONE_HUNDRED=void 0,Ac.ONE_HUNDRED=100,Ac.ONE_THOUSAND=1e3),Ac),e),t.__exportStar(function(){return Oc||(Oc=1,e=Tc,Object.defineProperty(e,"__esModule",{value:!0}),e.ONE_YEAR=e.FOUR_WEEKS=e.THREE_WEEKS=e.TWO_WEEKS=e.ONE_WEEK=e.THIRTY_DAYS=e.SEVEN_DAYS=e.FIVE_DAYS=e.THREE_DAYS=e.ONE_DAY=e.TWENTY_FOUR_HOURS=e.TWELVE_HOURS=e.SIX_HOURS=e.THREE_HOURS=e.ONE_HOUR=e.SIXTY_MINUTES=e.THIRTY_MINUTES=e.TEN_MINUTES=e.FIVE_MINUTES=e.ONE_MINUTE=e.SIXTY_SECONDS=e.THIRTY_SECONDS=e.TEN_SECONDS=e.FIVE_SECONDS=e.ONE_SECOND=void 0,e.ONE_SECOND=1,e.FIVE_SECONDS=5,e.TEN_SECONDS=10,e.THIRTY_SECONDS=30,e.SIXTY_SECONDS=60,e.ONE_MINUTE=e.SIXTY_SECONDS,e.FIVE_MINUTES=5*e.ONE_MINUTE,e.TEN_MINUTES=10*e.ONE_MINUTE,e.THIRTY_MINUTES=30*e.ONE_MINUTE,e.SIXTY_MINUTES=60*e.ONE_MINUTE,e.ONE_HOUR=e.SIXTY_MINUTES,e.THREE_HOURS=3*e.ONE_HOUR,e.SIX_HOURS=6*e.ONE_HOUR,e.TWELVE_HOURS=12*e.ONE_HOUR,e.TWENTY_FOUR_HOURS=24*e.ONE_HOUR,e.ONE_DAY=e.TWENTY_FOUR_HOURS,e.THREE_DAYS=3*e.ONE_DAY,e.FIVE_DAYS=5*e.ONE_DAY,e.SEVEN_DAYS=7*e.ONE_DAY,e.THIRTY_DAYS=30*e.ONE_DAY,e.ONE_WEEK=e.SEVEN_DAYS,e.TWO_WEEKS=2*e.ONE_WEEK,e.THREE_WEEKS=3*e.ONE_WEEK,e.FOUR_WEEKS=4*e.ONE_WEEK,e.ONE_YEAR=365*e.ONE_DAY),Tc;var e}(),e)}(Sc)),Sc}function Nc(){return Rc||(Rc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=vc;t.__exportStar((wc||(wc=1,Object.defineProperty(xc,"__esModule",{value:!0}),xc.delay=void 0,xc.delay=function(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}),xc),e),t.__exportStar(function(){if(Pc)return _c;Pc=1,Object.defineProperty(_c,"__esModule",{value:!0}),_c.fromMiliseconds=_c.toMiliseconds=void 0;const e=kc();return _c.toMiliseconds=function(t){return t*e.ONE_THOUSAND},_c.fromMiliseconds=function(t){return Math.floor(t/e.ONE_THOUSAND)},_c}(),e)}(Ec)),Ec}var Uc,Bc={};var Lc,Dc,$c={},Mc={};function jc(){return Dc||(Dc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});vc.__exportStar((Lc||(Lc=1,Object.defineProperty(Mc,"__esModule",{value:!0}),Mc.IWatch=void 0,Mc.IWatch=class{}),Mc),e)}($c)),$c}!function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=vc;t.__exportStar(Nc(),e),t.__exportStar(function(){if(Uc)return Bc;Uc=1,Object.defineProperty(Bc,"__esModule",{value:!0}),Bc.Watch=void 0;class e{constructor(){this.timestamps=new Map}start(e){if(this.timestamps.has(e))throw new Error(`Watch already started for label: ${e}`);this.timestamps.set(e,{started:Date.now()})}stop(e){const t=this.get(e);if(void 0!==t.elapsed)throw new Error(`Watch already stopped for label: ${e}`);const r=Date.now()-t.started;this.timestamps.set(e,{started:t.started,elapsed:r})}get(e){const t=this.timestamps.get(e);if(void 0===t)throw new Error(`No timestamp found for label: ${e}`);return t}elapsed(e){const t=this.get(e);return t.elapsed||Date.now()-t.started}}return Bc.Watch=e,Bc.default=e,Bc}(),e),t.__exportStar(jc(),e),t.__exportStar(kc(),e)}(dc);var Fc={};function Hc(e){let t;return"undefined"!=typeof window&&void 0!==window[e]&&(t=window[e]),t}function zc(e){const t=Hc(e);if(!t)throw new Error(`${e} is not defined in Window`);return t}Object.defineProperty(Fc,"__esModule",{value:!0}),Fc.getLocalStorage=Fc.getLocalStorageOrThrow=Fc.getCrypto=Fc.getCryptoOrThrow=Vc=Fc.getLocation=Fc.getLocationOrThrow=Wc=Fc.getNavigator=Fc.getNavigatorOrThrow=qc=Fc.getDocument=Fc.getDocumentOrThrow=Fc.getFromWindowOrThrow=Fc.getFromWindow=void 0,Fc.getFromWindow=Hc,Fc.getFromWindowOrThrow=zc,Fc.getDocumentOrThrow=function(){return zc("document")};var qc=Fc.getDocument=function(){return Hc("document")};Fc.getNavigatorOrThrow=function(){return zc("navigator")};var Wc=Fc.getNavigator=function(){return Hc("navigator")};Fc.getLocationOrThrow=function(){return zc("location")};var Vc=Fc.getLocation=function(){return Hc("location")};Fc.getCryptoOrThrow=function(){return zc("crypto")},Fc.getCrypto=function(){return Hc("crypto")},Fc.getLocalStorageOrThrow=function(){return zc("localStorage")},Fc.getLocalStorage=function(){return Hc("localStorage")};var Kc={};Object.defineProperty(Kc,"__esModule",{value:!0});var Gc=Kc.getWindowMetadata=void 0;const Zc=Fc;function Yc(e,{strict:t=!0}={}){return!!e&&("string"==typeof e&&(t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x")))}function Jc(e){return Yc(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}Gc=Kc.getWindowMetadata=function(){let e,t;try{e=Zc.getDocumentOrThrow(),t=Zc.getLocationOrThrow()}catch(e){return null}function r(...t){const r=e.getElementsByTagName("meta");for(let e=0;e<r.length;e++){const n=r[e],i=["itemprop","property","name"].map(e=>n.getAttribute(e)).filter(e=>!!e&&t.includes(e));if(i.length&&i){const e=n.getAttribute("content");if(e)return e}}return""}const n=function(){let t=r("name","og:site_name","og:title","twitter:title");return t||(t=e.title),t}(),i=r("description","og:description","twitter:description","keywords"),o=t.origin,s=function(){const r=e.getElementsByTagName("link"),n=[];for(let e=0;e<r.length;e++){const i=r[e],o=i.getAttribute("rel");if(o&&o.toLowerCase().indexOf("icon")>-1){const e=i.getAttribute("href");if(e)if(-1===e.toLowerCase().indexOf("https:")&&-1===e.toLowerCase().indexOf("http:")&&0!==e.indexOf("//")){let r=t.protocol+"//"+t.host;if(0===e.indexOf("/"))r+=e;else{const n=t.pathname.split("/");n.pop();r+=n.join("/")+"/"+e}n.push(r)}else if(0===e.indexOf("//")){const r=t.protocol+e;n.push(r)}else n.push(e)}}return n}();return{description:i,url:o,icons:s,name:n}};const Xc="2.31.0";let Qc=({docsBaseUrl:e,docsPath:t="",docsSlug:r})=>t?`${e??"https://viem.sh"}${t}${r?`#${r}`:""}`:void 0,el=`viem@${Xc}`;class tl extends Error{constructor(e,t={}){const r=t.cause instanceof tl?t.cause.details:t.cause?.message?t.cause.message:t.details,n=t.cause instanceof tl&&t.cause.docsPath||t.docsPath,i=Qc?.({...t,docsPath:n});super([e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...el?[`Version: ${el}`]:[]].join("\n"),t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=n,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=Xc}walk(e){return rl(this,e)}}function rl(e,t){return t?.(e)?e:e&&"object"==typeof e&&"cause"in e&&void 0!==e.cause?rl(e.cause,t):t?null:e}class nl extends tl{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}function il(e,{dir:t,size:r=32}={}){return"string"==typeof e?function(e,{dir:t,size:r=32}={}){if(null===r)return e;const n=e.replace("0x","");if(n.length>2*r)throw new nl({size:Math.ceil(n.length/2),targetSize:r,type:"hex"});return`0x${n["right"===t?"padEnd":"padStart"](2*r,"0")}`}(e,{dir:t,size:r}):function(e,{dir:t,size:r=32}={}){if(null===r)return e;if(e.length>r)throw new nl({size:e.length,targetSize:r,type:"bytes"});const n=new Uint8Array(r);for(let i=0;i<r;i++){const o="right"===t;n[o?i:r-i-1]=e[o?i:e.length-i-1]}return n}(e,{dir:t,size:r})}class ol extends tl{constructor({max:e,min:t,signed:r,size:n,value:i}){super(`Number "${i}" is not in safe ${n?`${8*n}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}class sl extends tl{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function al(e,{size:t}){if(Jc(e)>t)throw new sl({givenSize:Jc(e),maxSize:t})}function cl(e,t={}){const{signed:r}=t;t.size&&al(e,{size:t.size});const n=BigInt(e);if(!r)return n;const i=(e.length-2)/2;return n<=(1n<<8n*BigInt(i)-1n)-1n?n:n-BigInt(`0x${"f".padStart(2*i,"f")}`)-1n}const ll=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function ul(e,t={}){return"number"==typeof e||"bigint"==typeof e?dl(e,t):"string"==typeof e?function(e,t={}){const r=fl.encode(e);return hl(r,t)}(e,t):"boolean"==typeof e?function(e,t={}){const r=`0x${Number(e)}`;if("number"==typeof t.size)return al(r,{size:t.size}),il(r,{size:t.size});return r}(e,t):hl(e,t)}function hl(e,t={}){let r="";for(let t=0;t<e.length;t++)r+=ll[e[t]];const n=`0x${r}`;return"number"==typeof t.size?(al(n,{size:t.size}),il(n,{dir:"right",size:t.size})):n}function dl(e,t={}){const{signed:r,size:n}=t,i=BigInt(e);let o;n?o=r?(1n<<8n*BigInt(n)-1n)-1n:2n**(8n*BigInt(n))-1n:"number"==typeof e&&(o=BigInt(Number.MAX_SAFE_INTEGER));const s="bigint"==typeof o&&r?-o-1n:0;if(o&&i>o||i<s){const t="bigint"==typeof e?"n":"";throw new ol({max:o?`${o}${t}`:void 0,min:`${s}${t}`,signed:r,size:n,value:`${e}${t}`})}const a=`0x${(r&&i<0?(1n<<BigInt(8*n))+BigInt(i):i).toString(16)}`;return n?il(a,{size:n}):a}const fl=new TextEncoder;const pl=new TextEncoder;function gl(e,t={}){return"number"==typeof e||"bigint"==typeof e?function(e,t){const r=dl(e,t);return wl(r)}(e,t):"boolean"==typeof e?function(e,t={}){const r=new Uint8Array(1);if(r[0]=Number(e),"number"==typeof t.size)return al(r,{size:t.size}),il(r,{size:t.size});return r}(e,t):Yc(e)?wl(e,t):bl(e,t)}const ml={zero:48,nine:57,A:65,F:70,a:97,f:102};function yl(e){return e>=ml.zero&&e<=ml.nine?e-ml.zero:e>=ml.A&&e<=ml.F?e-(ml.A-10):e>=ml.a&&e<=ml.f?e-(ml.a-10):void 0}function wl(e,t={}){let r=e;t.size&&(al(r,{size:t.size}),r=il(r,{dir:"right",size:t.size}));let n=r.slice(2);n.length%2&&(n=`0${n}`);const i=n.length/2,o=new Uint8Array(i);for(let e=0,t=0;e<i;e++){const r=yl(n.charCodeAt(t++)),i=yl(n.charCodeAt(t++));if(void 0===r||void 0===i)throw new tl(`Invalid byte sequence ("${n[t-2]}${n[t-1]}" in "${n}").`);o[e]=16*r+i}return o}function bl(e,t={}){const r=pl.encode(e);return"number"==typeof t.size?(al(r,{size:t.size}),il(r,{dir:"right",size:t.size})):r}const vl=BigInt(2**32-1),El=BigInt(32);function xl(e,t=!1){return t?{h:Number(e&vl),l:Number(e>>El&vl)}:{h:0|Number(e>>El&vl),l:0|Number(e&vl)}}const Il="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function _l(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Sl(e,...t){if(!
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */
function(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Al(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Ol(e,t){Sl(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function Cl(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function Pl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Rl(e,t){return e<<32-t|e>>>t}function Tl(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}const kl=(()=>68===new Uint8Array(new Uint32Array([287454020]).buffer)[0])()?e=>e:function(e){for(let t=0;t<e.length;t++)e[t]=Tl(e[t]);return e};function Nl(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e)),Sl(e),e}class Ul{}function Bl(e){const t=t=>e().update(Nl(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function Ll(e=32){if(Il&&"function"==typeof Il.getRandomValues)return Il.getRandomValues(new Uint8Array(e));if(Il&&"function"==typeof Il.randomBytes)return Uint8Array.from(Il.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}const Dl=BigInt(0),$l=BigInt(1),Ml=BigInt(2),jl=BigInt(7),Fl=BigInt(256),Hl=BigInt(113),zl=[],ql=[],Wl=[];for(let e=0,t=$l,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],zl.push(2*(5*n+r)),ql.push((e+1)*(e+2)/2%64);let i=Dl;for(let e=0;e<7;e++)t=(t<<$l^(t>>jl)*Hl)%Fl,t&Ml&&(i^=$l<<($l<<BigInt(e))-$l);Wl.push(i)}const Vl=function(e,t=!1){const r=e.length;let n=new Uint32Array(r),i=new Uint32Array(r);for(let o=0;o<r;o++){const{h:r,l:s}=xl(e[o],t);[n[o],i[o]]=[r,s]}return[n,i]}(Wl,!0),Kl=Vl[0],Gl=Vl[1],Zl=(e,t,r)=>r>32?((e,t,r)=>t<<r-32|e>>>64-r)(e,t,r):((e,t,r)=>e<<r|t>>>32-r)(e,t,r),Yl=(e,t,r)=>r>32?((e,t,r)=>e<<r-32|t>>>64-r)(e,t,r):((e,t,r)=>t<<r|e>>>32-r)(e,t,r);class Jl extends Ul{constructor(e,t,r,n=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=n,this.rounds=i,_l(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");var o;this.state=new Uint8Array(200),this.state32=(o=this.state,new Uint32Array(o.buffer,o.byteOffset,Math.floor(o.byteLength/4)))}clone(){return this._cloneInto()}keccak(){kl(this.state32),function(e,t=24){const r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){const n=(t+8)%10,i=(t+2)%10,o=r[i],s=r[i+1],a=Zl(o,s,1)^r[n],c=Yl(o,s,1)^r[n+1];for(let r=0;r<50;r+=10)e[t+r]^=a,e[t+r+1]^=c}let t=e[2],i=e[3];for(let r=0;r<24;r++){const n=ql[r],o=Zl(t,i,n),s=Yl(t,i,n),a=zl[r];t=e[a],i=e[a+1],e[a]=o,e[a+1]=s}for(let t=0;t<50;t+=10){for(let n=0;n<10;n++)r[n]=e[t+n];for(let n=0;n<10;n++)e[t+n]^=~r[(n+2)%10]&r[(n+4)%10]}e[0]^=Kl[n],e[1]^=Gl[n]}Cl(r)}(this.state32,this.rounds),kl(this.state32),this.posOut=0,this.pos=0}update(e){Al(this),Sl(e=Nl(e));const{blockLen:t,state:r}=this,n=e.length;for(let i=0;i<n;){const o=Math.min(t-this.pos,n-i);for(let t=0;t<o;t++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:n}=this;e[r]^=t,128&t&&r===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){Al(this,!1),Sl(e),this.finish();const t=this.state,{blockLen:r}=this;for(let n=0,i=e.length;n<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-n);e.set(t.subarray(this.posOut,this.posOut+o),n),this.posOut+=o,n+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return _l(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Ol(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Cl(this.state)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:n,rounds:i,enableXOF:o}=this;return e||(e=new Jl(t,r,n,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=n,e.enableXOF=o,e.destroyed=this.destroyed,e}}const Xl=(()=>{return e=1,t=136,r=32,Bl(()=>new Jl(t,e,r));var e,t,r})();function Ql(e,t){const r=t||"hex",n=Xl(Yc(e,{strict:!1})?gl(e):e);return"bytes"===r?n:ul(n)}class eu extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&void 0!==t&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const e=this.keys().next().value;e&&this.delete(e)}return this}}const tu=new eu(8192);function ru(e){return function(e,t){if(tu.has(`${e}.${t}`))return tu.get(`${e}.${t}`);const r=e.substring(2).toLowerCase(),n=Ql(bl(r),"bytes"),i=r.split("");for(let e=0;e<40;e+=2)n[e>>1]>>4>=8&&i[e]&&(i[e]=i[e].toUpperCase()),(15&n[e>>1])>=8&&i[e+1]&&(i[e+1]=i[e+1].toUpperCase());const o=`0x${i.join("")}`;return tu.set(`${e}.${t}`,o),o}(`0x${Ql(`0x${e.substring(4)}`).substring(26)}`)}async function nu({hash:e,signature:t}){const r=Yc(e)?e:ul(e),{secp256k1:n}=await Promise.resolve().then(function(){return qh}),i=(()=>{if("object"==typeof t&&"r"in t&&"s"in t){const{r:e,s:r,v:i,yParity:o}=t,s=iu(Number(o??i));return new n.Signature(cl(e),cl(r)).addRecoveryBit(s)}const e=Yc(t)?t:ul(t);if(65!==Jc(e))throw new Error("invalid signature length");const r=iu(function(e,t={}){return Number(cl(e,t))}(`0x${e.slice(130)}`));return n.Signature.fromCompact(e.substring(2,130)).addRecoveryBit(r)})();return`0x${i.recoverPublicKey(r.substring(2)).toHex(!1)}`}function iu(e){if(0===e||1===e)return e;if(27===e)return 0;if(28===e)return 1;throw new Error("Invalid yParityOrV value")}function ou(e,t,r){return e&t^~e&r}function su(e,t,r){return e&t^e&r^t&r}class au extends Ul{constructor(e,t,r,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=n,this.buffer=new Uint8Array(e),this.view=Pl(this.buffer)}update(e){Al(this),Sl(e=Nl(e));const{view:t,buffer:r,blockLen:n}=this,i=e.length;for(let o=0;o<i;){const s=Math.min(n-this.pos,i-o);if(s===n){const t=Pl(e);for(;n<=i-o;o+=n)this.process(t,o);continue}r.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Al(this),Ol(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:n,isLE:i}=this;let{pos:o}=this;t[o++]=128,Cl(this.buffer.subarray(o)),this.padOffset>n-o&&(this.process(r,0),o=0);for(let e=o;e<n;e++)t[e]=0;!function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,l=n?0:4;e.setUint32(t+c,s,n),e.setUint32(t+l,a,n)}(r,n-8,BigInt(8*this.length),i),this.process(r,0);const s=Pl(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,l=this.get();if(c>l.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,l[e],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:i,destroyed:o,pos:s}=this;return e.destroyed=o,e.finished=i,e.length=n,e.pos=s,n%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}}const cu=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),lu=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),uu=new Uint32Array(64);class hu extends au{constructor(e=32){super(64,e,8,!1),this.A=0|cu[0],this.B=0|cu[1],this.C=0|cu[2],this.D=0|cu[3],this.E=0|cu[4],this.F=0|cu[5],this.G=0|cu[6],this.H=0|cu[7]}get(){const{A:e,B:t,C:r,D:n,E:i,F:o,G:s,H:a}=this;return[e,t,r,n,i,o,s,a]}set(e,t,r,n,i,o,s,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)uu[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=uu[e-15],r=uu[e-2],n=Rl(t,7)^Rl(t,18)^t>>>3,i=Rl(r,17)^Rl(r,19)^r>>>10;uu[e]=i+uu[e-7]+n+uu[e-16]|0}let{A:r,B:n,C:i,D:o,E:s,F:a,G:c,H:l}=this;for(let e=0;e<64;e++){const t=l+(Rl(s,6)^Rl(s,11)^Rl(s,25))+ou(s,a,c)+lu[e]+uu[e]|0,u=(Rl(r,2)^Rl(r,13)^Rl(r,22))+su(r,n,i)|0;l=c,c=a,a=s,s=o+t|0,o=i,i=n,n=r,r=t+u|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(r,n,i,o,s,a,c,l)}roundClean(){Cl(uu)}destroy(){this.set(0,0,0,0,0,0,0,0),Cl(this.buffer)}}const du=Bl(()=>new hu);class fu extends Ul{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.createHasher");_l(e.outputLen),_l(e.blockLen)}(e);const r=Nl(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,i=new Uint8Array(n);i.set(r.length>n?e.create().update(r).digest():r);for(let e=0;e<i.length;e++)i[e]^=54;this.iHash.update(i),this.oHash=e.create();for(let e=0;e<i.length;e++)i[e]^=106;this.oHash.update(i),Cl(i)}update(e){return Al(this),this.iHash.update(e),this}digestInto(e){Al(this),Sl(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:n,destroyed:i,blockLen:o,outputLen:s}=this;return e.finished=n,e.destroyed=i,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const pu=(e,t,r)=>new fu(e,t).update(r).digest();pu.create=(e,t)=>new fu(e,t);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const gu=BigInt(0),mu=BigInt(1);function yu(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function wu(e){if(!yu(e))throw new Error("Uint8Array expected")}function bu(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}function vu(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function Eu(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?gu:BigInt("0x"+e)}const xu="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,Iu=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function _u(e){if(wu(e),xu)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=Iu[e[r]];return t}const Su=48,Au=57,Ou=65,Cu=70,Pu=97,Ru=102;function Tu(e){return e>=Su&&e<=Au?e-Su:e>=Ou&&e<=Cu?e-(Ou-10):e>=Pu&&e<=Ru?e-(Pu-10):void 0}function ku(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);if(xu)return Uint8Array.fromHex(e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let t=0,i=0;t<r;t++,i+=2){const r=Tu(e.charCodeAt(i)),o=Tu(e.charCodeAt(i+1));if(void 0===r||void 0===o){const t=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+i)}n[t]=16*r+o}return n}function Nu(e){return Eu(_u(e))}function Uu(e){return wu(e),Eu(_u(Uint8Array.from(e).reverse()))}function Bu(e,t){return ku(e.toString(16).padStart(2*t,"0"))}function Lu(e,t){return Bu(e,t).reverse()}function Du(e,t,r){let n;if("string"==typeof t)try{n=ku(t)}catch(t){throw new Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!yu(t))throw new Error(e+" must be hex string or Uint8Array");n=Uint8Array.from(t)}const i=n.length;if("number"==typeof r&&i!==r)throw new Error(e+" of length "+r+" expected, got "+i);return n}function $u(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];wu(n),t+=n.length}const r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}const Mu=e=>"bigint"==typeof e&&gu<=e;function ju(e,t,r){return Mu(e)&&Mu(t)&&Mu(r)&&t<=e&&e<r}function Fu(e,t,r,n){if(!ju(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}const Hu=e=>(mu<<BigInt(e))-mu,zu=e=>new Uint8Array(e),qu=e=>Uint8Array.from(e);const Wu={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||yu(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function Vu(e,t,r={}){const n=(t,r,n)=>{const i=Wu[r];if("function"!=typeof i)throw new Error("invalid validator function");const o=e[t];if(!(n&&void 0===o||i(o,e)))throw new Error("param "+String(t)+" is invalid. Expected "+r+", got "+o)};for(const[e,r]of Object.entries(t))n(e,r,!1);for(const[e,t]of Object.entries(r))n(e,t,!0);return e}function Ku(e){const t=new WeakMap;return(r,...n)=>{const i=t.get(r);if(void 0!==i)return i;const o=e(r,...n);return t.set(r,o),o}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Gu=BigInt(0),Zu=BigInt(1),Yu=BigInt(2),Ju=BigInt(3),Xu=BigInt(4),Qu=BigInt(5),eh=BigInt(8);function th(e,t){const r=e%t;return r>=Gu?r:t+r}function rh(e,t,r){let n=e;for(;t-- >Gu;)n*=n,n%=r;return n}function nh(e,t){if(e===Gu)throw new Error("invert: expected non-zero number");if(t<=Gu)throw new Error("invert: expected positive modulus, got "+t);let r=th(e,t),n=t,i=Gu,o=Zu;for(;r!==Gu;){const e=n%r,t=i-o*(n/r);n=r,r=e,i=o,o=t}if(n!==Zu)throw new Error("invert: does not exist");return th(i,t)}function ih(e,t){const r=(e.ORDER+Zu)/Xu,n=e.pow(t,r);if(!e.eql(e.sqr(n),t))throw new Error("Cannot find square root");return n}function oh(e,t){const r=(e.ORDER-Qu)/eh,n=e.mul(t,Yu),i=e.pow(n,r),o=e.mul(t,i),s=e.mul(e.mul(o,Yu),i),a=e.mul(o,e.sub(s,e.ONE));if(!e.eql(e.sqr(a),t))throw new Error("Cannot find square root");return a}function sh(e){return e%Xu===Ju?ih:e%eh===Qu?oh:function(e){if(e<BigInt(3))throw new Error("sqrt is not defined for small field");let t=e-Zu,r=0;for(;t%Yu===Gu;)t/=Yu,r++;let n=Yu;const i=hh(e);for(;1===lh(i,n);)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===r)return ih;let o=i.pow(n,t);const s=(t+Zu)/Yu;return function(e,n){if(e.is0(n))return n;if(1!==lh(e,n))throw new Error("Cannot find square root");let i=r,a=e.mul(e.ONE,o),c=e.pow(n,t),l=e.pow(n,s);for(;!e.eql(c,e.ONE);){if(e.is0(c))return e.ZERO;let t=1,r=e.sqr(c);for(;!e.eql(r,e.ONE);)if(t++,r=e.sqr(r),t===i)throw new Error("Cannot find square root");const n=Zu<<BigInt(i-t-1),o=e.pow(a,n);i=t,a=e.sqr(o),c=e.mul(c,a),l=e.mul(l,o)}return l}}(e)}const ah=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ch(e,t,r=!1){const n=new Array(t.length).fill(r?e.ZERO:void 0),i=t.reduce((t,r,i)=>e.is0(r)?t:(n[i]=t,e.mul(t,r)),e.ONE),o=e.inv(i);return t.reduceRight((t,r,i)=>e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r)),o),n}function lh(e,t){const r=(e.ORDER-Zu)/Yu,n=e.pow(t,r),i=e.eql(n,e.ONE),o=e.eql(n,e.ZERO),s=e.eql(n,e.neg(e.ONE));if(!i&&!o&&!s)throw new Error("invalid Legendre symbol result");return i?1:o?0:-1}function uh(e,t){void 0!==t&&_l(t);const r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function hh(e,t,r=!1,n={}){if(e<=Gu)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:i,nByteLength:o}=uh(e,t);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let s;const a=Object.freeze({ORDER:e,isLE:r,BITS:i,BYTES:o,MASK:Hu(i),ZERO:Gu,ONE:Zu,create:t=>th(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return Gu<=t&&t<e},is0:e=>e===Gu,isOdd:e=>(e&Zu)===Zu,neg:t=>th(-t,e),eql:(e,t)=>e===t,sqr:t=>th(t*t,e),add:(t,r)=>th(t+r,e),sub:(t,r)=>th(t-r,e),mul:(t,r)=>th(t*r,e),pow:(e,t)=>function(e,t,r){if(r<Gu)throw new Error("invalid exponent, negatives unsupported");if(r===Gu)return e.ONE;if(r===Zu)return t;let n=e.ONE,i=t;for(;r>Gu;)r&Zu&&(n=e.mul(n,i)),i=e.sqr(i),r>>=Zu;return n}(a,e,t),div:(t,r)=>th(t*nh(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>nh(t,e),sqrt:n.sqrt||(t=>(s||(s=sh(e)),s(a,t))),toBytes:e=>r?Lu(e,o):Bu(e,o),fromBytes:e=>{if(e.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+e.length);return r?Uu(e):Nu(e)},invertBatch:e=>ch(a,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(a)}function dh(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function fh(e){const t=dh(e);return t+Math.ceil(t/2)}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const ph=BigInt(0),gh=BigInt(1);function mh(e,t){const r=t.negate();return e?r:t}function yh(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function wh(e,t){yh(e,t);const r=2**e;return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1),mask:Hu(e),maxNumber:r,shiftBy:BigInt(e)}}function bh(e,t,r){const{windowSize:n,mask:i,maxNumber:o,shiftBy:s}=r;let a=Number(e&i),c=e>>s;a>n&&(a-=o,c+=gh);const l=t*n;return{nextN:c,offset:l+Math.abs(a)-1,isZero:0===a,isNeg:a<0,isNegF:t%2!=0,offsetF:l}}const vh=new WeakMap,Eh=new WeakMap;function xh(e){return Eh.get(e)||1}function Ih(e,t,r,n){!function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw new Error("invalid point at index "+r)})}(r,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+r)})}(n,t);const i=r.length,o=n.length;if(i!==o)throw new Error("arrays of points and scalars must have equal length");const s=e.ZERO,a=function(e){let t;for(t=0;e>gu;e>>=mu,t+=1);return t}(BigInt(i));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=Hu(c),u=new Array(Number(l)+1).fill(s);let h=s;for(let e=Math.floor((t.BITS-1)/c)*c;e>=0;e-=c){u.fill(s);for(let t=0;t<o;t++){const i=n[t],o=Number(i>>BigInt(e)&l);u[o]=u[o].add(r[t])}let t=s;for(let e=u.length-1,r=s;e>0;e--)r=r.add(u[e]),t=t.add(r);if(h=h.add(t),0!==e)for(let e=0;e<c;e++)h=h.double()}return h}function _h(e){return Vu(e.Fp,ah.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),Vu(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...uh(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Sh(e){void 0!==e.lowS&&bu("lowS",e.lowS),void 0!==e.prehash&&bu("prehash",e.prehash)}class Ah extends Error{constructor(e=""){super(e)}}const Oh={Err:Ah,_tlv:{encode:(e,t)=>{const{Err:r}=Oh;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");const n=t.length/2,i=vu(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");const o=n>127?vu(i.length/2|128):"";return vu(e)+o+i+t},decode(e,t){const{Err:r}=Oh;let n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");const i=t[n++];let o=0;if(!!(128&i)){const e=127&i;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");const s=t.subarray(n,n+e);if(s.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===s[0])throw new r("tlv.decode(long): zero leftmost byte");for(const e of s)o=o<<8|e;if(n+=e,o<128)throw new r("tlv.decode(long): not minimal encoding")}else o=i;const s=t.subarray(n,n+o);if(s.length!==o)throw new r("tlv.decode: wrong value length");return{v:s,l:t.subarray(n+o)}}},_int:{encode(e){const{Err:t}=Oh;if(e<Ph)throw new t("integer: negative integers are not allowed");let r=vu(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){const{Err:t}=Oh;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return Nu(e)}},toSig(e){const{Err:t,_int:r,_tlv:n}=Oh,i=Du("signature",e),{v:o,l:s}=n.decode(48,i);if(s.length)throw new t("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,o),{v:l,l:u}=n.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(e){const{_tlv:t,_int:r}=Oh,n=t.encode(2,r.encode(e.r))+t.encode(2,r.encode(e.s));return t.encode(48,n)}};function Ch(e,t){return _u(Bu(e,t))}const Ph=BigInt(0),Rh=BigInt(1);BigInt(2);const Th=BigInt(3),kh=BigInt(4);function Nh(e){const t=function(e){const t=_h(e);Vu(t,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:r,Fp:n,a:i}=t;if(r){if(!n.eql(i,n.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...t})}(e),{Fp:r}=t,n=hh(t.n,t.nBitLength),i=t.toBytes||((e,t,n)=>{const i=t.toAffine();return $u(Uint8Array.from([4]),r.toBytes(i.x),r.toBytes(i.y))}),o=t.fromBytes||(e=>{const t=e.subarray(1);return{x:r.fromBytes(t.subarray(0,r.BYTES)),y:r.fromBytes(t.subarray(r.BYTES,2*r.BYTES))}});function s(e){const{a:n,b:i}=t,o=r.sqr(e),s=r.mul(o,e);return r.add(r.add(s,r.mul(e,n)),i)}function a(e,t){const n=r.sqr(t),i=s(e);return r.eql(n,i)}if(!a(t.Gx,t.Gy))throw new Error("bad curve params: generator point");const c=r.mul(r.pow(t.a,Th),kh),l=r.mul(r.sqr(t.b),BigInt(27));if(r.is0(r.add(c,l)))throw new Error("bad curve params: a or b");function u(e){const{allowedPrivateKeyLengths:r,nByteLength:n,wrapPrivateKey:i,n:o}=t;if(r&&"bigint"!=typeof e){if(yu(e)&&(e=_u(e)),"string"!=typeof e||!r.includes(e.length))throw new Error("invalid private key");e=e.padStart(2*n,"0")}let s;try{s="bigint"==typeof e?e:Nu(Du("private key",e,n))}catch(t){throw new Error("invalid private key, expected hex or "+n+" bytes, got "+typeof e)}return i&&(s=th(s,o)),Fu("private key",s,Rh,o),s}function h(e){if(!(e instanceof p))throw new Error("ProjectivePoint expected")}const d=Ku((e,t)=>{const{px:n,py:i,pz:o}=e;if(r.eql(o,r.ONE))return{x:n,y:i};const s=e.is0();null==t&&(t=s?r.ONE:r.inv(o));const a=r.mul(n,t),c=r.mul(i,t),l=r.mul(o,t);if(s)return{x:r.ZERO,y:r.ZERO};if(!r.eql(l,r.ONE))throw new Error("invZ was invalid");return{x:a,y:c}}),f=Ku(e=>{if(e.is0()){if(t.allowInfinityPoint&&!r.is0(e.py))return;throw new Error("bad point: ZERO")}const{x:n,y:i}=e.toAffine();if(!r.isValid(n)||!r.isValid(i))throw new Error("bad point: x or y not FE");if(!a(n,i))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class p{constructor(e,t,n){if(null==e||!r.isValid(e))throw new Error("x required");if(null==t||!r.isValid(t)||r.is0(t))throw new Error("y required");if(null==n||!r.isValid(n))throw new Error("z required");this.px=e,this.py=t,this.pz=n,Object.freeze(this)}static fromAffine(e){const{x:t,y:n}=e||{};if(!e||!r.isValid(t)||!r.isValid(n))throw new Error("invalid affine point");if(e instanceof p)throw new Error("projective point not allowed");const i=e=>r.eql(e,r.ZERO);return i(t)&&i(n)?p.ZERO:new p(t,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=ch(r,e.map(e=>e.pz));return e.map((e,r)=>e.toAffine(t[r])).map(p.fromAffine)}static fromHex(e){const t=p.fromAffine(o(Du("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return p.BASE.multiply(u(e))}static msm(e,t){return Ih(p,n,e,t)}_setWindowSize(e){y.setWindowSize(this,e)}assertValidity(){f(this)}hasEvenY(){const{y:e}=this.toAffine();if(r.isOdd)return!r.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){h(e);const{px:t,py:n,pz:i}=this,{px:o,py:s,pz:a}=e,c=r.eql(r.mul(t,a),r.mul(o,i)),l=r.eql(r.mul(n,a),r.mul(s,i));return c&&l}negate(){return new p(this.px,r.neg(this.py),this.pz)}double(){const{a:e,b:n}=t,i=r.mul(n,Th),{px:o,py:s,pz:a}=this;let c=r.ZERO,l=r.ZERO,u=r.ZERO,h=r.mul(o,o),d=r.mul(s,s),f=r.mul(a,a),g=r.mul(o,s);return g=r.add(g,g),u=r.mul(o,a),u=r.add(u,u),c=r.mul(e,u),l=r.mul(i,f),l=r.add(c,l),c=r.sub(d,l),l=r.add(d,l),l=r.mul(c,l),c=r.mul(g,c),u=r.mul(i,u),f=r.mul(e,f),g=r.sub(h,f),g=r.mul(e,g),g=r.add(g,u),u=r.add(h,h),h=r.add(u,h),h=r.add(h,f),h=r.mul(h,g),l=r.add(l,h),f=r.mul(s,a),f=r.add(f,f),h=r.mul(f,g),c=r.sub(c,h),u=r.mul(f,d),u=r.add(u,u),u=r.add(u,u),new p(c,l,u)}add(e){h(e);const{px:n,py:i,pz:o}=this,{px:s,py:a,pz:c}=e;let l=r.ZERO,u=r.ZERO,d=r.ZERO;const f=t.a,g=r.mul(t.b,Th);let m=r.mul(n,s),y=r.mul(i,a),w=r.mul(o,c),b=r.add(n,i),v=r.add(s,a);b=r.mul(b,v),v=r.add(m,y),b=r.sub(b,v),v=r.add(n,o);let E=r.add(s,c);return v=r.mul(v,E),E=r.add(m,w),v=r.sub(v,E),E=r.add(i,o),l=r.add(a,c),E=r.mul(E,l),l=r.add(y,w),E=r.sub(E,l),d=r.mul(f,v),l=r.mul(g,w),d=r.add(l,d),l=r.sub(y,d),d=r.add(y,d),u=r.mul(l,d),y=r.add(m,m),y=r.add(y,m),w=r.mul(f,w),v=r.mul(g,v),y=r.add(y,w),w=r.sub(m,w),w=r.mul(f,w),v=r.add(v,w),m=r.mul(y,v),u=r.add(u,m),m=r.mul(E,v),l=r.mul(b,l),l=r.sub(l,m),m=r.mul(b,y),d=r.mul(E,d),d=r.add(d,m),new p(l,u,d)}subtract(e){return this.add(e.negate())}is0(){return this.equals(p.ZERO)}wNAF(e){return y.wNAFCached(this,e,p.normalizeZ)}multiplyUnsafe(e){const{endo:n,n:i}=t;Fu("scalar",e,Ph,i);const o=p.ZERO;if(e===Ph)return o;if(this.is0()||e===Rh)return this;if(!n||y.hasPrecomputes(this))return y.wNAFCachedUnsafe(this,e,p.normalizeZ);let{k1neg:s,k1:a,k2neg:c,k2:l}=n.splitScalar(e),u=o,h=o,d=this;for(;a>Ph||l>Ph;)a&Rh&&(u=u.add(d)),l&Rh&&(h=h.add(d)),d=d.double(),a>>=Rh,l>>=Rh;return s&&(u=u.negate()),c&&(h=h.negate()),h=new p(r.mul(h.px,n.beta),h.py,h.pz),u.add(h)}multiply(e){const{endo:n,n:i}=t;let o,s;if(Fu("scalar",e,Rh,i),n){const{k1neg:t,k1:i,k2neg:a,k2:c}=n.splitScalar(e);let{p:l,f:u}=this.wNAF(i),{p:h,f:d}=this.wNAF(c);l=y.constTimeNegate(t,l),h=y.constTimeNegate(a,h),h=new p(r.mul(h.px,n.beta),h.py,h.pz),o=l.add(h),s=u.add(d)}else{const{p:t,f:r}=this.wNAF(e);o=t,s=r}return p.normalizeZ([o,s])[0]}multiplyAndAddUnsafe(e,t,r){const n=p.BASE,i=(e,t)=>t!==Ph&&t!==Rh&&e.equals(n)?e.multiply(t):e.multiplyUnsafe(t),o=i(this,t).add(i(e,r));return o.is0()?void 0:o}toAffine(e){return d(this,e)}isTorsionFree(){const{h:e,isTorsionFree:r}=t;if(e===Rh)return!0;if(r)return r(p,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:r}=t;return e===Rh?this:r?r(p,this):this.multiplyUnsafe(t.h)}toRawBytes(e=!0){return bu("isCompressed",e),this.assertValidity(),i(p,this,e)}toHex(e=!0){return bu("isCompressed",e),_u(this.toRawBytes(e))}}p.BASE=new p(t.Gx,t.Gy,r.ONE),p.ZERO=new p(r.ZERO,r.ONE,r.ZERO);const{endo:g,nBitLength:m}=t,y=function(e,t){return{constTimeNegate:mh,hasPrecomputes:e=>1!==xh(e),unsafeLadder(t,r,n=e.ZERO){let i=t;for(;r>ph;)r&gh&&(n=n.add(i)),i=i.double(),r>>=gh;return n},precomputeWindow(e,r){const{windows:n,windowSize:i}=wh(r,t),o=[];let s=e,a=s;for(let e=0;e<n;e++){a=s,o.push(a);for(let e=1;e<i;e++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(r,n,i){let o=e.ZERO,s=e.BASE;const a=wh(r,t);for(let e=0;e<a.windows;e++){const{nextN:t,offset:r,isZero:c,isNeg:l,isNegF:u,offsetF:h}=bh(i,e,a);i=t,c?s=s.add(mh(u,n[h])):o=o.add(mh(l,n[r]))}return{p:o,f:s}},wNAFUnsafe(r,n,i,o=e.ZERO){const s=wh(r,t);for(let e=0;e<s.windows&&i!==ph;e++){const{nextN:t,offset:r,isZero:a,isNeg:c}=bh(i,e,s);if(i=t,!a){const e=n[r];o=o.add(c?e.negate():e)}}return o},getPrecomputes(e,t,r){let n=vh.get(t);return n||(n=this.precomputeWindow(t,e),1!==e&&vh.set(t,r(n))),n},wNAFCached(e,t,r){const n=xh(e);return this.wNAF(n,this.getPrecomputes(n,e,r),t)},wNAFCachedUnsafe(e,t,r,n){const i=xh(e);return 1===i?this.unsafeLadder(e,t,n):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),t,n)},setWindowSize(e,r){yh(r,t),Eh.set(e,r),vh.delete(e)}}}(p,g?Math.ceil(m/2):m);return{CURVE:t,ProjectivePoint:p,normPrivateKeyToScalar:u,weierstrassEquation:s,isWithinCurveOrder:function(e){return ju(e,Rh,t.n)}}}function Uh(e){const t=function(e){const t=_h(e);return Vu(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}(e),{Fp:r,n:n,nByteLength:i,nBitLength:o}=t,s=r.BYTES+1,a=2*r.BYTES+1;function c(e){return th(e,n)}function l(e){return nh(e,n)}const{ProjectivePoint:u,normPrivateKeyToScalar:h,weierstrassEquation:d,isWithinCurveOrder:f}=Nh({...t,toBytes(e,t,n){const i=t.toAffine(),o=r.toBytes(i.x),s=$u;return bu("isCompressed",n),n?s(Uint8Array.from([t.hasEvenY()?2:3]),o):s(Uint8Array.from([4]),o,r.toBytes(i.y))},fromBytes(e){const t=e.length,n=e[0],i=e.subarray(1);if(t!==s||2!==n&&3!==n){if(t===a&&4===n){return{x:r.fromBytes(i.subarray(0,r.BYTES)),y:r.fromBytes(i.subarray(r.BYTES,2*r.BYTES))}}throw new Error("invalid Point, expected length of "+s+", or uncompressed "+a+", got "+t)}{const e=Nu(i);if(!ju(e,Rh,r.ORDER))throw new Error("Point is not on curve");const t=d(e);let o;try{o=r.sqrt(t)}catch(e){const t=e instanceof Error?": "+e.message:"";throw new Error("Point is not on curve"+t)}return!(1&~n)!==((o&Rh)===Rh)&&(o=r.neg(o)),{x:e,y:o}}}});function p(e){return e>n>>Rh}const g=(e,t,r)=>Nu(e.slice(t,r));class m{constructor(e,t,r){Fu("r",e,Rh,n),Fu("s",t,Rh,n),this.r=e,this.s=t,null!=r&&(this.recovery=r),Object.freeze(this)}static fromCompact(e){const t=i;return e=Du("compactSignature",e,2*t),new m(g(e,0,t),g(e,t,2*t))}static fromDER(e){const{r:t,s:r}=Oh.toSig(Du("DER",e));return new m(t,r)}assertValidity(){}addRecoveryBit(e){return new m(this.r,this.s,e)}recoverPublicKey(e){const{r:n,s:i,recovery:o}=this,s=v(Du("msgHash",e));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");const a=2===o||3===o?n+t.n:n;if(a>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const h=1&o?"03":"02",d=u.fromHex(h+Ch(a,r.BYTES)),f=l(a),p=c(-s*f),g=c(i*f),m=u.BASE.multiplyAndAddUnsafe(d,p,g);if(!m)throw new Error("point at infinify");return m.assertValidity(),m}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return ku(this.toDERHex())}toDERHex(){return Oh.hexFromSig(this)}toCompactRawBytes(){return ku(this.toCompactHex())}toCompactHex(){const e=i;return Ch(this.r,e)+Ch(this.s,e)}}const y={isValidPrivateKey(e){try{return h(e),!0}catch(e){return!1}},normPrivateKeyToScalar:h,randomPrivateKey:()=>{const e=fh(t.n);return function(e,t,r=!1){const n=e.length,i=dh(t),o=fh(t);if(n<16||n<o||n>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+n);const s=th(r?Uu(e):Nu(e),t-Zu)+Zu;return r?Lu(s,i):Bu(s,i)}(t.randomBytes(e),t.n)},precompute:(e=8,t=u.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)};function w(e){if("bigint"==typeof e)return!1;if(e instanceof u)return!0;const n=Du("key",e).length,o=r.BYTES,s=o+1,a=2*o+1;return t.allowedPrivateKeyLengths||i===s?void 0:n===s||n===a}const b=t.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");const t=Nu(e),r=8*e.length-o;return r>0?t>>BigInt(r):t},v=t.bits2int_modN||function(e){return c(b(e))},E=Hu(o);function x(e){return Fu("num < 2^"+o,e,Ph,E),Bu(e,i)}function I(e,n,i=_){if(["recovered","canonical"].some(e=>e in i))throw new Error("sign() legacy options not supported");const{hash:o,randomBytes:s}=t;let{lowS:a,prehash:d,extraEntropy:g}=i;null==a&&(a=!0),e=Du("msgHash",e),Sh(i),d&&(e=Du("prehashed msgHash",o(e)));const y=v(e),w=h(n),E=[x(w),x(y)];if(null!=g&&!1!==g){const e=!0===g?s(r.BYTES):g;E.push(Du("extraEntropy",e))}const I=$u(...E),S=y;return{seed:I,k2sig:function(e){const t=b(e);if(!f(t))return;const r=l(t),n=u.BASE.multiply(t).toAffine(),i=c(n.x);if(i===Ph)return;const o=c(r*c(S+i*w));if(o===Ph)return;let s=(n.x===i?0:2)|Number(n.y&Rh),h=o;return a&&p(o)&&(h=function(e){return p(e)?c(-e):e}(o),s^=1),new m(i,h,s)}}}const _={lowS:t.lowS,prehash:!1},S={lowS:t.lowS,prehash:!1};return u.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e,t=!0){return u.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,r=!0){if(!0===w(e))throw new Error("first arg must be private key");if(!1===w(t))throw new Error("second arg must be public key");return u.fromHex(t).multiply(h(e)).toRawBytes(r)},sign:function(e,r,n=_){const{seed:i,k2sig:o}=I(e,r,n),s=t,a=function(e,t,r){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof r)throw new Error("hmacFn must be a function");let n=zu(e),i=zu(e),o=0;const s=()=>{n.fill(1),i.fill(0),o=0},a=(...e)=>r(i,n,...e),c=(e=zu(0))=>{i=a(qu([0]),e),n=a(),0!==e.length&&(i=a(qu([1]),e),n=a())},l=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const r=[];for(;e<t;){n=a();const t=n.slice();r.push(t),e+=n.length}return $u(...r)};return(e,t)=>{let r;for(s(),c(e);!(r=t(l()));)c();return s(),r}}(s.hash.outputLen,s.nByteLength,s.hmac);return a(i,o)},verify:function(e,r,n,i=S){const o=e;r=Du("msgHash",r),n=Du("publicKey",n);const{lowS:s,prehash:a,format:h}=i;if(Sh(i),"strict"in i)throw new Error("options.strict was renamed to lowS");if(void 0!==h&&"compact"!==h&&"der"!==h)throw new Error("format must be compact or der");const d="string"==typeof o||yu(o),f=!d&&!h&&"object"==typeof o&&null!==o&&"bigint"==typeof o.r&&"bigint"==typeof o.s;if(!d&&!f)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let p,g;try{if(f&&(p=new m(o.r,o.s)),d){try{"compact"!==h&&(p=m.fromDER(o))}catch(e){if(!(e instanceof Oh.Err))throw e}p||"der"===h||(p=m.fromCompact(o))}g=u.fromHex(n)}catch(e){return!1}if(!p)return!1;if(s&&p.hasHighS())return!1;a&&(r=t.hash(r));const{r:y,s:w}=p,b=v(r),E=l(w),x=c(b*E),I=c(y*E),_=u.BASE.multiplyAndAddUnsafe(g,x,I)?.toAffine();return!!_&&c(_.x)===y},ProjectivePoint:u,Signature:m,utils:y}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Bh(e){return{hash:e,hmac:(t,...r)=>pu(e,t,function(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];Sl(n),t+=n.length}const r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}(...r)),randomBytes:Ll}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const Lh=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Dh=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),$h=BigInt(0),Mh=BigInt(1),jh=BigInt(2),Fh=(e,t)=>(e+t/jh)/t;const Hh=hh(Lh,void 0,void 0,{sqrt:function(e){const t=Lh,r=BigInt(3),n=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),l=e*e*e%t,u=l*l*e%t,h=rh(u,r,t)*u%t,d=rh(h,r,t)*u%t,f=rh(d,jh,t)*l%t,p=rh(f,i,t)*f%t,g=rh(p,o,t)*p%t,m=rh(g,a,t)*g%t,y=rh(m,c,t)*m%t,w=rh(y,a,t)*g%t,b=rh(w,r,t)*u%t,v=rh(b,s,t)*p%t,E=rh(v,n,t)*l%t,x=rh(E,jh,t);if(!Hh.eql(Hh.sqr(x),e))throw new Error("Cannot find square root");return x}}),zh=function(e,t){const r=t=>Uh({...e,...Bh(t)});return{...r(t),create:r}}({a:$h,b:BigInt(7),Fp:Hh,n:Dh,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=Dh,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Mh*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=r,s=BigInt("0x100000000000000000000000000000000"),a=Fh(o*e,t),c=Fh(-n*e,t);let l=th(e-a*r-c*i,t),u=th(-a*n-c*o,t);const h=l>s,d=u>s;if(h&&(l=t-l),d&&(u=t-u),l>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:h,k1:l,k2neg:d,k2:u}}}},du);var qh=Object.freeze({__proto__:null,secp256k1:zh});var Wh=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");const t=new Uint8Array(256);for(let e=0;e<t.length;e++)t[e]=255;for(let r=0;r<e.length;r++){const n=e.charAt(r),i=n.charCodeAt(0);if(255!==t[i])throw new TypeError(n+" is ambiguous");t[i]=r}const r=e.length,n=e.charAt(0),i=Math.log(r)/Math.log(256),o=Math.log(256)/Math.log(r);function s(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;let o=0,s=0,a=0;for(;e[o]===n;)s++,o++;const c=(e.length-o)*i+1>>>0,l=new Uint8Array(c);for(;o<e.length;){const n=e.charCodeAt(o);if(n>255)return;let i=t[n];if(255===i)return;let s=0;for(let e=c-1;(0!==i||s<a)&&-1!==e;e--,s++)i+=r*l[e]>>>0,l[e]=i%256>>>0,i=i/256>>>0;if(0!==i)throw new Error("Non-zero carry");a=s,o++}let u=c-a;for(;u!==c&&0===l[u];)u++;const h=new Uint8Array(s+(c-u));let d=s;for(;u!==c;)h[d++]=l[u++];return h}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";let i=0,s=0,a=0;const c=t.length;for(;a!==c&&0===t[a];)a++,i++;const l=(c-a)*o+1>>>0,u=new Uint8Array(l);for(;a!==c;){let e=t[a],n=0;for(let t=l-1;(0!==e||n<s)&&-1!==t;t--,n++)e+=256*u[t]>>>0,u[t]=e%r>>>0,e=e/r>>>0;if(0!==e)throw new Error("Non-zero carry");s=n,a++}let h=l-s;for(;h!==l&&0===u[h];)h++;let d=n.repeat(i);for(;h<l;++h)d+=e.charAt(u[h]);return d},decodeUnsafe:s,decode:function(e){const t=s(e);if(t)return t;throw new Error("Non-base"+r+" character")}}}("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");const Vh=new TextEncoder;function Kh(e,t,r){e.length>50?function(e,t,r){Vh.encodeInto(e,t.subarray(r))}(e,t,r):function(e,t,r){const n=e.length;let i=r,o=0;for(;o<n;){let r=e.charCodeAt(o++);if(4294967168&r){if(4294965248&r){if(r>=55296&&r<=56319&&o<n){const t=e.charCodeAt(o);56320==(64512&t)&&(++o,r=((1023&r)<<10)+(1023&t)+65536)}4294901760&r?(t[i++]=r>>18&7|240,t[i++]=r>>12&63|128,t[i++]=r>>6&63|128):(t[i++]=r>>12&15|224,t[i++]=r>>6&63|128)}else t[i++]=r>>6&31|192;t[i++]=63&r|128}else t[i++]=r}}(e,t,r)}function Gh(e,t,r){let n=t;const i=n+r,o=[];let s="";for(;n<i;){const t=e[n++];if(128&t)if(192==(224&t)){const r=63&e[n++];o.push((31&t)<<6|r)}else if(224==(240&t)){const r=63&e[n++],i=63&e[n++];o.push((31&t)<<12|r<<6|i)}else if(240==(248&t)){let r=(7&t)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++];r>65535&&(r-=65536,o.push(r>>>10&1023|55296),r=56320|1023&r),o.push(r)}else o.push(t);else o.push(t);o.length>=4096&&(s+=String.fromCharCode(...o),o.length=0)}return o.length>0&&(s+=String.fromCharCode(...o)),s}const Zh=new TextDecoder;function Yh(e,t,r){return r>200?function(e,t,r){const n=e.subarray(t,t+r);return Zh.decode(n)}(e,t,r):Gh(e,t,r)}class Jh{constructor(e,t){this.type=e,this.data=t}}class Xh extends Error{constructor(e){super(e);const t=Object.create(Xh.prototype);Object.setPrototypeOf(this,t),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:Xh.name})}}const Qh=4294967295;function ed(e,t,r){const n=Math.floor(r/4294967296),i=r;e.setUint32(t,n),e.setUint32(t+4,i)}function td(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}const rd={type:-1,encode:function(e){if(e instanceof Date){return function({sec:e,nsec:t}){if(e>=0&&t>=0&&e<=17179869183){if(0===t&&e<=4294967295){const t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e),t}{const r=e/4294967296,n=4294967295&e,i=new Uint8Array(8),o=new DataView(i.buffer);return o.setUint32(0,t<<2|3&r),o.setUint32(4,n),i}}{const r=new Uint8Array(12),n=new DataView(r.buffer);return n.setUint32(0,t),ed(n,4,e),r}}(function(e){const t=e.getTime(),r=Math.floor(t/1e3),n=1e6*(t-1e3*r),i=Math.floor(n/1e9);return{sec:r+i,nsec:n-1e9*i}}(e))}return null},decode:function(e){const t=function(e){const t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:{const e=t.getUint32(0);return{sec:4294967296*(3&e)+t.getUint32(4),nsec:e>>>2}}case 12:return{sec:td(t,4),nsec:t.getUint32(0)};default:throw new Xh(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${e.length}`)}}(e);return new Date(1e3*t.sec+t.nsec/1e6)}};class nd{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(rd)}register({type:e,encode:t,decode:r}){if(e>=0)this.encoders[e]=t,this.decoders[e]=r;else{const n=-1-e;this.builtInEncoders[n]=t,this.builtInDecoders[n]=r}}tryToEncode(e,t){for(let r=0;r<this.builtInEncoders.length;r++){const n=this.builtInEncoders[r];if(null!=n){const i=n(e,t);if(null!=i){return new Jh(-1-r,i)}}}for(let r=0;r<this.encoders.length;r++){const n=this.encoders[r];if(null!=n){const i=n(e,t);if(null!=i){return new Jh(r,i)}}}return e instanceof Jh?e:null}decode(e,t,r){const n=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return n?n(e,t,r):new Jh(t,e)}}function id(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):function(e){return e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer}(e)?new Uint8Array(e):Uint8Array.from(e)}nd.defaultCodec=new nd;let od=class e{constructor(e){this.entered=!1,this.extensionCodec=e?.extensionCodec??nd.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??100,this.initialBufferSize=e?.initialBufferSize??2048,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new e({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered){return this.clone().encodeSharedRef(e)}try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered){return this.clone().encode(e)}try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,t){if(t>this.maxDepth)throw new Error(`Too deep objects in depth ${t}`);null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.useBigInt64&&"bigint"==typeof e?this.encodeBigInt64(e):this.encodeObject(e,t)}ensureBufferSizeToWrite(e){const t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)}resizeBuffer(e){const t=new ArrayBuffer(e),r=new Uint8Array(t),n=new DataView(t);r.set(this.bytes),this.view=n,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){!1===e?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error(`Too long string: ${e} bytes in UTF-8`);this.writeU8(219),this.writeU32(e)}}encodeString(e){const t=function(e){const t=e.length;let r=0,n=0;for(;n<t;){let i=e.charCodeAt(n++);if(4294967168&i)if(4294965248&i){if(i>=55296&&i<=56319&&n<t){const t=e.charCodeAt(n);56320==(64512&t)&&(++n,i=((1023&i)<<10)+(1023&t)+65536)}r+=4294901760&i?4:3}else r+=2;else r++}return r}(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),Kh(e,this.bytes,this.pos),this.pos+=t}encodeObject(e,t){const r=this.extensionCodec.tryToEncode(e,this.context);if(null!=r)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`);this.encodeMap(e,t)}}encodeBinary(e){const t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error(`Too large binary: ${t}`);this.writeU8(198),this.writeU32(t)}const r=id(e);this.writeU8a(r)}encodeArray(e,t){const r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else{if(!(r<4294967296))throw new Error(`Too large array: ${r}`);this.writeU8(221),this.writeU32(r)}for(const r of e)this.doEncode(r,t+1)}countWithoutUndefined(e,t){let r=0;for(const n of t)void 0!==e[n]&&r++;return r}encodeMap(e,t){const r=Object.keys(e);this.sortKeys&&r.sort();const n=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(n<16)this.writeU8(128+n);else if(n<65536)this.writeU8(222),this.writeU16(n);else{if(!(n<4294967296))throw new Error(`Too large map object: ${n}`);this.writeU8(223),this.writeU32(n)}for(const n of r){const r=e[n];this.ignoreUndefined&&void 0===r||(this.encodeString(n),this.doEncode(r,t+1))}}encodeExtension(e){if("function"==typeof e.data){const t=e.data(this.pos+6),r=t.length;if(r>=4294967296)throw new Error(`Too large extension object: ${r}`);return this.writeU8(201),this.writeU32(r),this.writeI8(e.type),void this.writeU8a(t)}const t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error(`Too large extension object: ${t}`);this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),function(e,t,r){const n=r/4294967296,i=r;e.setUint32(t,n),e.setUint32(t+4,i)}(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),ed(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}};function sd(e){return`${e<0?"-":""}0x${Math.abs(e).toString(16).padStart(2,"0")}`}const ad="array",cd="map_key",ld="map_value",ud=e=>{if("string"==typeof e||"number"==typeof e)return e;throw new Xh("The type of key must be string or number but "+typeof e)};class hd{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const t=this.getUninitializedStateFromPool();t.type=ad,t.position=0,t.size=e,t.array=new Array(e)}pushMapState(e){const t=this.getUninitializedStateFromPool();t.type=cd,t.readCount=0,t.size=e,t.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===ad){const t=e;t.size=0,t.array=void 0,t.position=0,t.type=void 0}if(e.type===cd||e.type===ld){const t=e;t.size=0,t.map=void 0,t.readCount=0,t.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const dd=new DataView(new ArrayBuffer(0)),fd=new Uint8Array(dd.buffer);try{dd.getInt8(0)}catch(hM){if(!(hM instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const pd=new RangeError("Insufficient data"),gd=new class{constructor(e=16,t=16){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=t,this.caches=[];for(let e=0;e<this.maxKeyLength;e++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,t,r){const n=this.caches[r-1];e:for(const i of n){const n=i.bytes;for(let i=0;i<r;i++)if(n[i]!==e[t+i])continue e;return i.str}return null}store(e,t){const r=this.caches[e.length-1],n={bytes:e,str:t};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=n:r.push(n)}decode(e,t,r){const n=this.find(e,t,r);if(null!=n)return this.hit++,n;this.miss++;const i=Gh(e,t,r),o=Uint8Array.prototype.slice.call(e,t,t+r);return this.store(o,i),i}};let md=class e{constructor(e){this.totalPos=0,this.pos=0,this.view=dd,this.bytes=fd,this.headByte=-1,this.stack=new hd,this.entered=!1,this.extensionCodec=e?.extensionCodec??nd.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??Qh,this.maxBinLength=e?.maxBinLength??Qh,this.maxArrayLength=e?.maxArrayLength??Qh,this.maxMapLength=e?.maxMapLength??Qh,this.maxExtLength=e?.maxExtLength??Qh,this.keyDecoder=void 0!==e?.keyDecoder?e.keyDecoder:gd,this.mapKeyConverter=e?.mapKeyConverter??ud}clone(){return new e({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=-1,this.stack.reset()}setBuffer(e){const t=id(e);this.bytes=t,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.pos=0}appendBuffer(e){if(-1!==this.headByte||this.hasRemaining(1)){const t=this.bytes.subarray(this.pos),r=id(e),n=new Uint8Array(t.length+r.length);n.set(t),n.set(r,t.length),this.setBuffer(n)}else this.setBuffer(e)}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:t,pos:r}=this;return new RangeError(`Extra ${t.byteLength-r} of ${t.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered){return this.clone().decode(e)}try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){const t=this.clone();return void(yield*t.decodeMulti(e))}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered){return this.clone().decodeAsync(e)}try{this.entered=!0;let t,r=!1;for await(const n of e){if(r)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(n);try{t=this.doDecodeSync(),r=!0}catch(e){if(!(e instanceof RangeError))throw e}this.totalPos+=this.pos}if(r){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return t}const{headByte:n,pos:i,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${sd(n)} at ${o} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,t){if(this.entered){const r=this.clone();return void(yield*r.decodeMultiAsync(e,t))}try{this.entered=!0;let r=t,n=-1;for await(const i of e){if(t&&0===n)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),r&&(n=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),0!==--n;);}catch(e){if(!(e instanceof RangeError))throw e}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let t;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){const r=e-128;if(0!==r){this.pushMapState(r),this.complete();continue e}t={}}else if(e<160){const r=e-144;if(0!==r){this.pushArrayState(r),this.complete();continue e}t=[]}else{const r=e-160;t=this.decodeString(r,0)}else if(192===e)t=null;else if(194===e)t=!1;else if(195===e)t=!0;else if(202===e)t=this.readF32();else if(203===e)t=this.readF64();else if(204===e)t=this.readU8();else if(205===e)t=this.readU16();else if(206===e)t=this.readU32();else if(207===e)t=this.useBigInt64?this.readU64AsBigInt():this.readU64();else if(208===e)t=this.readI8();else if(209===e)t=this.readI16();else if(210===e)t=this.readI32();else if(211===e)t=this.useBigInt64?this.readI64AsBigInt():this.readI64();else if(217===e){const e=this.lookU8();t=this.decodeString(e,1)}else if(218===e){const e=this.lookU16();t=this.decodeString(e,2)}else if(219===e){const e=this.lookU32();t=this.decodeString(e,4)}else if(220===e){const e=this.readU16();if(0!==e){this.pushArrayState(e),this.complete();continue e}t=[]}else if(221===e){const e=this.readU32();if(0!==e){this.pushArrayState(e),this.complete();continue e}t=[]}else if(222===e){const e=this.readU16();if(0!==e){this.pushMapState(e),this.complete();continue e}t={}}else if(223===e){const e=this.readU32();if(0!==e){this.pushMapState(e),this.complete();continue e}t={}}else if(196===e){const e=this.lookU8();t=this.decodeBinary(e,1)}else if(197===e){const e=this.lookU16();t=this.decodeBinary(e,2)}else if(198===e){const e=this.lookU32();t=this.decodeBinary(e,4)}else if(212===e)t=this.decodeExtension(1,0);else if(213===e)t=this.decodeExtension(2,0);else if(214===e)t=this.decodeExtension(4,0);else if(215===e)t=this.decodeExtension(8,0);else if(216===e)t=this.decodeExtension(16,0);else if(199===e){const e=this.lookU8();t=this.decodeExtension(e,1)}else if(200===e){const e=this.lookU16();t=this.decodeExtension(e,2)}else{if(201!==e)throw new Xh(`Unrecognized type byte: ${sd(e)}`);{const e=this.lookU32();t=this.decodeExtension(e,4)}}this.complete();const r=this.stack;for(;r.length>0;){const e=r.top();if(e.type===ad){if(e.array[e.position]=t,e.position++,e.position!==e.size)continue e;t=e.array,r.release(e)}else{if(e.type===cd){if("__proto__"===t)throw new Xh("The key __proto__ is not allowed");e.key=this.mapKeyConverter(t),e.type=ld;continue e}if(e.map[e.key]=t,e.readCount++,e.readCount!==e.size){e.key=null,e.type=cd;continue e}t=e.map,r.release(e)}}return t}}readHeadByte(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=-1}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new Xh(`Unrecognized array type byte: ${sd(e)}`)}}pushMapState(e){if(e>this.maxMapLength)throw new Xh(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new Xh(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,t){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,t):this.decodeBinary(e,t)}decodeUtf8String(e,t){if(e>this.maxStrLength)throw new Xh(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+t+e)throw pd;const r=this.pos+t;let n;return n=this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?this.keyDecoder.decode(this.bytes,r,e):Yh(this.bytes,r,e),this.pos+=t+e,n}stateIsMapKey(){if(this.stack.length>0){return this.stack.top().type===cd}return!1}decodeBinary(e,t){if(e>this.maxBinLength)throw new Xh(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+t))throw pd;const r=this.pos+t,n=this.bytes.subarray(r,r+e);return this.pos+=t+e,n}decodeExtension(e,t){if(e>this.maxExtLength)throw new Xh(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+t),n=this.decodeBinary(e,t+1);return this.extensionCodec.decode(n,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=(t=this.view,r=this.pos,4294967296*t.getUint32(r)+t.getUint32(r+4));var t,r;return this.pos+=8,e}readI64(){const e=td(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}};function yd(e,t){return!!Array.isArray(t)&&(0===t.length||(e?t.every(e=>"string"==typeof e):t.every(e=>Number.isSafeInteger(e))))}function wd(e,t){if("string"!=typeof t)throw new Error(`${e}: string expected`);return!0}function bd(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function vd(e){if(!Array.isArray(e))throw new Error("array expected")}function Ed(e,t){if(!yd(!0,t))throw new Error(`${e}: array of strings expected`)}const xd=(e,t)=>0===t?e:xd(t,e%t),Id=(e,t)=>e+(t-xd(e,t)),_d=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function Sd(e,t,r,n){if(vd(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(Id(t,r)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${r} carryBits=${Id(t,r)}`);let i=0,o=0;const s=_d[t],a=_d[r]-1,c=[];for(const n of e){if(bd(n),n>=s)throw new Error(`convertRadix2: invalid data word=${n} from=${t}`);if(i=i<<t|n,o+t>32)throw new Error(`convertRadix2: carry overflow pos=${o} from=${t}`);for(o+=t;o>=r;o-=r)c.push((i>>o-r&a)>>>0);const e=_d[o];if(void 0===e)throw new Error("invalid carry");i&=e-1}if(i=i<<r-o&a,!n&&o>=t)throw new Error("Excess padding");if(!n&&i>0)throw new Error(`Non-zero padding: ${i}`);return n&&o>0&&c.push(i>>>0),c}const Ad=function(...e){const t=e=>e,r=(e,t)=>r=>e(t(r)),n=e.map(e=>e.encode).reduceRight(r,t),i=e.map(e=>e.decode).reduce(r,t);return{encode:n,decode:i}}(function(e,t=!1){if(bd(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(Id(8,e)>32||Id(e,8)>32)throw new Error("radix2: carry overflow");return{encode:r=>{if(!
/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */
function(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}(r))throw new Error("radix2.encode input should be Uint8Array");return Sd(Array.from(r),8,e,!t)},decode:r=>(function(e,t){if(!yd(!1,t))throw new Error(`${e}: array of numbers expected`)}("radix2.decode",r),Uint8Array.from(Sd(r,e,8,t)))}}(5),function(e){const t="string"==typeof e?e.split(""):e,r=t.length;Ed("alphabet",t);const n=new Map(t.map((e,t)=>[e,t]));return{encode:n=>(vd(n),n.map(n=>{if(!Number.isSafeInteger(n)||n<0||n>=r)throw new Error(`alphabet.encode: digit index outside alphabet "${n}". Allowed: ${e}`);return t[n]})),decode:t=>(vd(t),t.map(t=>{wd("alphabet.decode",t);const r=n.get(t);if(void 0===r)throw new Error(`Unknown letter: "${t}". Allowed: ${e}`);return r}))}}("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),function(e,t="="){return bd(e),wd("padding",t),{encode(r){for(Ed("padding.encode",r);r.length*e%8;)r.push(t);return r},decode(r){Ed("padding.decode",r);let n=r.length;if(n*e%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;n>0&&r[n-1]===t;n--){if((n-1)*e%8==0)throw new Error("padding: invalid, string has too much padding")}return r.slice(0,n)}}}(5),function(e=""){return wd("join",e),{encode:t=>(Ed("join.decode",t),t.join(e)),decode:t=>(wd("join.decode",t),t.split(e))}}(""));function Od(e){if("string"!=typeof e)throw new Error("Cannot safe json parse value of type "+typeof e);try{return(e=>{const t=e.replace(/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,'$1"$2n"$3');return JSON.parse(t,(e,t)=>"string"==typeof t&&t.match(/^\d+n$/)?BigInt(t.substring(0,t.length-1)):t)})(e)}catch(t){return e}}function Cd(e){return"string"==typeof e?e:(e=>JSON.stringify(e,(e,t)=>"bigint"==typeof t?t.toString()+"n":t))(e)||""}function Pd(e,...t){if(!function(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Rd(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}const Td="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,kd=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Nd(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),Pd(e),e}let Ud=class{clone(){return this._cloneInto()}};function Bd(e=32){if(Td&&"function"==typeof Td.getRandomValues)return Td.getRandomValues(new Uint8Array(e));if(Td&&"function"==typeof Td.randomBytes)return Td.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}let Ld=class extends Ud{constructor(e,t,r,n){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=kd(this.buffer)}update(e){Rd(this);const{view:t,buffer:r,blockLen:n}=this,i=(e=Nd(e)).length;for(let o=0;o<i;){const s=Math.min(n-this.pos,i-o);if(s===n){const t=kd(e);for(;n<=i-o;o+=n)this.process(t,o);continue}r.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Rd(this),function(e,t){Pd(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:n,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>n-o&&(this.process(r,0),o=0);for(let e=o;e<n;e++)t[e]=0;(function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,l=n?0:4;e.setUint32(t+c,s,n),e.setUint32(t+l,a,n)})(r,n-8,BigInt(8*this.length),i),this.process(r,0);const s=kd(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,l=this.get();if(c>l.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,l[e],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:i,destroyed:o,pos:s}=this;return e.length=n,e.pos=s,e.finished=i,e.destroyed=o,n%t&&e.buffer.set(r),e}};const Dd=BigInt(2**32-1),$d=BigInt(32);function Md(e,t=!1){return t?{h:Number(e&Dd),l:Number(e>>$d&Dd)}:{h:0|Number(e>>$d&Dd),l:0|Number(e&Dd)}}const jd={fromBig:Md,split:function(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:o,l:s}=Md(e[i],t);[r[i],n[i]]=[o,s]}return[r,n]},toBig:(e,t)=>BigInt(e>>>0)<<$d|BigInt(t>>>0),shrSH:(e,t,r)=>e>>>r,shrSL:(e,t,r)=>e<<32-r|t>>>r,rotrSH:(e,t,r)=>e>>>r|t<<32-r,rotrSL:(e,t,r)=>e<<32-r|t>>>r,rotrBH:(e,t,r)=>e<<64-r|t>>>r-32,rotrBL:(e,t,r)=>e>>>r-32|t<<64-r,rotr32H:(e,t)=>t,rotr32L:(e,t)=>e,rotlSH:(e,t,r)=>e<<r|t>>>32-r,rotlSL:(e,t,r)=>t<<r|e>>>32-r,rotlBH:(e,t,r)=>t<<r-32|e>>>64-r,rotlBL:(e,t,r)=>e<<r-32|t>>>64-r,add:function(e,t,r,n){const i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:0|i}},add3L:(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),add3H:(e,t,r,n)=>t+r+n+(e/2**32|0)|0,add4L:(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),add4H:(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0,add5H:(e,t,r,n,i,o)=>t+r+n+i+o+(e/2**32|0)|0,add5L:(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0)},[Fd,Hd]=jd.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),zd=new Uint32Array(80),qd=new Uint32Array(80);let Wd=class extends Ld{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:n,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:l,Fh:u,Fl:h,Gh:d,Gl:f,Hh:p,Hl:g}=this;return[e,t,r,n,i,o,s,a,c,l,u,h,d,f,p,g]}set(e,t,r,n,i,o,s,a,c,l,u,h,d,f,p,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|l,this.Fh=0|u,this.Fl=0|h,this.Gh=0|d,this.Gl=0|f,this.Hh=0|p,this.Hl=0|g}process(e,t){for(let r=0;r<16;r++,t+=4)zd[r]=e.getUint32(t),qd[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|zd[e-15],r=0|qd[e-15],n=jd.rotrSH(t,r,1)^jd.rotrSH(t,r,8)^jd.shrSH(t,r,7),i=jd.rotrSL(t,r,1)^jd.rotrSL(t,r,8)^jd.shrSL(t,r,7),o=0|zd[e-2],s=0|qd[e-2],a=jd.rotrSH(o,s,19)^jd.rotrBH(o,s,61)^jd.shrSH(o,s,6),c=jd.rotrSL(o,s,19)^jd.rotrBL(o,s,61)^jd.shrSL(o,s,6),l=jd.add4L(i,c,qd[e-7],qd[e-16]),u=jd.add4H(l,n,a,zd[e-7],zd[e-16]);zd[e]=0|u,qd[e]=0|l}let{Ah:r,Al:n,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:l,Eh:u,El:h,Fh:d,Fl:f,Gh:p,Gl:g,Hh:m,Hl:y}=this;for(let e=0;e<80;e++){const t=jd.rotrSH(u,h,14)^jd.rotrSH(u,h,18)^jd.rotrBH(u,h,41),w=jd.rotrSL(u,h,14)^jd.rotrSL(u,h,18)^jd.rotrBL(u,h,41),b=u&d^~u&p,v=h&f^~h&g,E=jd.add5L(y,w,v,Hd[e],qd[e]),x=jd.add5H(E,m,t,b,Fd[e],zd[e]),I=0|E,_=jd.rotrSH(r,n,28)^jd.rotrBH(r,n,34)^jd.rotrBH(r,n,39),S=jd.rotrSL(r,n,28)^jd.rotrBL(r,n,34)^jd.rotrBL(r,n,39),A=r&i^r&s^i&s,O=n&o^n&a^o&a;m=0|p,y=0|g,p=0|d,g=0|f,d=0|u,f=0|h,({h:u,l:h}=jd.add(0|c,0|l,0|x,0|I)),c=0|s,l=0|a,s=0|i,a=0|o,i=0|r,o=0|n;const C=jd.add3L(I,S,O);r=jd.add3H(C,x,_,A),n=0|C}({h:r,l:n}=jd.add(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:o}=jd.add(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=jd.add(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:l}=jd.add(0|this.Dh,0|this.Dl,0|c,0|l)),({h:u,l:h}=jd.add(0|this.Eh,0|this.El,0|u,0|h)),({h:d,l:f}=jd.add(0|this.Fh,0|this.Fl,0|d,0|f)),({h:p,l:g}=jd.add(0|this.Gh,0|this.Gl,0|p,0|g)),({h:m,l:y}=jd.add(0|this.Hh,0|this.Hl,0|m,0|y)),this.set(r,n,i,o,s,a,c,l,u,h,d,f,p,g,m,y)}roundClean(){zd.fill(0),qd.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const Vd=function(e){const t=t=>e().update(Nd(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}(()=>new Wd),Kd=BigInt(0),Gd=BigInt(1),Zd=BigInt(2);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Yd(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function Jd(e){if(!Yd(e))throw new Error("Uint8Array expected")}function Xd(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}const Qd=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function ef(e){Jd(e);let t="";for(let r=0;r<e.length;r++)t+=Qd[e[r]];return t}function tf(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?Kd:BigInt("0x"+e)}const rf=48,nf=57,of=65,sf=70,af=97,cf=102;function lf(e){return e>=rf&&e<=nf?e-rf:e>=of&&e<=sf?e-(of-10):e>=af&&e<=cf?e-(af-10):void 0}function uf(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let t=0,i=0;t<r;t++,i+=2){const r=lf(e.charCodeAt(i)),o=lf(e.charCodeAt(i+1));if(void 0===r||void 0===o){const t=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+i)}n[t]=16*r+o}return n}function hf(e){return Jd(e),tf(ef(Uint8Array.from(e).reverse()))}function df(e,t){return uf(e.toString(16).padStart(2*t,"0"))}function ff(e,t){return df(e,t).reverse()}function pf(e,t,r){let n;if("string"==typeof t)try{n=uf(t)}catch(t){throw new Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!Yd(t))throw new Error(e+" must be hex string or Uint8Array");n=Uint8Array.from(t)}const i=n.length;if("number"==typeof r&&i!==r)throw new Error(e+" of length "+r+" expected, got "+i);return n}function gf(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];Jd(n),t+=n.length}const r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}const mf=e=>"bigint"==typeof e&&Kd<=e;function yf(e,t,r,n){if(!function(e,t,r){return mf(e)&&mf(t)&&mf(r)&&t<=e&&e<r}(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}const wf=e=>(Zd<<BigInt(e-1))-Gd,bf={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||Yd(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function vf(e,t,r={}){const n=(t,r,n)=>{const i=bf[r];if("function"!=typeof i)throw new Error("invalid validator function");const o=e[t];if(!(n&&void 0===o||i(o,e)))throw new Error("param "+String(t)+" is invalid. Expected "+r+", got "+o)};for(const[e,r]of Object.entries(t))n(e,r,!1);for(const[e,t]of Object.entries(r))n(e,t,!0);return e}function Ef(e){const t=new WeakMap;return(r,...n)=>{const i=t.get(r);if(void 0!==i)return i;const o=e(r,...n);return t.set(r,o),o}}const xf=BigInt(0),If=BigInt(1),_f=BigInt(2),Sf=BigInt(3),Af=BigInt(4),Of=BigInt(5),Cf=BigInt(8);function Pf(e,t){const r=e%t;return r>=xf?r:t+r}function Rf(e,t,r){if(t<xf)throw new Error("invalid exponent, negatives unsupported");if(r<=xf)throw new Error("invalid modulus");if(r===If)return xf;let n=If;for(;t>xf;)t&If&&(n=n*e%r),e=e*e%r,t>>=If;return n}function Tf(e,t,r){let n=e;for(;t-- >xf;)n*=n,n%=r;return n}function kf(e,t){if(e===xf)throw new Error("invert: expected non-zero number");if(t<=xf)throw new Error("invert: expected positive modulus, got "+t);let r=Pf(e,t),n=t,i=xf,o=If;for(;r!==xf;){const e=n%r,t=i-o*(n/r);n=r,r=e,i=o,o=t}if(n!==If)throw new Error("invert: does not exist");return Pf(i,t)}function Nf(e){if(e%Af===Sf){const t=(e+If)/Af;return function(e,r){const n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw new Error("Cannot find square root");return n}}if(e%Cf===Of){const t=(e-Of)/Cf;return function(e,r){const n=e.mul(r,_f),i=e.pow(n,t),o=e.mul(r,i),s=e.mul(e.mul(o,_f),i),a=e.mul(o,e.sub(s,e.ONE));if(!e.eql(e.sqr(a),r))throw new Error("Cannot find square root");return a}}return function(e){const t=(e-If)/_f;let r,n,i;for(r=e-If,n=0;r%_f===xf;r/=_f,n++);for(i=_f;i<e&&Rf(i,t,e)!==e-If;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(1===n){const t=(e+If)/Af;return function(e,r){const n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw new Error("Cannot find square root");return n}}const o=(r+If)/_f;return function(e,s){if(e.pow(s,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let a=n,c=e.pow(e.mul(e.ONE,i),r),l=e.pow(s,o),u=e.pow(s,r);for(;!e.eql(u,e.ONE);){if(e.eql(u,e.ZERO))return e.ZERO;let t=1;for(let r=e.sqr(u);t<a&&!e.eql(r,e.ONE);t++)r=e.sqr(r);const r=e.pow(c,If<<BigInt(a-t-1));c=e.sqr(r),l=e.mul(l,r),u=e.mul(u,c),a=t}return l}}(e)}const Uf=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Bf(e,t){const r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function Lf(e,t,r=!1,n={}){if(e<=xf)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:i,nByteLength:o}=Bf(e,t);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let s;const a=Object.freeze({ORDER:e,isLE:r,BITS:i,BYTES:o,MASK:wf(i),ZERO:xf,ONE:If,create:t=>Pf(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return xf<=t&&t<e},is0:e=>e===xf,isOdd:e=>(e&If)===If,neg:t=>Pf(-t,e),eql:(e,t)=>e===t,sqr:t=>Pf(t*t,e),add:(t,r)=>Pf(t+r,e),sub:(t,r)=>Pf(t-r,e),mul:(t,r)=>Pf(t*r,e),pow:(e,t)=>function(e,t,r){if(r<xf)throw new Error("invalid exponent, negatives unsupported");if(r===xf)return e.ONE;if(r===If)return t;let n=e.ONE,i=t;for(;r>xf;)r&If&&(n=e.mul(n,i)),i=e.sqr(i),r>>=If;return n}(a,e,t),div:(t,r)=>Pf(t*kf(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>kf(t,e),sqrt:n.sqrt||(t=>(s||(s=Nf(e)),s(a,t))),invertBatch:e=>function(e,t){const r=new Array(t.length),n=t.reduce((t,n,i)=>e.is0(n)?t:(r[i]=t,e.mul(t,n)),e.ONE),i=e.inv(n);return t.reduceRight((t,n,i)=>e.is0(n)?t:(r[i]=e.mul(t,r[i]),e.mul(t,n)),i),r}(a,e),cmov:(e,t,r)=>r?t:e,toBytes:e=>r?ff(e,o):df(e,o),fromBytes:e=>{if(e.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+e.length);return r?hf(e):function(e){return tf(ef(e))}(e)}});return Object.freeze(a)}const Df=BigInt(0),$f=BigInt(1);function Mf(e,t){const r=t.negate();return e?r:t}function jf(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Ff(e,t){jf(e,t);return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1)}}const Hf=new WeakMap,zf=new WeakMap;function qf(e){return zf.get(e)||1}function Wf(e,t,r,n){if(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw new Error("invalid point at index "+r)})}(r,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+r)})}(n,t),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=e.ZERO,o=function(e){let t;for(t=0;e>Kd;e>>=Gd,t+=1);return t}(BigInt(r.length)),s=o>12?o-3:o>4?o-2:o?2:1,a=(1<<s)-1,c=new Array(a+1).fill(i);let l=i;for(let e=Math.floor((t.BITS-1)/s)*s;e>=0;e-=s){c.fill(i);for(let t=0;t<n.length;t++){const i=n[t],o=Number(i>>BigInt(e)&BigInt(a));c[o]=c[o].add(r[t])}let t=i;for(let e=c.length-1,r=i;e>0;e--)r=r.add(c[e]),t=t.add(r);if(l=l.add(t),0!==e)for(let e=0;e<s;e++)l=l.double()}return l}function Vf(e){return function(e){const t=Uf.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});vf(e,t)}(e.Fp),vf(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Bf(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}const Kf=BigInt(0),Gf=BigInt(1),Zf=BigInt(2),Yf=BigInt(8),Jf={zip215:!0};function Xf(e){const t=function(e){const t=Vf(e);return vf(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}(e),{Fp:r,n:n,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:c}=t,l=Zf<<BigInt(8*a)-Gf,u=r.create,h=Lf(t.n,t.nBitLength),d=t.uvRatio||((e,t)=>{try{return{isValid:!0,value:r.sqrt(e*r.inv(t))}}catch{return{isValid:!1,value:Kf}}}),f=t.adjustScalarBytes||(e=>e),p=t.domain||((e,t,r)=>{if(Xd("phflag",r),t.length||r)throw new Error("Contexts/pre-hash are not supported");return e});function g(e,t){yf("coordinate "+e,t,Kf,l)}function m(e){if(!(e instanceof b))throw new Error("ExtendedPoint expected")}const y=Ef((e,t)=>{const{ex:n,ey:i,ez:o}=e,s=e.is0();null==t&&(t=s?Yf:r.inv(o));const a=u(n*t),c=u(i*t),l=u(o*t);if(s)return{x:Kf,y:Gf};if(l!==Gf)throw new Error("invZ was invalid");return{x:a,y:c}}),w=Ef(e=>{const{a:r,d:n}=t;if(e.is0())throw new Error("bad point: ZERO");const{ex:i,ey:o,ez:s,et:a}=e,c=u(i*i),l=u(o*o),h=u(s*s),d=u(h*h),f=u(c*r);if(u(h*u(f+l))!==u(d+u(n*u(c*l))))throw new Error("bad point: equation left != right (1)");if(u(i*o)!==u(s*a))throw new Error("bad point: equation left != right (2)");return!0});class b{constructor(e,t,r,n){this.ex=e,this.ey=t,this.ez=r,this.et=n,g("x",e),g("y",t),g("z",r),g("t",n),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof b)throw new Error("extended point not allowed");const{x:t,y:r}=e||{};return g("x",t),g("y",r),new b(t,r,Gf,u(t*r))}static normalizeZ(e){const t=r.invertBatch(e.map(e=>e.ez));return e.map((e,r)=>e.toAffine(t[r])).map(b.fromAffine)}static msm(e,t){return Wf(b,h,e,t)}_setWindowSize(e){x.setWindowSize(this,e)}assertValidity(){w(this)}equals(e){m(e);const{ex:t,ey:r,ez:n}=this,{ex:i,ey:o,ez:s}=e,a=u(t*s),c=u(i*n),l=u(r*s),h=u(o*n);return a===c&&l===h}is0(){return this.equals(b.ZERO)}negate(){return new b(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:e}=t,{ex:r,ey:n,ez:i}=this,o=u(r*r),s=u(n*n),a=u(Zf*u(i*i)),c=u(e*o),l=r+n,h=u(u(l*l)-o-s),d=c+s,f=d-a,p=c-s,g=u(h*f),m=u(d*p),y=u(h*p),w=u(f*d);return new b(g,m,w,y)}add(e){m(e);const{a:r,d:n}=t,{ex:i,ey:o,ez:s,et:a}=this,{ex:c,ey:l,ez:h,et:d}=e;if(r===BigInt(-1)){const e=u((o-i)*(l+c)),t=u((o+i)*(l-c)),r=u(t-e);if(r===Kf)return this.double();const n=u(s*Zf*d),f=u(a*Zf*h),p=f+n,g=t+e,m=f-n,y=u(p*r),w=u(g*m),v=u(p*m),E=u(r*g);return new b(y,w,E,v)}const f=u(i*c),p=u(o*l),g=u(a*n*d),y=u(s*h),w=u((i+o)*(c+l)-f-p),v=y-g,E=y+g,x=u(p-r*f),I=u(w*v),_=u(E*x),S=u(w*x),A=u(v*E);return new b(I,_,A,S)}subtract(e){return this.add(e.negate())}wNAF(e){return x.wNAFCached(this,e,b.normalizeZ)}multiply(e){const t=e;yf("scalar",t,Gf,n);const{p:r,f:i}=this.wNAF(t);return b.normalizeZ([r,i])[0]}multiplyUnsafe(e,t=b.ZERO){const r=e;return yf("scalar",r,Kf,n),r===Kf?E:this.is0()||r===Gf?this:x.wNAFCachedUnsafe(this,r,b.normalizeZ,t)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return x.unsafeLadder(this,n).is0()}toAffine(e){return y(this,e)}clearCofactor(){const{h:e}=t;return e===Gf?this:this.multiplyUnsafe(e)}static fromHex(e,n=!1){const{d:i,a:o}=t,s=r.BYTES;e=pf("pointHex",e,s),Xd("zip215",n);const a=e.slice(),c=e[s-1];a[s-1]=-129&c;const h=hf(a),f=n?l:r.ORDER;yf("pointHex.y",h,Kf,f);const p=u(h*h),g=u(p-Gf),m=u(i*p-o);let{isValid:y,value:w}=d(g,m);if(!y)throw new Error("Point.fromHex: invalid y coordinate");const v=(w&Gf)===Gf,E=!!(128&c);if(!n&&w===Kf&&E)throw new Error("Point.fromHex: x=0 and x_0=1");return E!==v&&(w=u(-w)),b.fromAffine({x:w,y:h})}static fromPrivateKey(e){return S(e).point}toRawBytes(){const{x:e,y:t}=this.toAffine(),n=ff(t,r.BYTES);return n[n.length-1]|=e&Gf?128:0,n}toHex(){return ef(this.toRawBytes())}}b.BASE=new b(t.Gx,t.Gy,Gf,u(t.Gx*t.Gy)),b.ZERO=new b(Kf,Gf,Gf,Kf);const{BASE:v,ZERO:E}=b,x=function(e,t){return{constTimeNegate:Mf,hasPrecomputes:e=>1!==qf(e),unsafeLadder(t,r,n=e.ZERO){let i=t;for(;r>Df;)r&$f&&(n=n.add(i)),i=i.double(),r>>=$f;return n},precomputeWindow(e,r){const{windows:n,windowSize:i}=Ff(r,t),o=[];let s=e,a=s;for(let e=0;e<n;e++){a=s,o.push(a);for(let e=1;e<i;e++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(r,n,i){const{windows:o,windowSize:s}=Ff(r,t);let a=e.ZERO,c=e.BASE;const l=BigInt(2**r-1),u=2**r,h=BigInt(r);for(let e=0;e<o;e++){const t=e*s;let r=Number(i&l);i>>=h,r>s&&(r-=u,i+=$f);const o=t,d=t+Math.abs(r)-1,f=e%2!=0,p=r<0;0===r?c=c.add(Mf(f,n[o])):a=a.add(Mf(p,n[d]))}return{p:a,f:c}},wNAFUnsafe(r,n,i,o=e.ZERO){const{windows:s,windowSize:a}=Ff(r,t),c=BigInt(2**r-1),l=2**r,u=BigInt(r);for(let e=0;e<s;e++){const t=e*a;if(i===Df)break;let r=Number(i&c);if(i>>=u,r>a&&(r-=l,i+=$f),0===r)continue;let s=n[t+Math.abs(r)-1];r<0&&(s=s.negate()),o=o.add(s)}return o},getPrecomputes(e,t,r){let n=Hf.get(t);return n||(n=this.precomputeWindow(t,e),1!==e&&Hf.set(t,r(n))),n},wNAFCached(e,t,r){const n=qf(e);return this.wNAF(n,this.getPrecomputes(n,e,r),t)},wNAFCachedUnsafe(e,t,r,n){const i=qf(e);return 1===i?this.unsafeLadder(e,t,n):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),t,n)},setWindowSize(e,r){jf(r,t),zf.set(e,r),Hf.delete(e)}}}(b,8*a);function I(e){return Pf(e,n)}function _(e){return I(hf(e))}function S(e){const t=r.BYTES;e=pf("private key",e,t);const n=pf("hashed private key",o(e),2*t),i=f(n.slice(0,t)),s=n.slice(t,2*t),a=_(i),c=v.multiply(a),l=c.toRawBytes();return{head:i,prefix:s,scalar:a,point:c,pointBytes:l}}function A(e=new Uint8Array,...t){const r=gf(...t);return _(o(p(r,pf("context",e),!!i)))}const O=Jf;return v._setWindowSize(8),{CURVE:t,getPublicKey:function(e){return S(e).pointBytes},sign:function(e,t,o={}){e=pf("message",e),i&&(e=i(e));const{prefix:s,scalar:a,pointBytes:c}=S(t),l=A(o.context,s,e),u=v.multiply(l).toRawBytes(),h=I(l+A(o.context,u,c,e)*a);return yf("signature.s",h,Kf,n),pf("result",gf(u,ff(h,r.BYTES)),2*r.BYTES)},verify:function(e,t,n,o=O){const{context:s,zip215:a}=o,c=r.BYTES;e=pf("signature",e,2*c),t=pf("message",t),n=pf("publicKey",n,c),void 0!==a&&Xd("zip215",a),i&&(t=i(t));const l=hf(e.slice(c,2*c));let u,h,d;try{u=b.fromHex(n,a),h=b.fromHex(e.slice(0,c),a),d=v.multiplyUnsafe(l)}catch{return!1}if(!a&&u.isSmallOrder())return!1;const f=A(s,h.toRawBytes(),u.toRawBytes(),t);return h.add(u.multiplyUnsafe(f)).subtract(d).clearCofactor().equals(b.ZERO)},ExtendedPoint:b,utils:{getExtendedPublicKey:S,randomPrivateKey:()=>s(r.BYTES),precompute:(e=8,t=b.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)}}}BigInt(0),BigInt(1);const Qf=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),ep=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const tp=BigInt(1),rp=BigInt(2);BigInt(3);const np=BigInt(5),ip=BigInt(8);function op(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function sp(e,t){const r=Qf,n=Pf(t*t*t,r),i=function(e){const t=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),o=Qf,s=e*e%o*e%o,a=Tf(s,rp,o)*s%o,c=Tf(a,tp,o)*e%o,l=Tf(c,np,o)*c%o,u=Tf(l,t,o)*l%o,h=Tf(u,r,o)*u%o,d=Tf(h,n,o)*h%o,f=Tf(d,i,o)*d%o,p=Tf(f,i,o)*d%o,g=Tf(p,t,o)*l%o;return{pow_p_5_8:Tf(g,rp,o)*e%o,b2:s}}(e*Pf(n*n*t,r)).pow_p_5_8;let o=Pf(e*n*i,r);const s=Pf(t*o*o,r),a=o,c=Pf(o*ep,r),l=s===e,u=s===Pf(-e,r),h=s===Pf(-e*ep,r);return l&&(o=a),(u||h)&&(o=c),((e,t)=>(Pf(e,t)&If)===If)(o,r)&&(o=Pf(-o,r)),{isValid:l||u,value:o}}const ap=Lf(Qf,void 0,!0),cp=Xf({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:ap,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:ip,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Vd,randomBytes:Bd,adjustScalarBytes:op,uvRatio:sp}),lp=".",up="base64url",hp="utf8",dp="utf8",fp="did",pp="key",gp="base58btc";function mp(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function yp(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?mp(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function wp(e,t){t||(t=e.reduce((e,t)=>e+t.length,0));const r=yp(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return mp(r)}var bp=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(n+(o-f)),g=n;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}for(var p=s-n;p!==s&&0===l[p];)p++;for(var g=c.repeat(r);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}},vp=bp;const Ep=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};let xp=class{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Ip=class{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Sp(this,e)}},_p=class{constructor(e){this.decoders=e}or(e){return Sp(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const Sp=(e,t)=>new _p({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});let Ap=class{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new xp(e,t,r),this.decoder=new Ip(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const Op=({name:e,prefix:t,encode:r,decode:n})=>new Ap(e,t,r,n),Cp=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=vp(r,t);return Op({prefix:e,name:t,encode:n,decode:e=>Ep(i(e))})},Pp=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Op({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],s+=8;s>r;)s-=r,o+=t[i&a>>s];if(s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,l=0;for(let t=0;t<o;++t){const o=i[e[t]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(t,n,r,e)}),Rp=Op({prefix:"\0",name:"identity",encode:e=>(e=>(new TextDecoder).decode(e))(e),decode:e=>(e=>(new TextEncoder).encode(e))(e)});var Tp=Object.freeze({__proto__:null,identity:Rp});const kp=Pp({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Np=Object.freeze({__proto__:null,base2:kp});const Up=Pp({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Bp=Object.freeze({__proto__:null,base8:Up});const Lp=Cp({prefix:"9",name:"base10",alphabet:"0123456789"});var Dp=Object.freeze({__proto__:null,base10:Lp});const $p=Pp({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Mp=Pp({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var jp=Object.freeze({__proto__:null,base16:$p,base16upper:Mp});const Fp=Pp({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Hp=Pp({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),zp=Pp({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),qp=Pp({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Wp=Pp({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Vp=Pp({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Kp=Pp({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Gp=Pp({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Zp=Pp({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Yp=Object.freeze({__proto__:null,base32:Fp,base32upper:Hp,base32pad:zp,base32padupper:qp,base32hex:Wp,base32hexupper:Vp,base32hexpad:Kp,base32hexpadupper:Gp,base32z:Zp});const Jp=Cp({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Xp=Cp({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Qp=Object.freeze({__proto__:null,base36:Jp,base36upper:Xp});const eg=Cp({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),tg=Cp({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var rg=Object.freeze({__proto__:null,base58btc:eg,base58flickr:tg});const ng=Pp({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ig=Pp({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),og=Pp({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),sg=Pp({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var ag=Object.freeze({__proto__:null,base64:ng,base64pad:ig,base64url:og,base64urlpad:sg});const cg=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),lg=cg.reduce((e,t,r)=>(e[r]=t,e),[]),ug=cg.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);const hg=Op({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+=lg[t],"")},decode:function(e){const t=[];for(const r of e){const e=ug[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var dg=Object.freeze({__proto__:null,base256emoji:hg}),fg=function e(t,r,n){r=r||[];for(var i=n=n||0;t>=mg;)r[n++]=255&t|pg,t/=128;for(;t&gg;)r[n++]=255&t|pg,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},pg=128,gg=-128,mg=Math.pow(2,31);var yg=function e(t,r){var n,i=0,o=(r=r||0,0),s=r,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=o<28?(n&bg)<<o:(n&bg)*Math.pow(2,o),o+=7}while(n>=wg);return e.bytes=s-r,i},wg=128,bg=127;var vg=Math.pow(2,7),Eg=Math.pow(2,14),xg=Math.pow(2,21),Ig=Math.pow(2,28),_g=Math.pow(2,35),Sg=Math.pow(2,42),Ag=Math.pow(2,49),Og=Math.pow(2,56),Cg=Math.pow(2,63),Pg={encode:fg,decode:yg,encodingLength:function(e){return e<vg?1:e<Eg?2:e<xg?3:e<Ig?4:e<_g?5:e<Sg?6:e<Ag?7:e<Og?8:e<Cg?9:10}},Rg=Pg;const Tg=(e,t,r=0)=>(Rg.encode(e,t,r),t),kg=e=>Rg.encodingLength(e),Ng=(e,t)=>{const r=t.byteLength,n=kg(e),i=n+kg(r),o=new Uint8Array(i+r);return Tg(e,o,0),Tg(r,o,n),o.set(t,i),new Ug(e,r,t,o)};let Ug=class{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}};const Bg=({name:e,code:t,encode:r})=>new Lg(e,t,r);let Lg=class{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Ng(this.code,t):t.then(e=>Ng(this.code,e))}throw Error("Unknown type, must be binary type")}};const Dg=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),$g=Bg({name:"sha2-256",code:18,encode:Dg("SHA-256")}),Mg=Bg({name:"sha2-512",code:19,encode:Dg("SHA-512")});Object.freeze({__proto__:null,sha256:$g,sha512:Mg});const jg=Ep,Fg={code:0,name:"identity",encode:jg,digest:e=>Ng(0,jg(e))};Object.freeze({__proto__:null,identity:Fg});new TextEncoder,new TextDecoder;const Hg={...Tp,...Np,...Bp,...Dp,...jp,...Yp,...Qp,...rg,...ag,...dg};function zg(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const qg=zg("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>(new TextEncoder).encode(e.substring(1))),Wg=zg("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{const t=yp((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Vg={utf8:qg,"utf-8":qg,hex:Hg.base16,latin1:Wg,ascii:Wg,binary:Wg,...Hg};function Kg(e,t="utf8"){const r=Vg[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function Gg(e,t="utf8"){const r=Vg[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):mp(globalThis.Buffer.from(e,"utf-8"))}function Zg(e){return Od(Kg(Gg(e,up),hp))}function Yg(e){return Kg(Gg(Cd(e),hp),up)}function Jg(e){const t="z"+Kg(wp([Gg("K36",gp),e]),gp);return[fp,pp,t].join(":")}function Xg(e){return Kg(e,up)}function Qg(e){const t=e.split(lp),r=Zg(t[0]),n=Zg(t[1]),i=function(e){return Gg(e,up)}(t[2]);return{header:r,payload:n,signature:i,data:Gg(t.slice(0,2).join(lp),dp)}}function em(e=Bd(32)){const t=cp.getPublicKey(e);return{secretKey:wp([e,t]),publicKey:t}}async function tm(e,t,r,n,i=dc.fromMiliseconds(Date.now())){const o={alg:"EdDSA",typ:"JWT"},s={iss:Jg(n.publicKey),sub:e,aud:t,iat:i,exp:i+r},a=function(e){return Gg([Yg(e.header),Yg(e.payload)].join(lp),dp)}({header:o,payload:s});return function(e){return[Yg(e.header),Yg(e.payload),Xg(e.signature)].join(lp)}({header:o,payload:s,signature:cp.sign(a,n.secretKey.slice(0,32))})}function rm(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function nm(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?rm(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function im(e,t){t||(t=e.reduce((e,t)=>e+t.length,0));const r=nm(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return rm(r)}var om=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(n+(o-f)),g=n;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}for(var p=s-n;p!==s&&0===l[p];)p++;for(var g=c.repeat(r);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}},sm=om;class am{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class cm{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return um(this,e)}}class lm{constructor(e){this.decoders=e}or(e){return um(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const um=(e,t)=>new lm({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class hm{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new am(e,t,r),this.decoder=new cm(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const dm=({name:e,prefix:t,encode:r,decode:n})=>new hm(e,t,r,n),fm=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=sm(r,t);return dm({prefix:e,name:t,encode:n,decode:e=>(e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")})(i(e))})},pm=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>dm({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],s+=8;s>r;)s-=r,o+=t[i&a>>s];if(s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,l=0;for(let t=0;t<o;++t){const o=i[e[t]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(t,n,r,e)}),gm=dm({prefix:"\0",name:"identity",encode:e=>(e=>(new TextDecoder).decode(e))(e),decode:e=>(e=>(new TextEncoder).encode(e))(e)});var mm=Object.freeze({__proto__:null,identity:gm});const ym=pm({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var wm=Object.freeze({__proto__:null,base2:ym});const bm=pm({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var vm=Object.freeze({__proto__:null,base8:bm});const Em=fm({prefix:"9",name:"base10",alphabet:"0123456789"});var xm=Object.freeze({__proto__:null,base10:Em});const Im=pm({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),_m=pm({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Sm=Object.freeze({__proto__:null,base16:Im,base16upper:_m});const Am=pm({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Om=pm({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Cm=pm({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Pm=pm({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Rm=pm({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Tm=pm({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),km=pm({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Nm=pm({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Um=pm({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Bm=Object.freeze({__proto__:null,base32:Am,base32hex:Rm,base32hexpad:km,base32hexpadupper:Nm,base32hexupper:Tm,base32pad:Cm,base32padupper:Pm,base32upper:Om,base32z:Um});const Lm=fm({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Dm=fm({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var $m=Object.freeze({__proto__:null,base36:Lm,base36upper:Dm});const Mm=fm({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),jm=fm({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Fm=Object.freeze({__proto__:null,base58btc:Mm,base58flickr:jm});const Hm=pm({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),zm=pm({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),qm=pm({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Wm=pm({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Vm=Object.freeze({__proto__:null,base64:Hm,base64pad:zm,base64url:qm,base64urlpad:Wm});const Km=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Gm=Km.reduce((e,t,r)=>(e[r]=t,e),[]),Zm=Km.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);const Ym=dm({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+=Gm[t],"")},decode:function(e){const t=[];for(const r of e){const e=Zm[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var Jm=Object.freeze({__proto__:null,base256emoji:Ym});new TextEncoder,new TextDecoder;const Xm={...mm,...wm,...vm,...xm,...Sm,...Bm,...$m,...Fm,...Vm,...Jm};function Qm(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const ey=Qm("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>(new TextEncoder).encode(e.substring(1))),ty=Qm("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{const t=nm((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),ry={utf8:ey,"utf-8":ey,hex:Xm.base16,latin1:ty,ascii:ty,binary:ty,...Xm};function ny(e,t="utf8"){const r=ry[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):rm(globalThis.Buffer.from(e,"utf-8"))}function iy(e,t="utf8"){const r=ry[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}const oy={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};function sy(e){return(4294967296+e).toString(16).substring(1)}var ay={normalizeInput:function(e){let t;if(e instanceof Uint8Array)t=e;else{if("string"!=typeof e)throw new Error("Input must be an string, Buffer or Uint8Array");t=(new TextEncoder).encode(e)}return t},toHex:function(e){return Array.prototype.map.call(e,function(e){return(e<16?"0":"")+e.toString(16)}).join("")},debugPrint:function(e,t,r){let n="\n"+e+" = ";for(let i=0;i<t.length;i+=2){if(32===r)n+=sy(t[i]).toUpperCase(),n+=" ",n+=sy(t[i+1]).toUpperCase();else{if(64!==r)throw new Error("Invalid size "+r);n+=sy(t[i+1]).toUpperCase(),n+=sy(t[i]).toUpperCase()}i%6==4?n+="\n"+new Array(e.length+4).join(" "):i<t.length-2&&(n+=" ")}console.log(n)},testSpeed:function(e,t,r){let n=(new Date).getTime();const i=new Uint8Array(t);for(let e=0;e<t;e++)i[e]=e%256;const o=(new Date).getTime();console.log("Generated random input in "+(o-n)+"ms"),n=o;for(let o=0;o<r;o++){const r=e(i),o=(new Date).getTime(),s=o-n;n=o,console.log("Hashed in "+s+"ms: "+r.substring(0,20)+"..."),console.log(Math.round(t/(1<<20)/(s/1e3)*100)/100+" MB PER SECOND")}}};const cy=ay;function ly(e,t,r){const n=e[t]+e[r];let i=e[t+1]+e[r+1];n>=4294967296&&i++,e[t]=n,e[t+1]=i}function uy(e,t,r,n){let i=e[t]+r;r<0&&(i+=4294967296);let o=e[t+1]+n;i>=4294967296&&o++,e[t]=i,e[t+1]=o}function hy(e,t){return e[t]^e[t+1]<<8^e[t+2]<<16^e[t+3]<<24}function dy(e,t,r,n,i,o){const s=my[i],a=my[i+1],c=my[o],l=my[o+1];ly(gy,e,t),uy(gy,e,s,a);let u=gy[n]^gy[e],h=gy[n+1]^gy[e+1];gy[n]=h,gy[n+1]=u,ly(gy,r,n),u=gy[t]^gy[r],h=gy[t+1]^gy[r+1],gy[t]=u>>>24^h<<8,gy[t+1]=h>>>24^u<<8,ly(gy,e,t),uy(gy,e,c,l),u=gy[n]^gy[e],h=gy[n+1]^gy[e+1],gy[n]=u>>>16^h<<16,gy[n+1]=h>>>16^u<<16,ly(gy,r,n),u=gy[t]^gy[r],h=gy[t+1]^gy[r+1],gy[t]=h>>>31^u<<1,gy[t+1]=u>>>31^h<<1}const fy=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),py=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map(function(e){return 2*e})),gy=new Uint32Array(32),my=new Uint32Array(32);function yy(e,t){let r=0;for(r=0;r<16;r++)gy[r]=e.h[r],gy[r+16]=fy[r];for(gy[24]=gy[24]^e.t,gy[25]=gy[25]^e.t/4294967296,t&&(gy[28]=~gy[28],gy[29]=~gy[29]),r=0;r<32;r++)my[r]=hy(e.b,4*r);for(r=0;r<12;r++)dy(0,8,16,24,py[16*r+0],py[16*r+1]),dy(2,10,18,26,py[16*r+2],py[16*r+3]),dy(4,12,20,28,py[16*r+4],py[16*r+5]),dy(6,14,22,30,py[16*r+6],py[16*r+7]),dy(0,10,20,30,py[16*r+8],py[16*r+9]),dy(2,12,22,24,py[16*r+10],py[16*r+11]),dy(4,14,16,26,py[16*r+12],py[16*r+13]),dy(6,8,18,28,py[16*r+14],py[16*r+15]);for(r=0;r<16;r++)e.h[r]=e.h[r]^gy[r]^gy[r+16]}const wy=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function by(e,t,r,n){if(0===e||e>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(t&&t.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(r&&16!==r.length)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(n&&16!==n.length)throw new Error("Illegal personal, expected Uint8Array with length is 16");const i={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:e};wy.fill(0),wy[0]=e,t&&(wy[1]=t.length),wy[2]=1,wy[3]=1,r&&wy.set(r,32),n&&wy.set(n,48);for(let e=0;e<16;e++)i.h[e]=fy[e]^hy(wy,4*e);return t&&(vy(i,t),i.c=128),i}function vy(e,t){for(let r=0;r<t.length;r++)128===e.c&&(e.t+=e.c,yy(e,!1),e.c=0),e.b[e.c++]=t[r]}function Ey(e){for(e.t+=e.c;e.c<128;)e.b[e.c++]=0;yy(e,!0);const t=new Uint8Array(e.outlen);for(let r=0;r<e.outlen;r++)t[r]=e.h[r>>2]>>8*(3&r);return t}function xy(e,t,r,n,i){r=r||64,e=cy.normalizeInput(e),n&&(n=cy.normalizeInput(n)),i&&(i=cy.normalizeInput(i));const o=by(r,t,n,i);return vy(o,e),Ey(o)}var Iy={blake2b:xy,blake2bHex:function(e,t,r,n,i){const o=xy(e,t,r,n,i);return cy.toHex(o)},blake2bInit:by,blake2bUpdate:vy,blake2bFinal:Ey};const _y=ay;function Sy(e,t){return e[t]^e[t+1]<<8^e[t+2]<<16^e[t+3]<<24}function Ay(e,t,r,n,i,o){Ry[e]=Ry[e]+Ry[t]+i,Ry[n]=Oy(Ry[n]^Ry[e],16),Ry[r]=Ry[r]+Ry[n],Ry[t]=Oy(Ry[t]^Ry[r],12),Ry[e]=Ry[e]+Ry[t]+o,Ry[n]=Oy(Ry[n]^Ry[e],8),Ry[r]=Ry[r]+Ry[n],Ry[t]=Oy(Ry[t]^Ry[r],7)}function Oy(e,t){return e>>>t^e<<32-t}const Cy=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Py=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),Ry=new Uint32Array(16),Ty=new Uint32Array(16);function ky(e,t){let r=0;for(r=0;r<8;r++)Ry[r]=e.h[r],Ry[r+8]=Cy[r];for(Ry[12]^=e.t,Ry[13]^=e.t/4294967296,t&&(Ry[14]=~Ry[14]),r=0;r<16;r++)Ty[r]=Sy(e.b,4*r);for(r=0;r<10;r++)Ay(0,4,8,12,Ty[Py[16*r+0]],Ty[Py[16*r+1]]),Ay(1,5,9,13,Ty[Py[16*r+2]],Ty[Py[16*r+3]]),Ay(2,6,10,14,Ty[Py[16*r+4]],Ty[Py[16*r+5]]),Ay(3,7,11,15,Ty[Py[16*r+6]],Ty[Py[16*r+7]]),Ay(0,5,10,15,Ty[Py[16*r+8]],Ty[Py[16*r+9]]),Ay(1,6,11,12,Ty[Py[16*r+10]],Ty[Py[16*r+11]]),Ay(2,7,8,13,Ty[Py[16*r+12]],Ty[Py[16*r+13]]),Ay(3,4,9,14,Ty[Py[16*r+14]],Ty[Py[16*r+15]]);for(r=0;r<8;r++)e.h[r]^=Ry[r]^Ry[r+8]}function Ny(e,t){if(!(e>0&&e<=32))throw new Error("Incorrect output length, should be in [1, 32]");const r=t?t.length:0;if(t&&!(r>0&&r<=32))throw new Error("Incorrect key length, should be in [1, 32]");const n={h:new Uint32Array(Cy),b:new Uint8Array(64),c:0,t:0,outlen:e};return n.h[0]^=16842752^r<<8^e,r>0&&(Uy(n,t),n.c=64),n}function Uy(e,t){for(let r=0;r<t.length;r++)64===e.c&&(e.t+=e.c,ky(e,!1),e.c=0),e.b[e.c++]=t[r]}function By(e){for(e.t+=e.c;e.c<64;)e.b[e.c++]=0;ky(e,!0);const t=new Uint8Array(e.outlen);for(let r=0;r<e.outlen;r++)t[r]=e.h[r>>2]>>8*(3&r)&255;return t}function Ly(e,t,r){r=r||32,e=_y.normalizeInput(e);const n=Ny(r,t);return Uy(n,e),By(n)}var Dy={blake2s:Ly,blake2sHex:function(e,t,r){const n=Ly(e,t,r);return _y.toHex(n)},blake2sInit:Ny,blake2sUpdate:Uy,blake2sFinal:By};var $y={blake2b:Iy.blake2b,blake2bHex:Iy.blake2bHex,blake2bInit:Iy.blake2bInit,blake2bUpdate:Iy.blake2bUpdate,blake2bFinal:Iy.blake2bFinal,blake2s:Dy.blake2s,blake2sHex:Dy.blake2sHex,blake2sInit:Dy.blake2sInit,blake2sUpdate:Dy.blake2sUpdate,blake2sFinal:Dy.blake2sFinal};function My(e){const[t,r]=e.split(":");return{namespace:t,reference:r}}function jy(e,t){return e.includes(":")?[e]:t.chains||[]}var Fy=Object.defineProperty,Hy=Object.defineProperties,zy=Object.getOwnPropertyDescriptors,qy=Object.getOwnPropertySymbols,Wy=Object.prototype.hasOwnProperty,Vy=Object.prototype.propertyIsEnumerable,Ky=(e,t,r)=>t in e?Fy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Gy=(e,t)=>{for(var r in t||(t={}))Wy.call(t,r)&&Ky(e,r,t[r]);if(qy)for(var r of qy(t))Vy.call(t,r)&&Ky(e,r,t[r]);return e},Zy=(e,t,r)=>Ky(e,"symbol"!=typeof t?t+"":t,r);const Yy="react-native",Jy="node",Xy="browser",Qy="unknown",ew="js";function tw(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function rw(){return!qc()&&!!Wc()&&"ReactNative"===navigator.product}function nw(){return!tw()&&!!Wc()&&!!qc()}function iw(){return rw()?Yy:tw()?Jy:nw()?Xy:Qy}function ow(){var e;try{return rw()&&typeof global<"u"&&typeof(null==global?void 0:global.Application)<"u"?null==(e=global.Application)?void 0:e.applicationId:void 0}catch{return}}function sw(e){var t,r;const n=aw();try{return null!=e&&e.url&&n.url&&new URL(e.url).host!==new URL(n.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${e.url} differs from the actual page url:${n.url}. This is probably unintended and can lead to issues.`),e.url=n.url),null!=(t=e?.icons)&&t.length&&e.icons.length>0&&(e.icons=e.icons.filter(e=>""!==e)),((e,t)=>Hy(e,zy(t)))(Gy(Gy({},n),e),{url:e?.url||n.url,name:e?.name||n.name,description:e?.description||n.description,icons:null!=(r=e?.icons)&&r.length&&e.icons.length>0?e.icons:n.icons})}catch(t){return console.warn("Error populating app metadata",t),e||n}}function aw(){return Gc()||{name:"",description:"",url:"",icons:[""]}}function cw(e,t,r){const n=function(){if(iw()===Yy&&typeof global<"u"&&typeof(null==global?void 0:global.Platform)<"u"){const{OS:e,Version:t}=global.Platform;return[e,t].join("-")}const e=hc();if(null===e)return"unknown";const t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return"browser"===e.type?[t,e.name,e.version].join("-"):[t,e.version].join("-")}(),i=function(){var e;const t=iw();return t===Xy?[t,(null==(e=Vc())?void 0:e.host)||"unknown"].join(":"):t}();return[[e,t].join("-"),[ew,r].join("-"),n,i].join("/")}function lw({protocol:e,version:t,relayUrl:r,sdkVersion:n,auth:i,projectId:o,useOnCloseEvent:s,bundleId:a,packageName:c}){const l=r.split("?"),u={auth:i,ua:cw(e,t,n),projectId:o,useOnCloseEvent:s,packageName:c||void 0,bundleId:a||void 0},h=function(e,t){const r=new URLSearchParams(e);for(const e of Object.keys(t).sort())if(t.hasOwnProperty(e)){const n=t[e];void 0!==n&&r.set(e,n)}return r.toString()}(l[1]||"",u);return l[0]+"?"+h}function uw(e,t){return e.filter(e=>t.includes(e)).length===e.length}function hw(e){return Object.fromEntries(e.entries())}function dw(e){return new Map(Object.entries(e))}function fw(e=dc.FIVE_MINUTES,t){const r=dc.toMiliseconds(e||dc.FIVE_MINUTES);let n,i,o,s;return{resolve:e=>{o&&n&&(clearTimeout(o),n(e),s=Promise.resolve(e))},reject:e=>{o&&i&&(clearTimeout(o),i(e))},done:()=>new Promise((e,a)=>{if(s)return e(s);o=setTimeout(()=>{const e=new Error(t);s=Promise.reject(e),a(e)},r),n=e,i=a})}}function pw(e,t,r){return new Promise(async(n,i)=>{const o=setTimeout(()=>i(new Error(r)),t);try{n(await e)}catch(e){i(e)}clearTimeout(o)})}function gw(e,t){if("string"==typeof t&&t.startsWith(`${e}:`))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}if("id"===e.toLowerCase()){if("number"!=typeof t)throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function mw(e){const[t,r]=e.split(":"),n={id:void 0,topic:void 0};if("topic"===t&&"string"==typeof r)n.topic=r;else{if("id"!==t||!Number.isInteger(Number(r)))throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);n.id=Number(r)}return n}function yw(e,t){return dc.fromMiliseconds(Date.now()+dc.toMiliseconds(e))}function ww(e){return Date.now()>=dc.toMiliseconds(e)}function bw(e,t){return`${e}${t?`:${t}`:""}`}function vw(e=[],t=[]){return[...new Set([...e,...t])]}async function Ew({id:e,topic:t,wcDeepLink:r}){var n;try{if(!r)return;const i="string"==typeof r?JSON.parse(r):r,o=i?.href;if("string"!=typeof o)return;const s=function(e,t,r){const n=`requestId=${t}&sessionTopic=${r}`;e.endsWith("/")&&(e=e.slice(0,-1));let i=`${e}`;if(e.startsWith("https://t.me")){i=`${i}${e.includes("?")?"&startapp=":"?startapp="}${function(e,t=!1){const r=Buffer.from(e).toString("base64");return t?r.replace(/[=]/g,""):r}(n,!0)}`}else i=`${i}/wc?${n}`;return i}(o,e,t),a=iw();if(a===Xy){if(null==(n=qc())||!n.hasFocus())return void console.warn("Document does not have focus, skipping deeplink.");!function(e){let t="_self";!function(){try{return window.self!==window.top}catch{return!1}}()?(typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)||e.startsWith("https://")||e.startsWith("http://"))&&(t="_blank"):t="_top",window.open(e,t,"noreferrer noopener")}(s)}else a===Yy&&typeof(null==global?void 0:global.Linking)<"u"&&await global.Linking.openURL(s)}catch(e){console.error(e)}}function xw(e,t){if(!e.includes(t))return null;const r=e.split(/([&,?,=])/),n=r.indexOf(t);return r[n+2]}function Iw(){return typeof crypto<"u"&&null!=crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function _w(){return typeof process<"u"&&"true"===process.env.IS_VITEST}function Sw(e){return Buffer.from(e,"base64").toString("utf-8")}let Aw=class{constructor({limit:e}){Zy(this,"limit"),Zy(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){const e=this.set.values().next().value;e&&this.set.delete(e)}this.set.add(e)}}has(e){return this.set.has(e)}};const Ow=BigInt(2**32-1),Cw=BigInt(32);function Pw(e,t=!1){return t?{h:Number(e&Ow),l:Number(e>>Cw&Ow)}:{h:0|Number(e>>Cw&Ow),l:0|Number(e&Ow)}}function Rw(e,t=!1){const r=e.length;let n=new Uint32Array(r),i=new Uint32Array(r);for(let o=0;o<r;o++){const{h:r,l:s}=Pw(e[o],t);[n[o],i[o]]=[r,s]}return[n,i]}const Tw=(e,t,r)=>e>>>r,kw=(e,t,r)=>e<<32-r|t>>>r,Nw=(e,t,r)=>e>>>r|t<<32-r,Uw=(e,t,r)=>e<<32-r|t>>>r,Bw=(e,t,r)=>e<<64-r|t>>>r-32,Lw=(e,t,r)=>e>>>r-32|t<<64-r,Dw=(e,t)=>t,$w=(e,t)=>e;function Mw(e,t,r,n){const i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:0|i}}const jw=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),Fw=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,Hw=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),zw=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0,qw=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0),Ww=(e,t,r,n,i,o)=>t+r+n+i+o+(e/2**32|0)|0,Vw="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function Kw(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function Gw(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Zw(e,...t){if(!Kw(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Yw(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.createHasher");Gw(e.outputLen),Gw(e.blockLen)}function Jw(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Xw(e,t){Zw(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function Qw(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function eb(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function tb(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function rb(e,t){return e<<32-t|e>>>t}const nb=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function ib(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}const ob=nb?e=>e:e=>ib(e);const sb=nb?e=>e:function(e){for(let t=0;t<e.length;t++)e[t]=ib(e[t]);return e},ab="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,cb=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function lb(e){if(Zw(e),ab)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=cb[e[r]];return t}const ub=48,hb=57,db=65,fb=70,pb=97,gb=102;function mb(e){return e>=ub&&e<=hb?e-ub:e>=db&&e<=fb?e-(db-10):e>=pb&&e<=gb?e-(pb-10):void 0}function yb(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);if(ab)return Uint8Array.fromHex(e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let t=0,i=0;t<r;t++,i+=2){const r=mb(e.charCodeAt(i)),o=mb(e.charCodeAt(i+1));if(void 0===r||void 0===o){const t=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+i)}n[t]=16*r+o}return n}function wb(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e)),Zw(e),e}function bb(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];Zw(n),t+=n.length}const r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}let vb=class{};function Eb(e){const t=t=>e().update(wb(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function xb(e=32){if(Vw&&"function"==typeof Vw.getRandomValues)return Vw.getRandomValues(new Uint8Array(e));if(Vw&&"function"==typeof Vw.randomBytes)return Uint8Array.from(Vw.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}const Ib=BigInt(0),_b=BigInt(1),Sb=BigInt(2),Ab=BigInt(7),Ob=BigInt(256),Cb=BigInt(113),Pb=[],Rb=[],Tb=[];for(let e=0,t=_b,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],Pb.push(2*(5*n+r)),Rb.push((e+1)*(e+2)/2%64);let i=Ib;for(let e=0;e<7;e++)t=(t<<_b^(t>>Ab)*Cb)%Ob,t&Sb&&(i^=_b<<(_b<<BigInt(e))-_b);Tb.push(i)}const kb=Rw(Tb,!0),Nb=kb[0],Ub=kb[1],Bb=(e,t,r)=>r>32?((e,t,r)=>t<<r-32|e>>>64-r)(e,t,r):((e,t,r)=>e<<r|t>>>32-r)(e,t,r),Lb=(e,t,r)=>r>32?((e,t,r)=>e<<r-32|t>>>64-r)(e,t,r):((e,t,r)=>t<<r|e>>>32-r)(e,t,r);let Db=class e extends vb{constructor(e,t,r,n=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=n,this.rounds=i,Gw(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=Qw(this.state)}clone(){return this._cloneInto()}keccak(){sb(this.state32),function(e,t=24){const r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){const n=(t+8)%10,i=(t+2)%10,o=r[i],s=r[i+1],a=Bb(o,s,1)^r[n],c=Lb(o,s,1)^r[n+1];for(let r=0;r<50;r+=10)e[t+r]^=a,e[t+r+1]^=c}let t=e[2],i=e[3];for(let r=0;r<24;r++){const n=Rb[r],o=Bb(t,i,n),s=Lb(t,i,n),a=Pb[r];t=e[a],i=e[a+1],e[a]=o,e[a+1]=s}for(let t=0;t<50;t+=10){for(let n=0;n<10;n++)r[n]=e[t+n];for(let n=0;n<10;n++)e[t+n]^=~r[(n+2)%10]&r[(n+4)%10]}e[0]^=Nb[n],e[1]^=Ub[n]}eb(r)}(this.state32,this.rounds),sb(this.state32),this.posOut=0,this.pos=0}update(e){Jw(this),Zw(e=wb(e));const{blockLen:t,state:r}=this,n=e.length;for(let i=0;i<n;){const o=Math.min(t-this.pos,n-i);for(let t=0;t<o;t++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:n}=this;e[r]^=t,!!(128&t)&&r===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){Jw(this,!1),Zw(e),this.finish();const t=this.state,{blockLen:r}=this;for(let n=0,i=e.length;n<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-n);e.set(t.subarray(this.posOut,this.posOut+o),n),this.posOut+=o,n+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Gw(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Xw(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,eb(this.state)}_cloneInto(t){const{blockLen:r,suffix:n,outputLen:i,rounds:o,enableXOF:s}=this;return t||(t=new e(r,n,i,s,o)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=o,t.suffix=n,t.outputLen=i,t.enableXOF=s,t.destroyed=this.destroyed,t}};const $b=((e,t,r)=>Eb(()=>new Db(t,e,r)))(1,136,32);function Mb(e,t,r){return e&t^~e&r}function jb(e,t,r){return e&t^e&r^t&r}let Fb=class extends vb{constructor(e,t,r,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=n,this.buffer=new Uint8Array(e),this.view=tb(this.buffer)}update(e){Jw(this),Zw(e=wb(e));const{view:t,buffer:r,blockLen:n}=this,i=e.length;for(let o=0;o<i;){const s=Math.min(n-this.pos,i-o);if(s===n){const t=tb(e);for(;n<=i-o;o+=n)this.process(t,o);continue}r.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Jw(this),Xw(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:n,isLE:i}=this;let{pos:o}=this;t[o++]=128,eb(this.buffer.subarray(o)),this.padOffset>n-o&&(this.process(r,0),o=0);for(let e=o;e<n;e++)t[e]=0;(function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,l=n?0:4;e.setUint32(t+c,s,n),e.setUint32(t+l,a,n)})(r,n-8,BigInt(8*this.length),i),this.process(r,0);const s=tb(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,l=this.get();if(c>l.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,l[e],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:i,destroyed:o,pos:s}=this;return e.destroyed=o,e.finished=i,e.length=n,e.pos=s,n%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}};const Hb=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),zb=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),qb=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),Wb=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Vb=new Uint32Array(64);let Kb=class extends Fb{constructor(e=32){super(64,e,8,!1),this.A=0|Hb[0],this.B=0|Hb[1],this.C=0|Hb[2],this.D=0|Hb[3],this.E=0|Hb[4],this.F=0|Hb[5],this.G=0|Hb[6],this.H=0|Hb[7]}get(){const{A:e,B:t,C:r,D:n,E:i,F:o,G:s,H:a}=this;return[e,t,r,n,i,o,s,a]}set(e,t,r,n,i,o,s,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)Vb[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=Vb[e-15],r=Vb[e-2],n=rb(t,7)^rb(t,18)^t>>>3,i=rb(r,17)^rb(r,19)^r>>>10;Vb[e]=i+Vb[e-7]+n+Vb[e-16]|0}let{A:r,B:n,C:i,D:o,E:s,F:a,G:c,H:l}=this;for(let e=0;e<64;e++){const t=l+(rb(s,6)^rb(s,11)^rb(s,25))+Mb(s,a,c)+Wb[e]+Vb[e]|0,u=(rb(r,2)^rb(r,13)^rb(r,22))+jb(r,n,i)|0;l=c,c=a,a=s,s=o+t|0,o=i,i=n,n=r,r=t+u|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(r,n,i,o,s,a,c,l)}roundClean(){eb(Vb)}destroy(){this.set(0,0,0,0,0,0,0,0),eb(this.buffer)}};const Gb=Rw(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),Zb=Gb[0],Yb=Gb[1],Jb=new Uint32Array(80),Xb=new Uint32Array(80);let Qb=class extends Fb{constructor(e=64){super(128,e,16,!1),this.Ah=0|qb[0],this.Al=0|qb[1],this.Bh=0|qb[2],this.Bl=0|qb[3],this.Ch=0|qb[4],this.Cl=0|qb[5],this.Dh=0|qb[6],this.Dl=0|qb[7],this.Eh=0|qb[8],this.El=0|qb[9],this.Fh=0|qb[10],this.Fl=0|qb[11],this.Gh=0|qb[12],this.Gl=0|qb[13],this.Hh=0|qb[14],this.Hl=0|qb[15]}get(){const{Ah:e,Al:t,Bh:r,Bl:n,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:l,Fh:u,Fl:h,Gh:d,Gl:f,Hh:p,Hl:g}=this;return[e,t,r,n,i,o,s,a,c,l,u,h,d,f,p,g]}set(e,t,r,n,i,o,s,a,c,l,u,h,d,f,p,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|l,this.Fh=0|u,this.Fl=0|h,this.Gh=0|d,this.Gl=0|f,this.Hh=0|p,this.Hl=0|g}process(e,t){for(let r=0;r<16;r++,t+=4)Jb[r]=e.getUint32(t),Xb[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|Jb[e-15],r=0|Xb[e-15],n=Nw(t,r,1)^Nw(t,r,8)^Tw(t,0,7),i=Uw(t,r,1)^Uw(t,r,8)^kw(t,r,7),o=0|Jb[e-2],s=0|Xb[e-2],a=Nw(o,s,19)^Bw(o,s,61)^Tw(o,0,6),c=Uw(o,s,19)^Lw(o,s,61)^kw(o,s,6),l=Hw(i,c,Xb[e-7],Xb[e-16]),u=zw(l,n,a,Jb[e-7],Jb[e-16]);Jb[e]=0|u,Xb[e]=0|l}let{Ah:r,Al:n,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:l,Eh:u,El:h,Fh:d,Fl:f,Gh:p,Gl:g,Hh:m,Hl:y}=this;for(let e=0;e<80;e++){const t=Nw(u,h,14)^Nw(u,h,18)^Bw(u,h,41),w=Uw(u,h,14)^Uw(u,h,18)^Lw(u,h,41),b=u&d^~u&p,v=qw(y,w,h&f^~h&g,Yb[e],Xb[e]),E=Ww(v,m,t,b,Zb[e],Jb[e]),x=0|v,I=Nw(r,n,28)^Bw(r,n,34)^Bw(r,n,39),_=Uw(r,n,28)^Lw(r,n,34)^Lw(r,n,39),S=r&i^r&s^i&s,A=n&o^n&a^o&a;m=0|p,y=0|g,p=0|d,g=0|f,d=0|u,f=0|h,({h:u,l:h}=Mw(0|c,0|l,0|E,0|x)),c=0|s,l=0|a,s=0|i,a=0|o,i=0|r,o=0|n;const O=jw(x,_,A);r=Fw(O,E,I,S),n=0|O}({h:r,l:n}=Mw(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:o}=Mw(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=Mw(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:l}=Mw(0|this.Dh,0|this.Dl,0|c,0|l)),({h:u,l:h}=Mw(0|this.Eh,0|this.El,0|u,0|h)),({h:d,l:f}=Mw(0|this.Fh,0|this.Fl,0|d,0|f)),({h:p,l:g}=Mw(0|this.Gh,0|this.Gl,0|p,0|g)),({h:m,l:y}=Mw(0|this.Hh,0|this.Hl,0|m,0|y)),this.set(r,n,i,o,s,a,c,l,u,h,d,f,p,g,m,y)}roundClean(){eb(Jb,Xb)}destroy(){eb(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},ev=class extends Qb{constructor(){super(48),this.Ah=0|zb[0],this.Al=0|zb[1],this.Bh=0|zb[2],this.Bl=0|zb[3],this.Ch=0|zb[4],this.Cl=0|zb[5],this.Dh=0|zb[6],this.Dl=0|zb[7],this.Eh=0|zb[8],this.El=0|zb[9],this.Fh=0|zb[10],this.Fl=0|zb[11],this.Gh=0|zb[12],this.Gl=0|zb[13],this.Hh=0|zb[14],this.Hl=0|zb[15]}};const tv=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class rv extends Qb{constructor(){super(32),this.Ah=0|tv[0],this.Al=0|tv[1],this.Bh=0|tv[2],this.Bl=0|tv[3],this.Ch=0|tv[4],this.Cl=0|tv[5],this.Dh=0|tv[6],this.Dl=0|tv[7],this.Eh=0|tv[8],this.El=0|tv[9],this.Fh=0|tv[10],this.Fl=0|tv[11],this.Gh=0|tv[12],this.Gl=0|tv[13],this.Hh=0|tv[14],this.Hl=0|tv[15]}}const nv=Eb(()=>new Kb),iv=Eb(()=>new Qb),ov=Eb(()=>new ev),sv=Eb(()=>new rv),av=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),cv=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),lv=new Uint32Array(32);function uv(e,t,r,n,i,o){const s=i[o],a=i[o+1];let c=lv[2*e],l=lv[2*e+1],u=lv[2*t],h=lv[2*t+1],d=lv[2*r],f=lv[2*r+1],p=lv[2*n],g=lv[2*n+1],m=jw(c,u,s);l=Fw(m,l,h,a),c=0|m,({Dh:g,Dl:p}={Dh:g^l,Dl:p^c}),({Dh:g,Dl:p}={Dh:Dw(0,p),Dl:$w(g)}),({h:f,l:d}=Mw(f,d,g,p)),({Bh:h,Bl:u}={Bh:h^f,Bl:u^d}),({Bh:h,Bl:u}={Bh:Nw(h,u,24),Bl:Uw(h,u,24)}),lv[2*e]=c,lv[2*e+1]=l,lv[2*t]=u,lv[2*t+1]=h,lv[2*r]=d,lv[2*r+1]=f,lv[2*n]=p,lv[2*n+1]=g}function hv(e,t,r,n,i,o){const s=i[o],a=i[o+1];let c=lv[2*e],l=lv[2*e+1],u=lv[2*t],h=lv[2*t+1],d=lv[2*r],f=lv[2*r+1],p=lv[2*n],g=lv[2*n+1],m=jw(c,u,s);l=Fw(m,l,h,a),c=0|m,({Dh:g,Dl:p}={Dh:g^l,Dl:p^c}),({Dh:g,Dl:p}={Dh:Nw(g,p,16),Dl:Uw(g,p,16)}),({h:f,l:d}=Mw(f,d,g,p)),({Bh:h,Bl:u}={Bh:h^f,Bl:u^d}),({Bh:h,Bl:u}={Bh:Bw(h,u,63),Bl:Lw(h,u,63)}),lv[2*e]=c,lv[2*e+1]=l,lv[2*t]=u,lv[2*t+1]=h,lv[2*r]=d,lv[2*r+1]=f,lv[2*n]=p,lv[2*n+1]=g}class dv extends vb{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,Gw(e),Gw(t),this.blockLen=e,this.outputLen=t,this.buffer=new Uint8Array(e),this.buffer32=Qw(this.buffer)}update(e){Jw(this),Zw(e=wb(e));const{blockLen:t,buffer:r,buffer32:n}=this,i=e.length,o=e.byteOffset,s=e.buffer;for(let a=0;a<i;){this.pos===t&&(sb(n),this.compress(n,0,!1),sb(n),this.pos=0);const c=Math.min(t-this.pos,i-a),l=o+a;if(c===t&&!(l%4)&&a+c<i){const e=new Uint32Array(s,l,Math.floor((i-a)/4));sb(e);for(let r=0;a+t<i;r+=n.length,a+=t)this.length+=t,this.compress(e,r,!1);sb(e);continue}r.set(e.subarray(a,a+c),this.pos),this.pos+=c,this.length+=c,a+=c}return this}digestInto(e){Jw(this),Xw(e,this);const{pos:t,buffer32:r}=this;this.finished=!0,eb(this.buffer.subarray(t)),sb(r),this.compress(r,0,!0),sb(r);const n=Qw(e);this.get().forEach((e,t)=>n[t]=ob(e))}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){const{buffer:t,length:r,finished:n,destroyed:i,outputLen:o,pos:s}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(t),e.destroyed=i,e.finished=n,e.length=r,e.pos=s,e.outputLen=o,e}clone(){return this._cloneInto()}}class fv extends dv{constructor(e={}){const t=void 0===e.dkLen?64:e.dkLen;super(128,t),this.v0l=0|cv[0],this.v0h=0|cv[1],this.v1l=0|cv[2],this.v1h=0|cv[3],this.v2l=0|cv[4],this.v2h=0|cv[5],this.v3l=0|cv[6],this.v3h=0|cv[7],this.v4l=0|cv[8],this.v4h=0|cv[9],this.v5l=0|cv[10],this.v5h=0|cv[11],this.v6l=0|cv[12],this.v6h=0|cv[13],this.v7l=0|cv[14],this.v7h=0|cv[15],function(e,t={},r,n,i){if(Gw(r),e<0||e>r)throw new Error("outputLen bigger than keyLen");const{key:o,salt:s,personalization:a}=t;if(void 0!==o&&(o.length<1||o.length>r))throw new Error("key length must be undefined or 1.."+r);if(void 0!==s&&s.length!==n)throw new Error("salt must be undefined or "+n);if(void 0!==a&&a.length!==i)throw new Error("personalization must be undefined or "+i)}(t,e,64,16,16);let{key:r,personalization:n,salt:i}=e,o=0;if(void 0!==r&&(r=wb(r),o=r.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,void 0!==i){i=wb(i);const e=Qw(i);this.v4l^=ob(e[0]),this.v4h^=ob(e[1]),this.v5l^=ob(e[2]),this.v5h^=ob(e[3])}if(void 0!==n){n=wb(n);const e=Qw(n);this.v6l^=ob(e[0]),this.v6h^=ob(e[1]),this.v7l^=ob(e[2]),this.v7h^=ob(e[3])}if(void 0!==r){const e=new Uint8Array(this.blockLen);e.set(r),this.update(e)}}get(){let{v0l:e,v0h:t,v1l:r,v1h:n,v2l:i,v2h:o,v3l:s,v3h:a,v4l:c,v4h:l,v5l:u,v5h:h,v6l:d,v6h:f,v7l:p,v7h:g}=this;return[e,t,r,n,i,o,s,a,c,l,u,h,d,f,p,g]}set(e,t,r,n,i,o,s,a,c,l,u,h,d,f,p,g){this.v0l=0|e,this.v0h=0|t,this.v1l=0|r,this.v1h=0|n,this.v2l=0|i,this.v2h=0|o,this.v3l=0|s,this.v3h=0|a,this.v4l=0|c,this.v4h=0|l,this.v5l=0|u,this.v5h=0|h,this.v6l=0|d,this.v6h=0|f,this.v7l=0|p,this.v7h=0|g}compress(e,t,r){this.get().forEach((e,t)=>lv[t]=e),lv.set(cv,16);let{h:n,l:i}=Pw(BigInt(this.length));lv[24]=cv[8]^i,lv[25]=cv[9]^n,r&&(lv[28]=~lv[28],lv[29]=~lv[29]);let o=0;const s=av;for(let r=0;r<12;r++)uv(0,4,8,12,e,t+2*s[o++]),hv(0,4,8,12,e,t+2*s[o++]),uv(1,5,9,13,e,t+2*s[o++]),hv(1,5,9,13,e,t+2*s[o++]),uv(2,6,10,14,e,t+2*s[o++]),hv(2,6,10,14,e,t+2*s[o++]),uv(3,7,11,15,e,t+2*s[o++]),hv(3,7,11,15,e,t+2*s[o++]),uv(0,5,10,15,e,t+2*s[o++]),hv(0,5,10,15,e,t+2*s[o++]),uv(1,6,11,12,e,t+2*s[o++]),hv(1,6,11,12,e,t+2*s[o++]),uv(2,7,8,13,e,t+2*s[o++]),hv(2,7,8,13,e,t+2*s[o++]),uv(3,4,9,14,e,t+2*s[o++]),hv(3,4,9,14,e,t+2*s[o++]);this.v0l^=lv[0]^lv[16],this.v0h^=lv[1]^lv[17],this.v1l^=lv[2]^lv[18],this.v1h^=lv[3]^lv[19],this.v2l^=lv[4]^lv[20],this.v2h^=lv[5]^lv[21],this.v3l^=lv[6]^lv[22],this.v3h^=lv[7]^lv[23],this.v4l^=lv[8]^lv[24],this.v4h^=lv[9]^lv[25],this.v5l^=lv[10]^lv[26],this.v5h^=lv[11]^lv[27],this.v6l^=lv[12]^lv[28],this.v6h^=lv[13]^lv[29],this.v7l^=lv[14]^lv[30],this.v7h^=lv[15]^lv[31],eb(lv)}destroy(){this.destroyed=!0,eb(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const pv=function(e){const t=(t,r)=>e(r).update(wb(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}(e=>new fv(e)),gv="https://rpc.walletconnect.org/v1";function mv(e){const t=`Ethereum Signed Message:\n${e.length}`,r=(new TextEncoder).encode(t+e);return"0x"+Buffer.from($b(r)).toString("hex")}async function yv(e,t,r,n,i,o){switch(r.t){case"eip191":return await async function(e,t,r){return(await async function({hash:e,signature:t}){return ru(await nu({hash:e,signature:t}))}({hash:mv(t),signature:r})).toLowerCase()===e.toLowerCase()}(e,t,r.s);case"eip1271":return await async function(e,t,r,n,i,o){const s=My(n);if(!s.namespace||!s.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${n}`);try{const s="0x1626ba7e",a="0000000000000000000000000000000000000000000000000000000000000040",c=r.substring(2),l=(c.length/2).toString(16).padStart(64,"0"),u=s+(t.startsWith("0x")?t:mv(t)).substring(2)+a+l+c,h=await fetch(`${o||gv}/?chainId=${n}&projectId=${i}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:wv(),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:u},"latest"]})}),{result:d}=await h.json();return!!d&&d.slice(0,s.length).toLowerCase()===s.toLowerCase()}catch(e){return console.error("isValidEip1271Signature: ",e),!1}}(e,t,r.s,n,i,o);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}function wv(){return Date.now()+Math.floor(1e3*Math.random())}function bv(e){const t=new Uint8Array(Buffer.from(e,"base64")),r=Array.from("TransactionData::").map(e=>e.charCodeAt(0)),n=new Uint8Array(r.length+t.length);n.set(r),n.set(t,r.length);const i=pv(n,{dkLen:32});return Wh.encode(i)}function vv(e){const t=new Uint8Array(nv(function(e){if(e instanceof Uint8Array)return e;if(Array.isArray(e))return new Uint8Array(e);if("object"==typeof e&&null!=e&&e.data)return new Uint8Array(Object.values(e.data));if("object"==typeof e&&e)return new Uint8Array(Object.values(e));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}(e)));return Wh.encode(t)}function Ev(e){const t=function(e,t){return new md(t).decode(e)}(Buffer.from(e,"base64")).txn;if(!t)throw new Error("Invalid signed transaction: missing 'txn' field");const r=(s=t,new od(a).encodeSharedRef(s)),n=Buffer.from("TX"),i=Buffer.concat([n,Buffer.from(r)]),o=sv(i);var s,a;return Ad.encode(o).replace(/=+$/,"")}function xv(e){const t=[];let r=BigInt(e);for(;r>=BigInt(128);)t.push(Number(r&BigInt(127)|BigInt(128))),r>>=BigInt(7);return t.push(Number(r)),Buffer.from(t)}function Iv(e){const t=Buffer.from(e.signed.bodyBytes,"base64"),r=Buffer.from(e.signed.authInfoBytes,"base64"),n=Buffer.from(e.signature.signature,"base64"),i=[];i.push(Buffer.from([10])),i.push(xv(t.length)),i.push(t),i.push(Buffer.from([18])),i.push(xv(r.length)),i.push(r),i.push(Buffer.from([26])),i.push(xv(n.length)),i.push(n);const o=Buffer.concat(i),s=nv(o);return Buffer.from(s).toString("hex").toUpperCase()}var _v=Object.defineProperty,Sv=Object.defineProperties,Av=Object.getOwnPropertyDescriptors,Ov=Object.getOwnPropertySymbols,Cv=Object.prototype.hasOwnProperty,Pv=Object.prototype.propertyIsEnumerable,Rv=(e,t,r)=>t in e?_v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const Tv=e=>e?.split(":"),kv=e=>{const t=e&&Tv(e);if(t)return t[2]+":"+t[3]},Nv=e=>{const t=e&&Tv(e);if(t)return t.pop()};async function Uv(e){const{cacao:t,projectId:r}=e,{s:n,p:i}=t,o=Bv(i,i.iss),s=Nv(i.iss);return await yv(s,o,n,kv(i.iss),r)}const Bv=(e,t)=>{const r=`${e.domain} wants you to sign in with your Ethereum account:`,n=Nv(t);if(!e.aud&&!e.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let i=e.statement||void 0;const o=`URI: ${e.aud||e.uri}`,s=`Version: ${e.version}`,a=`Chain ID: ${(e=>{const t=e&&Tv(e);if(t)return e.includes("did:pkh:")?t[3]:t[1]})(t)}`,c=`Nonce: ${e.nonce}`,l=`Issued At: ${e.iat}`,u=e.exp?`Expiration Time: ${e.exp}`:void 0,h=e.nbf?`Not Before: ${e.nbf}`:void 0,d=e.requestId?`Request ID: ${e.requestId}`:void 0,f=e.resources?`Resources:${e.resources.map(e=>`\n- ${e}`).join("")}`:void 0,p=qv(e.resources);if(p){i=function(e="",t){Lv(t);const r="I further authorize the stated URI to perform the following actions on my behalf: ";if(e.includes(r))return e;const n=[];let i=0;Object.keys(t.att).forEach(e=>{const r=Object.keys(t.att[e]).map(e=>({ability:e.split("/")[0],action:e.split("/")[1]}));r.sort((e,t)=>e.action.localeCompare(t.action));const o={};r.forEach(e=>{o[e.ability]||(o[e.ability]=[]),o[e.ability].push(e.action)});const s=Object.keys(o).map(t=>(i++,`(${i}) '${t}': '${o[t].join("', '")}' for '${e}'.`));n.push(s.join(", ").replace(".,","."))});const o=n.join(" "),s=`${r}${o}`;return`${e?e+" ":""}${s}`}(i,Mv(p))}return[r,n,"",i,"",o,s,a,c,l,u,h,d,f].filter(e=>null!=e).join("\n")};function Lv(e){if(!e)throw new Error("No recap provided, value is undefined");if(!e.att)throw new Error("No `att` property found");const t=Object.keys(e.att);if(null==t||!t.length)throw new Error("No resources found in `att` property");t.forEach(t=>{const r=e.att[t];if(Array.isArray(r))throw new Error(`Resource must be an object: ${t}`);if("object"!=typeof r)throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(r).forEach(e=>{const t=r[e];if(!Array.isArray(t))throw new Error(`Ability limits ${e} must be an array of objects, found: ${t}`);if(!t.length)throw new Error(`Value of ${e} is empty array, must be an array with objects`);t.forEach(t=>{if("object"!=typeof t)throw new Error(`Ability limits (${e}) must be an array of objects, found: ${t}`)})})})}function Dv(e,t,r={}){t=t?.sort((e,t)=>e.localeCompare(t));const n=t.map(t=>({[`${e}/${t}`]:[r]}));return Object.assign({},...n)}function $v(e){return Lv(e),`urn:recap:${function(e){return Buffer.from(JSON.stringify(e)).toString("base64")}(e).replace(/=/g,"")}`}function Mv(e){const t=function(e){return JSON.parse(Buffer.from(e,"base64").toString("utf-8"))}(e.replace("urn:recap:",""));return Lv(t),t}function jv(e,t,r){const n=function(e,t,r,n={}){return r?.sort((e,t)=>e.localeCompare(t)),{att:{[e]:Dv(t,r,n)}}}(e,t,r);return $v(n)}function Fv(e,t){const r=function(e,t){Lv(e),Lv(t);const r=Object.keys(e.att).concat(Object.keys(t.att)).sort((e,t)=>e.localeCompare(t)),n={att:{}};return r.forEach(r=>{var i,o;Object.keys((null==(i=e.att)?void 0:i[r])||{}).concat(Object.keys((null==(o=t.att)?void 0:o[r])||{})).sort((e,t)=>e.localeCompare(t)).forEach(i=>{var o,s;n.att[r]=((e,t)=>Sv(e,Av(t)))(((e,t)=>{for(var r in t||(t={}))Cv.call(t,r)&&Rv(e,r,t[r]);if(Ov)for(var r of Ov(t))Pv.call(t,r)&&Rv(e,r,t[r]);return e})({},n.att[r]),{[i]:(null==(o=e.att[r])?void 0:o[i])||(null==(s=t.att[r])?void 0:s[i])})})}),n}(Mv(e),Mv(t));return $v(r)}function Hv(e){var t;const r=Mv(e);Lv(r);const n=null==(t=r.att)?void 0:t.eip155;return n?Object.keys(n).map(e=>e.split("/")[1]):[]}function zv(e){const t=Mv(e);Lv(t);const r=[];return Object.values(t.att).forEach(e=>{Object.values(e).forEach(e=>{var t;null!=(t=e?.[0])&&t.chains&&r.push(e[0].chains)})}),[...new Set(r.flat())]}function qv(e){if(!e)return;const t=e?.[e.length-1];return function(e){return e&&e.includes("urn:recap:")}(t)?t:void 0}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function Wv(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function Vv(e){if("boolean"!=typeof e)throw new Error(`boolean expected, not ${e}`)}function Kv(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Gv(e,...t){if(!Wv(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Zv(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Yv(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function Jv(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}const Xv=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function Qv(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e);else{if(!Wv(e))throw new Error("Uint8Array expected, got "+typeof e);e=nE(e)}return e}function eE(e,t,r=!0){if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(r&&!function(e){return e.byteOffset%4==0}(t))throw new Error("invalid output, must be aligned");return t}function tE(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o);e.setUint32(t+4,s,n),e.setUint32(t+0,a,n)}function rE(e,t,r){Vv(r);const n=new Uint8Array(16),i=function(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}(n);return tE(i,0,BigInt(t),r),tE(i,8,BigInt(e),r),n}function nE(e){return Uint8Array.from(e)}const iE=e=>Uint8Array.from(e.split("").map(e=>e.charCodeAt(0))),oE=iE("expand 16-byte k"),sE=iE("expand 32-byte k"),aE=Yv(oE),cE=Yv(sE);function lE(e,t){return e<<t|e>>>32-t}function uE(e){return e.byteOffset%4==0}const hE=2**32-1,dE=new Uint32Array;const fE=(e,t)=>255&e[t++]|(255&e[t++])<<8;class pE{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,Gv(e=Qv(e),32);const t=fE(e,0),r=fE(e,2),n=fE(e,4),i=fE(e,6),o=fE(e,8),s=fE(e,10),a=fE(e,12),c=fE(e,14);this.r[0]=8191&t,this.r[1]=8191&(t>>>13|r<<3),this.r[2]=7939&(r>>>10|n<<6),this.r[3]=8191&(n>>>7|i<<9),this.r[4]=255&(i>>>4|o<<12),this.r[5]=o>>>1&8190,this.r[6]=8191&(o>>>14|s<<2),this.r[7]=8065&(s>>>11|a<<5),this.r[8]=8191&(a>>>8|c<<8),this.r[9]=c>>>5&127;for(let t=0;t<8;t++)this.pad[t]=fE(e,16+2*t)}process(e,t,r=!1){const n=r?0:2048,{h:i,r:o}=this,s=o[0],a=o[1],c=o[2],l=o[3],u=o[4],h=o[5],d=o[6],f=o[7],p=o[8],g=o[9],m=fE(e,t+0),y=fE(e,t+2),w=fE(e,t+4),b=fE(e,t+6),v=fE(e,t+8),E=fE(e,t+10),x=fE(e,t+12),I=fE(e,t+14);let _=i[0]+(8191&m),S=i[1]+(8191&(m>>>13|y<<3)),A=i[2]+(8191&(y>>>10|w<<6)),O=i[3]+(8191&(w>>>7|b<<9)),C=i[4]+(8191&(b>>>4|v<<12)),P=i[5]+(v>>>1&8191),R=i[6]+(8191&(v>>>14|E<<2)),T=i[7]+(8191&(E>>>11|x<<5)),k=i[8]+(8191&(x>>>8|I<<8)),N=i[9]+(I>>>5|n),U=0,B=U+_*s+S*(5*g)+A*(5*p)+O*(5*f)+C*(5*d);U=B>>>13,B&=8191,B+=P*(5*h)+R*(5*u)+T*(5*l)+k*(5*c)+N*(5*a),U+=B>>>13,B&=8191;let L=U+_*a+S*s+A*(5*g)+O*(5*p)+C*(5*f);U=L>>>13,L&=8191,L+=P*(5*d)+R*(5*h)+T*(5*u)+k*(5*l)+N*(5*c),U+=L>>>13,L&=8191;let D=U+_*c+S*a+A*s+O*(5*g)+C*(5*p);U=D>>>13,D&=8191,D+=P*(5*f)+R*(5*d)+T*(5*h)+k*(5*u)+N*(5*l),U+=D>>>13,D&=8191;let $=U+_*l+S*c+A*a+O*s+C*(5*g);U=$>>>13,$&=8191,$+=P*(5*p)+R*(5*f)+T*(5*d)+k*(5*h)+N*(5*u),U+=$>>>13,$&=8191;let M=U+_*u+S*l+A*c+O*a+C*s;U=M>>>13,M&=8191,M+=P*(5*g)+R*(5*p)+T*(5*f)+k*(5*d)+N*(5*h),U+=M>>>13,M&=8191;let j=U+_*h+S*u+A*l+O*c+C*a;U=j>>>13,j&=8191,j+=P*s+R*(5*g)+T*(5*p)+k*(5*f)+N*(5*d),U+=j>>>13,j&=8191;let F=U+_*d+S*h+A*u+O*l+C*c;U=F>>>13,F&=8191,F+=P*a+R*s+T*(5*g)+k*(5*p)+N*(5*f),U+=F>>>13,F&=8191;let H=U+_*f+S*d+A*h+O*u+C*l;U=H>>>13,H&=8191,H+=P*c+R*a+T*s+k*(5*g)+N*(5*p),U+=H>>>13,H&=8191;let z=U+_*p+S*f+A*d+O*h+C*u;U=z>>>13,z&=8191,z+=P*l+R*c+T*a+k*s+N*(5*g),U+=z>>>13,z&=8191;let q=U+_*g+S*p+A*f+O*d+C*h;U=q>>>13,q&=8191,q+=P*u+R*l+T*c+k*a+N*s,U+=q>>>13,q&=8191,U=(U<<2)+U|0,U=U+B|0,B=8191&U,U>>>=13,L+=U,i[0]=B,i[1]=L,i[2]=D,i[3]=$,i[4]=M,i[5]=j,i[6]=F,i[7]=H,i[8]=z,i[9]=q}finalize(){const{h:e,pad:t}=this,r=new Uint16Array(10);let n=e[1]>>>13;e[1]&=8191;for(let t=2;t<10;t++)e[t]+=n,n=e[t]>>>13,e[t]&=8191;e[0]+=5*n,n=e[0]>>>13,e[0]&=8191,e[1]+=n,n=e[1]>>>13,e[1]&=8191,e[2]+=n,r[0]=e[0]+5,n=r[0]>>>13,r[0]&=8191;for(let t=1;t<10;t++)r[t]=e[t]+n,n=r[t]>>>13,r[t]&=8191;r[9]-=8192;let i=(1^n)-1;for(let e=0;e<10;e++)r[e]&=i;i=~i;for(let t=0;t<10;t++)e[t]=e[t]&i|r[t];e[0]=65535&(e[0]|e[1]<<13),e[1]=65535&(e[1]>>>3|e[2]<<10),e[2]=65535&(e[2]>>>6|e[3]<<7),e[3]=65535&(e[3]>>>9|e[4]<<4),e[4]=65535&(e[4]>>>12|e[5]<<1|e[6]<<14),e[5]=65535&(e[6]>>>2|e[7]<<11),e[6]=65535&(e[7]>>>5|e[8]<<8),e[7]=65535&(e[8]>>>8|e[9]<<5);let o=e[0]+t[0];e[0]=65535&o;for(let r=1;r<8;r++)o=(e[r]+t[r]|0)+(o>>>16)|0,e[r]=65535&o;Jv(r)}update(e){Zv(this),Gv(e=Qv(e));const{buffer:t,blockLen:r}=this,n=e.length;for(let i=0;i<n;){const o=Math.min(r-this.pos,n-i);if(o!==r)t.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===r&&(this.process(t,0,!1),this.pos=0);else for(;r<=n-i;i+=r)this.process(e,i)}return this}destroy(){Jv(this.h,this.r,this.buffer,this.pad)}digestInto(e){Zv(this),function(e,t){Gv(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;const{buffer:t,h:r}=this;let{pos:n}=this;if(n){for(t[n++]=1;n<16;n++)t[n]=0;this.process(t,0,!0)}this.finalize();let i=0;for(let t=0;t<8;t++)e[i++]=r[t]>>>0,e[i++]=r[t]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}}const gE=function(e){const t=(t,r)=>e(r).update(Qv(t)).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}(e=>new pE(e));const mE=function(e,t){const{allowShortKeys:r,extendNonceFn:n,counterLength:i,counterRight:o,rounds:s}=function(e,t){if(null==t||"object"!=typeof t)throw new Error("options must be defined");return Object.assign(e,t)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if("function"!=typeof e)throw new Error("core must be a function");return Kv(i),Kv(s),Vv(o),Vv(r),(t,a,c,l,u=0)=>{Gv(t),Gv(a),Gv(c);const h=c.length;if(void 0===l&&(l=new Uint8Array(h)),Gv(l),Kv(u),u<0||u>=hE)throw new Error("arx: counter overflow");if(l.length<h)throw new Error(`arx: output (${l.length}) is shorter than data (${h})`);const d=[];let f,p,g=t.length;if(32===g)d.push(f=nE(t)),p=cE;else{if(16!==g||!r)throw new Error(`arx: invalid 32-byte key, got length=${g}`);f=new Uint8Array(32),f.set(t),f.set(t,16),p=aE,d.push(f)}uE(a)||d.push(a=nE(a));const m=Yv(f);if(n){if(24!==a.length)throw new Error("arx: extended nonce must be 24 bytes");n(p,m,Yv(a.subarray(0,16)),m),a=a.subarray(16)}const y=16-i;if(y!==a.length)throw new Error(`arx: nonce must be ${y} or 16 bytes`);if(12!==y){const e=new Uint8Array(12);e.set(a,o?0:12-a.length),a=e,d.push(a)}const w=Yv(a);return function(e,t,r,n,i,o,s,a){const c=i.length,l=new Uint8Array(64),u=Yv(l),h=uE(i)&&uE(o),d=h?Yv(i):dE,f=h?Yv(o):dE;for(let p=0;p<c;s++){if(e(t,r,n,u,s,a),s>=hE)throw new Error("arx: counter overflow");const g=Math.min(64,c-p);if(h&&64===g){const e=p/4;if(p%4!=0)throw new Error("arx: invalid block position");for(let t,r=0;r<16;r++)t=e+r,f[t]=d[t]^u[r];p+=64;continue}for(let e,t=0;t<g;t++)e=p+t,o[e]=i[e]^l[t];p+=g}}(e,p,m,w,c,l,u,s),Jv(...d),l}}(function(e,t,r,n,i,o=20){let s=e[0],a=e[1],c=e[2],l=e[3],u=t[0],h=t[1],d=t[2],f=t[3],p=t[4],g=t[5],m=t[6],y=t[7],w=i,b=r[0],v=r[1],E=r[2],x=s,I=a,_=c,S=l,A=u,O=h,C=d,P=f,R=p,T=g,k=m,N=y,U=w,B=b,L=v,D=E;for(let e=0;e<o;e+=2)x=x+A|0,U=lE(U^x,16),R=R+U|0,A=lE(A^R,12),x=x+A|0,U=lE(U^x,8),R=R+U|0,A=lE(A^R,7),I=I+O|0,B=lE(B^I,16),T=T+B|0,O=lE(O^T,12),I=I+O|0,B=lE(B^I,8),T=T+B|0,O=lE(O^T,7),_=_+C|0,L=lE(L^_,16),k=k+L|0,C=lE(C^k,12),_=_+C|0,L=lE(L^_,8),k=k+L|0,C=lE(C^k,7),S=S+P|0,D=lE(D^S,16),N=N+D|0,P=lE(P^N,12),S=S+P|0,D=lE(D^S,8),N=N+D|0,P=lE(P^N,7),x=x+O|0,D=lE(D^x,16),k=k+D|0,O=lE(O^k,12),x=x+O|0,D=lE(D^x,8),k=k+D|0,O=lE(O^k,7),I=I+C|0,U=lE(U^I,16),N=N+U|0,C=lE(C^N,12),I=I+C|0,U=lE(U^I,8),N=N+U|0,C=lE(C^N,7),_=_+P|0,B=lE(B^_,16),R=R+B|0,P=lE(P^R,12),_=_+P|0,B=lE(B^_,8),R=R+B|0,P=lE(P^R,7),S=S+A|0,L=lE(L^S,16),T=T+L|0,A=lE(A^T,12),S=S+A|0,L=lE(L^S,8),T=T+L|0,A=lE(A^T,7);let $=0;n[$++]=s+x|0,n[$++]=a+I|0,n[$++]=c+_|0,n[$++]=l+S|0,n[$++]=u+A|0,n[$++]=h+O|0,n[$++]=d+C|0,n[$++]=f+P|0,n[$++]=p+R|0,n[$++]=g+T|0,n[$++]=m+k|0,n[$++]=y+N|0,n[$++]=w+U|0,n[$++]=b+B|0,n[$++]=v+L|0,n[$++]=E+D|0},{counterRight:!1,counterLength:4,allowShortKeys:!1}),yE=new Uint8Array(16),wE=(e,t)=>{e.update(t);const r=t.length%16;r&&e.update(yE.subarray(r))},bE=new Uint8Array(32);function vE(e,t,r,n,i){const o=e(t,r,bE),s=gE.create(o);i&&wE(s,i),wE(s,n);const a=rE(n.length,i?i.length:0,!0);s.update(a);const c=s.digest();return Jv(o,a),c}const EE=((e,t)=>{function r(r,...n){if(Gv(r),!Xv)throw new Error("Non little-endian hardware is not yet supported");if(void 0!==e.nonceLength){const t=n[0];if(!t)throw new Error("nonce / iv required");e.varSizeNonce?Gv(t):Gv(t,e.nonceLength)}const i=e.tagLength;i&&void 0!==n[1]&&Gv(n[1]);const o=t(r,...n),s=(e,t)=>{if(void 0!==t){if(2!==e)throw new Error("cipher output not supported");Gv(t)}};let a=!1;return{encrypt(e,t){if(a)throw new Error("cannot encrypt() twice with same key + nonce");return a=!0,Gv(e),s(o.encrypt.length,t),o.encrypt(e,t)},decrypt(e,t){if(Gv(e),i&&e.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return s(o.decrypt.length,t),o.decrypt(e,t)}}}return Object.assign(r,e),r})({blockSize:64,nonceLength:12,tagLength:16},(e=>(t,r,n)=>({encrypt(i,o){const s=i.length;(o=eE(s+16,o,!1)).set(i);const a=o.subarray(0,-16);e(t,r,a,a,1);const c=vE(e,t,r,a,n);return o.set(c,s),Jv(c),o},decrypt(i,o){o=eE(i.length-16,o,!1);const s=i.subarray(0,-16),a=i.subarray(-16),c=vE(e,t,r,s,n);if(!function(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}(a,c))throw new Error("invalid tag");return o.set(i.subarray(0,-16)),e(t,r,o,o,1),Jv(c),o}}))(mE));let xE=class extends vb{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Yw(e);const r=wb(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,i=new Uint8Array(n);i.set(r.length>n?e.create().update(r).digest():r);for(let e=0;e<i.length;e++)i[e]^=54;this.iHash.update(i),this.oHash=e.create();for(let e=0;e<i.length;e++)i[e]^=106;this.oHash.update(i),eb(i)}update(e){return Jw(this),this.iHash.update(e),this}digestInto(e){Jw(this),Zw(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:n,destroyed:i,blockLen:o,outputLen:s}=this;return e.finished=n,e.destroyed=i,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const IE=(e,t,r)=>new xE(e,t).update(r).digest();IE.create=(e,t)=>new xE(e,t);const _E=Uint8Array.from([0]),SE=Uint8Array.of();const AE=(e,t,r,n,i)=>function(e,t,r,n=32){Yw(e),Gw(n);const i=e.outputLen;if(n>255*i)throw new Error("Length should be <= 255*HashLen");const o=Math.ceil(n/i);void 0===r&&(r=SE);const s=new Uint8Array(o*i),a=IE.create(e,t),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let e=0;e<o;e++)_E[0]=e+1,c.update(0===e?SE:l).update(r).update(_E).digestInto(l),s.set(l,i*e),a._cloneInto(c);return a.destroy(),c.destroy(),eb(l,_E),s.slice(0,n)}(e,function(e,t,r){return Yw(e),void 0===r&&(r=new Uint8Array(e.outputLen)),IE(e,wb(r),wb(t))}(e,t,r),n,i),OE=nv,CE=BigInt(0),PE=BigInt(1);function RE(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}function TE(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function kE(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?CE:BigInt("0x"+e)}function NE(e){return kE(lb(e))}function UE(e){return Zw(e),kE(lb(Uint8Array.from(e).reverse()))}function BE(e,t){return yb(e.toString(16).padStart(2*t,"0"))}function LE(e,t){return BE(e,t).reverse()}function DE(e,t,r){let n;if("string"==typeof t)try{n=yb(t)}catch(t){throw new Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!Kw(t))throw new Error(e+" must be hex string or Uint8Array");n=Uint8Array.from(t)}const i=n.length;if("number"==typeof r&&i!==r)throw new Error(e+" of length "+r+" expected, got "+i);return n}const $E=e=>"bigint"==typeof e&&CE<=e;function ME(e,t,r,n){if(!function(e,t,r){return $E(e)&&$E(t)&&$E(r)&&t<=e&&e<r}(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}const jE=e=>(PE<<BigInt(e))-PE;function FE(e,t,r={}){if(!e||"object"!=typeof e)throw new Error("expected valid options object");function n(t,r,n){const i=e[t];if(n&&void 0===i)return;const o=typeof i;if(o!==r||null===i)throw new Error(`param "${t}" is invalid: expected ${r}, got ${o}`)}Object.entries(t).forEach(([e,t])=>n(e,t,!1)),Object.entries(r).forEach(([e,t])=>n(e,t,!0))}function HE(e){const t=new WeakMap;return(r,...n)=>{const i=t.get(r);if(void 0!==i)return i;const o=e(r,...n);return t.set(r,o),o}}const zE=BigInt(0),qE=BigInt(1),WE=BigInt(2),VE=BigInt(3),KE=BigInt(4),GE=BigInt(5),ZE=BigInt(8);function YE(e,t){const r=e%t;return r>=zE?r:t+r}function JE(e,t,r){let n=e;for(;t-- >zE;)n*=n,n%=r;return n}function XE(e,t){if(e===zE)throw new Error("invert: expected non-zero number");if(t<=zE)throw new Error("invert: expected positive modulus, got "+t);let r=YE(e,t),n=t,i=zE,o=qE;for(;r!==zE;){const e=n%r,t=i-o*(n/r);n=r,r=e,i=o,o=t}if(n!==qE)throw new Error("invert: does not exist");return YE(i,t)}function QE(e,t){const r=(e.ORDER+qE)/KE,n=e.pow(t,r);if(!e.eql(e.sqr(n),t))throw new Error("Cannot find square root");return n}function ex(e,t){const r=(e.ORDER-GE)/ZE,n=e.mul(t,WE),i=e.pow(n,r),o=e.mul(t,i),s=e.mul(e.mul(o,WE),i),a=e.mul(o,e.sub(s,e.ONE));if(!e.eql(e.sqr(a),t))throw new Error("Cannot find square root");return a}function tx(e){return e%KE===VE?QE:e%ZE===GE?ex:function(e){if(e<BigInt(3))throw new Error("sqrt is not defined for small field");let t=e-qE,r=0;for(;t%WE===zE;)t/=WE,r++;let n=WE;const i=ox(e);for(;1===ix(i,n);)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===r)return QE;let o=i.pow(n,t);const s=(t+qE)/WE;return function(e,n){if(e.is0(n))return n;if(1!==ix(e,n))throw new Error("Cannot find square root");let i=r,a=e.mul(e.ONE,o),c=e.pow(n,t),l=e.pow(n,s);for(;!e.eql(c,e.ONE);){if(e.is0(c))return e.ZERO;let t=1,r=e.sqr(c);for(;!e.eql(r,e.ONE);)if(t++,r=e.sqr(r),t===i)throw new Error("Cannot find square root");const n=qE<<BigInt(i-t-1),o=e.pow(a,n);i=t,a=e.sqr(o),c=e.mul(c,a),l=e.mul(l,o)}return l}}(e)}const rx=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function nx(e,t,r=!1){const n=new Array(t.length).fill(r?e.ZERO:void 0),i=t.reduce((t,r,i)=>e.is0(r)?t:(n[i]=t,e.mul(t,r)),e.ONE),o=e.inv(i);return t.reduceRight((t,r,i)=>e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r)),o),n}function ix(e,t){const r=(e.ORDER-qE)/WE,n=e.pow(t,r),i=e.eql(n,e.ONE),o=e.eql(n,e.ZERO),s=e.eql(n,e.neg(e.ONE));if(!i&&!o&&!s)throw new Error("invalid Legendre symbol result");return i?1:o?0:-1}function ox(e,t,r=!1,n={}){if(e<=zE)throw new Error("invalid field: expected ORDER > 0, got "+e);let i,o;if("object"==typeof t&&null!=t){if(n.sqrt||r)throw new Error("cannot specify opts in two arguments");const e=t;e.BITS&&(i=e.BITS),e.sqrt&&(o=e.sqrt),"boolean"==typeof e.isLE&&(r=e.isLE)}else"number"==typeof t&&(i=t),n.sqrt&&(o=n.sqrt);const{nBitLength:s,nByteLength:a}=function(e,t){void 0!==t&&Gw(t);const r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}(e,i);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c;const l=Object.freeze({ORDER:e,isLE:r,BITS:s,BYTES:a,MASK:jE(s),ZERO:zE,ONE:qE,create:t=>YE(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return zE<=t&&t<e},is0:e=>e===zE,isValidNot0:e=>!l.is0(e)&&l.isValid(e),isOdd:e=>(e&qE)===qE,neg:t=>YE(-t,e),eql:(e,t)=>e===t,sqr:t=>YE(t*t,e),add:(t,r)=>YE(t+r,e),sub:(t,r)=>YE(t-r,e),mul:(t,r)=>YE(t*r,e),pow:(e,t)=>function(e,t,r){if(r<zE)throw new Error("invalid exponent, negatives unsupported");if(r===zE)return e.ONE;if(r===qE)return t;let n=e.ONE,i=t;for(;r>zE;)r&qE&&(n=e.mul(n,i)),i=e.sqr(i),r>>=qE;return n}(l,e,t),div:(t,r)=>YE(t*XE(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>XE(t,e),sqrt:o||(t=>(c||(c=tx(e)),c(l,t))),toBytes:e=>r?LE(e,a):BE(e,a),fromBytes:e=>{if(e.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+e.length);return r?UE(e):NE(e)},invertBatch:e=>nx(l,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(l)}function sx(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function ax(e){const t=sx(e);return t+Math.ceil(t/2)}const cx=BigInt(0),lx=BigInt(1);function ux(e,t){const r=t.negate();return e?r:t}function hx(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function dx(e,t){hx(e,t);const r=2**e;return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1),mask:jE(e),maxNumber:r,shiftBy:BigInt(e)}}function fx(e,t,r){const{windowSize:n,mask:i,maxNumber:o,shiftBy:s}=r;let a=Number(e&i),c=e>>s;a>n&&(a-=o,c+=lx);const l=t*n;return{nextN:c,offset:l+Math.abs(a)-1,isZero:0===a,isNeg:a<0,isNegF:t%2!=0,offsetF:l}}const px=new WeakMap,gx=new WeakMap;function mx(e){return gx.get(e)||1}function yx(e){if(e!==cx)throw new Error("invalid wNAF")}function wx(e,t,r,n){(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw new Error("invalid point at index "+r)})})(r,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+r)})}(n,t);const i=r.length,o=n.length;if(i!==o)throw new Error("arrays of points and scalars must have equal length");const s=e.ZERO,a=function(e){let t;for(t=0;e>CE;e>>=PE,t+=1);return t}(BigInt(i));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=jE(c),u=new Array(Number(l)+1).fill(s);let h=s;for(let e=Math.floor((t.BITS-1)/c)*c;e>=0;e-=c){u.fill(s);for(let t=0;t<o;t++){const i=n[t],o=Number(i>>BigInt(e)&l);u[o]=u[o].add(r[t])}let t=s;for(let e=u.length-1,r=s;e>0;e--)r=r.add(u[e]),t=t.add(r);if(h=h.add(t),0!==e)for(let e=0;e<c;e++)h=h.double()}return h}function bx(e,t){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return function(e){const t=rx.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"});FE(e,t)}(t),t}return ox(e)}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const vx=BigInt(0),Ex=BigInt(1),xx=BigInt(2);function Ix(e){const t=function(e){return FE(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...e})}(e),{P:r,type:n,adjustScalarBytes:i,powPminus2:o,randomBytes:s}=t,a="x25519"===n;if(!a&&"x448"!==n)throw new Error("invalid type");const c=s||xb,l=a?255:448,u=a?32:56,h=BigInt(a?9:5),d=BigInt(a?121665:39081),f=a?xx**BigInt(254):xx**BigInt(447),p=a?BigInt(8)*xx**BigInt(251)-Ex:BigInt(4)*xx**BigInt(445)-Ex,g=f+p+Ex,m=e=>YE(e,r),y=w(h);function w(e){return LE(m(e),u)}function b(e,t){const n=function(e,t){ME("u",e,vx,r),ME("scalar",t,f,g);const n=t,i=e;let s=Ex,a=vx,c=e,u=Ex,h=vx;for(let e=BigInt(l-1);e>=vx;e--){const t=n>>e&Ex;h^=t,({x_2:s,x_3:c}=E(h,s,c)),({x_2:a,x_3:u}=E(h,a,u)),h=t;const r=s+a,o=m(r*r),l=s-a,f=m(l*l),p=o-f,g=c+u,y=m((c-u)*r),w=m(g*l),b=y+w,v=y-w;c=m(b*b),u=m(i*m(v*v)),s=m(o*f),a=m(p*(o+m(d*p)))}({x_2:s,x_3:c}=E(h,s,c)),({x_2:a,x_3:u}=E(h,a,u));const p=o(a);return m(s*p)}(function(e){const t=DE("u coordinate",e,u);return a&&(t[31]&=127),m(UE(t))}(t),function(e){return UE(i(DE("scalar",e,u)))}(e));if(n===vx)throw new Error("invalid private or public key received");return w(n)}function v(e){return b(e,y)}function E(e,t,r){const n=m(e*(t-r));return{x_2:t=m(t-n),x_3:r=m(r+n)}}return{scalarMult:b,scalarMultBase:v,getSharedSecret:(e,t)=>b(e,t),getPublicKey:e=>v(e),utils:{randomPrivateKey:()=>c(u)},GuBytes:y.slice()}}BigInt(0);const _x=BigInt(1),Sx=BigInt(2),Ax=BigInt(3),Ox=BigInt(5);BigInt(8);const Cx={p:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function Px(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}const Rx=(()=>{const e=Cx.p;return Ix({P:e,type:"x25519",powPminus2:t=>{const{pow_p_5_8:r,b2:n}=function(e){const t=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),o=Cx.p,s=e*e%o*e%o,a=JE(s,Sx,o)*s%o,c=JE(a,_x,o)*e%o,l=JE(c,Ox,o)*c%o,u=JE(l,t,o)*l%o,h=JE(u,r,o)*u%o,d=JE(h,n,o)*h%o,f=JE(d,i,o)*d%o,p=JE(f,i,o)*d%o,g=JE(p,t,o)*l%o;return{pow_p_5_8:JE(g,Sx,o)*e%o,b2:s}}(t);return YE(JE(r,Ax,e)*n,e)},adjustScalarBytes:Px})})();function Tx(e){void 0!==e.lowS&&RE("lowS",e.lowS),void 0!==e.prehash&&RE("prehash",e.prehash)}class kx extends Error{constructor(e=""){super(e)}}const Nx={Err:kx,_tlv:{encode:(e,t)=>{const{Err:r}=Nx;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");const n=t.length/2,i=TE(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");const o=n>127?TE(i.length/2|128):"";return TE(e)+o+i+t},decode(e,t){const{Err:r}=Nx;let n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");const i=t[n++];let o=0;if(!!(128&i)){const e=127&i;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");const s=t.subarray(n,n+e);if(s.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===s[0])throw new r("tlv.decode(long): zero leftmost byte");for(const e of s)o=o<<8|e;if(n+=e,o<128)throw new r("tlv.decode(long): not minimal encoding")}else o=i;const s=t.subarray(n,n+o);if(s.length!==o)throw new r("tlv.decode: wrong value length");return{v:s,l:t.subarray(n+o)}}},_int:{encode(e){const{Err:t}=Nx;if(e<Ux)throw new t("integer: negative integers are not allowed");let r=TE(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){const{Err:t}=Nx;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return NE(e)}},toSig(e){const{Err:t,_int:r,_tlv:n}=Nx,i=DE("signature",e),{v:o,l:s}=n.decode(48,i);if(s.length)throw new t("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,o),{v:l,l:u}=n.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(e){const{_tlv:t,_int:r}=Nx,n=t.encode(2,r.encode(e.r))+t.encode(2,r.encode(e.s));return t.encode(48,n)}},Ux=BigInt(0),Bx=BigInt(1),Lx=BigInt(2),Dx=BigInt(3),$x=BigInt(4);function Mx(e,t,r){const{BYTES:n}=e;return function(i){let o;if("bigint"==typeof i)o=i;else{let r=DE("private key",i);if(t){if(!t.includes(2*r.length))throw new Error("invalid private key");const e=new Uint8Array(n);e.set(r,e.length-r.length),r=e}try{o=e.fromBytes(r)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof i}`)}}if(r&&(o=e.create(o)),!e.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}}function jx(e,t={}){const{Fp:r,Fn:n}=function(e,t,r={}){if(!t||"object"!=typeof t)throw new Error(`expected valid ${e} CURVE object`);for(const e of["p","n","h"]){const r=t[e];if(!("bigint"==typeof r&&r>cx))throw new Error(`CURVE.${e} must be positive bigint`)}const n=bx(t.p,r.Fp),i=bx(t.n,r.Fn),o=["Gx","Gy","a","b"];for(const e of o)if(!n.isValid(t[e]))throw new Error(`CURVE.${e} must be valid field element of CURVE.Fp`);return{Fp:n,Fn:i}}("weierstrass",e,t),{h:i,n:o}=e;FE(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:s}=t;if(s&&(!r.is0(e.a)||"bigint"!=typeof s.beta||"function"!=typeof s.splitScalar))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}const c=t.toBytes||function(e,t,n){const{x:i,y:o}=t.toAffine(),s=r.toBytes(i);if(RE("isCompressed",n),n){a();return bb(Fx(!r.isOdd(o)),s)}return bb(Uint8Array.of(4),s,r.toBytes(o))},l=t.fromBytes||function(e){Zw(e);const t=r.BYTES,n=t+1,i=2*t+1,o=e.length,s=e[0],c=e.subarray(1);if(o!==n||2!==s&&3!==s){if(o===i&&4===s){const e=r.fromBytes(c.subarray(0*t,1*t)),n=r.fromBytes(c.subarray(1*t,2*t));if(!h(e,n))throw new Error("bad point: is not on curve");return{x:e,y:n}}throw new Error(`bad point: got length ${o}, expected compressed=${n} or uncompressed=${i}`)}{const e=r.fromBytes(c);if(!r.isValid(e))throw new Error("bad point: is not on curve, wrong x");const t=u(e);let n;try{n=r.sqrt(t)}catch(e){const t=e instanceof Error?": "+e.message:"";throw new Error("bad point: is not on curve, sqrt error"+t)}a();return!(1&~s)!==r.isOdd(n)&&(n=r.neg(n)),{x:e,y:n}}},u=function(e,t,r){return function(n){const i=e.sqr(n),o=e.mul(i,n);return e.add(e.add(o,e.mul(n,t)),r)}}(r,e.a,e.b);function h(e,t){const n=r.sqr(t),i=u(e);return r.eql(n,i)}if(!h(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const d=r.mul(r.pow(e.a,Dx),$x),f=r.mul(r.sqr(e.b),BigInt(27));if(r.is0(r.add(d,f)))throw new Error("bad curve params: a or b");function p(e,t,n=!1){if(!r.isValid(t)||n&&r.is0(t))throw new Error(`bad point coordinate ${e}`);return t}function g(e){if(!(e instanceof b))throw new Error("ProjectivePoint expected")}const m=HE((e,t)=>{const{px:n,py:i,pz:o}=e;if(r.eql(o,r.ONE))return{x:n,y:i};const s=e.is0();null==t&&(t=s?r.ONE:r.inv(o));const a=r.mul(n,t),c=r.mul(i,t),l=r.mul(o,t);if(s)return{x:r.ZERO,y:r.ZERO};if(!r.eql(l,r.ONE))throw new Error("invZ was invalid");return{x:a,y:c}}),y=HE(e=>{if(e.is0()){if(t.allowInfinityPoint&&!r.is0(e.py))return;throw new Error("bad point: ZERO")}const{x:n,y:i}=e.toAffine();if(!r.isValid(n)||!r.isValid(i))throw new Error("bad point: x or y not field elements");if(!h(n,i))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function w(e,t,n,i,o){return n=new b(r.mul(n.px,e),n.py,n.pz),t=ux(i,t),n=ux(o,n),t.add(n)}class b{constructor(e,t,r){this.px=p("x",e),this.py=p("y",t,!0),this.pz=p("z",r),Object.freeze(this)}static fromAffine(e){const{x:t,y:n}=e||{};if(!e||!r.isValid(t)||!r.isValid(n))throw new Error("invalid affine point");if(e instanceof b)throw new Error("projective point not allowed");return r.is0(t)&&r.is0(n)?b.ZERO:new b(t,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){return function(e,t,r){const n=nx(e.Fp,r.map(e=>e.pz));return r.map((e,t)=>e.toAffine(n[t])).map(e.fromAffine)}(b,0,e)}static fromBytes(e){return Zw(e),b.fromHex(e)}static fromHex(e){const t=b.fromAffine(l(DE("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){const r=Mx(n,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return b.BASE.multiply(r(e))}static msm(e,t){return wx(b,n,e,t)}precompute(e=8,t=!0){return E.setWindowSize(this,e),t||this.multiply(Dx),this}_setWindowSize(e){this.precompute(e)}assertValidity(){y(this)}hasEvenY(){const{y:e}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(e)}equals(e){g(e);const{px:t,py:n,pz:i}=this,{px:o,py:s,pz:a}=e,c=r.eql(r.mul(t,a),r.mul(o,i)),l=r.eql(r.mul(n,a),r.mul(s,i));return c&&l}negate(){return new b(this.px,r.neg(this.py),this.pz)}double(){const{a:t,b:n}=e,i=r.mul(n,Dx),{px:o,py:s,pz:a}=this;let c=r.ZERO,l=r.ZERO,u=r.ZERO,h=r.mul(o,o),d=r.mul(s,s),f=r.mul(a,a),p=r.mul(o,s);return p=r.add(p,p),u=r.mul(o,a),u=r.add(u,u),c=r.mul(t,u),l=r.mul(i,f),l=r.add(c,l),c=r.sub(d,l),l=r.add(d,l),l=r.mul(c,l),c=r.mul(p,c),u=r.mul(i,u),f=r.mul(t,f),p=r.sub(h,f),p=r.mul(t,p),p=r.add(p,u),u=r.add(h,h),h=r.add(u,h),h=r.add(h,f),h=r.mul(h,p),l=r.add(l,h),f=r.mul(s,a),f=r.add(f,f),h=r.mul(f,p),c=r.sub(c,h),u=r.mul(f,d),u=r.add(u,u),u=r.add(u,u),new b(c,l,u)}add(t){g(t);const{px:n,py:i,pz:o}=this,{px:s,py:a,pz:c}=t;let l=r.ZERO,u=r.ZERO,h=r.ZERO;const d=e.a,f=r.mul(e.b,Dx);let p=r.mul(n,s),m=r.mul(i,a),y=r.mul(o,c),w=r.add(n,i),v=r.add(s,a);w=r.mul(w,v),v=r.add(p,m),w=r.sub(w,v),v=r.add(n,o);let E=r.add(s,c);return v=r.mul(v,E),E=r.add(p,y),v=r.sub(v,E),E=r.add(i,o),l=r.add(a,c),E=r.mul(E,l),l=r.add(m,y),E=r.sub(E,l),h=r.mul(d,v),l=r.mul(f,y),h=r.add(l,h),l=r.sub(m,h),h=r.add(m,h),u=r.mul(l,h),m=r.add(p,p),m=r.add(m,p),y=r.mul(d,y),v=r.mul(f,v),m=r.add(m,y),y=r.sub(p,y),y=r.mul(d,y),v=r.add(v,y),p=r.mul(m,v),u=r.add(u,p),p=r.mul(E,v),l=r.mul(w,l),l=r.sub(l,p),p=r.mul(w,m),h=r.mul(E,h),h=r.add(h,p),new b(l,u,h)}subtract(e){return this.add(e.negate())}is0(){return this.equals(b.ZERO)}multiply(e){const{endo:r}=t;if(!n.isValidNot0(e))throw new Error("invalid scalar: out of range");let i,o;const s=e=>E.wNAFCached(this,e,b.normalizeZ);if(r){const{k1neg:t,k1:n,k2neg:a,k2:c}=r.splitScalar(e),{p:l,f:u}=s(n),{p:h,f:d}=s(c);o=u.add(d),i=w(r.beta,l,h,t,a)}else{const{p:t,f:r}=s(e);i=t,o=r}return b.normalizeZ([i,o])[0]}multiplyUnsafe(e){const{endo:r}=t,i=this;if(!n.isValid(e))throw new Error("invalid scalar: out of range");if(e===Ux||i.is0())return b.ZERO;if(e===Bx)return i;if(E.hasPrecomputes(this))return this.multiply(e);if(r){const{k1neg:t,k1:n,k2neg:o,k2:s}=r.splitScalar(e),{p1:a,p2:c}=function(e,t,r,n){let i=t,o=e.ZERO,s=e.ZERO;for(;r>cx||n>cx;)r&lx&&(o=o.add(i)),n&lx&&(s=s.add(i)),i=i.double(),r>>=lx,n>>=lx;return{p1:o,p2:s}}(b,i,n,s);return w(r.beta,a,c,t,o)}return E.wNAFCachedUnsafe(i,e)}multiplyAndAddUnsafe(e,t,r){const n=this.multiplyUnsafe(t).add(e.multiplyUnsafe(r));return n.is0()?void 0:n}toAffine(e){return m(this,e)}isTorsionFree(){const{isTorsionFree:e}=t;return i===Bx||(e?e(b,this):E.wNAFCachedUnsafe(this,o).is0())}clearCofactor(){const{clearCofactor:e}=t;return i===Bx?this:e?e(b,this):this.multiplyUnsafe(i)}toBytes(e=!0){return RE("isCompressed",e),this.assertValidity(),c(b,this,e)}toRawBytes(e=!0){return this.toBytes(e)}toHex(e=!0){return lb(this.toBytes(e))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}b.BASE=new b(e.Gx,e.Gy,r.ONE),b.ZERO=new b(r.ZERO,r.ONE,r.ZERO),b.Fp=r,b.Fn=n;const v=n.BITS,E=function(e,t){return{constTimeNegate:ux,hasPrecomputes:e=>1!==mx(e),unsafeLadder(t,r,n=e.ZERO){let i=t;for(;r>cx;)r&lx&&(n=n.add(i)),i=i.double(),r>>=lx;return n},precomputeWindow(e,r){const{windows:n,windowSize:i}=dx(r,t),o=[];let s=e,a=s;for(let e=0;e<n;e++){a=s,o.push(a);for(let e=1;e<i;e++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(r,n,i){let o=e.ZERO,s=e.BASE;const a=dx(r,t);for(let e=0;e<a.windows;e++){const{nextN:t,offset:r,isZero:c,isNeg:l,isNegF:u,offsetF:h}=fx(i,e,a);i=t,c?s=s.add(ux(u,n[h])):o=o.add(ux(l,n[r]))}return yx(i),{p:o,f:s}},wNAFUnsafe(r,n,i,o=e.ZERO){const s=dx(r,t);for(let e=0;e<s.windows&&i!==cx;e++){const{nextN:t,offset:r,isZero:a,isNeg:c}=fx(i,e,s);if(i=t,!a){const e=n[r];o=o.add(c?e.negate():e)}}return yx(i),o},getPrecomputes(e,t,r){let n=px.get(t);return n||(n=this.precomputeWindow(t,e),1!==e&&("function"==typeof r&&(n=r(n)),px.set(t,n))),n},wNAFCached(e,t,r){const n=mx(e);return this.wNAF(n,this.getPrecomputes(n,e,r),t)},wNAFCachedUnsafe(e,t,r,n){const i=mx(e);return 1===i?this.unsafeLadder(e,t,n):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),t,n)},setWindowSize(e,r){hx(r,t),gx.set(e,r),px.delete(e)}}}(b,t.endo?Math.ceil(v/2):v);return b}function Fx(e){return Uint8Array.of(e?2:3)}function Hx(e,t,r={}){FE(t,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const n=t.randomBytes||xb,i=t.hmac||((e,...r)=>IE(t.hash,e,bb(...r))),{Fp:o,Fn:s}=e,{ORDER:a,BITS:c}=s;function l(e){return e>a>>Bx}function u(e,t){if(!s.isValidNot0(t))throw new Error(`invalid signature ${e}: out of range 1..CURVE.n`)}class h{constructor(e,t,r){u("r",e),u("s",t),this.r=e,this.s=t,null!=r&&(this.recovery=r),Object.freeze(this)}static fromCompact(e){const t=s.BYTES,r=DE("compactSignature",e,2*t);return new h(s.fromBytes(r.subarray(0,t)),s.fromBytes(r.subarray(t,2*t)))}static fromDER(e){const{r:t,s:r}=Nx.toSig(DE("DER",e));return new h(t,r)}assertValidity(){}addRecoveryBit(e){return new h(this.r,this.s,e)}recoverPublicKey(t){const r=o.ORDER,{r:n,s:i,recovery:c}=this;if(null==c||![0,1,2,3].includes(c))throw new Error("recovery id invalid");if(a*Lx<r&&c>1)throw new Error("recovery id is ambiguous for h>1 curve");const l=2===c||3===c?n+a:n;if(!o.isValid(l))throw new Error("recovery id 2 or 3 invalid");const u=o.toBytes(l),h=e.fromHex(bb(Fx(!(1&c)),u)),d=s.inv(l),f=m(DE("msgHash",t)),p=s.create(-f*d),g=s.create(i*d),y=e.BASE.multiplyUnsafe(p).add(h.multiplyUnsafe(g));if(y.is0())throw new Error("point at infinify");return y.assertValidity(),y}hasHighS(){return l(this.s)}normalizeS(){return this.hasHighS()?new h(this.r,s.neg(this.s),this.recovery):this}toBytes(e){if("compact"===e)return bb(s.toBytes(this.r),s.toBytes(this.s));if("der"===e)return yb(Nx.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return lb(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return lb(this.toBytes("compact"))}}const d=Mx(s,r.allowedPrivateKeyLengths,r.wrapPrivateKey),f={isValidPrivateKey(e){try{return d(e),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{const e=a;return function(e,t,r=!1){const n=e.length,i=sx(t),o=ax(t);if(n<16||n<o||n>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+n);const s=YE(r?UE(e):NE(e),t-qE)+qE;return r?LE(s,i):BE(s,i)}(n(ax(e)),e)},precompute:(t=8,r=e.BASE)=>r.precompute(t,!1)};function p(t){if("bigint"==typeof t)return!1;if(t instanceof e)return!0;const n=DE("key",t).length,i=o.BYTES,a=i+1,c=2*i+1;return r.allowedPrivateKeyLengths||s.BYTES===a?void 0:n===a||n===c}const g=t.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");const t=NE(e),r=8*e.length-c;return r>0?t>>BigInt(r):t},m=t.bits2int_modN||function(e){return s.create(g(e))},y=jE(c);function w(e){return ME("num < 2^"+c,e,Ux,y),s.toBytes(e)}function b(r,i,a=v){if(["recovered","canonical"].some(e=>e in a))throw new Error("sign() legacy options not supported");const{hash:c}=t;let{lowS:u,prehash:f,extraEntropy:p}=a;null==u&&(u=!0),r=DE("msgHash",r),Tx(a),f&&(r=DE("prehashed msgHash",c(r)));const y=m(r),b=d(i),E=[w(b),w(y)];if(null!=p&&!1!==p){const e=!0===p?n(o.BYTES):p;E.push(DE("extraEntropy",e))}const x=bb(...E),I=y;return{seed:x,k2sig:function(t){const r=g(t);if(!s.isValidNot0(r))return;const n=s.inv(r),i=e.BASE.multiply(r).toAffine(),o=s.create(i.x);if(o===Ux)return;const a=s.create(n*s.create(I+o*b));if(a===Ux)return;let c=(i.x===o?0:2)|Number(i.y&Bx),d=a;return u&&l(a)&&(d=function(e){return l(e)?s.neg(e):e}(a),c^=1),new h(o,d,c)}}}const v={lowS:t.lowS,prehash:!1},E={lowS:t.lowS,prehash:!1};return e.BASE.precompute(8),Object.freeze({getPublicKey:function(t,r=!0){return e.fromPrivateKey(t).toBytes(r)},getSharedSecret:function(t,r,n=!0){if(!0===p(t))throw new Error("first arg must be private key");if(!1===p(r))throw new Error("second arg must be public key");return e.fromHex(r).multiply(d(t)).toBytes(n)},sign:function(e,r,n=v){const{seed:o,k2sig:a}=b(e,r,n);return function(e,t,r){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof r)throw new Error("hmacFn must be a function");const n=e=>new Uint8Array(e),i=e=>Uint8Array.of(e);let o=n(e),s=n(e),a=0;const c=()=>{o.fill(1),s.fill(0),a=0},l=(...e)=>r(s,o,...e),u=(e=n(0))=>{s=l(i(0),e),o=l(),0!==e.length&&(s=l(i(1),e),o=l())},h=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const r=[];for(;e<t;){o=l();const t=o.slice();r.push(t),e+=o.length}return bb(...r)};return(e,t)=>{let r;for(c(),u(e);!(r=t(h()));)u();return c(),r}}(t.hash.outputLen,s.BYTES,i)(o,a)},verify:function(r,n,i,o=E){const a=r;n=DE("msgHash",n),i=DE("publicKey",i),Tx(o);const{lowS:c,prehash:l,format:u}=o;if("strict"in o)throw new Error("options.strict was renamed to lowS");if(void 0!==u&&!["compact","der","js"].includes(u))throw new Error('format must be "compact", "der" or "js"');const d="string"==typeof a||Kw(a),f=!d&&!u&&"object"==typeof a&&null!==a&&"bigint"==typeof a.r&&"bigint"==typeof a.s;if(!d&&!f)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let p,g;try{if(f){if(void 0!==u&&"js"!==u)throw new Error("invalid format");p=new h(a.r,a.s)}if(d){try{"compact"!==u&&(p=h.fromDER(a))}catch(e){if(!(e instanceof Nx.Err))throw e}!p&&"der"!==u&&(p=h.fromCompact(a))}g=e.fromHex(i)}catch{return!1}if(!p||c&&p.hasHighS())return!1;l&&(n=t.hash(n));const{r:y,s:w}=p,b=m(n),v=s.inv(w),x=s.create(b*v),I=s.create(y*v),_=e.BASE.multiplyUnsafe(x).add(g.multiplyUnsafe(I));return!_.is0()&&s.create(_.x)===y},utils:f,Point:e,Signature:h})}function zx(e){const{CURVE:t,curveOpts:r}=function(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy};return{CURVE:t,curveOpts:{Fp:e.Fp,Fn:ox(t.n,e.nBitLength),allowedPrivateKeyLengths:e.allowedPrivateKeyLengths,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,wrapPrivateKey:e.wrapPrivateKey,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes}}}(e);return{CURVE:t,curveOpts:r,ecdsaOpts:{hash:e.hash,hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN}}}function qx(e){const{CURVE:t,curveOpts:r,ecdsaOpts:n}=zx(e);return function(e,t){return Object.assign({},t,{ProjectivePoint:t.Point,CURVE:e})}(e,Hx(jx(t,r),n,r))}function Wx(e,t){const r=t=>qx({...e,hash:t});return{...r(t),create:r}}const Vx={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},Kx={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},Gx={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},Zx=ox(Vx.p),Yx=ox(Kx.p),Jx=ox(Gx.p),Xx=Wx({...Vx,Fp:Zx,lowS:!1},nv);Wx({...Kx,Fp:Yx,lowS:!1},ov),Wx({...Gx,Fp:Jx,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},iv);const Qx=Xx,eI="base10",tI="base16",rI="base64pad",nI="base64url",iI="utf8";function oI(){return iy(xb(32),tI)}function sI(e){return iy(OE(ny(e,tI)),tI)}function aI(e){return iy(OE(ny(e,iI)),tI)}function cI(e){return ny(`${e}`,eI)}function lI(e){return Number(iy(e,eI))}function uI(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function hI(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),r=(4-t.length%4)%4;return t+"=".repeat(r)}function dI(e){if(2===lI(e.type))return iy(im([e.type,e.sealed]),rI);if(1===lI(e.type)){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return iy(im([e.type,e.senderPublicKey,e.iv,e.sealed]),rI)}return iy(im([e.type,e.iv,e.sealed]),rI)}function fI(e){const t=ny((e.encoding||rI)===nI?hI(e.encoded):e.encoded,rI),r=t.slice(0,1);if(1===lI(r)){const e=33,n=e+12,i=t.slice(1,e),o=t.slice(e,n);return{type:r,sealed:t.slice(n),iv:o,senderPublicKey:i}}if(2===lI(r)){return{type:r,sealed:t.slice(1),iv:xb(12)}}const n=t.slice(1,13);return{type:r,sealed:t.slice(13),iv:n}}function pI(e){const t=e?.type||0;if(1===t){if(typeof e?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function gI(e){return 1===e.type&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}function mI(e){return 2===e.type}function yI(e,t){const[r,n,i]=e.split("."),o=Buffer.from(hI(i),"base64");if(64!==o.length)throw new Error("Invalid signature length");const s=o.slice(0,32),a=o.slice(32,64),c=OE(`${r}.${n}`),l=function(e){const t=Buffer.from(e.x,"base64"),r=Buffer.from(e.y,"base64");return im([new Uint8Array([4]),t,r])}(t);if(!Qx.verify(im([s,a]),c,l))throw new Error("Invalid signature");return Qg(e).payload}function wI(e){return e?.relay||{protocol:"irn"}}function bI(e){const t=oy[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}function vI(e,t="-"){const r={},n="relay"+t;return Object.keys(e).forEach(t=>{if(t.startsWith(n)){const i=t.replace(n,""),o=e[t];r[i]=o}}),r}function EI(e){if(!e.includes("wc:")){const t=Sw(e);null!=t&&t.includes("wc:")&&(e=t)}const t=(e=(e=e.includes("wc://")?e.replace("wc://",""):e).includes("wc:")?e.replace("wc:",""):e).indexOf(":"),r=-1!==e.indexOf("?")?e.indexOf("?"):void 0,n=e.substring(0,t),i=e.substring(t+1,r).split("@"),o=typeof r<"u"?e.substring(r):"",s=new URLSearchParams(o),a={};s.forEach((e,t)=>{a[t]=e});const c="string"==typeof a.methods?a.methods.split(","):void 0;return{protocol:n,topic:xI(i[0]),version:parseInt(i[1],10),symKey:a.symKey,relay:vI(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function xI(e){return e.startsWith("//")?e.substring(2):e}function II(e){const t=new URLSearchParams,r=function(e,t="-"){const r={};return Object.keys(e).forEach(n=>{const i=n,o="relay"+t+i;e[i]&&(r[o]=e[i])}),r}(e.relay);Object.keys(r).sort().forEach(e=>{t.set(e,r[e])}),t.set("symKey",e.symKey),e.expiryTimestamp&&t.set("expiryTimestamp",e.expiryTimestamp.toString()),e.methods&&t.set("methods",e.methods.join(","));const n=t.toString();return`${e.protocol}:${e.topic}@${e.version}?${n}`}function _I(e,t,r){return`${e}?wc_ev=${r}&topic=${t}`}var SI=Object.defineProperty,AI=Object.defineProperties,OI=Object.getOwnPropertyDescriptors,CI=Object.getOwnPropertySymbols,PI=Object.prototype.hasOwnProperty,RI=Object.prototype.propertyIsEnumerable,TI=(e,t,r)=>t in e?SI(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,kI=(e,t)=>{for(var r in t||(t={}))PI.call(t,r)&&TI(e,r,t[r]);if(CI)for(var r of CI(t))RI.call(t,r)&&TI(e,r,t[r]);return e},NI=(e,t)=>AI(e,OI(t));function UI(e){const t=[];return e.forEach(e=>{const[r,n]=e.split(":");t.push(`${r}:${n}`)}),t}function BI(e){return e.includes(":")}function LI(e){return BI(e)?e.split(":")[0]:e}function DI(e){var t,r,n;const i={};if(!qI(e))return i;for(const[o,s]of Object.entries(e)){const e=BI(o)?[o]:s.chains,a=s.methods||[],c=s.events||[],l=LI(o);i[l]=NI(kI({},i[l]),{chains:vw(e,null==(t=i[l])?void 0:t.chains),methods:vw(a,null==(r=i[l])?void 0:r.methods),events:vw(c,null==(n=i[l])?void 0:n.events)})}return i}function $I(e,t){t=t.map(e=>e.replace("did:pkh:",""));const r=function(e){const t={};return e?.forEach(e=>{var r;const[n,i]=e.split(":");t[n]||(t[n]={accounts:[],chains:[],events:[],methods:[]}),t[n].accounts.push(e),null==(r=t[n].chains)||r.push(`${n}:${i}`)}),t}(t);for(const[t,n]of Object.entries(r))n.methods?n.methods=vw(n.methods,e):n.methods=e,n.events=["chainChanged","accountsChanged"];return r}const MI={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},jI={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function FI(e,t){const{message:r,code:n}=jI[e];return{message:t?`${r} ${t}`:r,code:n}}function HI(e,t){const{message:r,code:n}=MI[e];return{message:t?`${r} ${t}`:r,code:n}}function zI(e,t){return!!Array.isArray(e)}function qI(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function WI(e){return typeof e>"u"}function VI(e,t){return!(!t||!WI(e))||"string"==typeof e&&!!e.trim().length}function KI(e,t){return!(!t||!WI(e))||"number"==typeof e&&!isNaN(e)}function GI(e){return!(!VI(e,!1)||!e.includes(":"))&&2===e.split(":").length}function ZI(e){let t=!0;return zI(e)?e.length&&(t=e.every(e=>VI(e,!1))):t=!1,t}function YI(e,t,r){let n=null;return Object.entries(e).forEach(([e,i])=>{if(n)return;const o=function(e,t,r){let n=null;return zI(t)&&t.length?t.forEach(e=>{n||GI(e)||(n=HI("UNSUPPORTED_CHAINS",`${r}, chain ${e} should be a string and conform to "namespace:chainId" format`))}):GI(e)||(n=HI("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}(e,jy(e,i),`${t} ${r}`);o&&(n=o)}),n}function JI(e,t){let r=null;return zI(e)?e.forEach(e=>{r||function(e){if(VI(e,!1)&&e.includes(":")){const t=e.split(":");if(3===t.length){const e=t[0]+":"+t[1];return!!t[2]&&GI(e)}}return!1}(e)||(r=HI("UNSUPPORTED_ACCOUNTS",`${t}, account ${e} should be a string and conform to "namespace:chainId:address" format`))}):r=HI("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function XI(e,t){let r=null;return Object.values(e).forEach(e=>{if(r)return;const n=function(e,t){let r=null;return ZI(e?.methods)?ZI(e?.events)||(r=HI("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=HI("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}(e,`${t}, namespace`);n&&(r=n)}),r}function QI(e,t){let r=null;if(e&&qI(e)){const n=XI(e,t);n&&(r=n);const i=function(e,t){let r=null;return Object.values(e).forEach(e=>{if(r)return;const n=JI(e?.accounts,`${t} namespace`);n&&(r=n)}),r}(e,t);i&&(r=i)}else r=FI("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function e_(e){return VI(e.protocol,!0)}function t_(e){return typeof e<"u"&&null!==typeof e}function r_(e,t){return!(!GI(t)||!function(e){const t=[];return Object.values(e).forEach(e=>{t.push(...UI(e.accounts))}),t}(e).includes(t))}function n_(e,t,r){return!!VI(r,!1)&&function(e,t){const r=[];return Object.values(e).forEach(e=>{UI(e.accounts).includes(t)&&r.push(...e.methods)}),r}(e,t).includes(r)}function i_(e,t,r){return!!VI(r,!1)&&function(e,t){const r=[];return Object.values(e).forEach(e=>{UI(e.accounts).includes(t)&&r.push(...e.events)}),r}(e,t).includes(r)}function o_(e,t,r){let n=null;const i=function(e){const t={};return Object.keys(e).forEach(r=>{var n;r.includes(":")?t[r]=e[r]:null==(n=e[r].chains)||n.forEach(n=>{t[n]={methods:e[r].methods,events:e[r].events}})}),t}(e),o=function(e){const t={};return Object.keys(e).forEach(r=>{if(r.includes(":"))t[r]=e[r];else{const n=UI(e[r].accounts);n?.forEach(n=>{t[n]={accounts:e[r].accounts.filter(e=>e.includes(`${n}:`)),methods:e[r].methods,events:e[r].events}})}}),t}(t),s=Object.keys(i),a=Object.keys(o),c=s_(Object.keys(e)),l=s_(Object.keys(t)),u=c.filter(e=>!l.includes(e));return u.length&&(n=FI("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.\n      Required: ${u.toString()}\n      Received: ${Object.keys(t).toString()}`)),uw(s,a)||(n=FI("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.\n      Required: ${s.toString()}\n      Approved: ${a.toString()}`)),Object.keys(t).forEach(e=>{if(!e.includes(":")||n)return;const i=UI(t[e].accounts);i.includes(e)||(n=FI("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${e}\n        Required: ${e}\n        Approved: ${i.toString()}`))}),s.forEach(e=>{n||(uw(i[e].methods,o[e].methods)?uw(i[e].events,o[e].events)||(n=FI("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${e}`)):n=FI("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${e}`))}),n}function s_(e){return[...new Set(e.map(e=>e.includes(":")?e.split(":")[0]:e))]}function a_(){const e=iw();return new Promise(t=>{switch(e){case Xy:t(nw()&&navigator?.onLine);break;case Yy:t(async function(){if(rw()&&typeof global<"u"&&null!=global&&global.NetInfo){const e=await(null==global?void 0:global.NetInfo.fetch());return e?.isConnected}return!0}());break;default:t(!0)}})}function c_(e){switch(iw()){case Xy:!function(e){!rw()&&nw()&&(window.addEventListener("online",()=>e(!0)),window.addEventListener("offline",()=>e(!1)))}(e);break;case Yy:!function(e){rw()&&typeof global<"u"&&null!=global&&global.NetInfo&&global?.NetInfo.addEventListener(t=>e(t?.isConnected))}(e)}}const l_={};class u_{static get(e){return l_[e]}static set(e,t){l_[e]=t}static delete(e){delete l_[e]}}function h_({publicKey:e,signature:t,payload:r}){var n;const i=d_(r.method),o=128|parseInt((null==(n=r.version)?void 0:n.toString())||"4"),s=function(e){const t=Wh.decode(e)[0];return 42===t?0:60===t?2:1}(r.address),a="00"===r.era?new Uint8Array([0]):d_(r.era);if(1!==a.length&&2!==a.length)throw new Error("Invalid era length");const c=parseInt(r.nonce,16),l=new Uint8Array([255&c,c>>8&255]),u=BigInt(`0x${function(e){return e.startsWith("0x")?e.slice(2):e}(r.tip)}`),h=function(e){if(e<BigInt(1)<<BigInt(6))return new Uint8Array([Number(e<<BigInt(2))]);if(e<BigInt(1)<<BigInt(14)){const t=e<<BigInt(2)|BigInt(1);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255))])}if(e<BigInt(1)<<BigInt(30)){const t=e<<BigInt(2)|BigInt(2);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255)),Number(t>>BigInt(16)&BigInt(255)),Number(t>>BigInt(24)&BigInt(255))])}throw new Error("BigInt compact encoding not supported > 2^30")}(u),d=new Uint8Array([0,...e,s,...t,...a,...l,...h,...i]),f=function(e){if(e<64)return new Uint8Array([e<<2]);if(e<16384){const t=e<<2|1;return new Uint8Array([255&t,t>>8&255])}if(e<1<<30){const t=e<<2|2;return new Uint8Array([255&t,t>>8&255,t>>16&255,t>>24&255])}throw new Error("Compact encoding > 2^30 not supported")}(d.length+1);return new Uint8Array([...f,o,...d])}function d_(e){return new Uint8Array(e.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function f_(e){const t=Uint8Array.from(Buffer.from(e.signature,"hex")),r=function(e){const t=Wh.decode(e);if(t.length<33)throw new Error("Too short to contain a public key");return t.slice(1,33)}(e.transaction.address),n=h_({publicKey:r,signature:t,payload:e.transaction});return function(e){const t=d_(e),r=$y.blake2b(t,void 0,32);return"0x"+Buffer.from(r).toString("hex")}(Buffer.from(n).toString("hex"))}var p_,g_,m_,y_,w_,b_,v_,E_,x_,I_,__,S_={},A_=[],O_=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,C_=Array.isArray;function P_(e,t){for(var r in t)e[r]=t[r];return e}function R_(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function T_(e,t,r,n,i){var o={type:e,props:t,key:r,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==i?++m_:i,__i:-1,__u:0};return null==i&&null!=g_.vnode&&g_.vnode(o),o}function k_(e){return e.children}function N_(e,t){this.props=e,this.context=t}function U_(e,t){if(null==t)return e.__?U_(e.__,e.__i+1):null;for(var r;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e)return r.__e;return"function"==typeof e.type?U_(e):null}function B_(e){var t,r;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e){e.__e=e.__c.base=r.__e;break}return B_(e)}}function L_(e){(!e.__d&&(e.__d=!0)&&y_.push(e)&&!D_.__r++||w_!=g_.debounceRendering)&&((w_=g_.debounceRendering)||b_)(D_)}function D_(){for(var e,t,r,n,i,o,s,a=1;y_.length;)y_.length>a&&y_.sort(v_),e=y_.shift(),a=y_.length,e.__d&&(r=void 0,i=(n=(t=e).__v).__e,o=[],s=[],t.__P&&((r=P_({},n)).__v=n.__v+1,g_.vnode&&g_.vnode(r),q_(t.__P,r,n,t.__n,t.__P.namespaceURI,32&n.__u?[i]:null,o,null==i?U_(n):i,!!(32&n.__u),s),r.__v=n.__v,r.__.__k[r.__i]=r,V_(o,r,s),r.__e!=i&&B_(r)));D_.__r=0}function $_(e,t,r,n,i,o,s,a,c,l,u){var h,d,f,p,g,m,y,w=n&&n.__k||A_,b=t.length;for(c=function(e,t,r,n,i){var o,s,a,c,l,u=r.length,h=u,d=0;for(e.__k=new Array(i),o=0;o<i;o++)null!=(s=t[o])&&"boolean"!=typeof s&&"function"!=typeof s?(c=o+d,(s=e.__k[o]="string"==typeof s||"number"==typeof s||"bigint"==typeof s||s.constructor==String?T_(null,s,null,null,null):C_(s)?T_(k_,{children:s},null,null,null):null==s.constructor&&s.__b>0?T_(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):s).__=e,s.__b=e.__b+1,a=null,-1!=(l=s.__i=j_(s,r,c,h))&&(h--,(a=r[l])&&(a.__u|=2)),null==a||null==a.__v?(-1==l&&(i>u?d--:i<u&&d++),"function"!=typeof s.type&&(s.__u|=4)):l!=c&&(l==c-1?d--:l==c+1?d++:(l>c?d--:d++,s.__u|=4))):e.__k[o]=null;if(h)for(o=0;o<u;o++)null!=(a=r[o])&&!(2&a.__u)&&(a.__e==n&&(n=U_(a)),Z_(a,a));return n}(r,t,w,c,b),h=0;h<b;h++)null!=(f=r.__k[h])&&(d=-1==f.__i?S_:w[f.__i]||S_,f.__i=h,m=q_(e,f,d,i,o,s,a,c,l,u),p=f.__e,f.ref&&d.ref!=f.ref&&(d.ref&&G_(d.ref,null,f),u.push(f.ref,f.__c||p,f)),null==g&&null!=p&&(g=p),(y=!!(4&f.__u))||d.__k===f.__k?c=M_(f,c,e,y):"function"==typeof f.type&&void 0!==m?c=m:p&&(c=p.nextSibling),f.__u&=-7);return r.__e=g,c}function M_(e,t,r,n){var i,o;if("function"==typeof e.type){for(i=e.__k,o=0;i&&o<i.length;o++)i[o]&&(i[o].__=e,t=M_(i[o],t,r,n));return t}e.__e!=t&&(n&&(t&&e.type&&!t.parentNode&&(t=U_(e)),r.insertBefore(e.__e,t||null)),t=e.__e);do{t=t&&t.nextSibling}while(null!=t&&8==t.nodeType);return t}function j_(e,t,r,n){var i,o,s,a=e.key,c=e.type,l=t[r],u=null!=l&&!(2&l.__u);if(null===l&&null==e.key||u&&a==l.key&&c==l.type)return r;if(n>(u?1:0))for(i=r-1,o=r+1;i>=0||o<t.length;)if(null!=(l=t[s=i>=0?i--:o++])&&!(2&l.__u)&&a==l.key&&c==l.type)return s;return-1}function F_(e,t,r){"-"==t[0]?e.setProperty(t,null==r?"":r):e[t]=null==r?"":"number"!=typeof r||O_.test(t)?r:r+"px"}function H_(e,t,r,n,i){var o,s;e:if("style"==t)if("string"==typeof r)e.style.cssText=r;else{if("string"==typeof n&&(e.style.cssText=n=""),n)for(t in n)r&&t in r||F_(e.style,t,"");if(r)for(t in r)n&&r[t]==n[t]||F_(e.style,t,r[t])}else if("o"==t[0]&&"n"==t[1])o=t!=(t=t.replace(E_,"$1")),s=t.toLowerCase(),t=s in e||"onFocusOut"==t||"onFocusIn"==t?s.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=r,r?n?r.u=n.u:(r.u=x_,e.addEventListener(t,o?__:I_,o)):e.removeEventListener(t,o?__:I_,o);else{if("http://www.w3.org/2000/svg"==i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!=t&&"list"!=t&&"form"!=t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&"popover"!=t&&t in e)try{e[t]=null==r?"":r;break e}catch(e){}"function"==typeof r||(null==r||!1===r&&"-"!=t[4]?e.removeAttribute(t):e.setAttribute(t,"popover"==t&&1==r?"":r))}}function z_(e){return function(t){if(this.l){var r=this.l[t.type+e];if(null==t.t)t.t=x_++;else if(t.t<r.u)return;return r(g_.event?g_.event(t):t)}}}function q_(e,t,r,n,i,o,s,a,c,l){var u,h,d,f,p,g,m,y,w,b,v,E,x,I,_,S,A,O=t.type;if(null!=t.constructor)return null;128&r.__u&&(c=!!(32&r.__u),o=[a=t.__e=r.__e]),(u=g_.__b)&&u(t);e:if("function"==typeof O)try{if(y=t.props,w="prototype"in O&&O.prototype.render,b=(u=O.contextType)&&n[u.__c],v=u?b?b.props.value:u.__:n,r.__c?m=(h=t.__c=r.__c).__=h.__E:(w?t.__c=h=new O(y,v):(t.__c=h=new N_(y,v),h.constructor=O,h.render=Y_),b&&b.sub(h),h.props=y,h.state||(h.state={}),h.context=v,h.__n=n,d=h.__d=!0,h.__h=[],h._sb=[]),w&&null==h.__s&&(h.__s=h.state),w&&null!=O.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=P_({},h.__s)),P_(h.__s,O.getDerivedStateFromProps(y,h.__s))),f=h.props,p=h.state,h.__v=t,d)w&&null==O.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),w&&null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(w&&null==O.getDerivedStateFromProps&&y!==f&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(y,v),!h.__e&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(y,h.__s,v)||t.__v==r.__v){for(t.__v!=r.__v&&(h.props=y,h.state=h.__s,h.__d=!1),t.__e=r.__e,t.__k=r.__k,t.__k.some(function(e){e&&(e.__=t)}),E=0;E<h._sb.length;E++)h.__h.push(h._sb[E]);h._sb=[],h.__h.length&&s.push(h);break e}null!=h.componentWillUpdate&&h.componentWillUpdate(y,h.__s,v),w&&null!=h.componentDidUpdate&&h.__h.push(function(){h.componentDidUpdate(f,p,g)})}if(h.context=v,h.props=y,h.__P=e,h.__e=!1,x=g_.__r,I=0,w){for(h.state=h.__s,h.__d=!1,x&&x(t),u=h.render(h.props,h.state,h.context),_=0;_<h._sb.length;_++)h.__h.push(h._sb[_]);h._sb=[]}else do{h.__d=!1,x&&x(t),u=h.render(h.props,h.state,h.context),h.state=h.__s}while(h.__d&&++I<25);h.state=h.__s,null!=h.getChildContext&&(n=P_(P_({},n),h.getChildContext())),w&&!d&&null!=h.getSnapshotBeforeUpdate&&(g=h.getSnapshotBeforeUpdate(f,p)),S=u,null!=u&&u.type===k_&&null==u.key&&(S=K_(u.props.children)),a=$_(e,C_(S)?S:[S],t,r,n,i,o,s,a,c,l),h.base=t.__e,t.__u&=-161,h.__h.length&&s.push(h),m&&(h.__E=h.__=null)}catch(e){if(t.__v=null,c||null!=o)if(e.then){for(t.__u|=c?160:128;a&&8==a.nodeType&&a.nextSibling;)a=a.nextSibling;o[o.indexOf(a)]=null,t.__e=a}else{for(A=o.length;A--;)R_(o[A]);W_(t)}else t.__e=r.__e,t.__k=r.__k,e.then||W_(t);g_.__e(e,t,r)}else null==o&&t.__v==r.__v?(t.__k=r.__k,t.__e=r.__e):a=t.__e=function(e,t,r,n,i,o,s,a,c){var l,u,h,d,f,p,g,m=r.props,y=t.props,w=t.type;if("svg"==w?i="http://www.w3.org/2000/svg":"math"==w?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),null!=o)for(l=0;l<o.length;l++)if((f=o[l])&&"setAttribute"in f==!!w&&(w?f.localName==w:3==f.nodeType)){e=f,o[l]=null;break}if(null==e){if(null==w)return document.createTextNode(y);e=document.createElementNS(i,w,y.is&&y),a&&(g_.__m&&g_.__m(t,o),a=!1),o=null}if(null==w)m===y||a&&e.data==y||(e.data=y);else{if(o=o&&p_.call(e.childNodes),m=r.props||S_,!a&&null!=o)for(m={},l=0;l<e.attributes.length;l++)m[(f=e.attributes[l]).name]=f.value;for(l in m)if(f=m[l],"children"==l);else if("dangerouslySetInnerHTML"==l)h=f;else if(!(l in y)){if("value"==l&&"defaultValue"in y||"checked"==l&&"defaultChecked"in y)continue;H_(e,l,null,f,i)}for(l in y)f=y[l],"children"==l?d=f:"dangerouslySetInnerHTML"==l?u=f:"value"==l?p=f:"checked"==l?g=f:a&&"function"!=typeof f||m[l]===f||H_(e,l,f,m[l],i);if(u)a||h&&(u.__html==h.__html||u.__html==e.innerHTML)||(e.innerHTML=u.__html),t.__k=[];else if(h&&(e.innerHTML=""),$_("template"==t.type?e.content:e,C_(d)?d:[d],t,r,n,"foreignObject"==w?"http://www.w3.org/1999/xhtml":i,o,s,o?o[0]:r.__k&&U_(r,0),a,c),null!=o)for(l=o.length;l--;)R_(o[l]);a||(l="value","progress"==w&&null==p?e.removeAttribute("value"):null!=p&&(p!==e[l]||"progress"==w&&!p||"option"==w&&p!=m[l])&&H_(e,l,p,m[l],i),l="checked",null!=g&&g!=e[l]&&H_(e,l,g,m[l],i))}return e}(r.__e,t,r,n,i,o,s,c,l);return(u=g_.diffed)&&u(t),128&t.__u?void 0:a}function W_(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(W_)}function V_(e,t,r){for(var n=0;n<r.length;n++)G_(r[n],r[++n],r[++n]);g_.__c&&g_.__c(t,e),e.some(function(t){try{e=t.__h,t.__h=[],e.some(function(e){e.call(t)})}catch(e){g_.__e(e,t.__v)}})}function K_(e){return"object"!=typeof e||null==e||e.__b&&e.__b>0?e:C_(e)?e.map(K_):P_({},e)}function G_(e,t,r){try{if("function"==typeof e){var n="function"==typeof e.__u;n&&e.__u(),n&&null==t||(e.__u=e(t))}else e.current=t}catch(e){g_.__e(e,r)}}function Z_(e,t,r){var n,i;if(g_.unmount&&g_.unmount(e),(n=e.ref)&&(n.current&&n.current!=e.__e||G_(n,null,t)),null!=(n=e.__c)){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(e){g_.__e(e,t)}n.base=n.__P=null}if(n=e.__k)for(i=0;i<n.length;i++)n[i]&&Z_(n[i],t,r||"function"!=typeof e.type);r||R_(e.__e),e.__c=e.__=e.__e=void 0}function Y_(e,t,r){return this.constructor(e,r)}function J_(e,t,r){var n,i,o;t==document&&(t=document.documentElement),g_.__&&g_.__(e,t),n=!1?null:t.__k,i=[],o=[],q_(t,e=t.__k=function(e,t,r){var n,i,o,s={};for(o in t)"key"==o?n=t[o]:"ref"==o?i=t[o]:s[o]=t[o];if(arguments.length>2&&(s.children=arguments.length>3?p_.call(arguments,2):r),"function"==typeof e&&null!=e.defaultProps)for(o in e.defaultProps)void 0===s[o]&&(s[o]=e.defaultProps[o]);return T_(e,s,n,i,null)}(k_,null,[e]),n||S_,S_,t.namespaceURI,n?null:t.firstChild?p_.call(t.childNodes):null,i,n?n.__e:t.firstChild,false,o),V_(i,e,o)}p_=A_.slice,g_={__e:function(e,t,r,n){for(var i,o,s;t=t.__;)if((i=t.__c)&&!i.__)try{if((o=i.constructor)&&null!=o.getDerivedStateFromError&&(i.setState(o.getDerivedStateFromError(e)),s=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(e,n||{}),s=i.__d),s)return i.__E=i}catch(t){e=t}throw e}},m_=0,N_.prototype.setState=function(e,t){var r;r=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=P_({},this.state),"function"==typeof e&&(e=e(P_({},r),this.props)),e&&P_(r,e),null!=e&&this.__v&&(t&&this._sb.push(t),L_(this))},N_.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),L_(this))},N_.prototype.render=k_,y_=[],b_="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,v_=function(e,t){return e.__v.__b-t.__v.__b},D_.__r=0,E_=/(PointerCapture)$|Capture$/i,x_=0,I_=z_(!1),__=z_(!0);var X_=0;function Q_(e,t,r,n,i,o){t||(t={});var s,a,c=t;if("ref"in c)for(a in c={},t)"ref"==a?s=t[a]:c[a]=t[a];var l={type:e,props:c,key:r,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--X_,__i:-1,__u:0,__source:i,__self:o};if("function"==typeof e&&(s=e.defaultProps))for(a in s)void 0===c[a]&&(c[a]=s[a]);return g_.vnode&&g_.vnode(l),l}class eS{}let tS=class extends eS{constructor(e){super()}};const rS=dc.FIVE_SECONDS,nS="heartbeat_pulse";let iS=class e extends tS{constructor(e){super(e),this.events=new Ke.EventEmitter,this.interval=rS,this.interval=e?.interval||rS}static async init(t){const r=new e(t);return await r.init(),r}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),dc.toMiliseconds(this.interval))}pulse(){this.events.emit(nS)}};const oS=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,sS=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,aS=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function cS(e,t){if(!("__proto__"===e||"constructor"===e&&t&&"object"==typeof t&&"prototype"in t))return t;!function(e){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`)}(e)}function lS(e,t={}){if("string"!=typeof e)return e;if('"'===e[0]&&'"'===e[e.length-1]&&-1===e.indexOf("\\"))return e.slice(1,-1);const r=e.trim();if(r.length<=9)switch(r.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!aS.test(e)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(oS.test(e)||sS.test(e)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,cS)}return JSON.parse(e)}catch(r){if(t.strict)throw r;return e}}function uS(e,...t){try{return(r=e(...t))&&"function"==typeof r.then?r:Promise.resolve(r)}catch(e){return Promise.reject(e)}var r}function hS(e){if(function(e){const t=typeof e;return null===e||"object"!==t&&"function"!==t}(e))return String(e);if(function(e){const t=Object.getPrototypeOf(e);return!t||t.isPrototypeOf(Object)}(e)||Array.isArray(e))return JSON.stringify(e);if("function"==typeof e.toJSON)return hS(e.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const dS="base64:";function fS(e){return"string"==typeof e?e:dS+function(e){if(globalThis.Buffer)return Buffer.from(e).toString("base64");return globalThis.btoa(String.fromCodePoint(...e))}(e)}function pS(e){return"string"!=typeof e?e:e.startsWith(dS)?function(e){if(globalThis.Buffer)return Buffer.from(e,"base64");return Uint8Array.from(globalThis.atob(e),e=>e.codePointAt(0))}(e.slice(7)):e}function gS(e){return e&&e.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function mS(...e){return gS(e.join(":"))}function yS(e){return(e=gS(e))?e+":":""}const wS=()=>{const e=new Map;return{name:"memory",getInstance:()=>e,hasItem:t=>e.has(t),getItem:t=>e.get(t)??null,getItemRaw:t=>e.get(t)??null,setItem(t,r){e.set(t,r)},setItemRaw(t,r){e.set(t,r)},removeItem(t){e.delete(t)},getKeys:()=>[...e.keys()],clear(){e.clear()},dispose(){e.clear()}}};function bS(e={}){const t={mounts:{"":e.driver||wS()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=e=>{for(const r of t.mountpoints)if(e.startsWith(r))return{base:r,relativeKey:e.slice(r.length),driver:t.mounts[r]};return{base:"",relativeKey:e,driver:t.mounts[""]}},n=(e,r)=>t.mountpoints.filter(t=>t.startsWith(e)||r&&e.startsWith(t)).map(r=>({relativeBase:e.length>r.length?e.slice(r.length):void 0,mountpoint:r,driver:t.mounts[r]})),i=(e,r)=>{if(t.watching){r=gS(r);for(const n of t.watchListeners)n(e,r)}},o=async()=>{if(t.watching){for(const e in t.unwatch)await t.unwatch[e]();t.unwatch={},t.watching=!1}},s=(e,t,n)=>{const i=new Map,o=e=>{let t=i.get(e.base);return t||(t={driver:e.driver,base:e.base,items:[]},i.set(e.base,t)),t};for(const n of e){const e="string"==typeof n,i=gS(e?n:n.key),s=e?void 0:n.value,a=e||!n.options?t:{...t,...n.options},c=r(i);o(c).items.push({key:i,value:s,relativeKey:c.relativeKey,options:a})}return Promise.all([...i.values()].map(e=>n(e))).then(e=>e.flat())},a={hasItem(e,t={}){e=gS(e);const{relativeKey:n,driver:i}=r(e);return uS(i.hasItem,n,t)},getItem(e,t={}){e=gS(e);const{relativeKey:n,driver:i}=r(e);return uS(i.getItem,n,t).then(e=>lS(e))},getItems:(e,t={})=>s(e,t,e=>e.driver.getItems?uS(e.driver.getItems,e.items.map(e=>({key:e.relativeKey,options:e.options})),t).then(t=>t.map(t=>({key:mS(e.base,t.key),value:lS(t.value)}))):Promise.all(e.items.map(t=>uS(e.driver.getItem,t.relativeKey,t.options).then(e=>({key:t.key,value:lS(e)}))))),getItemRaw(e,t={}){e=gS(e);const{relativeKey:n,driver:i}=r(e);return i.getItemRaw?uS(i.getItemRaw,n,t):uS(i.getItem,n,t).then(e=>pS(e))},async setItem(e,t,n={}){if(void 0===t)return a.removeItem(e);e=gS(e);const{relativeKey:o,driver:s}=r(e);s.setItem&&(await uS(s.setItem,o,hS(t),n),s.watch||i("update",e))},async setItems(e,t){await s(e,t,async e=>{if(e.driver.setItems)return uS(e.driver.setItems,e.items.map(e=>({key:e.relativeKey,value:hS(e.value),options:e.options})),t);e.driver.setItem&&await Promise.all(e.items.map(t=>uS(e.driver.setItem,t.relativeKey,hS(t.value),t.options)))})},async setItemRaw(e,t,n={}){if(void 0===t)return a.removeItem(e,n);e=gS(e);const{relativeKey:o,driver:s}=r(e);if(s.setItemRaw)await uS(s.setItemRaw,o,t,n);else{if(!s.setItem)return;await uS(s.setItem,o,fS(t),n)}s.watch||i("update",e)},async removeItem(e,t={}){"boolean"==typeof t&&(t={removeMeta:t}),e=gS(e);const{relativeKey:n,driver:o}=r(e);o.removeItem&&(await uS(o.removeItem,n,t),(t.removeMeta||t.removeMata)&&await uS(o.removeItem,n+"$",t),o.watch||i("remove",e))},async getMeta(e,t={}){"boolean"==typeof t&&(t={nativeOnly:t}),e=gS(e);const{relativeKey:n,driver:i}=r(e),o=Object.create(null);if(i.getMeta&&Object.assign(o,await uS(i.getMeta,n,t)),!t.nativeOnly){const e=await uS(i.getItem,n+"$",t).then(e=>lS(e));e&&"object"==typeof e&&("string"==typeof e.atime&&(e.atime=new Date(e.atime)),"string"==typeof e.mtime&&(e.mtime=new Date(e.mtime)),Object.assign(o,e))}return o},setMeta(e,t,r={}){return this.setItem(e+"$",t,r)},removeMeta(e,t={}){return this.removeItem(e+"$",t)},async getKeys(e,t={}){e=yS(e);const r=n(e,!0);let i=[];const o=[];let s=!0;for(const e of r){e.driver.flags?.maxDepth||(s=!1);const r=await uS(e.driver.getKeys,e.relativeBase,t);for(const t of r){const r=e.mountpoint+gS(t);i.some(e=>r.startsWith(e))||o.push(r)}i=[e.mountpoint,...i.filter(t=>!t.startsWith(e.mountpoint))]}const a=void 0!==t.maxDepth&&!s;return o.filter(r=>(!a||function(e,t){if(void 0===t)return!0;let r=0,n=e.indexOf(":");for(;n>-1;)r++,n=e.indexOf(":",n+1);return r<=t}(r,t.maxDepth))&&function(e,t){return t?e.startsWith(t)&&"$"!==e[e.length-1]:"$"!==e[e.length-1]}(r,e))},async clear(e,t={}){e=yS(e),await Promise.all(n(e,!1).map(async e=>{if(e.driver.clear)return uS(e.driver.clear,e.relativeBase,t);if(e.driver.removeItem){const r=await e.driver.getKeys(e.relativeBase||"",t);return Promise.all(r.map(r=>e.driver.removeItem(r,t)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(e=>ES(e)))},watch:async e=>(await(async()=>{if(!t.watching){t.watching=!0;for(const e in t.mounts)t.unwatch[e]=await vS(t.mounts[e],i,e)}})(),t.watchListeners.push(e),async()=>{t.watchListeners=t.watchListeners.filter(t=>t!==e),0===t.watchListeners.length&&await o()}),async unwatch(){t.watchListeners=[],await o()},mount(e,r){if((e=yS(e))&&t.mounts[e])throw new Error(`already mounted at ${e}`);return e&&(t.mountpoints.push(e),t.mountpoints.sort((e,t)=>t.length-e.length)),t.mounts[e]=r,t.watching&&Promise.resolve(vS(r,i,e)).then(r=>{t.unwatch[e]=r}).catch(console.error),a},async unmount(e,r=!0){(e=yS(e))&&t.mounts[e]&&(t.watching&&e in t.unwatch&&(t.unwatch[e]?.(),delete t.unwatch[e]),r&&await ES(t.mounts[e]),t.mountpoints=t.mountpoints.filter(t=>t!==e),delete t.mounts[e])},getMount(e=""){e=gS(e)+":";const t=r(e);return{driver:t.driver,base:t.base}},getMounts(e="",t={}){e=gS(e);return n(e,t.parents).map(e=>({driver:e.driver,base:e.mountpoint}))},keys:(e,t={})=>a.getKeys(e,t),get:(e,t={})=>a.getItem(e,t),set:(e,t,r={})=>a.setItem(e,t,r),has:(e,t={})=>a.hasItem(e,t),del:(e,t={})=>a.removeItem(e,t),remove:(e,t={})=>a.removeItem(e,t)};return a}function vS(e,t,r){return e.watch?e.watch((e,n)=>t(e,r+n)):()=>{}}async function ES(e){"function"==typeof e.dispose&&await uS(e.dispose)}function xS(e){return new Promise((t,r)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>r(e.error)})}function IS(e,t){let r;return(n,i)=>(()=>{if(r)return r;const n=indexedDB.open(e);return n.onupgradeneeded=()=>n.result.createObjectStore(t),r=xS(n),r.then(e=>{e.onclose=()=>r=void 0},()=>{}),r})().then(e=>i(e.transaction(t,n).objectStore(t)))}let _S;function SS(){return _S||(_S=IS("keyval-store","keyval")),_S}function AS(e,t=SS()){return t("readonly",t=>xS(t.get(e)))}function OS(e=SS()){return e("readonly",e=>{if(e.getAllKeys)return xS(e.getAllKeys());const t=[];return function(e,t){return e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},xS(e.transaction)}(e,e=>t.push(e.key)).then(()=>t)})}var CS=(e={})=>{const t=e.base&&e.base.length>0?`${e.base}:`:"",r=e=>t+e;let n;return e.dbName&&e.storeName&&(n=IS(e.dbName,e.storeName)),{name:"idb-keyval",options:e,hasItem:async e=>!(typeof await AS(r(e),n)>"u"),getItem:async e=>await AS(r(e),n)??null,setItem:(e,t)=>function(e,t,r=SS()){return r("readwrite",r=>(r.put(t,e),xS(r.transaction)))}(r(e),t,n),removeItem:e=>function(e,t=SS()){return t("readwrite",t=>(t.delete(e),xS(t.transaction)))}(r(e),n),getKeys:()=>OS(n),clear:()=>function(e=SS()){return e("readwrite",e=>(e.clear(),xS(e.transaction)))}(n)}};let PS=class{constructor(){this.indexedDb=bS({driver:CS({dbName:"WALLET_CONNECT_V2_INDEXED_DB",storeName:"keyvaluestorage"})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(null!==t)return t}async setItem(e,t){await this.indexedDb.setItem(e,Cd(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var RS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},TS={exports:{}};function kS(e){var t;return[e[0],Od(null!=(t=e[1])?t:"")]}!function(){let e;function t(){}e=t,e.prototype.getItem=function(e){return this.hasOwnProperty(e)?String(this[e]):null},e.prototype.setItem=function(e,t){this[e]=String(t)},e.prototype.removeItem=function(e){delete this[e]},e.prototype.clear=function(){const e=this;Object.keys(e).forEach(function(t){e[t]=void 0,delete e[t]})},e.prototype.key=function(e){return e=e||0,Object.keys(this)[e]},e.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof RS<"u"&&RS.localStorage?TS.exports=RS.localStorage:typeof window<"u"&&window.localStorage?TS.exports=window.localStorage:TS.exports=new t}();let NS=class{constructor(){this.localStorage=TS.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(kS)}async getItem(e){const t=this.localStorage.getItem(e);if(null!==t)return Od(t)}async setItem(e,t){this.localStorage.setItem(e,Cd(t))}async removeItem(e){this.localStorage.removeItem(e)}};const US=async(e,t)=>{t.length&&t.forEach(async t=>{await e.removeItem(t)})};let BS=class{constructor(){this.initialized=!1,this.setInitialized=e=>{this.storage=e,this.initialized=!0};const e=new NS;this.storage=e;try{(async(e,t,r)=>{const n="wc_storage_version",i=await t.getItem(n);if(i&&i>=1)return void r(t);const o=await e.getKeys();if(!o.length)return void r(t);const s=[];for(;o.length;){const r=o.shift();if(!r)continue;const n=r.toLowerCase();if(n.includes("wc@")||n.includes("walletconnect")||n.includes("wc_")||n.includes("wallet_connect")){const n=await e.getItem(r);await t.setItem(r,n),s.push(r)}}await t.setItem(n,1),r(t),US(e,s)})(e,new PS,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};function LS(e){try{return JSON.stringify(e)}catch(e){return'"[Circular]"'}}var DS=function(e,t,r){var n=r&&r.stringify||LS;if("object"==typeof e&&null!==e){var i=t.length+1;if(1===i)return e;var o=new Array(i);o[0]=n(e);for(var s=1;s<i;s++)o[s]=n(t[s]);return o.join(" ")}if("string"!=typeof e)return e;var a=t.length;if(0===a)return e;for(var c="",l=0,u=-1,h=e&&e.length||0,d=0;d<h;){if(37===e.charCodeAt(d)&&d+1<h){switch(u=u>-1?u:0,e.charCodeAt(d+1)){case 100:case 102:if(l>=a)break;if(null==t[l])break;u<d&&(c+=e.slice(u,d)),c+=Number(t[l]),u=d+2,d++;break;case 105:if(l>=a)break;if(null==t[l])break;u<d&&(c+=e.slice(u,d)),c+=Math.floor(Number(t[l])),u=d+2,d++;break;case 79:case 111:case 106:if(l>=a)break;if(void 0===t[l])break;u<d&&(c+=e.slice(u,d));var f=typeof t[l];if("string"===f){c+="'"+t[l]+"'",u=d+2,d++;break}if("function"===f){c+=t[l].name||"<anonymous>",u=d+2,d++;break}c+=n(t[l]),u=d+2,d++;break;case 115:if(l>=a)break;u<d&&(c+=e.slice(u,d)),c+=String(t[l]),u=d+2,d++;break;case 37:u<d&&(c+=e.slice(u,d)),c+="%",u=d+2,d++,l--}++l}++d}if(-1===u)return e;u<h&&(c+=e.slice(u));return c};const $S=DS;var MS=HS;const jS=function(){function e(e){return void 0!==e&&e}try{return"undefined"!=typeof globalThis||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{},FS={mapHttpRequest:GS,mapHttpResponse:GS,wrapRequestSerializer:ZS,wrapResponseSerializer:ZS,wrapErrorSerializer:ZS,req:GS,res:GS,err:function(e){const t={type:e.constructor.name,msg:e.message,stack:e.stack};for(const r in e)void 0===t[r]&&(t[r]=e[r]);return t}};function HS(e){(e=e||{}).browser=e.browser||{};const t=e.browser.transmit;if(t&&"function"!=typeof t.send)throw Error("pino: transmit option must have a send function");const r=e.browser.write||jS;e.browser.write&&(e.browser.asObject=!0);const n=e.serializers||{},i=function(e,t){if(Array.isArray(e)){const t=e.filter(function(e){return"!stdSerializers.err"!==e});return t}return!0===e&&Object.keys(t)}(e.browser.serialize,n);let o=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(o=!1);"function"==typeof r&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),!1===e.enabled&&(e.level="silent");const s=e.level||"info",a=Object.create(r);a.log||(a.log=YS),Object.defineProperty(a,"levelVal",{get:function(){return"silent"===this.level?1/0:this.levels.values[this.level]}}),Object.defineProperty(a,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,zS(c,a,"error","log"),zS(c,a,"fatal","error"),zS(c,a,"warn","error"),zS(c,a,"info","log"),zS(c,a,"debug","log"),zS(c,a,"trace","log")}});const c={transmit:t,serialize:i,asObject:e.browser.asObject,levels:["error","fatal","warn","info","debug","trace"],timestamp:KS(e)};return a.levels=HS.levels,a.level=s,a.setMaxListeners=a.getMaxListeners=a.emit=a.addListener=a.on=a.prependListener=a.once=a.prependOnceListener=a.removeListener=a.removeAllListeners=a.listeners=a.listenerCount=a.eventNames=a.write=a.flush=YS,a.serializers=n,a._serialize=i,a._stdErrSerialize=o,a.child=function(r,o){if(!r)throw new Error("missing bindings for child Pino");o=o||{},i&&r.serializers&&(o.serializers=r.serializers);const s=o.serializers;if(i&&s){var a=Object.assign({},n,s),c=!0===e.browser.serialize?Object.keys(a):i;delete r.serializers,qS([r],c,a,this._stdErrSerialize)}function l(e){this._childLevel=1+(0|e._childLevel),this.error=WS(e,r,"error"),this.fatal=WS(e,r,"fatal"),this.warn=WS(e,r,"warn"),this.info=WS(e,r,"info"),this.debug=WS(e,r,"debug"),this.trace=WS(e,r,"trace"),a&&(this.serializers=a,this._serialize=c),t&&(this._logEvent=VS([].concat(e._logEvent.bindings,r)))}return l.prototype=this,new l(this)},t&&(a._logEvent=VS()),a}function zS(e,t,r,n){const i=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?YS:i[r]?i[r]:jS[r]||jS[n]||YS,function(e,t,r){if(!e.transmit&&t[r]===YS)return;t[r]=(n=t[r],function(){const i=e.timestamp(),o=new Array(arguments.length),s=Object.getPrototypeOf&&Object.getPrototypeOf(this)===jS?jS:this;for(var a=0;a<o.length;a++)o[a]=arguments[a];if(e.serialize&&!e.asObject&&qS(o,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?n.call(s,function(e,t,r,n){e._serialize&&qS(r,e._serialize,e.serializers,e._stdErrSerialize);const i=r.slice();let o=i[0];const s={};n&&(s.time=n),s.level=HS.levels.values[t];let a=1+(0|e._childLevel);if(a<1&&(a=1),null!==o&&"object"==typeof o){for(;a--&&"object"==typeof i[0];)Object.assign(s,i.shift());o=i.length?$S(i.shift(),i):void 0}else"string"==typeof o&&(o=$S(i.shift(),i));return void 0!==o&&(s.msg=o),s}(this,r,o,i)):n.apply(s,o),e.transmit){const n=e.transmit.level||t.level,s=HS.levels.values[n],a=HS.levels.values[r];if(a<s)return;!function(e,t,r){const n=t.send,i=t.ts,o=t.methodLevel,s=t.methodValue,a=t.val,c=e._logEvent.bindings;qS(r,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=r.filter(function(e){return-1===c.indexOf(e)}),e._logEvent.level.label=o,e._logEvent.level.value=s,n(o,e._logEvent,a),e._logEvent=VS(c)}(this,{ts:i,methodLevel:r,methodValue:a,transmitValue:HS.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},o)}});var n}(e,t,r)}function qS(e,t,r,n){for(const i in e)if(n&&e[i]instanceof Error)e[i]=HS.stdSerializers.err(e[i]);else if("object"==typeof e[i]&&!Array.isArray(e[i]))for(const n in e[i])t&&t.indexOf(n)>-1&&n in r&&(e[i][n]=r[n](e[i][n]))}function WS(e,t,r){return function(){const n=new Array(1+arguments.length);n[0]=t;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return e[r].apply(this,n)}}function VS(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function KS(e){return"function"==typeof e.timestamp?e.timestamp:!1===e.timestamp?JS:XS}function GS(){return{}}function ZS(e){return e}function YS(){}function JS(){return!1}function XS(){return Date.now()}HS.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},HS.stdSerializers=FS,HS.stdTimeFunctions=Object.assign({},{nullTime:JS,epochTime:XS,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}});var QS=de(MS);const eA="info",tA="custom_context",rA=1024e3;let nA=class{constructor(e){this.nodeValue=e,this.sizeInBytes=(new TextEncoder).encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},iA=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const t=new nA(e);if(t.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let t=this.head;for(;null!==t;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const t=e.value;return e=e.next,{done:!1,value:t}}}}},oA=class{constructor(e,t=rA){this.level=e??"error",this.levelValue=MS.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new iA(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===MS.levels.values.error?console.error(e):t===MS.levels.values.warn?console.warn(e):t===MS.levels.values.debug?console.debug(e):t===MS.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(Cd({timestamp:(new Date).toISOString(),log:e}));const t="string"==typeof e?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new iA(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const t=this.getLogArray();return t.push(Cd({extraMetadata:e})),new Blob(t,{type:"application/json"})}},sA=class{constructor(e,t=rA){this.baseChunkLogger=new oA(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const t=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=t,r.download=`walletconnect-logs-${(new Date).toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}},aA=class{constructor(e,t=rA){this.baseChunkLogger=new oA(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var cA=Object.defineProperty,lA=Object.defineProperties,uA=Object.getOwnPropertyDescriptors,hA=Object.getOwnPropertySymbols,dA=Object.prototype.hasOwnProperty,fA=Object.prototype.propertyIsEnumerable,pA=(e,t,r)=>t in e?cA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,gA=(e,t)=>{for(var r in t||(t={}))dA.call(t,r)&&pA(e,r,t[r]);if(hA)for(var r of hA(t))fA.call(t,r)&&pA(e,r,t[r]);return e},mA=(e,t)=>lA(e,uA(t));function yA(e){return mA(gA({},e),{level:e?.level||eA})}function wA(e,t=tA){let r="";return r=typeof e.bindings>"u"?function(e,t=tA){return e[t]||""}(e,t):e.bindings().context||"",r}function bA(e,t,r=tA){const n=function(e,t,r=tA){const n=wA(e,r);return n.trim()?`${n}/${t}`:t}(e,t,r);return function(e,t,r=tA){return e[r]=t,e}(e.child({context:n}),n,r)}function vA(e){return typeof e.loggerOverride<"u"&&"string"!=typeof e.loggerOverride?{logger:e.loggerOverride,chunkLoggerController:null}:typeof window<"u"?function(e){var t,r;const n=new sA(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:QS(mA(gA({},e.opts),{level:"trace",browser:mA(gA({},null==(r=e.opts)?void 0:r.browser),{write:e=>n.write(e)})})),chunkLoggerController:n}}(e):function(e){var t;const r=new aA(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:QS(mA(gA({},e.opts),{level:"trace"}),r),chunkLoggerController:r}}(e)}var EA=Object.defineProperty,xA=(e,t,r)=>((e,t,r)=>t in e?EA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);let IA=class extends eS{constructor(e){super(),this.opts=e,xA(this,"protocol","wc"),xA(this,"version",2)}};var _A=Object.defineProperty,SA=(e,t,r)=>((e,t,r)=>t in e?_A(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,t+"",r);let AA=class extends eS{constructor(e,t){super(),this.core=e,this.logger=t,SA(this,"records",new Map)}},OA=class{constructor(e,t){this.logger=e,this.core=t}},CA=class extends eS{constructor(e,t){super(),this.relayer=e,this.logger=t}},PA=class extends eS{constructor(e){super()}},RA=class{constructor(e,t,r,n){this.core=e,this.logger=t,this.name=r}},TA=class extends eS{constructor(e,t){super(),this.relayer=e,this.logger=t}},kA=class extends eS{constructor(e,t){super(),this.core=e,this.logger=t}},NA=class{constructor(e,t,r){this.core=e,this.logger=t,this.store=r}},UA=class{constructor(e,t){this.projectId=e,this.logger=t}},BA=class{constructor(e,t,r){this.core=e,this.logger=t,this.telemetryEnabled=r}};var LA=Object.defineProperty,DA=(e,t,r)=>((e,t,r)=>t in e?LA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);let $A=class{constructor(e){this.opts=e,DA(this,"protocol","wc"),DA(this,"version",2)}},MA=class{constructor(e){this.client=e}};const jA="PARSE_ERROR",FA="INVALID_REQUEST",HA="METHOD_NOT_FOUND",zA="INVALID_PARAMS",qA="INTERNAL_ERROR",WA="SERVER_ERROR",VA=[-32700,-32600,-32601,-32602,-32603],KA={[jA]:{code:-32700,message:"Parse error"},[FA]:{code:-32600,message:"Invalid Request"},[HA]:{code:-32601,message:"Method not found"},[zA]:{code:-32602,message:"Invalid params"},[qA]:{code:-32603,message:"Internal error"},[WA]:{code:-32e3,message:"Server error"}},GA=WA;function ZA(e){return Object.keys(KA).includes(e)?KA[e]:KA[GA]}function YA(e,t,r){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):e}var JA,XA={},QA={};var eO,tO={};function rO(e=3){return Date.now()*Math.pow(10,e)+Math.floor(Math.random()*Math.pow(10,e))}function nO(e=6){return BigInt(rO(e))}function iO(e,t,r){return{id:r||rO(),jsonrpc:"2.0",method:e,params:t}}function oO(e,t){return{id:e,jsonrpc:"2.0",result:t}}function sO(e,t,r){return{id:e,jsonrpc:"2.0",error:aO(t)}}function aO(e,t){return void 0===e?ZA(qA):("string"==typeof e&&(e=Object.assign(Object.assign({},ZA(WA)),{message:e})),function(e){return VA.includes(e)}(e.code)&&(e=function(e){const t=Object.values(KA).find(t=>t.code===e);return t||KA[GA]}(e.code)),e)}!function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=vc;t.__exportStar(function(){if(JA)return QA;function e(){return(null==he?void 0:he.crypto)||(null==he?void 0:he.msCrypto)||{}}function t(){const t=e();return t.subtle||t.webkitSubtle}return JA=1,Object.defineProperty(QA,"__esModule",{value:!0}),QA.isBrowserCryptoAvailable=QA.getSubtleCrypto=QA.getBrowerCrypto=void 0,QA.getBrowerCrypto=e,QA.getSubtleCrypto=t,QA.isBrowserCryptoAvailable=function(){return!!e()&&!!t()},QA}(),e),t.__exportStar(function(){if(eO)return tO;function e(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product}function t(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node}return eO=1,Object.defineProperty(tO,"__esModule",{value:!0}),tO.isBrowser=tO.isNode=tO.isReactNative=void 0,tO.isReactNative=e,tO.isNode=t,tO.isBrowser=function(){return!e()&&!t()},tO}(),e)}(XA);let cO=class{},lO=class extends cO{constructor(){super()}},uO=class extends lO{constructor(e){super()}};function hO(e,t){const r=function(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(t&&t.length)return t[0]}(e);return void 0!==r&&new RegExp(t).test(r)}function dO(e){return hO(e,"^https?:")}function fO(e){return hO(e,"^wss?:")}function pO(e){return"object"==typeof e&&"id"in e&&"jsonrpc"in e&&"2.0"===e.jsonrpc}function gO(e){return pO(e)&&"method"in e}function mO(e){return pO(e)&&(yO(e)||wO(e))}function yO(e){return"result"in e}function wO(e){return"error"in e}let bO=class extends uO{constructor(e){super(e),this.events=new Ke.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(iO(e.method,e.params||[],e.id||nO().toString()),t)}async requestStrict(e,t){return new Promise(async(r,n)=>{if(!this.connection.connected)try{await this.open()}catch(e){n(e)}this.events.on(`${e.id}`,e=>{wO(e)?n(e.error):r(e.result)});try{await this.connection.send(e,t)}catch(e){n(e)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),mO(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&3e3===e.code&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),"string"==typeof e&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const vO=e=>e.split("?")[0],EO=typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws");let xO=class{constructor(e){if(this.url=e,this.events=new Ke.EventEmitter,this.registering=!1,!fO(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{typeof this.socket>"u"?t(new Error("Connection already closed")):(this.socket.onclose=t=>{this.onClose(t),e()},this.socket.close())})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Cd(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!fO(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise((e,t)=>{this.events.once("register_error",e=>{this.resetMaxListeners(),t(e)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return t(new Error("WebSocket connection is missing or invalid"));e(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,r)=>{const n=XA.isReactNative()?void 0:{rejectUnauthorized:(o=e,!new RegExp("wss?://localhost(:d{2,5})?").test(o))},i=new EO(e,[],n);var o;typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u"?i.onerror=e=>{const t=e;r(this.emitError(t.error))}:i.on("error",e=>{r(this.emitError(e))}),i.onopen=()=>{this.onOpen(i),t(i)}})}onOpen(e){e.onmessage=e=>this.onPayload(e),e.onclose=e=>this.onClose(e),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t="string"==typeof e.data?Od(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const r=this.parseError(t),n=sO(e,r.message||r.toString());this.events.emit("payload",n)}parseError(e,t=this.url){return YA(e,vO(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}emitError(e){const t=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${vO(this.url)}`));return this.events.emit("register_error",t),t}};const IO="core",_O=`wc@2:${IO}:`,SO="error",AO={database:":memory:"},OO="client_ed25519_seed",CO=dc.ONE_DAY,PO=dc.SIX_HOURS,RO="wss://relay.walletconnect.org",TO="relayer_message",kO="relayer_message_ack",NO="relayer_connect",UO="relayer_disconnect",BO="relayer_error",LO="relayer_connection_stalled",DO="relayer_publish",$O="payload",MO="connect",jO="disconnect",FO="error",HO="2.21.8",zO={link_mode:"link_mode",relay:"relay"},qO="inbound",WO="outbound",VO="WALLETCONNECT_LINK_MODE_APPS",KO="subscription_created",GO="subscription_deleted",ZO="subscription_sync",YO="subscription_resubscribed",JO={wc_pairingDelete:{req:{ttl:dc.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:dc.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:dc.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:dc.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:dc.ONE_DAY,prompt:!1,tag:0},res:{ttl:dc.ONE_DAY,prompt:!1,tag:0}}},XO="pairing_create",QO="pairing_expire",eC="pairing_delete",tC="pairing_ping",rC="history_created",nC="history_updated",iC="history_deleted",oC="history_sync",sC="expirer_created",aC="expirer_deleted",cC="expirer_expired",lC="expirer_sync",uC="https://verify.walletconnect.org",hC=uC,dC=`${hC}/v3`,fC=["https://verify.walletconnect.com",uC],pC="pairing_started",gC="pairing_uri_validation_success",mC="pairing_uri_not_expired",yC="store_new_pairing",wC="subscribing_pairing_topic",bC="subscribe_pairing_topic_success",vC="existing_pairing",EC="pairing_not_expired",xC="emit_inactive_pairing",IC="emit_session_proposal",_C="no_internet_connection",SC="malformed_pairing_uri",AC="active_pairing_already_exists",OC="subscribe_pairing_topic_failure",CC="pairing_expired",PC="proposal_listener_not_found",RC="session_approve_started",TC="session_namespaces_validation_success",kC="subscribing_session_topic",NC="subscribe_session_topic_success",UC="session_approve_publish_success",BC="store_session",LC="no_internet_connection",DC="proposal_expired",$C="subscribe_session_topic_failure",MC="session_approve_namespace_validation_failure",jC="proposal_not_found",FC="authenticated_session_approve_started",HC="create_authenticated_session_topic",zC="cacaos_verified",qC="store_authenticated_session",WC="subscribing_authenticated_session_topic",VC="subscribe_authenticated_session_topic_success",KC="publishing_authenticated_session_approve",GC="no_internet_connection",ZC="invalid_cacao",YC="subscribe_authenticated_session_topic_failure",JC="authenticated_session_approve_publish_failure",XC="authenticated_session_pending_request_not_found";var QC=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(n+(o-f)),g=n;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}for(var p=s-n;p!==s&&0===l[p];)p++;for(var g=c.repeat(r);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}},eP=QC;const tP=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class rP{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class nP{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return oP(this,e)}}class iP{constructor(e){this.decoders=e}or(e){return oP(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const oP=(e,t)=>new iP({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class sP{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new rP(e,t,r),this.decoder=new nP(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const aP=({name:e,prefix:t,encode:r,decode:n})=>new sP(e,t,r,n),cP=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=eP(r,t);return aP({prefix:e,name:t,encode:n,decode:e=>tP(i(e))})},lP=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>aP({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],s+=8;s>r;)s-=r,o+=t[i&a>>s];if(s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,l=0;for(let t=0;t<o;++t){const o=i[e[t]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(t,n,r,e)}),uP=aP({prefix:"\0",name:"identity",encode:e=>(e=>(new TextDecoder).decode(e))(e),decode:e=>(e=>(new TextEncoder).encode(e))(e)});var hP=Object.freeze({__proto__:null,identity:uP});const dP=lP({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var fP=Object.freeze({__proto__:null,base2:dP});const pP=lP({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var gP=Object.freeze({__proto__:null,base8:pP});const mP=cP({prefix:"9",name:"base10",alphabet:"0123456789"});var yP=Object.freeze({__proto__:null,base10:mP});const wP=lP({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),bP=lP({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var vP=Object.freeze({__proto__:null,base16:wP,base16upper:bP});const EP=lP({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),xP=lP({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),IP=lP({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),_P=lP({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),SP=lP({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),AP=lP({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),OP=lP({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),CP=lP({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),PP=lP({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var RP=Object.freeze({__proto__:null,base32:EP,base32upper:xP,base32pad:IP,base32padupper:_P,base32hex:SP,base32hexupper:AP,base32hexpad:OP,base32hexpadupper:CP,base32z:PP});const TP=cP({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),kP=cP({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var NP=Object.freeze({__proto__:null,base36:TP,base36upper:kP});const UP=cP({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),BP=cP({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var LP=Object.freeze({__proto__:null,base58btc:UP,base58flickr:BP});const DP=lP({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),$P=lP({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),MP=lP({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),jP=lP({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var FP=Object.freeze({__proto__:null,base64:DP,base64pad:$P,base64url:MP,base64urlpad:jP});const HP=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),zP=HP.reduce((e,t,r)=>(e[r]=t,e),[]),qP=HP.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);const WP=aP({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+=zP[t],"")},decode:function(e){const t=[];for(const r of e){const e=qP[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var VP=Object.freeze({__proto__:null,base256emoji:WP}),KP=function e(t,r,n){r=r||[];for(var i=n=n||0;t>=YP;)r[n++]=255&t|GP,t/=128;for(;t&ZP;)r[n++]=255&t|GP,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},GP=128,ZP=-128,YP=Math.pow(2,31);var JP=function e(t,r){var n,i=0,o=(r=r||0,0),s=r,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=o<28?(n&QP)<<o:(n&QP)*Math.pow(2,o),o+=7}while(n>=XP);return e.bytes=s-r,i},XP=128,QP=127;var eR=Math.pow(2,7),tR=Math.pow(2,14),rR=Math.pow(2,21),nR=Math.pow(2,28),iR=Math.pow(2,35),oR=Math.pow(2,42),sR=Math.pow(2,49),aR=Math.pow(2,56),cR=Math.pow(2,63),lR={encode:KP,decode:JP,encodingLength:function(e){return e<eR?1:e<tR?2:e<rR?3:e<nR?4:e<iR?5:e<oR?6:e<sR?7:e<aR?8:e<cR?9:10}},uR=lR;const hR=(e,t,r=0)=>(uR.encode(e,t,r),t),dR=e=>uR.encodingLength(e),fR=(e,t)=>{const r=t.byteLength,n=dR(e),i=n+dR(r),o=new Uint8Array(i+r);return hR(e,o,0),hR(r,o,n),o.set(t,i),new pR(e,r,t,o)};class pR{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const gR=({name:e,code:t,encode:r})=>new mR(e,t,r);class mR{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?fR(this.code,t):t.then(e=>fR(this.code,e))}throw Error("Unknown type, must be binary type")}}const yR=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),wR=gR({name:"sha2-256",code:18,encode:yR("SHA-256")}),bR=gR({name:"sha2-512",code:19,encode:yR("SHA-512")});Object.freeze({__proto__:null,sha256:wR,sha512:bR});const vR=tP,ER={code:0,name:"identity",encode:vR,digest:e=>fR(0,vR(e))};Object.freeze({__proto__:null,identity:ER});new TextEncoder,new TextDecoder;const xR={...hP,...fP,...gP,...yP,...vP,...RP,...NP,...LP,...FP,...VP};function IR(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function _R(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const SR=_R("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>(new TextEncoder).encode(e.substring(1))),AR=_R("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{const t=function(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?IR(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),OR={utf8:SR,"utf-8":SR,hex:xR.base16,latin1:AR,ascii:AR,binary:AR,...xR};var CR=Object.defineProperty,PR=(e,t,r)=>((e,t,r)=>t in e?CR(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class RR{constructor(e,t){this.core=e,this.logger=t,PR(this,"keychain",new Map),PR(this,"name","keychain"),PR(this,"version","0.3"),PR(this,"initialized",!1),PR(this,"storagePrefix",_O),PR(this,"init",async()=>{if(!this.initialized){const e=await this.getKeyChain();typeof e<"u"&&(this.keychain=e),this.initialized=!0}}),PR(this,"has",e=>(this.isInitialized(),this.keychain.has(e))),PR(this,"set",async(e,t)=>{this.isInitialized(),this.keychain.set(e,t),await this.persist()}),PR(this,"get",e=>{this.isInitialized();const t=this.keychain.get(e);if(typeof t>"u"){const{message:t}=FI("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t}),PR(this,"del",async e=>{this.isInitialized(),this.keychain.delete(e),await this.persist()}),this.core=e,this.logger=bA(t,this.name)}get context(){return wA(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,hw(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?dw(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=FI("NOT_INITIALIZED",this.name);throw new Error(e)}}}var TR=Object.defineProperty,kR=(e,t,r)=>((e,t,r)=>t in e?TR(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class NR{constructor(e,t,r){this.core=e,this.logger=t,kR(this,"name","crypto"),kR(this,"keychain"),kR(this,"randomSessionIdentifier",oI()),kR(this,"initialized",!1),kR(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),kR(this,"hasKeys",e=>(this.isInitialized(),this.keychain.has(e))),kR(this,"getClientId",async()=>{this.isInitialized();return Jg(em(await this.getClientSeed()).publicKey)}),kR(this,"generateKeyPair",()=>{this.isInitialized();const e=function(){const e=Rx.utils.randomPrivateKey(),t=Rx.getPublicKey(e);return{privateKey:iy(e,tI),publicKey:iy(t,tI)}}();return this.setPrivateKey(e.publicKey,e.privateKey)}),kR(this,"signJWT",async e=>{this.isInitialized();const t=em(await this.getClientSeed()),r=this.randomSessionIdentifier,n=CO;return await tm(r,e,n,t)}),kR(this,"generateSharedKey",(e,t,r)=>{this.isInitialized();const n=function(e,t){const r=Rx.getSharedSecret(ny(e,tI),ny(t,tI));return iy(AE(OE,r,void 0,void 0,32),tI)}(this.getPrivateKey(e),t);return this.setSymKey(n,r)}),kR(this,"setSymKey",async(e,t)=>{this.isInitialized();const r=t||sI(e);return await this.keychain.set(r,e),r}),kR(this,"deleteKeyPair",async e=>{this.isInitialized(),await this.keychain.del(e)}),kR(this,"deleteSymKey",async e=>{this.isInitialized(),await this.keychain.del(e)}),kR(this,"encode",async(e,t,r)=>{this.isInitialized();const n=pI(r),i=Cd(t);if(mI(n))return function(e,t){const r=cI(2),n=xb(12),i=dI({type:r,sealed:ny(e,iI),iv:n});return t===nI?uI(i):i}(i,r?.encoding);if(gI(n)){const t=n.senderPublicKey,r=n.receiverPublicKey;e=await this.generateSharedKey(t,r)}const o=this.getSymKey(e),{type:s,senderPublicKey:a}=n;return function(e){const t=cI(typeof e.type<"u"?e.type:0);if(1===lI(t)&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof e.senderPublicKey<"u"?ny(e.senderPublicKey,tI):void 0,n=typeof e.iv<"u"?ny(e.iv,tI):xb(12),i=ny(e.symKey,tI),o=dI({type:t,sealed:EE(i,n).encrypt(ny(e.message,iI)),iv:n,senderPublicKey:r});return e.encoding===nI?uI(o):o}({type:s,symKey:o,message:i,senderPublicKey:a,encoding:r?.encoding})}),kR(this,"decode",async(e,t,r)=>{this.isInitialized();const n=function(e,t){const r=fI({encoded:e,encoding:t?.encoding});return pI({type:lI(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?iy(r.senderPublicKey,tI):void 0,receiverPublicKey:t?.receiverPublicKey})}(t,r);if(mI(n)){const e=function(e,t){const{sealed:r}=fI({encoded:e,encoding:t});return iy(r,iI)}(t,r?.encoding);return Od(e)}if(gI(n)){const t=n.receiverPublicKey,r=n.senderPublicKey;e=await this.generateSharedKey(t,r)}try{const n=function(e){const t=ny(e.symKey,tI),{sealed:r,iv:n}=fI({encoded:e.encoded,encoding:e.encoding}),i=EE(t,n).decrypt(r);if(null===i)throw new Error("Failed to decrypt");return iy(i,iI)}({symKey:this.getSymKey(e),encoded:t,encoding:r?.encoding});return Od(n)}catch(t){this.logger.error(`Failed to decode message from topic: '${e}', clientId: '${await this.getClientId()}'`),this.logger.error(t)}}),kR(this,"getPayloadType",(e,t=rI)=>lI(fI({encoded:e,encoding:t}).type)),kR(this,"getPayloadSenderPublicKey",(e,t=rI)=>{const r=fI({encoded:e,encoding:t});return r.senderPublicKey?iy(r.senderPublicKey,tI):void 0}),this.core=e,this.logger=bA(t,this.name),this.keychain=r||new RR(this.core,this.logger)}get context(){return wA(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(OO)}catch{e=oI(),await this.keychain.set(OO,e)}return function(e,t="utf8"){const r=OR[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):IR(globalThis.Buffer.from(e,"utf-8"))}(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=FI("NOT_INITIALIZED",this.name);throw new Error(e)}}}var UR=Object.defineProperty,BR=Object.defineProperties,LR=Object.getOwnPropertyDescriptors,DR=Object.getOwnPropertySymbols,$R=Object.prototype.hasOwnProperty,MR=Object.prototype.propertyIsEnumerable,jR=(e,t,r)=>t in e?UR(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,FR=(e,t,r)=>jR(e,"symbol"!=typeof t?t+"":t,r);class HR extends OA{constructor(e,t){super(e,t),this.logger=e,this.core=t,FR(this,"messages",new Map),FR(this,"messagesWithoutClientAck",new Map),FR(this,"name","messages"),FR(this,"version","0.3"),FR(this,"initialized",!1),FR(this,"storagePrefix",_O),FR(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const e=await this.getRelayerMessages();typeof e<"u"&&(this.messages=e);const t=await this.getRelayerMessagesWithoutClientAck();typeof t<"u"&&(this.messagesWithoutClientAck=t),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}finally{this.initialized=!0}}}),FR(this,"set",async(e,t,r)=>{this.isInitialized();const n=aI(t);let i=this.messages.get(e);if(typeof i>"u"&&(i={}),typeof i[n]<"u")return n;if(i[n]=t,this.messages.set(e,i),r===qO){const r=this.messagesWithoutClientAck.get(e)||{};this.messagesWithoutClientAck.set(e,((e,t)=>BR(e,LR(t)))(((e,t)=>{for(var r in t||(t={}))$R.call(t,r)&&jR(e,r,t[r]);if(DR)for(var r of DR(t))MR.call(t,r)&&jR(e,r,t[r]);return e})({},r),{[n]:t}))}return await this.persist(),n}),FR(this,"get",e=>{this.isInitialized();let t=this.messages.get(e);return typeof t>"u"&&(t={}),t}),FR(this,"getWithoutAck",e=>{this.isInitialized();const t={};for(const r of e){const e=this.messagesWithoutClientAck.get(r)||{};t[r]=Object.values(e)}return t}),FR(this,"has",(e,t)=>{this.isInitialized();return typeof this.get(e)[aI(t)]<"u"}),FR(this,"ack",async(e,t)=>{this.isInitialized();const r=this.messagesWithoutClientAck.get(e);if(typeof r>"u")return;delete r[aI(t)],0===Object.keys(r).length?this.messagesWithoutClientAck.delete(e):this.messagesWithoutClientAck.set(e,r),await this.persist()}),FR(this,"del",async e=>{this.isInitialized(),this.messages.delete(e),this.messagesWithoutClientAck.delete(e),await this.persist()}),this.logger=bA(e,this.name),this.core=t}get context(){return wA(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,hw(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,hw(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?dw(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?dw(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=FI("NOT_INITIALIZED",this.name);throw new Error(e)}}}var zR=Object.defineProperty,qR=Object.defineProperties,WR=Object.getOwnPropertyDescriptors,VR=Object.getOwnPropertySymbols,KR=Object.prototype.hasOwnProperty,GR=Object.prototype.propertyIsEnumerable,ZR=(e,t,r)=>t in e?zR(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,YR=(e,t)=>{for(var r in t||(t={}))KR.call(t,r)&&ZR(e,r,t[r]);if(VR)for(var r of VR(t))GR.call(t,r)&&ZR(e,r,t[r]);return e},JR=(e,t)=>qR(e,WR(t)),XR=(e,t,r)=>ZR(e,"symbol"!=typeof t?t+"":t,r);class QR extends CA{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,XR(this,"events",new Ke.EventEmitter),XR(this,"name","publisher"),XR(this,"queue",new Map),XR(this,"publishTimeout",dc.toMiliseconds(dc.ONE_MINUTE)),XR(this,"initialPublishTimeout",dc.toMiliseconds(15*dc.ONE_SECOND)),XR(this,"needsTransportRestart",!1),XR(this,"publish",async(e,t,r)=>{var n,i,o,s,a;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:r}});const c=r?.ttl||PO,l=r?.prompt||!1,u=r?.tag||0,h=r?.id||nO().toString(),d=bI(wI().protocol),f={id:h,method:r?.publishMethod||d.publish,params:YR({topic:e,message:t,ttl:c,prompt:l,tag:u,attestation:r?.attestation},r?.tvf&&{tvf:r.tvf})},p=`Failed to publish payload, please try again. id:${h} tag:${u}`;try{WI(null==(n=f.params)?void 0:n.prompt)&&(null==(i=f.params)||delete i.prompt),WI(null==(o=f.params)?void 0:o.tag)&&(null==(s=f.params)||delete s.tag);const a=new Promise(async e=>{const t=({id:r})=>{var n;(null==(n=f.id)?void 0:n.toString())===r.toString()&&(this.removeRequestFromQueue(r),this.relayer.events.removeListener(DO,t),e())};this.relayer.events.on(DO,t);const n=pw(new Promise((e,t)=>{this.rpcPublish(f,r).then(e).catch(e=>{this.logger.warn(e,e?.message),t(e)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${h} tag:${u}`);try{await n,this.events.removeListener(DO,t)}catch(e){this.queue.set(h,{request:f,opts:r,attempt:1}),this.logger.warn(e,e?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:h,topic:e,message:t,opts:r}}),await pw(a,this.publishTimeout,p)}catch(e){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(e),null!=(a=r?.internal)&&a.throwOnFailedPublish)throw e}finally{this.queue.delete(h)}}),XR(this,"publishCustom",async e=>{var t,r,n,i,o;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:e});const{payload:s,opts:a={}}=e,{attestation:c,tvf:l,publishMethod:u,prompt:h,tag:d,ttl:f=dc.FIVE_MINUTES}=a,p=a.id||nO().toString(),g=bI(wI().protocol),m=u||g.publish,y={id:p,method:m,params:YR(JR(YR({},s),{ttl:f,prompt:h,tag:d,attestation:c}),l)},w=`Failed to publish custom payload, please try again. id:${p} tag:${d}`;try{WI(null==(t=y.params)?void 0:t.prompt)&&(null==(r=y.params)||delete r.prompt),WI(null==(n=y.params)?void 0:n.tag)&&(null==(i=y.params)||delete i.tag);const e=new Promise(async e=>{const t=({id:r})=>{var n;(null==(n=y.id)?void 0:n.toString())===r.toString()&&(this.removeRequestFromQueue(r),this.relayer.events.removeListener(DO,t),e())};this.relayer.events.on(DO,t);const r=pw(new Promise((e,t)=>{this.rpcPublish(y,a).then(e).catch(e=>{this.logger.warn(e,e?.message),t(e)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${m} id:${p} tag:${d}`);try{await r,this.events.removeListener(DO,t)}catch(e){this.queue.set(p,{request:y,opts:a,attempt:1}),this.logger.warn(e,e?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:p,payload:s,opts:a}}),await pw(e,this.publishTimeout,w)}catch(e){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(e),null!=(o=a?.internal)&&o.throwOnFailedPublish)throw e}finally{this.queue.delete(p)}}),XR(this,"on",(e,t)=>{this.events.on(e,t)}),XR(this,"once",(e,t)=>{this.events.once(e,t)}),XR(this,"off",(e,t)=>{this.events.off(e,t)}),XR(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.relayer=e,this.logger=bA(t,this.name),this.registerEventListeners()}get context(){return wA(this.logger)}async rpcPublish(e,t){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});const r=await this.relayer.request(e);return this.relayer.events.emit(DO,YR(YR({},e),t)),this.logger.debug("Successfully Published Payload"),r}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{var r;const n=e.attempt+1;this.queue.set(t,JR(YR({},e),{attempt:n})),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${null==(r=e.request.params)?void 0:r.tag}, attempt: ${n}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(nS,()=>{if(this.needsTransportRestart)return this.needsTransportRestart=!1,void this.relayer.events.emit(LO);this.checkQueue()}),this.relayer.on(kO,e=>{this.removeRequestFromQueue(e.id.toString())})}}var eT=Object.defineProperty,tT=(e,t,r)=>((e,t,r)=>t in e?eT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class rT{constructor(){tT(this,"map",new Map),tT(this,"set",(e,t)=>{const r=this.get(e);this.exists(e,t)||this.map.set(e,[...r,t])}),tT(this,"get",e=>this.map.get(e)||[]),tT(this,"exists",(e,t)=>this.get(e).includes(t)),tT(this,"delete",(e,t)=>{if(typeof t>"u")return void this.map.delete(e);if(!this.map.has(e))return;const r=this.get(e);if(!this.exists(e,t))return;const n=r.filter(e=>e!==t);n.length?this.map.set(e,n):this.map.delete(e)}),tT(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var nT=Object.defineProperty,iT=Object.defineProperties,oT=Object.getOwnPropertyDescriptors,sT=Object.getOwnPropertySymbols,aT=Object.prototype.hasOwnProperty,cT=Object.prototype.propertyIsEnumerable,lT=(e,t,r)=>t in e?nT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uT=(e,t)=>{for(var r in t||(t={}))aT.call(t,r)&&lT(e,r,t[r]);if(sT)for(var r of sT(t))cT.call(t,r)&&lT(e,r,t[r]);return e},hT=(e,t)=>iT(e,oT(t)),dT=(e,t,r)=>lT(e,"symbol"!=typeof t?t+"":t,r);class fT extends TA{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,dT(this,"subscriptions",new Map),dT(this,"topicMap",new rT),dT(this,"events",new Ke.EventEmitter),dT(this,"name","subscription"),dT(this,"version","0.3"),dT(this,"pending",new Map),dT(this,"cached",[]),dT(this,"initialized",!1),dT(this,"storagePrefix",_O),dT(this,"subscribeTimeout",dc.toMiliseconds(dc.ONE_MINUTE)),dT(this,"initialSubscribeTimeout",dc.toMiliseconds(15*dc.ONE_SECOND)),dT(this,"clientId"),dT(this,"batchSubscribeTopicsLimit",500),dT(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),dT(this,"subscribe",async(e,t)=>{var r;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}});try{const n=wI(t),i={topic:e,relay:n,transportType:t?.transportType};null!=(r=t?.internal)&&r.skipSubscribe||this.pending.set(e,i);const o=await this.rpcSubscribe(e,n,t);return"string"==typeof o&&(this.onSubscribe(o,i),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}})),o}catch(e){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(e),e}}),dT(this,"unsubscribe",async(e,t)=>{this.isInitialized(),typeof t?.id<"u"?await this.unsubscribeById(e,t.id,t):await this.unsubscribeByTopic(e,t)}),dT(this,"isSubscribed",e=>new Promise(t=>{t(this.topicMap.topics.includes(e))})),dT(this,"isKnownTopic",e=>new Promise(t=>{t(this.topicMap.topics.includes(e)||this.pending.has(e)||this.cached.some(t=>t.topic===e))})),dT(this,"on",(e,t)=>{this.events.on(e,t)}),dT(this,"once",(e,t)=>{this.events.once(e,t)}),dT(this,"off",(e,t)=>{this.events.off(e,t)}),dT(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),dT(this,"start",async()=>{await this.onConnect()}),dT(this,"stop",async()=>{await this.onDisconnect()}),dT(this,"restart",async()=>{await this.restore(),await this.onRestart()}),dT(this,"checkPending",async()=>{if(!(0!==this.pending.size||this.initialized&&this.relayer.connected))return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}),dT(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(nS,async()=>{await this.checkPending()}),this.events.on(KO,async e=>{const t=KO;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(GO,async e=>{const t=GO;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}),this.relayer=e,this.logger=bA(t,this.name),this.clientId=""}get context(){return wA(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let r=!1;try{r=this.getSubscription(e).topic===t}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const r=this.topicMap.get(e);await Promise.all(r.map(async r=>await this.unsubscribeById(e,r,t)))}async unsubscribeById(e,t,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}});try{const n=wI(r);await this.restartToComplete({topic:e,id:t,relay:n}),await this.rpcUnsubscribe(e,t,n);const i=HI("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}})}catch(e){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(e),e}}async rpcSubscribe(e,t,r){var n,i;const o=await this.getSubscriptionId(e);if(null!=(n=r?.internal)&&n.skipSubscribe)return o;(!r||r?.transportType===zO.relay)&&await this.restartToComplete({topic:e,id:e,relay:t});const s={method:bI(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});const a=null==(i=r?.internal)?void 0:i.throwOnFailedPublish;try{if(r?.transportType===zO.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(s).catch(e=>this.logger.warn(e))},dc.toMiliseconds(dc.ONE_SECOND)),o;const t=new Promise(async t=>{const r=n=>{n.topic===e&&(this.events.removeListener(KO,r),t(n.id))};this.events.on(KO,r);try{const n=await pw(new Promise((e,t)=>{this.relayer.request(s).catch(e=>{this.logger.warn(e,e?.message),t(e)}).then(e)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(KO,r),t(n)}catch{}}),n=await pw(t,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!n&&a)throw new Error(`Subscribing to ${e} failed, please try again`);return n?o:null}catch(e){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(LO),a)throw e}return null}async rpcBatchSubscribe(e){if(!e.length)return;const t={method:bI(e[0].relay.protocol).batchSubscribe,params:{topics:e.map(e=>e.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{await await pw(new Promise(e=>{this.relayer.request(t).catch(e=>this.logger.warn(e)).then(e)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(LO)}}async rpcBatchFetchMessages(e){if(!e.length)return;const t={method:bI(e[0].relay.protocol).batchFetchMessages,params:{topics:e.map(e=>e.topic)}};let r;this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{r=await await pw(new Promise((e,r)=>{this.relayer.request(t).catch(e=>{this.logger.warn(e),r(e)}).then(e)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(LO)}return r}rpcUnsubscribe(e,t,r){const n={method:bI(r.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}onSubscribe(e,t){this.setSubscription(e,hT(uT({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(e=>{this.setSubscription(e.id,uT({},e)),this.pending.delete(e.topic)})}async onUnsubscribe(e,t,r){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,uT({},t)),this.topicMap.set(t.topic,e),this.events.emit(KO,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:t}=FI("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(GO,hT(uT({},r),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ZO)}async onRestart(){if(this.cached.length){const e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const t=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(t)}}this.events.emit(YO)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(e=>{var t;return e.topic===(null==(t=this.subscriptions.get(e.id))?void 0:t.topic)})){const{message:e}=FI("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async e=>hT(uT({},e),{id:await this.getSubscriptionId(e.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(await function(e){return new Promise(t=>setTimeout(t,e))}(dc.toMiliseconds(dc.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(t.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=FI("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return aI(e+await this.getClientId())}}var pT=Object.defineProperty,gT=Object.getOwnPropertySymbols,mT=Object.prototype.hasOwnProperty,yT=Object.prototype.propertyIsEnumerable,wT=(e,t,r)=>t in e?pT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,bT=(e,t)=>{for(var r in t||(t={}))mT.call(t,r)&&wT(e,r,t[r]);if(gT)for(var r of gT(t))yT.call(t,r)&&wT(e,r,t[r]);return e},vT=(e,t,r)=>wT(e,"symbol"!=typeof t?t+"":t,r);class ET extends PA{constructor(e){super(e),vT(this,"protocol","wc"),vT(this,"version",2),vT(this,"core"),vT(this,"logger"),vT(this,"events",new Ke.EventEmitter),vT(this,"provider"),vT(this,"messages"),vT(this,"subscriber"),vT(this,"publisher"),vT(this,"name","relayer"),vT(this,"transportExplicitlyClosed",!1),vT(this,"initialized",!1),vT(this,"connectionAttemptInProgress",!1),vT(this,"relayUrl"),vT(this,"projectId"),vT(this,"packageName"),vT(this,"bundleId"),vT(this,"hasExperiencedNetworkDisruption",!1),vT(this,"pingTimeout"),vT(this,"heartBeatTimeout",dc.toMiliseconds(dc.THIRTY_SECONDS+dc.FIVE_SECONDS)),vT(this,"reconnectTimeout"),vT(this,"connectPromise"),vT(this,"reconnectInProgress",!1),vT(this,"requestsInFlight",[]),vT(this,"connectTimeout",dc.toMiliseconds(15*dc.ONE_SECOND)),vT(this,"request",async e=>{var t,r;this.logger.debug("Publishing Request Payload");const n=e.id||nO().toString();await this.toEstablishConnection();try{this.logger.trace({id:n,method:e.method,topic:null==(t=e.params)?void 0:t.topic},"relayer.request - publishing...");const i=`${n}:${(null==(r=e.params)?void 0:r.tag)||""}`;this.requestsInFlight.push(i);const o=await this.provider.request(e);return this.requestsInFlight=this.requestsInFlight.filter(e=>e!==i),o}catch(e){throw this.logger.debug(`Failed to Publish Request: ${n}`),e}}),vT(this,"resetPingTimeout",()=>{tw()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var e,t,r,n;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),null==(n=null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.terminate)||n.call(r)}catch(e){this.logger.warn(e,e?.message)}},this.heartBeatTimeout))}),vT(this,"onPayloadHandler",e=>{this.onProviderPayload(e),this.resetPingTimeout()}),vT(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected 🛜"),this.startPingTimeout(),this.events.emit(NO)}),vT(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected 🛑"),this.requestsInFlight=[],this.onProviderDisconnect()}),vT(this,"onProviderErrorHandler",e=>{this.logger.fatal(`Fatal socket error: ${e.message}`),this.events.emit(BO,e),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),vT(this,"registerProviderListeners",()=>{this.provider.on($O,this.onPayloadHandler),this.provider.on(MO,this.onConnectHandler),this.provider.on(jO,this.onDisconnectHandler),this.provider.on(FO,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&"string"!=typeof e.logger?bA(e.logger,this.name):QS(yA({level:e.logger||"error"})),this.messages=new HR(this.logger,e.core),this.subscriber=new fT(this,this.logger),this.publisher=new QR(this,this.logger),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||RO,rw()&&typeof global<"u"&&typeof(null==global?void 0:global.Platform)<"u"&&"android"===(null==global?void 0:global.Platform.OS)?this.packageName=ow():rw()&&typeof global<"u"&&typeof(null==global?void 0:global.Platform)<"u"&&"ios"===(null==global?void 0:global.Platform.OS)&&(this.bundleId=ow()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e?.message))}get context(){return wA(this.logger)}get connected(){var e,t,r;return 1===(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)||!1}get connecting(){var e,t,r;return 0===(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)||void 0!==this.connectPromise||!1}async publish(e,t,r){this.isInitialized(),await this.publisher.publish(e,t,r),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:zO.relay},WO)}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,t){var r,n,i;this.isInitialized(),(null==t||!t.transportType||"relay"===t?.transportType)&&await this.toEstablishConnection();const o=typeof(null==(r=t?.internal)?void 0:r.throwOnFailedPublish)>"u"||(null==(n=t?.internal)?void 0:n.throwOnFailedPublish);let s,a=(null==(i=this.subscriber.topicMap.get(e))?void 0:i[0])||"";const c=t=>{t.topic===e&&(this.subscriber.off(KO,c),s())};return await Promise.all([new Promise(e=>{s=e,this.subscriber.on(KO,c)}),new Promise(async(r,n)=>{a=await this.subscriber.subscribe(e,bT({internal:{throwOnFailedPublish:o}},t)).catch(e=>{o&&n(e)})||a,r()})]),a}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await pw(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(this.subscriber.hasAnyTopics){if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,r)=>{await this.connect(e).then(t).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}else this.logger.info("Starting WS connection skipped because the client has no topics to work with.")}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await a_())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(0===e?.length)return void this.logger.trace("Batch message events is empty. Ignoring...");const t=e.sort((e,t)=>e.publishedAt-t.publishedAt);this.logger.debug(`Batch of ${t.length} message events sorted`);for(const e of t)try{await this.onMessageEvent(e)}catch(e){this.logger.warn(e,"Error while processing batch message event: "+e?.message)}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){const{topic:r}=e;if(!t.sessionExists){const e={topic:r,expiry:yw(dc.FIVE_MINUTES),relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,e)}this.events.emit(TO,e),await this.recordMessageEvent(e,qO)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(e,t)=>{const r=()=>{t(new Error("Connection interrupted while trying to connect"))};this.provider.once(jO,r),await pw(new Promise((e,t)=>{this.provider.connect().then(e).catch(t)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(e=>{t(e)}).finally(()=>{this.provider.off(jO,r),clearTimeout(this.reconnectTimeout)}),await new Promise(async(e,r)=>{const n=()=>{t(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(jO,n),await this.subscriber.start().then(e).catch(r).finally(()=>{this.provider.off(jO,n)})}),this.hasExperiencedNetworkDisruption=!1,e()})}catch(e){await this.subscriber.stop();const t=e;this.logger.warn({},t.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(e=>setTimeout(e,dc.toMiliseconds(1*t))),t++}}startPingTimeout(){var e,t,r,n,i;if(tw())try{null!=(t=null==(e=this.provider)?void 0:e.connection)&&t.socket&&(null==(i=null==(n=null==(r=this.provider)?void 0:r.connection)?void 0:n.socket)||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(e){this.logger.warn(e,e?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new bO(new xO(lw({sdkVersion:HO,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){const{topic:r,message:n}=e;await this.messages.set(r,n,t)}async shouldIgnoreMessageEvent(e){const{topic:t,message:r}=e;if(!r||0===r.length)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;const n=this.messages.has(t,r);return n&&this.logger.warn(`Ignoring duplicate message: ${r}`),n}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),gO(e)){if(!e.method.endsWith("_subscription"))return;const t=e.params,{topic:r,message:n,publishedAt:i,attestation:o}=t.data,s={topic:r,message:n,publishedAt:i,transportType:zO.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(bT({type:"event",event:t.id},s)),this.events.emit(t.id,s),await this.acknowledgePayload(e),await this.onMessageEvent(s)}else mO(e)&&this.events.emit(kO,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,qO),this.events.emit(TO,e))}async acknowledgePayload(e){const t=oO(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off($O,this.onPayloadHandler),this.provider.off(MO,this.onConnectHandler),this.provider.off(jO,this.onDisconnectHandler),this.provider.off(FO,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await a_();c_(async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(e=>this.logger.error(e,e?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(nS,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&function(){var e;return!nw()||!qc()||"visible"===(null==(e=qc())?void 0:e.visibilityState)}())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(e){this.logger.warn(e,e?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(UO),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},dc.toMiliseconds(.1)))))}isInitialized(){if(!this.initialized){const{message:e}=FI("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise)return void await this.connectPromise;await this.connect()}}}function xT(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function IT(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const _T="[object Arguments]",ST="[object Object]";function AT(){}function OT(e){if(!e||"object"!=typeof e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&"[object Object]"===Object.prototype.toString.call(e)}function CT(e,t,r,n,i,o,s){const a=s(e,t,r,n,i,o);if(void 0!==a)return a;if(typeof e==typeof t)switch(typeof e){case"bigint":case"string":case"boolean":case"symbol":case"undefined":case"function":return e===t;case"number":return e===t||Object.is(e,t);case"object":return PT(e,t,o,s)}return PT(e,t,o,s)}function PT(e,t,r,n){if(Object.is(e,t))return!0;let i=IT(e),o=IT(t);if(i===_T&&(i=ST),o===_T&&(o=ST),i!==o)return!1;switch(i){case"[object String]":return e.toString()===t.toString();case"[object Number]":return function(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}(e.valueOf(),t.valueOf());case"[object Boolean]":case"[object Date]":case"[object Symbol]":return Object.is(e.valueOf(),t.valueOf());case"[object RegExp]":return e.source===t.source&&e.flags===t.flags;case"[object Function]":return e===t}const s=(r=r??new Map).get(e),a=r.get(t);if(null!=s&&null!=a)return s===t;r.set(e,t),r.set(t,e);try{switch(i){case"[object Map]":if(e.size!==t.size)return!1;for(const[i,o]of e.entries())if(!t.has(i)||!CT(o,t.get(i),i,e,t,r,n))return!1;return!0;case"[object Set]":{if(e.size!==t.size)return!1;const i=Array.from(e.values()),o=Array.from(t.values());for(let s=0;s<i.length;s++){const a=i[s],c=o.findIndex(i=>CT(a,i,void 0,e,t,r,n));if(-1===c)return!1;o.splice(c,1)}return!0}case"[object Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":case"[object BigUint64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object BigInt64Array]":case"[object Float32Array]":case"[object Float64Array]":if(typeof Buffer<"u"&&Buffer.isBuffer(e)!==Buffer.isBuffer(t)||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!CT(e[i],t[i],i,e,t,r,n))return!1;return!0;case"[object ArrayBuffer]":return e.byteLength===t.byteLength&&PT(new Uint8Array(e),new Uint8Array(t),r,n);case"[object DataView]":return e.byteLength===t.byteLength&&e.byteOffset===t.byteOffset&&PT(new Uint8Array(e),new Uint8Array(t),r,n);case"[object Error]":return e.name===t.name&&e.message===t.message;case ST:{if(!(PT(e.constructor,t.constructor,r,n)||OT(e)&&OT(t)))return!1;const i=[...Object.keys(e),...xT(e)],o=[...Object.keys(t),...xT(t)];if(i.length!==o.length)return!1;for(let o=0;o<i.length;o++){const s=i[o],a=e[s];if(!Object.hasOwn(t,s))return!1;if(!CT(a,t[s],s,e,t,r,n))return!1}return!0}default:return!1}}finally{r.delete(e),r.delete(t)}}function RT(e,t){return function(e,t,r){return CT(e,t,void 0,void 0,void 0,void 0,r)}(e,t,AT)}var TT=Object.defineProperty,kT=Object.getOwnPropertySymbols,NT=Object.prototype.hasOwnProperty,UT=Object.prototype.propertyIsEnumerable,BT=(e,t,r)=>t in e?TT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,LT=(e,t)=>{for(var r in t||(t={}))NT.call(t,r)&&BT(e,r,t[r]);if(kT)for(var r of kT(t))UT.call(t,r)&&BT(e,r,t[r]);return e},DT=(e,t,r)=>BT(e,"symbol"!=typeof t?t+"":t,r);class $T extends RA{constructor(e,t,r,n=_O,i=void 0){super(e,t,r,n),this.core=e,this.logger=t,this.name=r,DT(this,"map",new Map),DT(this,"version","0.3"),DT(this,"cached",[]),DT(this,"initialized",!1),DT(this,"getKey"),DT(this,"storagePrefix",_O),DT(this,"recentlyDeleted",[]),DT(this,"recentlyDeletedLimit",200),DT(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>{this.getKey&&null!==e&&!WI(e)?this.map.set(this.getKey(e),e):function(e){var t;return null==(t=e?.proposer)?void 0:t.publicKey}(e)?this.map.set(e.id,e):function(e){return e?.topic}(e)&&this.map.set(e.topic,e)}),this.cached=[],this.initialized=!0)}),DT(this,"set",async(e,t)=>{this.isInitialized(),this.map.has(e)?await this.update(e,t):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:e,value:t}),this.map.set(e,t),await this.persist())}),DT(this,"get",e=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:e}),this.getData(e))),DT(this,"getAll",e=>(this.isInitialized(),e?this.values.filter(t=>Object.keys(e).every(r=>RT(t[r],e[r]))):this.values)),DT(this,"update",async(e,t)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:e,update:t});const r=LT(LT({},this.getData(e)),t);this.map.set(e,r),await this.persist()}),DT(this,"delete",async(e,t)=>{this.isInitialized(),this.map.has(e)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:e,reason:t}),this.map.delete(e),this.addToRecentlyDeleted(e),await this.persist())}),this.logger=bA(t,this.name),this.storagePrefix=n,this.getKey=i}get context(){return wA(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:t}=FI("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(t),new Error(t)}const{message:t}=FI("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(t),new Error(t)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:e}=FI("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=FI("NOT_INITIALIZED",this.name);throw new Error(e)}}}var MT=Object.defineProperty,jT=(e,t,r)=>((e,t,r)=>t in e?MT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class FT{constructor(e,t){this.core=e,this.logger=t,jT(this,"name","pairing"),jT(this,"version","0.3"),jT(this,"events",new Ge),jT(this,"pairings"),jT(this,"initialized",!1),jT(this,"storagePrefix",_O),jT(this,"ignoredPayloadTypes",[1]),jT(this,"registeredMethods",[]),jT(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),jT(this,"register",({methods:e})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...e])]}),jT(this,"create",async e=>{this.isInitialized();const t=oI(),r=await this.core.crypto.setSymKey(t),n=yw(dc.FIVE_MINUTES),i={protocol:"irn"},o={topic:r,expiry:n,relay:i,active:!1,methods:e?.methods},s=II({protocol:this.core.protocol,version:this.core.version,topic:r,symKey:t,relay:i,expiryTimestamp:n,methods:e?.methods});return this.events.emit(XO,o),this.core.expirer.set(r,n),await this.pairings.set(r,o),await this.core.relayer.subscribe(r,{transportType:e?.transportType,internal:e?.internal}),{topic:r,uri:s}}),jT(this,"pair",async e=>{this.isInitialized();const t=this.core.eventClient.createEvent({properties:{topic:e?.uri,trace:[pC]}});this.isValidPair(e,t);const{topic:r,symKey:n,relay:i,expiryTimestamp:o,methods:s}=EI(e.uri);let a;if(t.props.properties.topic=r,t.addTrace(gC),t.addTrace(mC),this.pairings.keys.includes(r)){if(a=this.pairings.get(r),t.addTrace(vC),a.active)throw t.setError(AC),new Error(`Pairing already exists: ${r}. Please try again with a new connection URI.`);t.addTrace(EC)}const c=o||yw(dc.FIVE_MINUTES),l={topic:r,relay:i,expiry:c,active:!1,methods:s};this.core.expirer.set(r,c),await this.pairings.set(r,l),t.addTrace(yC),e.activatePairing&&await this.activate({topic:r}),this.events.emit(XO,l),t.addTrace(xC),this.core.crypto.keychain.has(r)||await this.core.crypto.setSymKey(n,r),t.addTrace(wC);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{t.setError(_C)}try{await this.core.relayer.subscribe(r,{relay:i})}catch(e){throw t.setError(OC),e}return t.addTrace(bC),l}),jT(this,"activate",async({topic:e})=>{this.isInitialized();const t=yw(dc.FIVE_MINUTES);this.core.expirer.set(e,t),await this.pairings.update(e,{active:!0,expiry:t})}),jT(this,"ping",async e=>{this.isInitialized(),await this.isValidPing(e),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:t}=e;if(this.pairings.keys.includes(t)){const e=await this.sendRequest(t,"wc_pairingPing",{}),{done:r,resolve:n,reject:i}=fw();this.events.once(bw("pairing_ping",e),({error:e})=>{e?i(e):n()}),await r()}}),jT(this,"updateExpiry",async({topic:e,expiry:t})=>{this.isInitialized(),await this.pairings.update(e,{expiry:t})}),jT(this,"updateMetadata",async({topic:e,metadata:t})=>{this.isInitialized(),await this.pairings.update(e,{peerMetadata:t})}),jT(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),jT(this,"disconnect",async e=>{this.isInitialized(),await this.isValidDisconnect(e);const{topic:t}=e;this.pairings.keys.includes(t)&&(await this.sendRequest(t,"wc_pairingDelete",HI("USER_DISCONNECTED")),await this.deletePairing(t))}),jT(this,"formatUriFromPairing",e=>{this.isInitialized();const{topic:t,relay:r,expiry:n,methods:i}=e,o=this.core.crypto.keychain.get(t);return II({protocol:this.core.protocol,version:this.core.version,topic:t,symKey:o,relay:r,expiryTimestamp:n,methods:i})}),jT(this,"sendRequest",async(e,t,r)=>{const n=iO(t,r),i=await this.core.crypto.encode(e,n),o=JO[t].req;return this.core.history.set(e,n),this.core.relayer.publish(e,i,o),n.id}),jT(this,"sendResult",async(e,t,r)=>{const n=oO(e,r),i=await this.core.crypto.encode(t,n),o=(await this.core.history.get(t,e)).request.method,s=JO[o].res;await this.core.relayer.publish(t,i,s),await this.core.history.resolve(n)}),jT(this,"sendError",async(e,t,r)=>{const n=sO(e,r),i=await this.core.crypto.encode(t,n),o=(await this.core.history.get(t,e)).request.method,s=JO[o]?JO[o].res:JO.unregistered_method.res;await this.core.relayer.publish(t,i,s),await this.core.history.resolve(n)}),jT(this,"deletePairing",async(e,t)=>{await this.core.relayer.unsubscribe(e),await Promise.all([this.pairings.delete(e,HI("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(e),t?Promise.resolve():this.core.expirer.del(e)])}),jT(this,"cleanup",async()=>{const e=this.pairings.getAll().filter(e=>ww(e.expiry));await Promise.all(e.map(e=>this.deletePairing(e.topic)))}),jT(this,"onRelayEventRequest",async e=>{const{topic:t,payload:r}=e;switch(r.method){case"wc_pairingPing":return await this.onPairingPingRequest(t,r);case"wc_pairingDelete":return await this.onPairingDeleteRequest(t,r);default:return await this.onUnknownRpcMethodRequest(t,r)}}),jT(this,"onRelayEventResponse",async e=>{const{topic:t,payload:r}=e,n=(await this.core.history.get(t,r.id)).request.method;return"wc_pairingPing"===n?this.onPairingPingResponse(t,r):this.onUnknownRpcMethodResponse(n)}),jT(this,"onPairingPingRequest",async(e,t)=>{const{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult(r,e,!0),this.events.emit(tC,{id:r,topic:e})}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),jT(this,"onPairingPingResponse",(e,t)=>{const{id:r}=t;setTimeout(()=>{yO(t)?this.events.emit(bw("pairing_ping",r),{}):wO(t)&&this.events.emit(bw("pairing_ping",r),{error:t.error})},500)}),jT(this,"onPairingDeleteRequest",async(e,t)=>{const{id:r}=t;try{this.isValidDisconnect({topic:e}),await this.deletePairing(e),this.events.emit(eC,{id:r,topic:e})}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),jT(this,"onUnknownRpcMethodRequest",async(e,t)=>{const{id:r,method:n}=t;try{if(this.registeredMethods.includes(n))return;const t=HI("WC_METHOD_UNSUPPORTED",n);await this.sendError(r,e,t),this.logger.error(t)}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),jT(this,"onUnknownRpcMethodResponse",e=>{this.registeredMethods.includes(e)||this.logger.error(HI("WC_METHOD_UNSUPPORTED",e))}),jT(this,"isValidPair",(e,t)=>{var r;if(!t_(e)){const{message:r}=FI("MISSING_OR_INVALID",`pair() params: ${e}`);throw t.setError(SC),new Error(r)}if(!function(e){function t(e){try{return typeof new URL(e)<"u"}catch{return!1}}try{if(VI(e,!1))return!!t(e)||t(Sw(e))}catch{}return!1}(e.uri)){const{message:r}=FI("MISSING_OR_INVALID",`pair() uri: ${e.uri}`);throw t.setError(SC),new Error(r)}const n=EI(e?.uri);if(null==(r=n?.relay)||!r.protocol){const{message:e}=FI("MISSING_OR_INVALID","pair() uri#relay-protocol");throw t.setError(SC),new Error(e)}if(null==n||!n.symKey){const{message:e}=FI("MISSING_OR_INVALID","pair() uri#symKey");throw t.setError(SC),new Error(e)}if(null!=n&&n.expiryTimestamp&&dc.toMiliseconds(n?.expiryTimestamp)<Date.now()){t.setError(CC);const{message:e}=FI("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(e)}}),jT(this,"isValidPing",async e=>{if(!t_(e)){const{message:t}=FI("MISSING_OR_INVALID",`ping() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidPairingTopic(t)}),jT(this,"isValidDisconnect",async e=>{if(!t_(e)){const{message:t}=FI("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidPairingTopic(t)}),jT(this,"isValidPairingTopic",async e=>{if(!VI(e,!1)){const{message:t}=FI("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.pairings.keys.includes(e)){const{message:t}=FI("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(ww(this.pairings.get(e).expiry)){await this.deletePairing(e);const{message:t}=FI("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}),this.core=e,this.logger=bA(t,this.name),this.pairings=new $T(this.core,this.logger,this.name,this.storagePrefix)}get context(){return wA(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=FI("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(TO,async e=>{const{topic:t,message:r,transportType:n}=e;if(this.pairings.keys.includes(t)&&n!==zO.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{const e=await this.core.crypto.decode(t,r);gO(e)?(this.core.history.set(t,e),await this.onRelayEventRequest({topic:t,payload:e})):mO(e)&&(await this.core.history.resolve(e),await this.onRelayEventResponse({topic:t,payload:e}),this.core.history.delete(t,e.id)),await this.core.relayer.messages.ack(t,r)}catch(e){this.logger.error(e)}})}registerExpirerEvents(){this.core.expirer.on(cC,async e=>{const{topic:t}=mw(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(QO,{topic:t}))})}}var HT=Object.defineProperty,zT=(e,t,r)=>((e,t,r)=>t in e?HT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class qT extends AA{constructor(e,t){super(e,t),this.core=e,this.logger=t,zT(this,"records",new Map),zT(this,"events",new Ke.EventEmitter),zT(this,"name","history"),zT(this,"version","0.3"),zT(this,"cached",[]),zT(this,"initialized",!1),zT(this,"storagePrefix",_O),zT(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.records.set(e.id,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),zT(this,"set",(e,t,r)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:r}),this.records.has(t.id))return;const n={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:r,expiry:yw(dc.THIRTY_DAYS)};this.records.set(n.id,n),this.persist(),this.events.emit(rC,n)}),zT(this,"resolve",async e=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:e}),!this.records.has(e.id))return;const t=await this.getRecord(e.id);typeof t.response>"u"&&(t.response=wO(e)?{error:e.error}:{result:e.result},this.records.set(t.id,t),this.persist(),this.events.emit(nC,t))}),zT(this,"get",async(e,t)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:e,id:t}),await this.getRecord(t))),zT(this,"delete",(e,t)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:t}),this.values.forEach(r=>{if(r.topic===e){if(typeof t<"u"&&r.id!==t)return;this.records.delete(r.id),this.events.emit(iC,r)}}),this.persist()}),zT(this,"exists",async(e,t)=>(this.isInitialized(),!!this.records.has(t)&&(await this.getRecord(t)).topic===e)),zT(this,"on",(e,t)=>{this.events.on(e,t)}),zT(this,"once",(e,t)=>{this.events.once(e,t)}),zT(this,"off",(e,t)=>{this.events.off(e,t)}),zT(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=bA(t,this.name)}get context(){return wA(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const r={topic:t.topic,request:iO(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:t}=FI("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(oC)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:e}=FI("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(rC,e=>{const t=rC;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(nC,e=>{const t=nC;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(iC,e=>{const t=iC;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(nS,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{dc.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(iC,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=FI("NOT_INITIALIZED",this.name);throw new Error(e)}}}var WT=Object.defineProperty,VT=(e,t,r)=>((e,t,r)=>t in e?WT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class KT extends kA{constructor(e,t){super(e,t),this.core=e,this.logger=t,VT(this,"expirations",new Map),VT(this,"events",new Ke.EventEmitter),VT(this,"name","expirer"),VT(this,"version","0.3"),VT(this,"cached",[]),VT(this,"initialized",!1),VT(this,"storagePrefix",_O),VT(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.expirations.set(e.target,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),VT(this,"has",e=>{try{const t=this.formatTarget(e);return typeof this.getExpiration(t)<"u"}catch{return!1}}),VT(this,"set",(e,t)=>{this.isInitialized();const r=this.formatTarget(e),n={target:r,expiry:t};this.expirations.set(r,n),this.checkExpiry(r,n),this.events.emit(sC,{target:r,expiration:n})}),VT(this,"get",e=>{this.isInitialized();const t=this.formatTarget(e);return this.getExpiration(t)}),VT(this,"del",e=>{if(this.isInitialized(),this.has(e)){const t=this.formatTarget(e),r=this.getExpiration(t);this.expirations.delete(t),this.events.emit(aC,{target:t,expiration:r})}}),VT(this,"on",(e,t)=>{this.events.on(e,t)}),VT(this,"once",(e,t)=>{this.events.once(e,t)}),VT(this,"off",(e,t)=>{this.events.off(e,t)}),VT(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=bA(t,this.name)}get context(){return wA(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if("string"==typeof e)return function(e){return gw("topic",e)}(e);if("number"==typeof e)return function(e){return gw("id",e)}(e);const{message:t}=FI("UNKNOWN_TYPE","Target type: "+typeof e);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(lC)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:e}=FI("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:t}=FI("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(t),new Error(t)}return t}checkExpiry(e,t){const{expiry:r}=t;dc.toMiliseconds(r)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(cC,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(nS,()=>this.checkExpirations()),this.events.on(sC,e=>{const t=sC;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(cC,e=>{const t=cC;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(aC,e=>{const t=aC;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=FI("NOT_INITIALIZED",this.name);throw new Error(e)}}}var GT=Object.defineProperty,ZT=(e,t,r)=>((e,t,r)=>t in e?GT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class YT extends NA{constructor(e,t,r){super(e,t,r),this.core=e,this.logger=t,this.store=r,ZT(this,"name","verify-api"),ZT(this,"abortController"),ZT(this,"isDevEnv"),ZT(this,"verifyUrlV3",dC),ZT(this,"storagePrefix",_O),ZT(this,"version",2),ZT(this,"publicKey"),ZT(this,"fetchPromise"),ZT(this,"init",async()=>{var e;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&dc.toMiliseconds(null==(e=this.publicKey)?void 0:e.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),ZT(this,"register",async e=>{if(!nw()||this.isDevEnv)return;const t=window.location.origin,{id:r,decryptedId:n}=e,i=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${t}&id=${r}&decryptedId=${n}`;try{const e=qc(),t=this.startAbortTimer(5*dc.ONE_SECOND),n=await new Promise((n,o)=>{const s=()=>{window.removeEventListener("message",c),e.body.removeChild(a),o("attestation aborted")};this.abortController.signal.addEventListener("abort",s);const a=e.createElement("iframe");a.src=i,a.style.display="none",a.addEventListener("error",s,{signal:this.abortController.signal});const c=i=>{if(i.data&&"string"==typeof i.data)try{const o=JSON.parse(i.data);if("verify_attestation"===o.type){if(Qg(o.attestation).payload.id!==r)return;clearInterval(t),e.body.removeChild(a),this.abortController.signal.removeEventListener("abort",s),window.removeEventListener("message",c),n(null===o.attestation?"":o.attestation)}}catch(e){this.logger.warn(e)}};e.body.appendChild(a),window.addEventListener("message",c,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",n),n}catch(e){this.logger.warn(e)}return""}),ZT(this,"resolve",async e=>{if(this.isDevEnv)return"";const{attestationId:t,hash:r,encryptedId:n}=e;if(""===t)return void this.logger.debug("resolve: attestationId is empty, skipping");if(t){if(Qg(t).payload.id!==n)return;const e=await this.isValidJwtAttestation(t);if(e)return e.isVerified?e:void this.logger.warn("resolve: jwt attestation: origin url not verified")}if(!r)return;const i=this.getVerifyUrl(e?.verifyUrl);return this.fetchAttestation(r,i)}),ZT(this,"fetchAttestation",async(e,t)=>{this.logger.debug(`resolving attestation: ${e} from url: ${t}`);const r=this.startAbortTimer(5*dc.ONE_SECOND),n=await fetch(`${t}/attestation/${e}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(r),200===n.status?await n.json():void 0}),ZT(this,"getVerifyUrl",e=>{let t=e||hC;return fC.includes(t)||(this.logger.info(`verify url: ${t}, not included in trusted list, assigning default: ${hC}`),t=hC),t}),ZT(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const e=this.startAbortTimer(dc.FIVE_SECONDS),t=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(e),await t.json()}catch(e){this.logger.warn(e)}}),ZT(this,"persistPublicKey",async e=>{this.logger.debug("persisting public key to local storage",e),await this.store.setItem(this.storeKey,e),this.publicKey=e}),ZT(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),ZT(this,"isValidJwtAttestation",async e=>{const t=await this.getPublicKey();try{if(t)return this.validateAttestation(e,t)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}const r=await this.fetchAndPersistPublicKey();try{if(r)return this.validateAttestation(e,r)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}}),ZT(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),ZT(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async e=>{const t=await this.fetchPublicKey();t&&(await this.persistPublicKey(t),e(t))});const e=await this.fetchPromise;return this.fetchPromise=void 0,e}),ZT(this,"validateAttestation",(e,t)=>{const r=yI(e,t.publicKey),n={hasExpired:dc.toMiliseconds(r.exp)<Date.now(),payload:r};if(n.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:n.payload.origin,isScam:n.payload.isScam,isVerified:n.payload.isVerified}}),this.logger=bA(t,this.name),this.abortController=new AbortController,this.isDevEnv=_w(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return wA(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),dc.toMiliseconds(e))}}var JT=Object.defineProperty,XT=(e,t,r)=>((e,t,r)=>t in e?JT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class QT extends UA{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,XT(this,"context","echo"),XT(this,"registerDeviceToken",async e=>{const{clientId:t,token:r,notificationType:n,enableEncrypted:i=!1}=e,o=`https://echo.walletconnect.com/${this.projectId}/clients`;await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:t,type:n,token:r,always_raw:i})})}),this.logger=bA(t,this.context)}}var ek=Object.defineProperty,tk=Object.getOwnPropertySymbols,rk=Object.prototype.hasOwnProperty,nk=Object.prototype.propertyIsEnumerable,ik=(e,t,r)=>t in e?ek(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ok=(e,t)=>{for(var r in t||(t={}))rk.call(t,r)&&ik(e,r,t[r]);if(tk)for(var r of tk(t))nk.call(t,r)&&ik(e,r,t[r]);return e},sk=(e,t,r)=>ik(e,"symbol"!=typeof t?t+"":t,r);class ak extends BA{constructor(e,t,r=!0){super(e,t,r),this.core=e,this.logger=t,sk(this,"context","event-client"),sk(this,"storagePrefix",_O),sk(this,"storageVersion",.1),sk(this,"events",new Map),sk(this,"shouldPersist",!1),sk(this,"init",async()=>{if(!_w())try{const e={eventId:Iw(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:cw(this.core.relayer.protocol,this.core.relayer.version,HO)}}};await this.sendEvent([e])}catch(e){this.logger.warn(e)}}),sk(this,"createEvent",e=>{const{event:t="ERROR",type:r="",properties:{topic:n,trace:i}}=e,o=Iw(),s=this.core.projectId||"",a=Date.now(),c=ok({eventId:o,timestamp:a,props:{event:t,type:r,properties:{topic:n,trace:i}},bundleId:s,domain:this.getAppDomain()},this.setMethods(o));return this.telemetryEnabled&&(this.events.set(o,c),this.shouldPersist=!0),c}),sk(this,"getEvent",e=>{const{eventId:t,topic:r}=e;if(t)return this.events.get(t);const n=Array.from(this.events.values()).find(e=>e.props.properties.topic===r);return n?ok(ok({},n),this.setMethods(n.eventId)):void 0}),sk(this,"deleteEvent",e=>{const{eventId:t}=e;this.events.delete(t),this.shouldPersist=!0}),sk(this,"setEventListeners",()=>{this.core.heartbeat.on(nS,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(e=>{dc.fromMiliseconds(Date.now())-dc.fromMiliseconds(e.timestamp)>86400&&(this.events.delete(e.eventId),this.shouldPersist=!0)})})}),sk(this,"setMethods",e=>({addTrace:t=>this.addTrace(e,t),setError:t=>this.setError(e,t)})),sk(this,"addTrace",(e,t)=>{const r=this.events.get(e);r&&(r.props.properties.trace.push(t),this.events.set(e,r),this.shouldPersist=!0)}),sk(this,"setError",(e,t)=>{const r=this.events.get(e);r&&(r.props.type=t,r.timestamp=Date.now(),this.events.set(e,r),this.shouldPersist=!0)}),sk(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),sk(this,"restore",async()=>{try{const e=await this.core.storage.getItem(this.storageKey)||[];if(!e.length)return;e.forEach(e=>{this.events.set(e.eventId,ok(ok({},e),this.setMethods(e.eventId)))})}catch(e){this.logger.warn(e)}}),sk(this,"submit",async()=>{if(!this.telemetryEnabled||0===this.events.size)return;const e=[];for(const[t,r]of this.events)r.props.type&&e.push(r);if(0!==e.length)try{if((await this.sendEvent(e)).ok)for(const t of e)this.events.delete(t.eventId),this.shouldPersist=!0}catch(e){this.logger.warn(e)}}),sk(this,"sendEvent",async e=>{const t=this.getAppDomain()?"":"&sp=desktop";return await fetch(`https://pulse.walletconnect.org/batch?projectId=${this.core.projectId}&st=events_sdk&sv=js-${HO}${t}`,{method:"POST",body:JSON.stringify(e)})}),sk(this,"getAppDomain",()=>aw().url),this.logger=bA(t,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var ck=Object.defineProperty,lk=Object.getOwnPropertySymbols,uk=Object.prototype.hasOwnProperty,hk=Object.prototype.propertyIsEnumerable,dk=(e,t,r)=>t in e?ck(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,fk=(e,t)=>{for(var r in t||(t={}))uk.call(t,r)&&dk(e,r,t[r]);if(lk)for(var r of lk(t))hk.call(t,r)&&dk(e,r,t[r]);return e},pk=(e,t,r)=>dk(e,"symbol"!=typeof t?t+"":t,r);const gk=class e extends IA{constructor(e){var t;super(e),pk(this,"protocol","wc"),pk(this,"version",2),pk(this,"name",IO),pk(this,"relayUrl"),pk(this,"projectId"),pk(this,"customStoragePrefix"),pk(this,"events",new Ke.EventEmitter),pk(this,"logger"),pk(this,"heartbeat"),pk(this,"relayer"),pk(this,"crypto"),pk(this,"storage"),pk(this,"history"),pk(this,"expirer"),pk(this,"pairing"),pk(this,"verify"),pk(this,"echoClient"),pk(this,"linkModeSupportedApps"),pk(this,"eventClient"),pk(this,"initialized",!1),pk(this,"logChunkController"),pk(this,"on",(e,t)=>this.events.on(e,t)),pk(this,"once",(e,t)=>this.events.once(e,t)),pk(this,"off",(e,t)=>this.events.off(e,t)),pk(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),pk(this,"dispatchEnvelope",({topic:e,message:t,sessionExists:r})=>{if(!e||!t)return;const n={topic:e,message:t,publishedAt:Date.now(),transportType:zO.link_mode};this.relayer.onLinkMessageEvent(n,{sessionExists:r})});const r=this.getGlobalCore(e?.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(e){console.warn("Failed to copy global core",e)}this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||RO,this.customStoragePrefix=null!=e&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const n=yA({level:"string"==typeof e?.logger&&e.logger?e.logger:SO,name:IO}),{logger:i,chunkLoggerController:o}=vA({opts:n,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=o,null!=(t=this.logChunkController)&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var e,t;null!=(e=this.logChunkController)&&e.downloadLogsBlobInBrowser&&(null==(t=this.logChunkController)||t.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=bA(i,this.name),this.heartbeat=new iS,this.crypto=new NR(this,this.logger,e?.keychain),this.history=new qT(this,this.logger),this.expirer=new KT(this,this.logger),this.storage=null!=e&&e.storage?e.storage:new BS(fk(fk({},AO),e?.storageOptions)),this.relayer=new ET({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new FT(this,this.logger),this.verify=new YT(this,this.logger,this.storage),this.echoClient=new QT(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new ak(this,this.logger,e?.telemetryEnabled),this.setGlobalCore(this)}static async init(t){const r=new e(t);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem("WALLETCONNECT_CLIENT_ID",n),r}get context(){return wA(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return null==(e=this.logChunkController)?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(VO,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(VO)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const t=`_walletConnectCore_${e}`,r=`${t}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[t]}catch(e){return void console.warn("Failed to get global WalletConnect core",e)}}setGlobalCore(e){var t;try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${(null==(t=e.opts)?void 0:t.customStoragePrefix)||""}`;globalThis[r]=e}catch(e){console.warn("Failed to set global WalletConnect core",e)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&"true"===process.env.DISABLE_GLOBAL_CORE}catch{return!0}}},mk="client",yk=`wc@2:${mk}:`,wk=mk,bk="error",vk="WALLETCONNECT_DEEPLINK_CHOICE",Ek="Proposal expired",xk=dc.SEVEN_DAYS,Ik={wc_sessionPropose:{req:{ttl:dc.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:dc.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:dc.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:dc.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:dc.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:dc.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:dc.ONE_DAY,prompt:!1,tag:1104},res:{ttl:dc.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:dc.ONE_DAY,prompt:!1,tag:1106},res:{ttl:dc.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:dc.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:dc.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:dc.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:dc.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:dc.ONE_DAY,prompt:!1,tag:1112},res:{ttl:dc.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:dc.ONE_DAY,prompt:!1,tag:1114},res:{ttl:dc.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:dc.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:dc.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:dc.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:dc.FIVE_MINUTES,prompt:!1,tag:1119}}},_k={min:dc.FIVE_MINUTES,max:dc.SEVEN_DAYS},Sk="IDLE",Ak="ACTIVE",Ok={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},Ck=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],Pk="wc@1.5:auth:",Rk=`${Pk}:PUB_KEY`;var Tk=Object.defineProperty,kk=Object.defineProperties,Nk=Object.getOwnPropertyDescriptors,Uk=Object.getOwnPropertySymbols,Bk=Object.prototype.hasOwnProperty,Lk=Object.prototype.propertyIsEnumerable,Dk=(e,t,r)=>t in e?Tk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,$k=(e,t)=>{for(var r in t||(t={}))Bk.call(t,r)&&Dk(e,r,t[r]);if(Uk)for(var r of Uk(t))Lk.call(t,r)&&Dk(e,r,t[r]);return e},Mk=(e,t)=>kk(e,Nk(t)),jk=(e,t,r)=>Dk(e,"symbol"!=typeof t?t+"":t,r);let Fk=class extends MA{constructor(e){super(e),jk(this,"name","engine"),jk(this,"events",new Ge),jk(this,"initialized",!1),jk(this,"requestQueue",{state:Sk,queue:[]}),jk(this,"sessionRequestQueue",{state:Sk,queue:[]}),jk(this,"emittedSessionRequests",new Aw({limit:500})),jk(this,"requestQueueDelay",dc.ONE_SECOND),jk(this,"expectedPairingMethodMap",new Map),jk(this,"recentlyDeletedMap",new Map),jk(this,"recentlyDeletedLimit",200),jk(this,"relayMessageCache",[]),jk(this,"pendingSessions",new Map),jk(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Ik)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},dc.toMiliseconds(this.requestQueueDelay)))}),jk(this,"connect",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const t=Mk($k({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});await this.isValidConnect(t),t.optionalNamespaces=function(e,t){var r,n,i,o,s,a;const c=DI(e),l=DI(t),u={},h=Object.keys(c).concat(Object.keys(l));for(const e of h)u[e]={chains:vw(null==(r=c[e])?void 0:r.chains,null==(n=l[e])?void 0:n.chains),methods:vw(null==(i=c[e])?void 0:i.methods,null==(o=l[e])?void 0:o.methods),events:vw(null==(s=c[e])?void 0:s.events,null==(a=l[e])?void 0:a.events)};return u}(t.requiredNamespaces,t.optionalNamespaces),t.requiredNamespaces={};const{pairingTopic:r,requiredNamespaces:n,optionalNamespaces:i,sessionProperties:o,scopedProperties:s,relays:a}=t;let c,l=r,u=!1;try{if(l){const e=this.client.core.pairing.pairings.get(l);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),u=e.active}}catch(e){throw this.client.logger.error(`connect() -> pairing.get(${l}) failed`),e}if(!l||!u){const{topic:e,uri:t}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});l=e,c=t}if(!l){const{message:e}=FI("NO_MATCHING_KEY",`connect() pairing topic: ${l}`);throw new Error(e)}const h=await this.client.core.crypto.generateKeyPair(),d=Ik.wc_sessionPropose.req.ttl||dc.FIVE_MINUTES,f=yw(d),p=Mk($k($k({requiredNamespaces:n,optionalNamespaces:i,relays:a??[{protocol:"irn"}],proposer:{publicKey:h,metadata:this.client.metadata},expiryTimestamp:f,pairingTopic:l},o&&{sessionProperties:o}),s&&{scopedProperties:s}),{id:rO()}),g=bw("session_connect",p.id),{reject:m,resolve:y,done:w}=fw(d,Ek),b=({id:e})=>{e===p.id&&(this.client.events.off("proposal_expire",b),this.pendingSessions.delete(p.id),this.events.emit(g,{error:{message:Ek,code:0}}))};return this.client.events.on("proposal_expire",b),this.events.once(g,({error:e,session:t})=>{this.client.events.off("proposal_expire",b),e?m(e):t&&y(t)}),await this.sendProposeSession({proposal:p,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:p.id}}}),await this.setProposal(p.id,p),{uri:c,approval:w}}),jk(this,"pair",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(e)}catch(e){throw this.client.logger.error("pair() failed"),e}}),jk(this,"approve",async e=>{var t,r,n;const i=this.client.core.eventClient.createEvent({properties:{topic:null==(t=e?.id)?void 0:t.toString(),trace:[RC]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(e){throw i.setError(LC),e}try{await this.isValidProposalId(e?.id)}catch(t){throw this.client.logger.error(`approve() -> proposal.get(${e?.id}) failed`),i.setError(jC),t}try{await this.isValidApprove(e)}catch(e){throw this.client.logger.error("approve() -> isValidApprove() failed"),i.setError(MC),e}const{id:o,relayProtocol:s,namespaces:a,sessionProperties:c,scopedProperties:l,sessionConfig:u}=e,h=this.client.proposal.get(o);this.client.core.eventClient.deleteEvent({eventId:i.eventId});const{pairingTopic:d,proposer:f,requiredNamespaces:p,optionalNamespaces:g}=h;let m=null==(r=this.client.core.eventClient)?void 0:r.getEvent({topic:d});m||(m=null==(n=this.client.core.eventClient)?void 0:n.createEvent({type:RC,properties:{topic:d,trace:[RC,TC]}}));const y=await this.client.core.crypto.generateKeyPair(),w=f.publicKey,b=await this.client.core.crypto.generateSharedKey(y,w),v=$k($k($k({relay:{protocol:s??"irn"},namespaces:a,controller:{publicKey:y,metadata:this.client.metadata},expiry:yw(xk)},c&&{sessionProperties:c}),l&&{scopedProperties:l}),u&&{sessionConfig:u}),E=zO.relay;m.addTrace(kC);try{await this.client.core.relayer.subscribe(b,{transportType:E,internal:{skipSubscribe:!0}})}catch(e){throw m.setError($C),e}m.addTrace(NC);const x=Mk($k({},v),{topic:b,requiredNamespaces:p,optionalNamespaces:g,pairingTopic:d,acknowledged:!1,self:v.controller,peer:{publicKey:f.publicKey,metadata:f.metadata},controller:y,transportType:zO.relay});await this.client.session.set(b,x),m.addTrace(BC);try{await this.sendApproveSession({sessionTopic:b,proposal:h,pairingProposalResponse:{relay:{protocol:s??"irn"},responderPublicKey:y},sessionSettleRequest:v,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:o}}}),m.addTrace(UC)}catch(e){throw this.client.logger.error(e),this.client.session.delete(b,HI("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(b),e}return this.client.core.eventClient.deleteEvent({eventId:m.eventId}),await this.client.core.pairing.updateMetadata({topic:d,metadata:f.metadata}),await this.deleteProposal(o),await this.client.core.pairing.activate({topic:d}),await this.setExpiry(b,yw(xk)),{topic:b,acknowledged:()=>Promise.resolve(this.client.session.get(b))}}),jk(this,"reject",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(e)}catch(e){throw this.client.logger.error("reject() -> isValidReject() failed"),e}const{id:t,reason:r}=e;let n;try{n=this.client.proposal.get(t).pairingTopic}catch(e){throw this.client.logger.error(`reject() -> proposal.get(${t}) failed`),e}n&&await this.sendError({id:t,topic:n,error:r,rpcOpts:Ik.wc_sessionPropose.reject}),await this.deleteProposal(t)}),jk(this,"update",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(e)}catch(e){throw this.client.logger.error("update() -> isValidUpdate() failed"),e}const{topic:t,namespaces:r}=e,{done:n,resolve:i,reject:o}=fw(),s=rO(),a=nO().toString(),c=this.client.session.get(t).namespaces;return this.events.once(bw("session_update",s),({error:e})=>{e?o(e):i()}),await this.client.session.update(t,{namespaces:r}),await this.sendRequest({topic:t,method:"wc_sessionUpdate",params:{namespaces:r},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:a}).catch(e=>{this.client.logger.error(e),this.client.session.update(t,{namespaces:c}),o(e)}),{acknowledged:n}}),jk(this,"extend",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(e)}catch(e){throw this.client.logger.error("extend() -> isValidExtend() failed"),e}const{topic:t}=e,r=rO(),{done:n,resolve:i,reject:o}=fw();return this.events.once(bw("session_extend",r),({error:e})=>{e?o(e):i()}),await this.setExpiry(t,yw(xk)),this.sendRequest({topic:t,method:"wc_sessionExtend",params:{},clientRpcId:r,throwOnFailedPublish:!0}).catch(e=>{o(e)}),{acknowledged:n}}),jk(this,"request",async e=>{this.isInitialized();try{await this.isValidRequest(e)}catch(e){throw this.client.logger.error("request() -> isValidRequest() failed"),e}const{chainId:t,request:r,topic:n,expiry:i=Ik.wc_sessionRequest.req.ttl}=e,o=this.client.session.get(n);o?.transportType===zO.relay&&await this.confirmOnlineStateOrThrow();const s=rO(),a=nO().toString(),{done:c,resolve:l,reject:u}=fw(i,"Request expired. Please try again.");this.events.once(bw("session_request",s),({error:e,result:t})=>{e?u(e):l(t)});const h="wc_sessionRequest",d=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);if(d)return await this.sendRequest({clientRpcId:s,relayRpcId:a,topic:n,method:h,params:{request:Mk($k({},r),{expiryTimestamp:yw(i)}),chainId:t},expiry:i,throwOnFailedPublish:!0,appLink:d}).catch(e=>u(e)),this.client.events.emit("session_request_sent",{topic:n,request:r,chainId:t,id:s}),await c();const f={request:Mk($k({},r),{expiryTimestamp:yw(i)}),chainId:t};return await Promise.all([new Promise(async e=>{await this.sendRequest({clientRpcId:s,relayRpcId:a,topic:n,method:h,params:f,expiry:i,throwOnFailedPublish:!0,tvf:this.getTVFParams(s,f)}).catch(e=>u(e)),this.client.events.emit("session_request_sent",{topic:n,request:r,chainId:t,id:s}),e()}),new Promise(async e=>{var t;if(null==(t=o.sessionConfig)||!t.disableDeepLink){const e=await async function(e,t){let r="";try{if(nw()&&(r=localStorage.getItem(t),r))return r;r=await e.getItem(t)}catch(e){console.error(e)}return r}(this.client.core.storage,vk);await Ew({id:s,topic:n,wcDeepLink:e})}e()}),c()]).then(e=>e[2])}),jk(this,"respond",async e=>{this.isInitialized(),await this.isValidRespond(e);const{topic:t,response:r}=e,{id:n}=r,i=this.client.session.get(t);i.transportType===zO.relay&&await this.confirmOnlineStateOrThrow();const o=this.getAppLinkIfEnabled(i.peer.metadata,i.transportType);yO(r)?await this.sendResult({id:n,topic:t,result:r.result,throwOnFailedPublish:!0,appLink:o}):wO(r)&&await this.sendError({id:n,topic:t,error:r.error,appLink:o}),this.cleanupAfterResponse(e)}),jk(this,"ping",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(e)}catch(e){throw this.client.logger.error("ping() -> isValidPing() failed"),e}const{topic:t}=e;if(this.client.session.keys.includes(t)){const e=rO(),r=nO().toString(),{done:n,resolve:i,reject:o}=fw();this.events.once(bw("session_ping",e),({error:e})=>{e?o(e):i()}),await Promise.all([this.sendRequest({topic:t,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:e,relayRpcId:r}),n()])}else this.client.core.pairing.pairings.keys.includes(t)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:t}))}),jk(this,"emit",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(e);const{topic:t,event:r,chainId:n}=e,i=nO().toString(),o=rO();await this.sendRequest({topic:t,method:"wc_sessionEvent",params:{event:r,chainId:n},throwOnFailedPublish:!0,relayRpcId:i,clientRpcId:o})}),jk(this,"disconnect",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(e);const{topic:t}=e;if(this.client.session.keys.includes(t))await this.sendRequest({topic:t,method:"wc_sessionDelete",params:HI("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:t,emitEvent:!1});else{if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:e}=FI("MISMATCHED_TOPIC",`Session or pairing topic not found: ${t}`);throw new Error(e)}await this.client.core.pairing.disconnect({topic:t})}}),jk(this,"find",e=>(this.isInitialized(),this.client.session.getAll().filter(t=>function(e,t){const{requiredNamespaces:r}=t,n=Object.keys(e.namespaces),i=Object.keys(r);let o=!0;return!!uw(i,n)&&(n.forEach(t=>{const{accounts:n,methods:i,events:s}=e.namespaces[t],a=UI(n),c=r[t];uw(jy(t,c),a)&&uw(c.methods,i)&&uw(c.events,s)||(o=!1)}),o)}(t,e)))),jk(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),jk(this,"authenticate",async(e,t)=>{var r;this.isInitialized(),this.isValidAuthenticate(e);const n=t&&this.client.core.linkModeSupportedApps.includes(t)&&(null==(r=this.client.metadata.redirect)?void 0:r.linkMode),i=n?zO.link_mode:zO.relay;i===zO.relay&&await this.confirmOnlineStateOrThrow();const{chains:o,statement:s="",uri:a,domain:c,nonce:l,type:u,exp:h,nbf:d,methods:f=[],expiry:p}=e,g=[...e.resources||[]],{topic:m,uri:y}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:i});this.client.logger.info({message:"Generated new pairing",pairing:{topic:m,uri:y}});const w=await this.client.core.crypto.generateKeyPair(),b=sI(w);if(await Promise.all([this.client.auth.authKeys.set(Rk,{responseTopic:b,publicKey:w}),this.client.auth.pairingTopics.set(b,{topic:b,pairingTopic:m})]),await this.client.core.relayer.subscribe(b,{transportType:i}),this.client.logger.info(`sending request to new pairing topic: ${m}`),f.length>0){const{namespace:e}=My(o[0]);let t=jv(e,"request",f);qv(g)&&(t=Fv(t,g.pop())),g.push(t)}const v=p&&p>Ik.wc_sessionAuthenticate.req.ttl?p:Ik.wc_sessionAuthenticate.req.ttl,E={authPayload:{type:u??"caip122",chains:o,statement:s,aud:a,domain:c,version:"1",nonce:l,iat:(new Date).toISOString(),exp:h,nbf:d,resources:g},requester:{publicKey:w,metadata:this.client.metadata},expiryTimestamp:yw(v)},x={requiredNamespaces:{},optionalNamespaces:{eip155:{chains:o,methods:[...new Set(["personal_sign",...f])],events:["chainChanged","accountsChanged"]}},relays:[{protocol:"irn"}],pairingTopic:m,proposer:{publicKey:w,metadata:this.client.metadata},expiryTimestamp:yw(Ik.wc_sessionPropose.req.ttl),id:rO()},{done:I,resolve:_,reject:S}=fw(v,"Request expired"),A=rO(),O=bw("session_connect",x.id),C=bw("session_request",A),P=async({error:e,session:t})=>{this.events.off(C,R),e?S(e):t&&_({session:t})},R=async e=>{var r,n,o;if(await this.deletePendingAuthRequest(A,{message:"fulfilled",code:0}),e.error){const t=HI("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return e.error.code===t.code?void 0:(this.events.off(O,P),S(e.error.message))}await this.deleteProposal(x.id),this.events.off(O,P);const{cacaos:s,responder:a}=e.result,c=[],l=[];for(const e of s){await Uv({cacao:e,projectId:this.client.core.projectId})||(this.client.logger.error(e,"Signature verification failed"),S(HI("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:t}=e,r=qv(t.resources),n=[kv(t.iss)],i=Nv(t.iss);if(r){const e=Hv(r),t=zv(r);c.push(...e),n.push(...t)}for(const e of n)l.push(`${e}:${i}`)}const u=await this.client.core.crypto.generateSharedKey(w,a.publicKey);let h;c.length>0&&(h={topic:u,acknowledged:!0,self:{publicKey:w,metadata:this.client.metadata},peer:a,controller:a.publicKey,expiry:yw(xk),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:m,namespaces:$I([...new Set(c)],[...new Set(l)]),transportType:i},await this.client.core.relayer.subscribe(u,{transportType:i}),await this.client.session.set(u,h),m&&await this.client.core.pairing.updateMetadata({topic:m,metadata:a.metadata}),h=this.client.session.get(u)),null!=(r=this.client.metadata.redirect)&&r.linkMode&&null!=(n=a.metadata.redirect)&&n.linkMode&&null!=(o=a.metadata.redirect)&&o.universal&&t&&(this.client.core.addLinkModeSupportedApp(a.metadata.redirect.universal),this.client.session.update(u,{transportType:zO.link_mode})),_({auths:s,session:h})};let T;this.events.once(O,P),this.events.once(C,R);try{if(n){const e=iO("wc_sessionAuthenticate",E,A);this.client.core.history.set(m,e);const r=await this.client.core.crypto.encode("",e,{type:2,encoding:nI});T=_I(t,m,r)}else await Promise.all([this.sendRequest({topic:m,method:"wc_sessionAuthenticate",params:E,expiry:e.expiry,throwOnFailedPublish:!0,clientRpcId:A}),this.sendRequest({topic:m,method:"wc_sessionPropose",params:x,expiry:Ik.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:x.id})])}catch(e){throw this.events.off(O,P),this.events.off(C,R),e}return await this.setProposal(x.id,x),await this.setAuthRequest(A,{request:Mk($k({},E),{verifyContext:{}}),pairingTopic:m,transportType:i}),{uri:T??y,response:I}}),jk(this,"approveSessionAuthenticate",async e=>{const{id:t,auths:r}=e,n=this.client.core.eventClient.createEvent({properties:{topic:t.toString(),trace:[FC]}});try{this.isInitialized()}catch(e){throw n.setError(GC),e}const i=this.getPendingAuthRequest(t);if(!i)throw n.setError(XC),new Error(`Could not find pending auth request with id ${t}`);const o=i.transportType||zO.relay;o===zO.relay&&await this.confirmOnlineStateOrThrow();const s=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=sI(s),l={type:1,receiverPublicKey:s,senderPublicKey:a},u=[],h=[];for(const e of r){if(!await Uv({cacao:e,projectId:this.client.core.projectId})){n.setError(ZC);const e=HI("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:t,topic:c,error:e,encodeOpts:l}),new Error(e.message)}n.addTrace(zC);const{p:r}=e,i=qv(r.resources),o=[kv(r.iss)],s=Nv(r.iss);if(i){const e=Hv(i),t=zv(i);u.push(...e),o.push(...t)}for(const e of o)h.push(`${e}:${s}`)}const d=await this.client.core.crypto.generateSharedKey(a,s);let f;if(n.addTrace(HC),u?.length>0){f={topic:d,acknowledged:!0,self:{publicKey:a,metadata:this.client.metadata},peer:{publicKey:s,metadata:i.requester.metadata},controller:s,expiry:yw(xk),authentication:r,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:i.pairingTopic,namespaces:$I([...new Set(u)],[...new Set(h)]),transportType:o},n.addTrace(WC);try{await this.client.core.relayer.subscribe(d,{transportType:o})}catch(e){throw n.setError(YC),e}n.addTrace(VC),await this.client.session.set(d,f),n.addTrace(qC),await this.client.core.pairing.updateMetadata({topic:i.pairingTopic,metadata:i.requester.metadata})}n.addTrace(KC);try{await this.sendResult({topic:c,id:t,result:{cacaos:r,responder:{publicKey:a,metadata:this.client.metadata}},encodeOpts:l,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(i.requester.metadata,o)})}catch(e){throw n.setError(JC),e}return await this.client.auth.requests.delete(t,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:i.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:n.eventId}),{session:f}}),jk(this,"rejectSessionAuthenticate",async e=>{this.isInitialized();const{id:t,reason:r}=e,n=this.getPendingAuthRequest(t);if(!n)throw new Error(`Could not find pending auth request with id ${t}`);n.transportType===zO.relay&&await this.confirmOnlineStateOrThrow();const i=n.requester.publicKey,o=await this.client.core.crypto.generateKeyPair(),s=sI(i),a={type:1,receiverPublicKey:i,senderPublicKey:o};await this.sendError({id:t,topic:s,error:r,encodeOpts:a,rpcOpts:Ik.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(n.requester.metadata,n.transportType)}),await this.client.auth.requests.delete(t,{message:"rejected",code:0}),await this.deleteProposal(t)}),jk(this,"formatAuthMessage",e=>{this.isInitialized();const{request:t,iss:r}=e;return Bv(t,r)}),jk(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(0!==this.relayMessageCache.length)for(;this.relayMessageCache.length>0;)try{const e=this.relayMessageCache.shift();e&&await this.onRelayMessage(e)}catch(e){this.client.logger.error(e)}},50)}),jk(this,"cleanupDuplicatePairings",async e=>{if(e.pairingTopic)try{const t=this.client.core.pairing.pairings.get(e.pairingTopic),r=this.client.core.pairing.pairings.getAll().filter(r=>{var n,i;return(null==(n=r.peerMetadata)?void 0:n.url)&&(null==(i=r.peerMetadata)?void 0:i.url)===e.peer.metadata.url&&r.topic&&r.topic!==t.topic});if(0===r.length)return;this.client.logger.info(`Cleaning up ${r.length} duplicate pairing(s)`),await Promise.all(r.map(e=>this.client.core.pairing.disconnect({topic:e.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(e){this.client.logger.error(e)}}),jk(this,"deleteSession",async e=>{var t;const{topic:r,expirerHasDeleted:n=!1,emitEvent:i=!0,id:o=0}=e,{self:s}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await this.client.session.delete(r,HI("USER_DISCONNECTED")),this.addToRecentlyDeleted(r,"session"),this.client.core.crypto.keychain.has(s.publicKey)&&await this.client.core.crypto.deleteKeyPair(s.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),n||this.client.core.expirer.del(r),this.client.core.storage.removeItem(vk).catch(e=>this.client.logger.warn(e)),this.getPendingSessionRequests().forEach(e=>{e.topic===r&&this.deletePendingSessionRequest(e.id,HI("USER_DISCONNECTED"))}),r===(null==(t=this.sessionRequestQueue.queue[0])?void 0:t.topic)&&(this.sessionRequestQueue.state=Sk),i&&this.client.events.emit("session_delete",{id:o,topic:r})}),jk(this,"deleteProposal",async(e,t)=>{if(t)try{const t=this.client.proposal.get(e),r=this.client.core.eventClient.getEvent({topic:t.pairingTopic});r?.setError(DC)}catch{}await Promise.all([this.client.proposal.delete(e,HI("USER_DISCONNECTED")),t?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"proposal")}),jk(this,"deletePendingSessionRequest",async(e,t,r=!1)=>{await Promise.all([this.client.pendingRequest.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(t=>t.id!==e),r&&(this.sessionRequestQueue.state=Sk,this.client.events.emit("session_request_expire",{id:e}))}),jk(this,"deletePendingAuthRequest",async(e,t,r=!1)=>{await Promise.all([this.client.auth.requests.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)])}),jk(this,"setExpiry",async(e,t)=>{this.client.session.keys.includes(e)&&(this.client.core.expirer.set(e,t),await this.client.session.update(e,{expiry:t}))}),jk(this,"setProposal",async(e,t)=>{this.client.core.expirer.set(e,yw(Ik.wc_sessionPropose.req.ttl)),await this.client.proposal.set(e,t)}),jk(this,"setAuthRequest",async(e,t)=>{const{request:r,pairingTopic:n,transportType:i=zO.relay}=t;this.client.core.expirer.set(e,r.expiryTimestamp),await this.client.auth.requests.set(e,{authPayload:r.authPayload,requester:r.requester,expiryTimestamp:r.expiryTimestamp,id:e,pairingTopic:n,verifyContext:r.verifyContext,transportType:i})}),jk(this,"setPendingSessionRequest",async e=>{const{id:t,topic:r,params:n,verifyContext:i}=e,o=n.request.expiryTimestamp||yw(Ik.wc_sessionRequest.req.ttl);this.client.core.expirer.set(t,o),await this.client.pendingRequest.set(t,{id:t,topic:r,params:n,verifyContext:i})}),jk(this,"sendRequest",async e=>{const{topic:t,method:r,params:n,expiry:i,relayRpcId:o,clientRpcId:s,throwOnFailedPublish:a,appLink:c,tvf:l,publishOpts:u={}}=e,h=iO(r,n,s);let d;const f=!!c;try{const e=f?nI:rI;d=await this.client.core.crypto.encode(t,h,{encoding:e})}catch(e){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${t} failed`),e}let p;if(Ck.includes(r)){const e=aI(JSON.stringify(h)),t=aI(d);p=await this.client.core.verify.register({id:t,decryptedId:e})}const g=$k($k({},Ik[r].req),u);if(g.attestation=p,i&&(g.ttl=i),o&&(g.id=o),this.client.core.history.set(t,h),f){const e=_I(c,t,d);await global.Linking.openURL(e,this.client.name)}else g.tvf=Mk($k({},l),{correlationId:h.id}),a?(g.internal=Mk($k({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(t,d,g)):this.client.core.relayer.publish(t,d,g).catch(e=>this.client.logger.error(e));return h.id}),jk(this,"sendProposeSession",async e=>{const{proposal:t,publishOpts:r}=e,n=iO("wc_sessionPropose",t,t.id);this.client.core.history.set(t.pairingTopic,n);const i=await this.client.core.crypto.encode(t.pairingTopic,n,{encoding:rI}),o=aI(JSON.stringify(n)),s=aI(i),a=await this.client.core.verify.register({id:s,decryptedId:o});await this.client.core.relayer.publishCustom({payload:{pairingTopic:t.pairingTopic,sessionProposal:i},opts:Mk($k({},r),{publishMethod:"wc_proposeSession",attestation:a})})}),jk(this,"sendApproveSession",async e=>{const{sessionTopic:t,pairingProposalResponse:r,proposal:n,sessionSettleRequest:i,publishOpts:o}=e,s=oO(n.id,r),a=await this.client.core.crypto.encode(n.pairingTopic,s,{encoding:rI}),c=iO("wc_sessionSettle",i,o?.id),l=await this.client.core.crypto.encode(t,c,{encoding:rI});this.client.core.history.set(t,c),await this.client.core.relayer.publishCustom({payload:{sessionTopic:t,pairingTopic:n.pairingTopic,sessionProposalResponse:a,sessionSettlementRequest:l},opts:Mk($k({},o),{publishMethod:"wc_approveSession"})})}),jk(this,"sendResult",async e=>{const{id:t,topic:r,result:n,throwOnFailedPublish:i,encodeOpts:o,appLink:s}=e,a=oO(t,n);let c;const l=s&&typeof(null==global?void 0:global.Linking)<"u";try{const e=l?nI:rI;c=await this.client.core.crypto.encode(r,a,Mk($k({},o||{}),{encoding:e}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${r} failed`),e}let u,h;try{u=await this.client.core.history.get(r,t);const e=u.request;try{h=this.getTVFParams(t,e.params,n)}catch(e){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${e?.message}`)}}catch(e){throw this.client.logger.error(`sendResult() -> history.get(${r}, ${t}) failed`),e}if(l){const e=_I(s,r,c);await global.Linking.openURL(e,this.client.name)}else{const e=u.request.method,n=Ik[e].res;n.tvf=Mk($k({},h),{correlationId:t}),i?(n.internal=Mk($k({},n.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(r,c,n)):this.client.core.relayer.publish(r,c,n).catch(e=>this.client.logger.error(e))}await this.client.core.history.resolve(a)}),jk(this,"sendError",async e=>{const{id:t,topic:r,error:n,encodeOpts:i,rpcOpts:o,appLink:s}=e,a=sO(t,n);let c;const l=s&&typeof(null==global?void 0:global.Linking)<"u";try{const e=l?nI:rI;c=await this.client.core.crypto.encode(r,a,Mk($k({},i||{}),{encoding:e}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${r} failed`),e}let u;try{u=await this.client.core.history.get(r,t)}catch(e){throw this.client.logger.error(`sendError() -> history.get(${r}, ${t}) failed`),e}if(l){const e=_I(s,r,c);await global.Linking.openURL(e,this.client.name)}else{const e=u.request.method,t=o||Ik[e].res;this.client.core.relayer.publish(r,c,t)}await this.client.core.history.resolve(a)}),jk(this,"cleanup",async()=>{const e=[],t=[];this.client.session.getAll().forEach(t=>{let r=!1;ww(t.expiry)&&(r=!0),this.client.core.crypto.keychain.has(t.topic)||(r=!0),r&&e.push(t.topic)}),this.client.proposal.getAll().forEach(e=>{ww(e.expiryTimestamp)&&t.push(e.id)}),await Promise.all([...e.map(e=>this.deleteSession({topic:e})),...t.map(e=>this.deleteProposal(e))])}),jk(this,"onProviderMessageEvent",async e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):await this.onRelayMessage(e)}),jk(this,"onRelayEventRequest",async e=>{this.requestQueue.queue.push(e),await this.processRequestsQueue()}),jk(this,"processRequestsQueue",async()=>{if(this.requestQueue.state!==Ak){for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Ak;const e=this.requestQueue.queue.shift();if(e)try{await this.processRequest(e)}catch(e){this.client.logger.warn(e)}}this.requestQueue.state=Sk}else this.client.logger.info("Request queue already active, skipping...")}),jk(this,"processRequest",async e=>{const{topic:t,payload:r,attestation:n,transportType:i,encryptedId:o}=e,s=r.method;if(!this.shouldIgnorePairingRequest({topic:t,requestMethod:s}))switch(s){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:t,payload:r,attestation:n,encryptedId:o});case"wc_sessionSettle":return await this.onSessionSettleRequest(t,r);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(t,r);case"wc_sessionExtend":return await this.onSessionExtendRequest(t,r);case"wc_sessionPing":return await this.onSessionPingRequest(t,r);case"wc_sessionDelete":return await this.onSessionDeleteRequest(t,r);case"wc_sessionRequest":return await this.onSessionRequest({topic:t,payload:r,attestation:n,encryptedId:o,transportType:i});case"wc_sessionEvent":return await this.onSessionEventRequest(t,r);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:t,payload:r,attestation:n,encryptedId:o,transportType:i});default:return this.client.logger.info(`Unsupported request method ${s}`)}}),jk(this,"onRelayEventResponse",async e=>{const{topic:t,payload:r,transportType:n}=e,i=(await this.client.core.history.get(t,r.id)).request.method;switch(i){case"wc_sessionPropose":return this.onSessionProposeResponse(t,r,n);case"wc_sessionSettle":return this.onSessionSettleResponse(t,r);case"wc_sessionUpdate":return this.onSessionUpdateResponse(t,r);case"wc_sessionExtend":return this.onSessionExtendResponse(t,r);case"wc_sessionPing":return this.onSessionPingResponse(t,r);case"wc_sessionRequest":return this.onSessionRequestResponse(t,r);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(t,r);default:return this.client.logger.info(`Unsupported response method ${i}`)}}),jk(this,"onRelayEventUnknownPayload",e=>{const{topic:t}=e,{message:r}=FI("MISSING_OR_INVALID",`Decoded payload on topic ${t} is not identifiable as a JSON-RPC request or a response.`);throw new Error(r)}),jk(this,"shouldIgnorePairingRequest",e=>{const{topic:t,requestMethod:r}=e,n=this.expectedPairingMethodMap.get(t);return!(!n||n.includes(r))&&!!(n.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),jk(this,"onSessionProposeRequest",async e=>{const{topic:t,payload:r,attestation:n,encryptedId:i}=e,{params:o,id:s}=r;try{const e=this.client.core.eventClient.getEvent({topic:t});0===this.client.events.listenerCount("session_proposal")&&(console.warn("No listener for session_proposal event"),e?.setError(PC)),this.isValidConnect($k({},r.params));const a=o.expiryTimestamp||yw(Ik.wc_sessionPropose.req.ttl),c=$k({id:s,pairingTopic:t,expiryTimestamp:a,attestation:n,encryptedId:i},o);await this.setProposal(s,c);const l=await this.getVerifyContext({attestationId:n,hash:aI(JSON.stringify(r)),encryptedId:i,metadata:c.proposer.metadata});e?.addTrace(IC),this.client.events.emit("session_proposal",{id:s,params:c,verifyContext:l})}catch(e){await this.sendError({id:s,topic:t,error:e,rpcOpts:Ik.wc_sessionPropose.autoReject}),this.client.logger.error(e)}}),jk(this,"onSessionProposeResponse",async(e,t,r)=>{const{id:n}=t;if(yO(t)){const{result:i}=t;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:i});const o=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:o});const s=o.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:s});const a=i.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:a});const c=await this.client.core.crypto.generateSharedKey(s,a);this.pendingSessions.set(n,{sessionTopic:c,pairingTopic:e,proposalId:n,publicKey:s});const l=await this.client.core.relayer.subscribe(c,{transportType:r});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:l}),await this.client.core.pairing.activate({topic:e})}else if(wO(t)){await this.deleteProposal(n);const e=bw("session_connect",n);if(0===this.events.listenerCount(e))throw new Error(`emitting ${e} without any listeners, 954`);this.events.emit(e,{error:t.error})}}),jk(this,"onSessionSettleRequest",async(e,t)=>{const{id:r,params:n}=t;try{this.isValidSessionSettleRequest(n);const{relay:r,controller:i,expiry:o,namespaces:s,sessionProperties:a,scopedProperties:c,sessionConfig:l}=t.params,u=[...this.pendingSessions.values()].find(t=>t.sessionTopic===e);if(!u)return this.client.logger.error(`Pending session not found for topic ${e}`);const h=this.client.proposal.get(u.proposalId),d=Mk($k($k($k({topic:e,relay:r,expiry:o,namespaces:s,acknowledged:!0,pairingTopic:u.pairingTopic,requiredNamespaces:h.requiredNamespaces,optionalNamespaces:h.optionalNamespaces,controller:i.publicKey,self:{publicKey:u.publicKey,metadata:this.client.metadata},peer:{publicKey:i.publicKey,metadata:i.metadata}},a&&{sessionProperties:a}),c&&{scopedProperties:c}),l&&{sessionConfig:l}),{transportType:zO.relay});await this.client.session.set(d.topic,d),await this.setExpiry(d.topic,d.expiry),await this.client.core.pairing.updateMetadata({topic:u.pairingTopic,metadata:d.peer.metadata}),this.client.events.emit("session_connect",{session:d}),this.events.emit(bw("session_connect",u.proposalId),{session:d}),this.pendingSessions.delete(u.proposalId),this.deleteProposal(u.proposalId,!1),this.cleanupDuplicatePairings(d),await this.sendResult({id:t.id,topic:e,result:!0})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),jk(this,"onSessionSettleResponse",async(e,t)=>{const{id:r}=t;yO(t)?(await this.client.session.update(e,{acknowledged:!0}),this.events.emit(bw("session_approve",r),{})):wO(t)&&(await this.client.session.delete(e,HI("USER_DISCONNECTED")),this.events.emit(bw("session_approve",r),{error:t.error}))}),jk(this,"onSessionUpdateRequest",async(e,t)=>{const{params:r,id:n}=t;try{const t=`${e}_session_update`,i=u_.get(t);if(i&&this.isRequestOutOfSync(i,n))return this.client.logger.warn(`Discarding out of sync request - ${n}`),void this.sendError({id:n,topic:e,error:HI("INVALID_UPDATE_REQUEST")});this.isValidUpdate($k({topic:e},r));try{u_.set(t,n),await this.client.session.update(e,{namespaces:r.namespaces}),await this.sendResult({id:n,topic:e,result:!0})}catch(e){throw u_.delete(t),e}this.client.events.emit("session_update",{id:n,topic:e,params:r})}catch(t){await this.sendError({id:n,topic:e,error:t}),this.client.logger.error(t)}}),jk(this,"isRequestOutOfSync",(e,t)=>t.toString().slice(0,-3)<e.toString().slice(0,-3)),jk(this,"onSessionUpdateResponse",(e,t)=>{const{id:r}=t,n=bw("session_update",r);if(0===this.events.listenerCount(n))throw new Error(`emitting ${n} without any listeners`);yO(t)?this.events.emit(bw("session_update",r),{}):wO(t)&&this.events.emit(bw("session_update",r),{error:t.error})}),jk(this,"onSessionExtendRequest",async(e,t)=>{const{id:r}=t;try{this.isValidExtend({topic:e}),await this.setExpiry(e,yw(xk)),await this.sendResult({id:r,topic:e,result:!0}),this.client.events.emit("session_extend",{id:r,topic:e})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),jk(this,"onSessionExtendResponse",(e,t)=>{const{id:r}=t,n=bw("session_extend",r);if(0===this.events.listenerCount(n))throw new Error(`emitting ${n} without any listeners`);yO(t)?this.events.emit(bw("session_extend",r),{}):wO(t)&&this.events.emit(bw("session_extend",r),{error:t.error})}),jk(this,"onSessionPingRequest",async(e,t)=>{const{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:r,topic:e})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),jk(this,"onSessionPingResponse",(e,t)=>{const{id:r}=t,n=bw("session_ping",r);setTimeout(()=>{if(0===this.events.listenerCount(n))throw new Error(`emitting ${n} without any listeners 2176`);yO(t)?this.events.emit(bw("session_ping",r),{}):wO(t)&&this.events.emit(bw("session_ping",r),{error:t.error})},500)}),jk(this,"onSessionDeleteRequest",async(e,t)=>{const{id:r}=t;try{this.isValidDisconnect({topic:e,reason:t.params}),await Promise.all([new Promise(t=>{this.client.core.relayer.once(DO,async()=>{t(await this.deleteSession({topic:e,id:r}))})}),this.sendResult({id:r,topic:e,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:e,error:HI("USER_DISCONNECTED")})]).catch(e=>this.client.logger.error(e))}catch(e){this.client.logger.error(e)}}),jk(this,"onSessionRequest",async e=>{var t,r,n;const{topic:i,payload:o,attestation:s,encryptedId:a,transportType:c}=e,{id:l,params:u}=o;try{await this.isValidRequest($k({topic:i},u));const e=this.client.session.get(i),o={id:l,topic:i,params:u,verifyContext:await this.getVerifyContext({attestationId:s,hash:aI(JSON.stringify(iO("wc_sessionRequest",u,l))),encryptedId:a,metadata:e.peer.metadata,transportType:c})};await this.setPendingSessionRequest(o),c===zO.link_mode&&null!=(t=e.peer.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(null==(r=e.peer.metadata.redirect)?void 0:r.universal),null!=(n=this.client.signConfig)&&n.disableRequestQueue?this.emitSessionRequest(o):(this.addSessionRequestToSessionRequestQueue(o),this.processSessionRequestQueue())}catch(e){await this.sendError({id:l,topic:i,error:e}),this.client.logger.error(e)}}),jk(this,"onSessionRequestResponse",(e,t)=>{const{id:r}=t,n=bw("session_request",r);if(0===this.events.listenerCount(n))throw new Error(`emitting ${n} without any listeners`);yO(t)?this.events.emit(bw("session_request",r),{result:t.result}):wO(t)&&this.events.emit(bw("session_request",r),{error:t.error})}),jk(this,"onSessionEventRequest",async(e,t)=>{const{id:r,params:n}=t;try{const t=`${e}_session_event_${n.event.name}`,i=u_.get(t);if(i&&this.isRequestOutOfSync(i,r))return void this.client.logger.info(`Discarding out of sync request - ${r}`);this.isValidEmit($k({topic:e},n)),this.client.events.emit("session_event",{id:r,topic:e,params:n}),u_.set(t,r)}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),jk(this,"onSessionAuthenticateResponse",(e,t)=>{const{id:r}=t;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:e,payload:t}),yO(t)?this.events.emit(bw("session_request",r),{result:t.result}):wO(t)&&this.events.emit(bw("session_request",r),{error:t.error})}),jk(this,"onSessionAuthenticateRequest",async e=>{var t;const{topic:r,payload:n,attestation:i,encryptedId:o,transportType:s}=e;try{const{requester:e,authPayload:a,expiryTimestamp:c}=n.params,l=await this.getVerifyContext({attestationId:i,hash:aI(JSON.stringify(n)),encryptedId:o,metadata:e.metadata,transportType:s}),u={requester:e,pairingTopic:r,id:n.id,authPayload:a,verifyContext:l,expiryTimestamp:c};await this.setAuthRequest(n.id,{request:u,pairingTopic:r,transportType:s}),s===zO.link_mode&&null!=(t=e.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(e.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:r,params:n.params,id:n.id,verifyContext:l})}catch(e){this.client.logger.error(e);const t=n.params.requester.publicKey,i=await this.client.core.crypto.generateKeyPair(),o=this.getAppLinkIfEnabled(n.params.requester.metadata,s),a={type:1,receiverPublicKey:t,senderPublicKey:i};await this.sendError({id:n.id,topic:r,error:e,encodeOpts:a,rpcOpts:Ik.wc_sessionAuthenticate.autoReject,appLink:o})}}),jk(this,"addSessionRequestToSessionRequestQueue",e=>{this.sessionRequestQueue.queue.push(e)}),jk(this,"cleanupAfterResponse",e=>{this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Sk,this.processSessionRequestQueue()},dc.toMiliseconds(this.requestQueueDelay))}),jk(this,"cleanupPendingSentRequestsForTopic",({topic:e,error:t})=>{const r=this.client.core.history.pending;r.length>0&&r.filter(t=>t.topic===e&&"wc_sessionRequest"===t.request.method).forEach(e=>{const r=bw("session_request",e.request.id);if(0===this.events.listenerCount(r))throw new Error(`emitting ${r} without any listeners`);this.events.emit(bw("session_request",e.request.id),{error:t})})}),jk(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===Ak)return void this.client.logger.info("session request queue is already active.");const e=this.sessionRequestQueue.queue[0];if(e)try{this.emitSessionRequest(e)}catch(e){this.client.logger.error(e)}else this.client.logger.info("session request queue is empty.")}),jk(this,"emitSessionRequest",e=>{this.emittedSessionRequests.has(e.id)?this.client.logger.warn({id:e.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${e.id}`):(this.sessionRequestQueue.state=Ak,this.emittedSessionRequests.add(e.id),this.client.events.emit("session_request",e))}),jk(this,"onPairingCreated",e=>{if(e.methods&&this.expectedPairingMethodMap.set(e.topic,e.methods),e.active)return;const t=this.client.proposal.getAll().find(t=>t.pairingTopic===e.topic);t&&this.onSessionProposeRequest({topic:e.topic,payload:iO("wc_sessionPropose",Mk($k({},t),{requiredNamespaces:t.requiredNamespaces,optionalNamespaces:t.optionalNamespaces,relays:t.relays,proposer:t.proposer,sessionProperties:t.sessionProperties,scopedProperties:t.scopedProperties}),t.id),attestation:t.attestation,encryptedId:t.encryptedId})}),jk(this,"isValidConnect",async e=>{if(!t_(e)){const{message:t}=FI("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw new Error(t)}const{pairingTopic:t,requiredNamespaces:r,optionalNamespaces:n,sessionProperties:i,scopedProperties:o,relays:s}=e;if(WI(t)||await this.isValidPairingTopic(t),!function(e){let t=!1;return e?e&&zI(e)&&e.length&&e.forEach(e=>{t=e_(e)}):t=!0,t}(s)){const{message:e}=FI("MISSING_OR_INVALID",`connect() relays: ${s}`);throw new Error(e)}if(!WI(r)&&0!==qI(r)){const e="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(e):this.client.logger.warn(e),this.validateNamespaces(r,"requiredNamespaces")}if(!WI(n)&&0!==qI(n)&&this.validateNamespaces(n,"optionalNamespaces"),WI(i)||this.validateSessionProps(i,"sessionProperties"),!WI(o)){this.validateSessionProps(o,"scopedProperties");const e=Object.keys(r||{}).concat(Object.keys(n||{}));if(!Object.keys(o).every(t=>e.includes(t.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(o)}, required/optional namespaces: ${JSON.stringify(e)}`)}}),jk(this,"validateNamespaces",(e,t)=>{const r=function(e,t,r){let n=null;if(e&&qI(e)){const i=XI(e,t);i&&(n=i);const o=YI(e,t,r);o&&(n=o)}else n=FI("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return n}(e,"connect()",t);if(r)throw new Error(r.message)}),jk(this,"isValidApprove",async e=>{if(!t_(e))throw new Error(FI("MISSING_OR_INVALID",`approve() params: ${e}`).message);const{id:t,namespaces:r,relayProtocol:n,sessionProperties:i,scopedProperties:o}=e;this.checkRecentlyDeleted(t),await this.isValidProposalId(t);const s=this.client.proposal.get(t),a=QI(r,"approve()");if(a)throw new Error(a.message);const c=o_(s.requiredNamespaces,r,"approve()");if(c)throw new Error(c.message);if(!VI(n,!0)){const{message:e}=FI("MISSING_OR_INVALID",`approve() relayProtocol: ${n}`);throw new Error(e)}if(WI(i)||this.validateSessionProps(i,"sessionProperties"),!WI(o)){this.validateSessionProps(o,"scopedProperties");const e=new Set(Object.keys(r));if(!Object.keys(o).every(t=>e.has(t.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(o)}, approved namespaces: ${Array.from(e).join(", ")}`)}}),jk(this,"isValidReject",async e=>{if(!t_(e)){const{message:t}=FI("MISSING_OR_INVALID",`reject() params: ${e}`);throw new Error(t)}const{id:t,reason:r}=e;if(this.checkRecentlyDeleted(t),await this.isValidProposalId(t),!function(e){return!!(e&&"object"==typeof e&&e.code&&KI(e.code,!1)&&e.message&&VI(e.message,!1))}(r)){const{message:e}=FI("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(r)}`);throw new Error(e)}}),jk(this,"isValidSessionSettleRequest",e=>{if(!t_(e)){const{message:t}=FI("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw new Error(t)}const{relay:t,controller:r,namespaces:n,expiry:i}=e;if(!e_(t)){const{message:e}=FI("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(e)}const o=function(e,t){let r=null;return VI(e?.publicKey,!1)||(r=FI("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}(r,"onSessionSettleRequest()");if(o)throw new Error(o.message);const s=QI(n,"onSessionSettleRequest()");if(s)throw new Error(s.message);if(ww(i)){const{message:e}=FI("EXPIRED","onSessionSettleRequest()");throw new Error(e)}}),jk(this,"isValidUpdate",async e=>{if(!t_(e)){const{message:t}=FI("MISSING_OR_INVALID",`update() params: ${e}`);throw new Error(t)}const{topic:t,namespaces:r}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);const n=this.client.session.get(t),i=QI(r,"update()");if(i)throw new Error(i.message);const o=o_(n.requiredNamespaces,r,"update()");if(o)throw new Error(o.message)}),jk(this,"isValidExtend",async e=>{if(!t_(e)){const{message:t}=FI("MISSING_OR_INVALID",`extend() params: ${e}`);throw new Error(t)}const{topic:t}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t)}),jk(this,"isValidRequest",async e=>{if(!t_(e)){const{message:t}=FI("MISSING_OR_INVALID",`request() params: ${e}`);throw new Error(t)}const{topic:t,request:r,chainId:n,expiry:i}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);const{namespaces:o}=this.client.session.get(t);if(!r_(o,n)){const{message:e}=FI("MISSING_OR_INVALID",`request() chainId: ${n}`);throw new Error(e)}if(!function(e){return!(WI(e)||!VI(e.method,!1))}(r)){const{message:e}=FI("MISSING_OR_INVALID",`request() ${JSON.stringify(r)}`);throw new Error(e)}if(!n_(o,n,r.method)){const{message:e}=FI("MISSING_OR_INVALID",`request() method: ${r.method}`);throw new Error(e)}if(i&&!function(e,t){return KI(e,!1)&&e<=t.max&&e>=t.min}(i,_k)){const{message:e}=FI("MISSING_OR_INVALID",`request() expiry: ${i}. Expiry must be a number (in seconds) between ${_k.min} and ${_k.max}`);throw new Error(e)}}),jk(this,"isValidRespond",async e=>{var t;if(!t_(e)){const{message:t}=FI("MISSING_OR_INVALID",`respond() params: ${e}`);throw new Error(t)}const{topic:r,response:n}=e;try{await this.isValidSessionTopic(r)}catch(r){throw null!=(t=e?.response)&&t.id&&this.cleanupAfterResponse(e),r}if(!function(e){return!(WI(e)||WI(e.result)&&WI(e.error)||!KI(e.id,!1)||!VI(e.jsonrpc,!1))}(n)){const{message:e}=FI("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(n)}`);throw new Error(e)}}),jk(this,"isValidPing",async e=>{if(!t_(e)){const{message:t}=FI("MISSING_OR_INVALID",`ping() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidSessionOrPairingTopic(t)}),jk(this,"isValidEmit",async e=>{if(!t_(e)){const{message:t}=FI("MISSING_OR_INVALID",`emit() params: ${e}`);throw new Error(t)}const{topic:t,event:r,chainId:n}=e;await this.isValidSessionTopic(t);const{namespaces:i}=this.client.session.get(t);if(!r_(i,n)){const{message:e}=FI("MISSING_OR_INVALID",`emit() chainId: ${n}`);throw new Error(e)}if(!function(e){return!(WI(e)||!VI(e.name,!1))}(r)){const{message:e}=FI("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(r)}`);throw new Error(e)}if(!i_(i,n,r.name)){const{message:e}=FI("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(r)}`);throw new Error(e)}}),jk(this,"isValidDisconnect",async e=>{if(!t_(e)){const{message:t}=FI("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidSessionOrPairingTopic(t)}),jk(this,"isValidAuthenticate",e=>{const{chains:t,uri:r,domain:n,nonce:i}=e;if(!Array.isArray(t)||0===t.length)throw new Error("chains is required and must be a non-empty array");if(!VI(r,!1))throw new Error("uri is required parameter");if(!VI(n,!1))throw new Error("domain is required parameter");if(!VI(i,!1))throw new Error("nonce is required parameter");if([...new Set(t.map(e=>My(e).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:o}=My(t[0]);if("eip155"!==o)throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),jk(this,"getVerifyContext",async e=>{const{attestationId:t,hash:r,encryptedId:n,metadata:i,transportType:o}=e,s={verified:{verifyUrl:i.verifyUrl||hC,validation:"UNKNOWN",origin:i.url||""}};try{if(o===zO.link_mode){const e=this.getAppLinkIfEnabled(i,o);return s.verified.validation=e&&new URL(e).origin===new URL(i.url).origin?"VALID":"INVALID",s}const e=await this.client.core.verify.resolve({attestationId:t,hash:r,encryptedId:n,verifyUrl:i.verifyUrl});e&&(s.verified.origin=e.origin,s.verified.isScam=e.isScam,s.verified.validation=e.origin===new URL(i.url).origin?"VALID":"INVALID")}catch(e){this.client.logger.warn(e)}return this.client.logger.debug(`Verify context: ${JSON.stringify(s)}`),s}),jk(this,"validateSessionProps",(e,t)=>{Object.values(e).forEach((r,n)=>{if(null==r){const{message:i}=FI("MISSING_OR_INVALID",`${t} must contain an existing value for each key. Received: ${r} for key ${Object.keys(e)[n]}`);throw new Error(i)}})}),jk(this,"getPendingAuthRequest",e=>{const t=this.client.auth.requests.get(e);return"object"==typeof t?t:void 0}),jk(this,"addToRecentlyDeleted",(e,t)=>{if(this.recentlyDeletedMap.set(e,t),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let e=0;const t=this.recentlyDeletedLimit/2;for(const r of this.recentlyDeletedMap.keys()){if(e++>=t)break;this.recentlyDeletedMap.delete(r)}}}),jk(this,"checkRecentlyDeleted",e=>{const t=this.recentlyDeletedMap.get(e);if(t){const{message:r}=FI("MISSING_OR_INVALID",`Record was recently deleted - ${t}: ${e}`);throw new Error(r)}}),jk(this,"isLinkModeEnabled",(e,t)=>{var r,n,i,o,s,a,c,l,u;return!(!e||t!==zO.link_mode)&&(!0===(null==(n=null==(r=this.client.metadata)?void 0:r.redirect)?void 0:n.linkMode)&&void 0!==(null==(o=null==(i=this.client.metadata)?void 0:i.redirect)?void 0:o.universal)&&""!==(null==(a=null==(s=this.client.metadata)?void 0:s.redirect)?void 0:a.universal)&&void 0!==(null==(c=e?.redirect)?void 0:c.universal)&&""!==(null==(l=e?.redirect)?void 0:l.universal)&&!0===(null==(u=e?.redirect)?void 0:u.linkMode)&&this.client.core.linkModeSupportedApps.includes(e.redirect.universal)&&typeof(null==global?void 0:global.Linking)<"u")}),jk(this,"getAppLinkIfEnabled",(e,t)=>{var r;return this.isLinkModeEnabled(e,t)?null==(r=e?.redirect)?void 0:r.universal:void 0}),jk(this,"handleLinkModeMessage",({url:e})=>{if(!e||!e.includes("wc_ev")||!e.includes("topic"))return;const t=xw(e,"topic")||"",r=decodeURIComponent(xw(e,"wc_ev")||""),n=this.client.session.keys.includes(t);n&&this.client.session.update(t,{transportType:zO.link_mode}),this.client.core.dispatchEnvelope({topic:t,message:r,sessionExists:n})}),jk(this,"registerLinkModeListeners",async()=>{var e;if(_w()||rw()&&null!=(e=this.client.metadata.redirect)&&e.linkMode){const e=null==global?void 0:global.Linking;if(typeof e<"u"){e.addEventListener("url",this.handleLinkModeMessage,this.client.name);const t=await e.getInitialURL();t&&setTimeout(()=>{this.handleLinkModeMessage({url:t})},50)}}}),jk(this,"getTVFParams",(e,t,r)=>{var n,i,o;if(null==(n=t.request)||!n.method)return{};const s={correlationId:e,rpcMethods:[t.request.method],chainId:t.chainId};try{const e=this.extractTxHashesFromResult(t.request,r);s.txHashes=e,s.contractAddresses=this.isValidContractData(t.request.params)?[null==(o=null==(i=t.request.params)?void 0:i[0])?void 0:o.to]:[]}catch(e){this.client.logger.warn("Error getting TVF params",e)}return s}),jk(this,"isValidContractData",e=>{var t;if(!e)return!1;try{const r=e?.data||(null==(t=e?.[0])?void 0:t.data);if(!r.startsWith("0x"))return!1;const n=r.slice(2);return!!/^[0-9a-fA-F]*$/.test(n)&&n.length%2==0}catch{}return!1}),jk(this,"extractTxHashesFromResult",(e,t)=>{var r;try{if(!t)return[];const n=e.method,i=Ok[n];if("sui_signTransaction"===n)return[bv(t.transactionBytes)];if("near_signTransaction"===n)return[vv(t)];if("near_signTransactions"===n)return t.map(e=>vv(e));if("xrpl_signTransactionFor"===n||"xrpl_signTransaction"===n)return[null==(r=t.tx_json)?void 0:r.hash];if("polkadot_signTransaction"===n)return[f_({transaction:e.params.transactionPayload,signature:t.signature})];if("algo_signTxn"===n)return zI(t)?t.map(e=>Ev(e)):[Ev(t)];if("cosmos_signDirect"===n)return[Iv(t)];if("string"==typeof t)return[t];const o=t[i.key];if(zI(o))return"solana_signAllTransactions"===n?o.map(e=>function(e){const t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);const n=r[0];if(0===n)throw new Error("No signatures found");const i=1+64*n;if(r.length<i)throw new Error("Transaction data too short for claimed signature count");if(r.length<100)throw new Error("Transaction too short");const o=Buffer.from(e,"base64").slice(1,65);return Wh.encode(o)}(e)):o;if("string"==typeof o)return[o]}catch(e){this.client.logger.warn("Error extracting tx hashes from result",e)}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(const[e,r]of Object.entries(t))for(const t of r)try{await this.onProviderMessageEvent({topic:e,message:t,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${e}, message: ${t}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){const{message:e}=FI("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(TO,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:t,message:r,attestation:n,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(Rk)?this.client.auth.authKeys.get(Rk):{publicKey:void 0};try{const e=await this.client.core.crypto.decode(t,r,{receiverPublicKey:o,encoding:i===zO.link_mode?nI:rI});gO(e)?(this.client.core.history.set(t,e),await this.onRelayEventRequest({topic:t,payload:e,attestation:n,transportType:i,encryptedId:aI(r)})):mO(e)?(await this.client.core.history.resolve(e),await this.onRelayEventResponse({topic:t,payload:e,transportType:i}),this.client.core.history.delete(t,e.id)):await this.onRelayEventUnknownPayload({topic:t,payload:e,transportType:i}),await this.client.core.relayer.messages.ack(t,r)}catch(e){this.client.logger.error(e)}}registerExpirerEvents(){this.client.core.expirer.on(cC,async e=>{const{topic:t,id:r}=mw(e.target);return r&&this.client.pendingRequest.keys.includes(r)?await this.deletePendingSessionRequest(r,FI("EXPIRED"),!0):r&&this.client.auth.requests.keys.includes(r)?await this.deletePendingAuthRequest(r,FI("EXPIRED"),!0):void(t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r})))})}registerPairingEvents(){this.client.core.pairing.events.on(XO,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(eC,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!VI(e,!1)){const{message:t}=FI("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=FI("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(ww(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=FI("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!VI(e,!1)){const{message:t}=FI("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:t}=FI("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(ww(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=FI("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=FI("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else{if(!this.client.core.pairing.pairings.keys.includes(e)){if(VI(e,!1)){const{message:t}=FI("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}{const{message:t}=FI("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}this.isValidPairingTopic(e)}}async isValidProposalId(e){if(!function(e){return"number"==typeof e}(e)){const{message:t}=FI("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=FI("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(ww(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=FI("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}};class Hk extends $T{constructor(e,t){super(e,t,"proposal",yk),this.core=e,this.logger=t}}let zk=class extends $T{constructor(e,t){super(e,t,"session",yk),this.core=e,this.logger=t}},qk=class extends $T{constructor(e,t){super(e,t,"request",yk,e=>e.id),this.core=e,this.logger=t}},Wk=class extends $T{constructor(e,t){super(e,t,"authKeys",Pk,()=>Rk),this.core=e,this.logger=t}},Vk=class extends $T{constructor(e,t){super(e,t,"pairingTopics",Pk),this.core=e,this.logger=t}},Kk=class extends $T{constructor(e,t){super(e,t,"requests",Pk,e=>e.id),this.core=e,this.logger=t}};var Gk=Object.defineProperty,Zk=(e,t,r)=>((e,t,r)=>t in e?Gk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class Yk{constructor(e,t){this.core=e,this.logger=t,Zk(this,"authKeys"),Zk(this,"pairingTopics"),Zk(this,"requests"),this.authKeys=new Wk(this.core,this.logger),this.pairingTopics=new Vk(this.core,this.logger),this.requests=new Kk(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var Jk=Object.defineProperty,Xk=(e,t,r)=>((e,t,r)=>t in e?Jk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);let Qk=class e extends $A{constructor(e){super(e),Xk(this,"protocol","wc"),Xk(this,"version",2),Xk(this,"name",wk),Xk(this,"metadata"),Xk(this,"core"),Xk(this,"logger"),Xk(this,"events",new Ke.EventEmitter),Xk(this,"engine"),Xk(this,"session"),Xk(this,"proposal"),Xk(this,"pendingRequest"),Xk(this,"auth"),Xk(this,"signConfig"),Xk(this,"on",(e,t)=>this.events.on(e,t)),Xk(this,"once",(e,t)=>this.events.once(e,t)),Xk(this,"off",(e,t)=>this.events.off(e,t)),Xk(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),Xk(this,"removeAllListeners",e=>this.events.removeAllListeners(e)),Xk(this,"connect",async e=>{try{return await this.engine.connect(e)}catch(e){throw this.logger.error(e.message),e}}),Xk(this,"pair",async e=>{try{return await this.engine.pair(e)}catch(e){throw this.logger.error(e.message),e}}),Xk(this,"approve",async e=>{try{return await this.engine.approve(e)}catch(e){throw this.logger.error(e.message),e}}),Xk(this,"reject",async e=>{try{return await this.engine.reject(e)}catch(e){throw this.logger.error(e.message),e}}),Xk(this,"update",async e=>{try{return await this.engine.update(e)}catch(e){throw this.logger.error(e.message),e}}),Xk(this,"extend",async e=>{try{return await this.engine.extend(e)}catch(e){throw this.logger.error(e.message),e}}),Xk(this,"request",async e=>{try{return await this.engine.request(e)}catch(e){throw this.logger.error(e.message),e}}),Xk(this,"respond",async e=>{try{return await this.engine.respond(e)}catch(e){throw this.logger.error(e.message),e}}),Xk(this,"ping",async e=>{try{return await this.engine.ping(e)}catch(e){throw this.logger.error(e.message),e}}),Xk(this,"emit",async e=>{try{return await this.engine.emit(e)}catch(e){throw this.logger.error(e.message),e}}),Xk(this,"disconnect",async e=>{try{return await this.engine.disconnect(e)}catch(e){throw this.logger.error(e.message),e}}),Xk(this,"find",e=>{try{return this.engine.find(e)}catch(e){throw this.logger.error(e.message),e}}),Xk(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(e){throw this.logger.error(e.message),e}}),Xk(this,"authenticate",async(e,t)=>{try{return await this.engine.authenticate(e,t)}catch(e){throw this.logger.error(e.message),e}}),Xk(this,"formatAuthMessage",e=>{try{return this.engine.formatAuthMessage(e)}catch(e){throw this.logger.error(e.message),e}}),Xk(this,"approveSessionAuthenticate",async e=>{try{return await this.engine.approveSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}}),Xk(this,"rejectSessionAuthenticate",async e=>{try{return await this.engine.rejectSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}}),this.name=e?.name||wk,this.metadata=sw(e?.metadata),this.signConfig=e?.signConfig;const t=typeof e?.logger<"u"&&"string"!=typeof e?.logger?e.logger:QS(yA({level:e?.logger||bk}));this.core=e?.core||new gk(e),this.logger=bA(t,this.name),this.session=new zk(this.core,this.logger),this.proposal=new Hk(this.core,this.logger),this.pendingRequest=new qk(this.core,this.logger),this.engine=new Fk(this),this.auth=new Yk(this.core,this.logger)}static async init(t){const r=new e(t);return await r.initialize(),r}get context(){return wA(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var eN={exports:{}};!function(e,t){var r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==he&&he,n=function(){function e(){this.fetch=!1,this.DOMException=r.DOMException}return e.prototype=r,new e}();!function(e){!function(t){var r=void 0!==e&&e||"undefined"!=typeof self&&self||void 0!==he&&he||{},n="URLSearchParams"in r,i="Symbol"in r&&"iterator"in Symbol,o="FileReader"in r&&"Blob"in r&&function(){try{return new Blob,!0}catch(e){return!1}}(),s="FormData"in r,a="ArrayBuffer"in r;if(a)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(e){return e&&c.indexOf(Object.prototype.toString.call(e))>-1};function u(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function h(e){return"string"!=typeof e&&(e=String(e)),e}function d(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return i&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){if(2!=e.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function p(e){if(!e._noBody)return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function g(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function m(e){var t=new FileReader,r=g(t);return t.readAsArrayBuffer(e),r}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function w(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:o&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:s&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():a&&o&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a&&(ArrayBuffer.prototype.isPrototypeOf(e)||l(e))?this._bodyArrayBuffer=y(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=p(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}if(o)return this.blob().then(m);throw new Error("could not read as ArrayBuffer")},this.text=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,r=g(t),n=/charset=([A-Za-z0-9_-]+)/.exec(e.type),i=n?n[1]:"utf-8";return t.readAsText(e,i),r}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(E)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(e,t){e=u(e),t=h(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},f.prototype.delete=function(e){delete this.map[u(e)]},f.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},f.prototype.set=function(e,t){this.map[u(e)]=h(t)},f.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},f.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),d(e)},f.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),d(e)},f.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),d(e)},i&&(f.prototype[Symbol.iterator]=f.prototype.entries);var b=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function v(e,t){if(!(this instanceof v))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n,i,o=(t=t||{}).body;if(e instanceof v){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=(n=t.method||this.method||"GET",i=n.toUpperCase(),b.indexOf(i)>-1?i:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal||function(){if("AbortController"in r)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(o),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var s=/([?&])_=[^&]*/;if(s.test(this.url))this.url=this.url.replace(s,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function E(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}}),t}function x(e,t){if(!(this instanceof x))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}v.prototype.clone=function(){return new v(this,{body:this._bodyInit})},w.call(v.prototype),w.call(x.prototype),x.prototype.clone=function(){return new x(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},x.error=function(){var e=new x(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var I=[301,302,303,307,308];x.redirect=function(e,t){if(-1===I.indexOf(t))throw new RangeError("Invalid status code");return new x(null,{status:t,headers:{location:e}})},t.DOMException=r.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function _(e,n){return new Promise(function(i,s){var c=new v(e,n);if(c.signal&&c.signal.aborted)return s(new t.DOMException("Aborted","AbortError"));var l=new XMLHttpRequest;function d(){l.abort()}if(l.onload=function(){var e,t,r={statusText:l.statusText,headers:(e=l.getAllResponseHeaders()||"",t=new f,e.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e}).forEach(function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();try{t.append(n,i)}catch(e){console.warn("Response "+e.message)}}}),t)};0===c.url.indexOf("file://")&&(l.status<200||l.status>599)?r.status=200:r.status=l.status,r.url="responseURL"in l?l.responseURL:r.headers.get("X-Request-URL");var n="response"in l?l.response:l.responseText;setTimeout(function(){i(new x(n,r))},0)},l.onerror=function(){setTimeout(function(){s(new TypeError("Network request failed"))},0)},l.ontimeout=function(){setTimeout(function(){s(new TypeError("Network request timed out"))},0)},l.onabort=function(){setTimeout(function(){s(new t.DOMException("Aborted","AbortError"))},0)},l.open(c.method,function(e){try{return""===e&&r.location.href?r.location.href:e}catch(t){return e}}(c.url),!0),"include"===c.credentials?l.withCredentials=!0:"omit"===c.credentials&&(l.withCredentials=!1),"responseType"in l&&(o?l.responseType="blob":a&&(l.responseType="arraybuffer")),n&&"object"==typeof n.headers&&!(n.headers instanceof f||r.Headers&&n.headers instanceof r.Headers)){var p=[];Object.getOwnPropertyNames(n.headers).forEach(function(e){p.push(u(e)),l.setRequestHeader(e,h(n.headers[e]))}),c.headers.forEach(function(e,t){-1===p.indexOf(t)&&l.setRequestHeader(t,e)})}else c.headers.forEach(function(e,t){l.setRequestHeader(t,e)});c.signal&&(c.signal.addEventListener("abort",d),l.onreadystatechange=function(){4===l.readyState&&c.signal.removeEventListener("abort",d)}),l.send(void 0===c._bodyInit?null:c._bodyInit)})}_.polyfill=!0,r.fetch||(r.fetch=_,r.Headers=f,r.Request=v,r.Response=x),t.Headers=f,t.Request=v,t.Response=x,t.fetch=_,Object.defineProperty(t,"__esModule",{value:!0})}({})}(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var i=r.fetch?r:n;(t=i.fetch).default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,e.exports=t}(eN,eN.exports);var tN=de(eN.exports),rN=Object.defineProperty,nN=Object.defineProperties,iN=Object.getOwnPropertyDescriptors,oN=Object.getOwnPropertySymbols,sN=Object.prototype.hasOwnProperty,aN=Object.prototype.propertyIsEnumerable,cN=(e,t,r)=>t in e?rN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,lN=(e,t)=>{for(var r in t||(t={}))sN.call(t,r)&&cN(e,r,t[r]);if(oN)for(var r of oN(t))aN.call(t,r)&&cN(e,r,t[r]);return e},uN=(e,t)=>nN(e,iN(t));const hN={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};let dN=class{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new Ke.EventEmitter,this.isAvailable=!1,this.registering=!1,!dO(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const t=Cd(e),r=await(await tN(this.url,uN(lN({},hN),{body:t}))).json();this.onPayload({data:r})}catch(t){this.onError(e.id,t)}}async register(e=this.url){if(!dO(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise((e,t)=>{this.events.once("register_error",e=>{this.resetMaxListeners(),t(e)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return t(new Error("HTTP connection is missing or invalid"));e()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=Cd({id:1,jsonrpc:"2.0",method:"test",params:[]});await tN(e,uN(lN({},hN),{body:t}))}this.onOpen()}catch(e){const t=this.parseError(e);throw this.events.emit("register_error",t),this.onClose(),t}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t="string"==typeof e.data?Od(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const r=this.parseError(t),n=sO(e,r.message||r.toString());this.events.emit("payload",n)}parseError(e,t=this.url){return YA(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}};const fN="error",pN="wc@2:universal_provider:",gN="https://rpc.walletconnect.org/v1/",mN="generic",yN=`${gN}bundler`,wN="call_status",bN="default_chain_changed";function vN(e){return null==e||"object"!=typeof e&&"function"!=typeof e}function EN(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function xN(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const IN="[object RegExp]",_N="[object String]",SN="[object Number]",AN="[object Boolean]",ON="[object Arguments]",CN="[object Symbol]",PN="[object Date]",RN="[object Map]",TN="[object Set]",kN="[object Array]",NN="[object ArrayBuffer]",UN="[object Object]",BN="[object DataView]",LN="[object Uint8Array]",DN="[object Uint8ClampedArray]",$N="[object Uint16Array]",MN="[object Uint32Array]",jN="[object Int8Array]",FN="[object Int16Array]",HN="[object Int32Array]",zN="[object Float32Array]",qN="[object Float64Array]";function WN(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function VN(e,t,r,n=new Map,i=void 0){const o=i?.(e,t,r,n);if(null!=o)return o;if(vN(e))return e;if(n.has(e))return n.get(e);if(Array.isArray(e)){const t=new Array(e.length);n.set(e,t);for(let o=0;o<e.length;o++)t[o]=VN(e[o],o,r,n,i);return Object.hasOwn(e,"index")&&(t.index=e.index),Object.hasOwn(e,"input")&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){const t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){const t=new Map;n.set(e,t);for(const[o,s]of e)t.set(o,VN(s,o,r,n,i));return t}if(e instanceof Set){const t=new Set;n.set(e,t);for(const o of e)t.add(VN(o,void 0,r,n,i));return t}if(typeof Buffer<"u"&&Buffer.isBuffer(e))return e.subarray();if(WN(e)){const t=new(Object.getPrototypeOf(e).constructor)(e.length);n.set(e,t);for(let o=0;o<e.length;o++)t[o]=VN(e[o],o,r,n,i);return t}if(e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){const t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return n.set(e,t),KN(t,e,r,n,i),t}if(typeof File<"u"&&e instanceof File){const t=new File([e],e.name,{type:e.type});return n.set(e,t),KN(t,e,r,n,i),t}if(e instanceof Blob){const t=new Blob([e],{type:e.type});return n.set(e,t),KN(t,e,r,n,i),t}if(e instanceof Error){const t=new e.constructor;return n.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,KN(t,e,r,n,i),t}if("object"==typeof e&&function(e){switch(xN(e)){case ON:case kN:case NN:case BN:case AN:case PN:case zN:case qN:case jN:case FN:case HN:case RN:case SN:case UN:case IN:case TN:case _N:case CN:case LN:case DN:case $N:case MN:return!0;default:return!1}}(e)){const t=Object.create(Object.getPrototypeOf(e));return n.set(e,t),KN(t,e,r,n,i),t}return e}function KN(e,t,r=e,n,i){const o=[...Object.keys(t),...EN(t)];for(let s=0;s<o.length;s++){const a=o[s],c=Object.getOwnPropertyDescriptor(e,a);(null==c||c.writable)&&(e[a]=VN(t[a],a,r,n,i))}}function GN(e,t){return function(e,t){return VN(e,void 0,e,new Map,t)}(e,(t,r,n,i)=>{if("object"==typeof e)switch(Object.prototype.toString.call(e)){case SN:case _N:case AN:{const t=new e.constructor(e?.valueOf());return KN(t,e),t}case ON:{const t={};return KN(t,e),t.length=e.length,t[Symbol.iterator]=e[Symbol.iterator],t}default:return}})}function ZN(e){return GN(e)}function YN(e){return null!==e&&"object"==typeof e&&"[object Arguments]"===xN(e)}function JN(e){return"object"==typeof e&&null!==e}function XN(){}function QN(e){return WN(e)}function eU(e){if("object"!=typeof e||null==e)return!1;if(null===Object.getPrototypeOf(e))return!0;if("[object Object]"!==Object.prototype.toString.call(e)){const t=e[Symbol.toStringTag];return!(null==t||!Object.getOwnPropertyDescriptor(e,Symbol.toStringTag)?.writable)&&e.toString()===`[object ${t}]`}let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function tU(e,t,r,n){if(vN(e)&&(e=Object(e)),null==t||"object"!=typeof t)return e;if(n.has(t))return function(e){if(vN(e))return e;if(Array.isArray(e)||WN(e)||e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);const t=Object.getPrototypeOf(e),r=t.constructor;if(e instanceof Date||e instanceof Map||e instanceof Set)return new r(e);if(e instanceof RegExp){const t=new r(e);return t.lastIndex=e.lastIndex,t}if(e instanceof DataView)return new r(e.buffer.slice(0));if(e instanceof Error){const t=new r(e.message);return t.stack=e.stack,t.name=e.name,t.cause=e.cause,t}if(typeof File<"u"&&e instanceof File)return new r([e],e.name,{type:e.type,lastModified:e.lastModified});if("object"==typeof e){const r=Object.create(t);return Object.assign(r,e)}return e}(n.get(t));if(n.set(t,e),Array.isArray(t)){t=t.slice();for(let e=0;e<t.length;e++)t[e]=t[e]??void 0}const i=[...Object.keys(t),...EN(t)];for(let o=0;o<i.length;o++){const s=i[o];let a=t[s],c=e[s];if(YN(a)&&(a={...a}),YN(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=ZN(a)),Array.isArray(a))if("object"==typeof c&&null!=c){const e=[],t=Reflect.ownKeys(c);for(let r=0;r<t.length;r++){const n=t[r];e[n]=c[n]}c=e}else c=[];const l=r(c,a,s,e,t,n);null!=l?e[s]=l:Array.isArray(a)||JN(c)&&JN(a)?e[s]=tU(c,a,r,n):null==c&&eU(a)?e[s]=tU({},a,r,n):null==c&&QN(a)?e[s]=ZN(a):(void 0===c||void 0!==a)&&(e[s]=a)}return e}function rU(e,...t){return function(e,...t){const r=t.slice(0,-1),n=t[t.length-1];let i=e;for(let e=0;e<r.length;e++)i=tU(i,r[e],n,new Map);return i}(e,...t,XN)}var nU=Object.defineProperty,iU=Object.defineProperties,oU=Object.getOwnPropertyDescriptors,sU=Object.getOwnPropertySymbols,aU=Object.prototype.hasOwnProperty,cU=Object.prototype.propertyIsEnumerable,lU=(e,t,r)=>t in e?nU(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uU=(e,t)=>{for(var r in t||(t={}))aU.call(t,r)&&lU(e,r,t[r]);if(sU)for(var r of sU(t))cU.call(t,r)&&lU(e,r,t[r]);return e},hU=(e,t)=>iU(e,oU(t));function dU(e,t,r){var n;const i=My(e);return(null==(n=t.rpcMap)?void 0:n[i.reference])||`${gN}?chainId=${i.namespace}:${i.reference}&projectId=${r}`}function fU(e){return e.includes(":")?e.split(":")[1]:e}function pU(e){return e.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function gU(e){return Object.fromEntries(Object.entries(e).filter(([e,t])=>{var r,n;return(null==(r=t?.chains)?void 0:r.length)&&(null==(n=t?.chains)?void 0:n.length)>0}))}function mU(e={},t={}){return rU(gU(yU(e)),gU(yU(t)))}function yU(e){var t,r,n,i,o;const s={};if(!qI(e))return s;for(const[a,c]of Object.entries(e)){const e=BI(a)?[a]:c.chains,l=c.methods||[],u=c.events||[],h=c.rpcMap||{},d=LI(a);s[d]=hU(uU(uU({},s[d]),c),{chains:vw(e,null==(t=s[d])?void 0:t.chains),methods:vw(l,null==(r=s[d])?void 0:r.methods),events:vw(u,null==(n=s[d])?void 0:n.events)}),(qI(h)||qI((null==(i=s[d])?void 0:i.rpcMap)||{}))&&(s[d].rpcMap=uU(uU({},h),null==(o=s[d])?void 0:o.rpcMap))}return s}function wU(e){return e.includes(":")?e.split(":")[2]:e}function bU(e){const t={};for(const[r,n]of Object.entries(e)){const e=n.methods||[],i=n.events||[],o=n.accounts||[],s=BI(r)?[r]:n.chains?n.chains:pU(n.accounts);t[r]={chains:s,methods:e,events:i,accounts:o}}return t}function vU(e){return"number"==typeof e?e:e.includes("0x")?parseInt(e,16):(e=e.includes(":")?e.split(":")[1]:e,isNaN(Number(e))?e:Number(e))}const EU={},xU=e=>EU[e],IU=(e,t)=>{EU[e]=t};var _U=Object.defineProperty,SU=Object.getOwnPropertySymbols,AU=Object.prototype.hasOwnProperty,OU=Object.prototype.propertyIsEnumerable,CU=(e,t,r)=>t in e?_U(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,PU=(e,t)=>{for(var r in t||(t={}))AU.call(t,r)&&CU(e,r,t[r]);if(SU)for(var r of SU(t))OU.call(t,r)&&CU(e,r,t[r]);return e};const RU="eip155",TU=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],kU=e=>e&&e.startsWith("0x")?BigInt(e).toString(10):e,NU=e=>e&&e.startsWith("0x")?e:`0x${BigInt(e).toString(16)}`,UU=e=>Object.keys(e).filter(e=>TU.includes(e)).reduce((t,r)=>(t[r]=BU(e[r]),t),{}),BU=e=>"string"==typeof e&&function(e){try{const t=JSON.parse(e);return"object"==typeof t&&null!==t&&!Array.isArray(t)}catch{return!1}}(e)?JSON.parse(e):e;var LU=Object.defineProperty,DU=(e,t,r)=>((e,t,r)=>t in e?LU(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,t+"",r);let $U;class MU{constructor(e){DU(this,"storage"),this.storage=e}async getItem(e){return await this.storage.getItem(e)}async setItem(e,t){return await this.storage.setItem(e,t)}async removeItem(e){return await this.storage.removeItem(e)}static getStorage(e){return $U||($U=new MU(e)),$U}}var jU=Object.defineProperty,FU=Object.defineProperties,HU=Object.getOwnPropertyDescriptors,zU=Object.getOwnPropertySymbols,qU=Object.prototype.hasOwnProperty,WU=Object.prototype.propertyIsEnumerable,VU=(e,t,r)=>t in e?jU(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;async function KU(e,t){const r=My(e.result.capabilities.caip345.caip2),n=e.result.capabilities.caip345.transactionHashes,i=await Promise.allSettled(n.map(e=>async function(e,t,r){return await r(parseInt(e)).request(iO("eth_getTransactionReceipt",[t]))}(r.reference,e,t))),o=i.filter(e=>"fulfilled"===e.status).map(e=>e.value).filter(e=>e);i.filter(e=>"rejected"===e.status).forEach(e=>console.warn("Failed to fetch transaction receipt:",e.reason));const s=!o.length||o.some(e=>!e),a=o.every(e=>"0x1"===e?.status),c=o.every(e=>"0x0"===e?.status),l=o.some(e=>"0x0"===e?.status);let u;return s?u=100:a?u=200:c?u=500:l&&(u=600),{id:e.result.id,version:e.request.version,atomic:e.request.atomicRequired,chainId:e.request.chainId,capabilities:e.result.capabilities,receipts:o,status:u}}async function GU({sendCalls:e,storage:t}){const r=await t.getItem(wN);await t.setItem(wN,((e,t)=>FU(e,HU(t)))(((e,t)=>{for(var r in t||(t={}))qU.call(t,r)&&VU(e,r,t[r]);if(zU)for(var r of zU(t))WU.call(t,r)&&VU(e,r,t[r]);return e})({},r),{[e.result.id]:{request:e.request,result:e.result,expiry:yw(86400)}}))}async function ZU({resultId:e,storage:t}){const r=await t.getItem(wN),n=r?.[e];if(n&&!ww(n.expiry))return n;await async function({resultId:e,storage:t}){const r=await t.getItem(wN);if(r){delete r[e],await t.setItem(wN,r);for(const e in r)ww(r[e].expiry)&&delete r[e];await t.setItem(wN,r)}}({resultId:e,storage:t})}var YU=Object.defineProperty,JU=(e,t,r)=>((e,t,r)=>t in e?YU(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class XU{constructor(e){JU(this,"name","polkadot"),JU(this,"client"),JU(this,"httpProviders"),JU(this,"events"),JU(this,"namespace"),JU(this,"chainId"),this.namespace=e.namespace,this.events=xU("events"),this.client=xU("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(bN,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const n=fU(t);e[n]=this.createHttpProvider(n,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||dU(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new bO(new dN(r,xU("disableProviderPing")))}}var QU=Object.defineProperty,eB=Object.defineProperties,tB=Object.getOwnPropertyDescriptors,rB=Object.getOwnPropertySymbols,nB=Object.prototype.hasOwnProperty,iB=Object.prototype.propertyIsEnumerable,oB=(e,t,r)=>t in e?QU(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,sB=(e,t)=>{for(var r in t||(t={}))nB.call(t,r)&&oB(e,r,t[r]);if(rB)for(var r of rB(t))iB.call(t,r)&&oB(e,r,t[r]);return e},aB=(e,t)=>eB(e,tB(t)),cB=(e,t,r)=>oB(e,"symbol"!=typeof t?t+"":t,r);class lB{constructor(e){cB(this,"name","eip155"),cB(this,"client"),cB(this,"chainId"),cB(this,"namespace"),cB(this,"httpProviders"),cB(this,"events"),cB(this,"storage"),this.namespace=e.namespace,this.events=xU("events"),this.client=xU("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain()),this.storage=MU.getStorage(this.client.core.storage)}async request(e){switch(e.request.method){case"eth_requestAccounts":case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e);case"wallet_sendCalls":return await this.sendCalls(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(bN,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const r=t||dU(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new bO(new dN(r,xU("disableProviderPing")))}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const n=parseInt(fU(t));e[n]=this.createHttpProvider(n,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}getHttpProvider(e){const t=e||this.chainId;return this.httpProviders[t]||(this.httpProviders=aB(sB({},this.httpProviders),{[t]:this.createHttpProvider(t)}),this.httpProviders[t])}async handleSwitchChain(e){var t,r;let n=e.request.params?null==(t=e.request.params[0])?void 0:t.chainId:"0x0";n=n.startsWith("0x")?n:`0x${n}`;const i=parseInt(n,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else{if(!this.namespace.methods.includes("wallet_switchEthereumChain"))throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:n}]},chainId:null==(r=this.namespace.chains)?void 0:r[0]}),this.setDefaultChain(`${i}`)}return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,r,n,i,o;const s=null==(r=null==(t=e.request)?void 0:t.params)?void 0:r[0],a=(null==(i=null==(n=e.request)?void 0:n.params)?void 0:i[1])||[];if(!s)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const c=this.client.session.get(e.topic),l=(null==(o=c?.sessionProperties)?void 0:o.capabilities)||{},u=`${s}${a.join(",")}`,h=l?.[u];if(h)return h;let d;try{d=((e,t,r)=>{const{sessionProperties:n={},scopedProperties:i={}}=e,o={};if(!qI(i)&&!qI(n))return;const s=UU(n);for(const e of r){const r=kU(e);if(!r)continue;o[NU(r)]=s;const n=i?.[`${RU}:${r}`];if(n){const e=n?.[`${RU}:${r}:${t}`];o[NU(r)]=PU(PU({},o[NU(r)]),UU(e||n))}}for(const[e,t]of Object.entries(o))0===Object.keys(t).length&&delete o[e];return Object.keys(o).length>0?o:void 0})(c,s,a)}catch(e){console.warn("Failed to extract capabilities from session",e)}if(d)return d;const f=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:aB(sB({},c.sessionProperties||{}),{capabilities:aB(sB({},l||{}),{[u]:f})})})}catch(e){console.warn("Failed to update session with capabilities",e)}return f}async getCallStatus(e){var t,r,n;const i=this.client.session.get(e.topic),o=null==(t=i.sessionProperties)?void 0:t.bundler_name;if(o){const t=this.getBundlerUrl(e.chainId,o);try{return await this.getUserOperationReceipt(t,e)}catch(e){console.warn("Failed to fetch call status from bundler",e,t)}}const s=null==(r=i.sessionProperties)?void 0:r.bundler_url;if(s)try{return await this.getUserOperationReceipt(s,e)}catch(e){console.warn("Failed to fetch call status from custom bundler",e,s)}const a=await ZU({resultId:null==(n=e.request.params)?void 0:n[0],storage:this.storage});if(a)try{return await KU(a,this.getHttpProvider.bind(this))}catch(e){console.warn("Failed to fetch call status from stored send calls",e,a)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var r;const n=new URL(e),i=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(iO("eth_getUserOperationReceipt",[null==(r=t.request.params)?void 0:r[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,t){return`${yN}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}async sendCalls(e){var t,r,n;const i=await this.client.request(e),o=null==(t=e.request.params)?void 0:t[0],s=i?.id,a=i?.capabilities||{},c=null==(r=a?.caip345)?void 0:r.caip2,l=null==(n=a?.caip345)?void 0:n.transactionHashes;return!s||!c||!(null!=l&&l.length)||await GU({sendCalls:{request:o,result:i},storage:this.storage}),i}}var uB=Object.defineProperty,hB=(e,t,r)=>((e,t,r)=>t in e?uB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class dB{constructor(e){hB(this,"name","solana"),hB(this,"client"),hB(this,"httpProviders"),hB(this,"events"),hB(this,"namespace"),hB(this,"chainId"),this.namespace=e.namespace,this.events=xU("events"),this.client=xU("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(bN,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const n=fU(t);e[n]=this.createHttpProvider(n,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||dU(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new bO(new dN(r,xU("disableProviderPing")))}}var fB=Object.defineProperty,pB=(e,t,r)=>((e,t,r)=>t in e?fB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class gB{constructor(e){pB(this,"name","cosmos"),pB(this,"client"),pB(this,"httpProviders"),pB(this,"events"),pB(this,"namespace"),pB(this,"chainId"),this.namespace=e.namespace,this.events=xU("events"),this.client=xU("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(bN,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const n=fU(t);e[n]=this.createHttpProvider(n,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||dU(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new bO(new dN(r,xU("disableProviderPing")))}}var mB=Object.defineProperty,yB=(e,t,r)=>((e,t,r)=>t in e?mB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class wB{constructor(e){yB(this,"name","algorand"),yB(this,"client"),yB(this,"httpProviders"),yB(this,"events"),yB(this,"namespace"),yB(this,"chainId"),this.namespace=e.namespace,this.events=xU("events"),this.client=xU("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const r=t||dU(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.chainId=e,this.events.emit(bN,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;e[t]=this.createHttpProvider(t,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||dU(e,this.namespace,this.client.core.projectId);return typeof r>"u"?void 0:new bO(new dN(r,xU("disableProviderPing")))}}var bB=Object.defineProperty,vB=(e,t,r)=>((e,t,r)=>t in e?bB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class EB{constructor(e){vB(this,"name","cip34"),vB(this,"client"),vB(this,"httpProviders"),vB(this,"events"),vB(this,"namespace"),vB(this,"chainId"),this.namespace=e.namespace,this.events=xU("events"),this.client=xU("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(bN,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const r=this.getCardanoRPCUrl(t),n=fU(t);e[n]=this.createHttpProvider(n,r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||this.getCardanoRPCUrl(e);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new bO(new dN(r,xU("disableProviderPing")))}}var xB=Object.defineProperty,IB=(e,t,r)=>((e,t,r)=>t in e?xB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class _B{constructor(e){IB(this,"name","elrond"),IB(this,"client"),IB(this,"httpProviders"),IB(this,"events"),IB(this,"namespace"),IB(this,"chainId"),this.namespace=e.namespace,this.events=xU("events"),this.client=xU("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(bN,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const n=fU(t);e[n]=this.createHttpProvider(n,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||dU(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new bO(new dN(r,xU("disableProviderPing")))}}var SB=Object.defineProperty,AB=(e,t,r)=>((e,t,r)=>t in e?SB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class OB{constructor(e){AB(this,"name","multiversx"),AB(this,"client"),AB(this,"httpProviders"),AB(this,"events"),AB(this,"namespace"),AB(this,"chainId"),this.namespace=e.namespace,this.events=xU("events"),this.client=xU("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(bN,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const n=fU(t);e[n]=this.createHttpProvider(n,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||dU(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new bO(new dN(r,xU("disableProviderPing")))}}var CB=Object.defineProperty,PB=(e,t,r)=>((e,t,r)=>t in e?CB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class RB{constructor(e){PB(this,"name","near"),PB(this,"client"),PB(this,"httpProviders"),PB(this,"events"),PB(this,"namespace"),PB(this,"chainId"),this.namespace=e.namespace,this.events=xU("events"),this.client=xU("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const r=t||dU(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(bN,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;e[t]=this.createHttpProvider(t,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||dU(e,this.namespace);return typeof r>"u"?void 0:new bO(new dN(r,xU("disableProviderPing")))}}var TB=Object.defineProperty,kB=(e,t,r)=>((e,t,r)=>t in e?TB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class NB{constructor(e){kB(this,"name","tezos"),kB(this,"client"),kB(this,"httpProviders"),kB(this,"events"),kB(this,"namespace"),kB(this,"chainId"),this.namespace=e.namespace,this.events=xU("events"),this.client=xU("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const r=t||dU(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(bN,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||dU(e,this.namespace);return typeof r>"u"?void 0:new bO(new dN(r))}}var UB=Object.defineProperty,BB=(e,t,r)=>((e,t,r)=>t in e?UB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class LB{constructor(e){BB(this,"name",mN),BB(this,"client"),BB(this,"httpProviders"),BB(this,"events"),BB(this,"namespace"),BB(this,"chainId"),this.namespace=e.namespace,this.events=xU("events"),this.client=xU("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(bN,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getNamespaceName(){const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return My(e).namespace}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){var e,t;const r={};return null==(t=null==(e=this.namespace)?void 0:e.accounts)||t.forEach(e=>{const t=My(e);r[t.reference]=this.createHttpProvider(e)}),r}getHttpProvider(e){const t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||dU(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new bO(new dN(r,xU("disableProviderPing")))}}var DB=Object.defineProperty,$B=Object.defineProperties,MB=Object.getOwnPropertyDescriptors,jB=Object.getOwnPropertySymbols,FB=Object.prototype.hasOwnProperty,HB=Object.prototype.propertyIsEnumerable,zB=(e,t,r)=>t in e?DB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,qB=(e,t)=>{for(var r in t||(t={}))FB.call(t,r)&&zB(e,r,t[r]);if(jB)for(var r of jB(t))HB.call(t,r)&&zB(e,r,t[r]);return e},WB=(e,t)=>$B(e,MB(t)),VB=(e,t,r)=>zB(e,"symbol"!=typeof t?t+"":t,r);class KB{constructor(e){VB(this,"client"),VB(this,"namespaces"),VB(this,"optionalNamespaces"),VB(this,"sessionProperties"),VB(this,"scopedProperties"),VB(this,"events",new Ge),VB(this,"rpcProviders",{}),VB(this,"session"),VB(this,"providerOpts"),VB(this,"logger"),VB(this,"uri"),VB(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof e?.logger<"u"&&"string"!=typeof e?.logger?e.logger:QS(yA({level:e?.logger||fN})),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){const t=new KB(e);return await t.initialize(),t}async request(e,t,r){const[n,i]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:qB({},e),chainId:`${n}:${i}`,topic:this.session.topic,expiry:r})}sendAsync(e,t,r,n){const i=(new Date).getTime();this.request(e,r,n).then(e=>t(null,oO(i,e))).catch(e=>t(e,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:null==(e=this.session)?void 0:e.topic,reason:HI("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:r,response:n}=await this.client.authenticate(e,t);r&&(this.uri=r,this.events.emit("display_uri",r));const i=await n();if(this.session=i.session,this.session){const e=bU(this.session.namespaces);this.namespaces=mU(this.namespaces,e),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){const{uri:t,approval:r}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));const n=await r();this.session=n;const i=bU(n.namespaces);return this.namespaces=mU(this.namespaces,i),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[r,n]=this.validateChain(e);this.getProvider(r).setDefaultChain(n,t)}catch(e){if(!/Please call connect/.test(e.message))throw e}}async cleanupPendingPairings(e={}){try{this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(!zI(t))return;for(const r of t)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}catch(e){this.logger.warn("Failed to cleanup pending pairings",e)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await Qk.init({core:this.providerOpts.core,logger:this.providerOpts.logger||fN,relayUrl:this.providerOpts.relayUrl||"wss://relay.walletconnect.org",projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error("Failed to get session",r),new Error(`The provided session: ${null==(t=null==(e=this.providerOpts)?void 0:e.session)?void 0:t.topic} doesn't exist in the Sign client`)}else{const e=this.client.session.getAll();this.session=e[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(e=>LI(e)))];IU("client",this.client),IU("events",this.events),IU("disableProviderPing",this.disableProviderPing),e.forEach(e=>{if(!this.session)return;const t=function(e,t){const r=Object.keys(t.namespaces).filter(t=>t.includes(e));if(!r.length)return[];const n=[];return r.forEach(e=>{const r=t.namespaces[e].accounts;n.push(...r)}),n}(e,this.session);if(0===t?.length)return;const r=pU(t),n=mU(this.namespaces,this.optionalNamespaces),i=WB(qB({},n[e]),{accounts:t,chains:r});switch(e){case"eip155":this.rpcProviders[e]=new lB({namespace:i});break;case"algorand":this.rpcProviders[e]=new wB({namespace:i});break;case"solana":this.rpcProviders[e]=new dB({namespace:i});break;case"cosmos":this.rpcProviders[e]=new gB({namespace:i});break;case"polkadot":this.rpcProviders[e]=new XU({namespace:i});break;case"cip34":this.rpcProviders[e]=new EB({namespace:i});break;case"elrond":this.rpcProviders[e]=new _B({namespace:i});break;case"multiversx":this.rpcProviders[e]=new OB({namespace:i});break;case"near":this.rpcProviders[e]=new RB({namespace:i});break;case"tezos":this.rpcProviders[e]=new NB({namespace:i});break;default:this.rpcProviders[e]=new LB({namespace:i})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;const{topic:r}=e;r===(null==(t=this.session)?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;const{params:r,topic:n}=e;if(n!==(null==(t=this.session)?void 0:t.topic))return;const{event:i}=r;if("accountsChanged"===i.name){const e=i.data;e&&zI(e)&&this.events.emit("accountsChanged",e.map(wU))}else if("chainChanged"===i.name){const e=r.chainId,t=r.event.data,n=LI(e),i=vU(e)!==vU(t)?`${n}:${vU(t)}`:e;this.onChainChanged(i)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var r,n;if(e!==(null==(r=this.session)?void 0:r.topic))return;const{namespaces:i}=t,o=null==(n=this.client)?void 0:n.session.get(e);this.session=WB(qB({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{var t;e.topic===(null==(t=this.session)?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",WB(qB({},HI("USER_DISCONNECTED")),{data:e.topic})))}),this.on(bN,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[mN]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace(null==(t=this.session)?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t={},optionalNamespaces:r={},sessionProperties:n,scopedProperties:i}=e;this.optionalNamespaces=mU(t,r),this.sessionProperties=n,this.scopedProperties=i}validateChain(e){const[t,r]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,r];if(t&&!Object.keys(this.namespaces||{}).map(e=>LI(e)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&r)return[t,r];const n=LI(Object.keys(this.namespaces)[0]);return[n,this.rpcProviders[n].getDefaultChain()]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,t=!1){if(!this.namespaces)return;const[r,n]=this.validateChain(e);if(!n)return;this.updateNamespaceChain(r,n);const i=this.getProvider(r).getDefaultChain();t?(this.events.emit("chainChanged",n),this.emitAccountsChangedOnChainChange({namespace:r,previousChainId:i,newChainId:e})):this.getProvider(r).setDefaultChain(n),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:t,newChainId:r}){var n,i;try{if(t===r)return;const o=null==(i=null==(n=this.session)?void 0:n.namespaces[e])?void 0:i.accounts;if(!o)return;const s=o.filter(e=>e.includes(`${r}:`)).map(wU);if(!zI(s))return;this.events.emit("accountsChanged",s)}catch(e){this.logger.warn("Failed to emit accountsChanged on chain change",e)}}updateNamespaceChain(e,t){if(!this.namespaces)return;const r=this.namespaces[e]?e:`${e}:${t}`,n={chains:[],methods:[],events:[],defaultChain:t};this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=t):this.namespaces[r]=n}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var r;const n=(null==(r=this.session)?void 0:r.topic)||"";await this.client.core.storage.setItem(`${pN}/${e}${n}`,t)}async getFromStore(e){var t;const r=(null==(t=this.session)?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${pN}/${e}${r}`)}async deleteFromStore(e){var t;const r=(null==(t=this.session)?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${pN}/${e}${r}`)}async cleanupStorage(){var e;try{if((null==(e=this.client)?void 0:e.session.length)>0)return;const t=await this.client.core.storage.getKeys();for(const e of t)e.startsWith(pN)&&await this.client.core.storage.removeItem(e)}catch(e){this.logger.warn("Failed to cleanup storage",e)}}}const GB=KB;let ZB=function(e){return e.FLOW_AUTHN="flow_authn",e.FLOW_PRE_AUTHZ="flow_pre_authz",e.FLOW_AUTHZ="flow_authz",e.FLOW_USER_SIGN="flow_user_sign",e}({}),YB=function(e){return e.SESSION_REQUEST="session_proposal",e.SIGNING_REQUEST="signing_request",e}({});const JB="fcl-plugin-service-walletconnect",XB="WC/RPC";function QB(){return"undefined"!=typeof navigator&&/iPhone|iPod/.test(navigator.userAgent)||"undefined"!=typeof navigator&&/iPad/.test(navigator.userAgent)}function eL(){return"undefined"!=typeof navigator&&/android/i.test(navigator.userAgent)||QB()}function tL(e){if(e.startsWith("http")){const t=document.createElement("a");t.href=e,t.target="_blank",t.rel="noreferrer noopener",t.click()}else window.open(e,"_blank")}async function rL(e){let{provider:t,existingPairing:r,network:n}=e;const i=n||await os(),o={flow:{methods:[ZB.FLOW_AUTHN,ZB.FLOW_PRE_AUTHZ,ZB.FLOW_AUTHZ,ZB.FLOW_USER_SIGN],chains:[`flow:${i}`],events:["chainChanged","accountsChanged"]}};let s;const a=new Promise((e,r)=>{const n=t=>{e(t)};t.on("display_uri",n),s=()=>{t.removeListener("display_uri",n),r(new Error("WalletConnect Session Request aborted"))}}),c=t.connect({pairingTopic:r?.topic,namespaces:o}).finally(()=>{s()});return{uri:await a,approval:()=>c}}const nL=async e=>{let{method:t,body:r,session:n,provider:i,isExternal:o,abortSignal:s,disableNotifications:a}=e;const[c,l,u]=function(e){const[t,r,n]=Object.values(e.namespaces).map(e=>e.accounts).flat().filter(e=>e.startsWith("flow:"))[0].split(":"),i=`${t}:${r}`,o=n;return[i,o,n]}(n),h=JSON.stringify({...r,addr:l,address:u}),d=await Promise.race([i.client.request({request:{method:t,params:[h]},chainId:c,topic:i.session?.topic}),new Promise((e,t)=>{s?.aborted&&t(new Error("WalletConnect Request aborted")),s?.addEventListener("abort",()=>{t(new Error("WalletConnect Request aborted"))})})]);if("object"==typeof d&&null!=d)switch(d.status){case"APPROVED":function f(e){return"WC/RPC"===e.method?{...e,params:{...e.params,...o?{externalProvider:n.topic}:{},...a?{disableNotifications:a}:{}}}:e}if(t===ZB.FLOW_AUTHN){const p=(d?.data?.services??[]).map(f);return{...d.data?d.data:{},services:p}}return t===ZB.FLOW_PRE_AUTHZ?{...d.data,...d.data?.proposer?{proposer:f(d.data.proposer)}:{},payer:[...d.data?.payer?.map(f)],authorization:[...d.data?.authorization?.map(f)]}:d.data;case"DECLINED":throw new Error(`Declined: ${d.reason||"No reason supplied"}`);case"REDIRECT":return d.data;default:throw new Error("Declined: No reason supplied")}};function iL(e){let{title:t,message:r,icon:n,onClick:i,onDismiss:o,animate:s}=e;return Q_("div",{className:"fixed bottom-3 left-3 right-3 mx-auto z-[2147483647] flex max-w-sm\n        overflow-hidden rounded-lg border border-gray-200 bg-white p-4 shadow-lg\n        md:bottom-4 md:left-auto md:right-4 dark:bg-gray-700 dark:border-gray-600\n        "+(s?"animate-slideUp":""),role:"alert",onClick:e=>{i&&(e.stopPropagation(),i?.())},children:[n&&Q_("img",{className:"h-10 w-10 self-center rounded-md md:self-start",src:n,alt:t}),Q_("div",{className:"ml-3 grow",children:[Q_("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:t}),Q_("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-300",children:r})]}),Q_("button",{className:"ml-2 inline-flex rounded-full text-gray-400 hover:text-gray-500 focus:ring-0\n          dark:text-gray-200 dark:hover:text-gray-300 "+(eL()?"self-center p-2":"self-start p-0 bg-transparent border-transparent focus:border-transparent"),onClick:e=>{e.stopPropagation(),o?.()},children:[Q_("span",{className:"sr-only",children:"Close"}),Q_("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:Q_("path",{fillRule:"evenodd",d:"M14.354 5.646a.5.5 0 00-.708 0L10 9.293 5.354 4.646a.5.5 0 00-.708.708L9.293 10l-4.647 4.646a.5.5 0 00.708.708L10 10.707l4.646 4.647a.5.5 0 00.708-.708L10.707 10l4.647-4.646a.5.5 0 000-.708z"})})]})]})}let oL=null,sL=0,aL=null;function cL(e){let{title:t,message:r,icon:n,onClick:i,onDismiss:o,debounceDelay:s=0}=e;oL||(oL=function(){const e=document.createElement("div"),t=e.attachShadow({mode:"open"}),r=document.createElement("div");t.appendChild(r),document.body.appendChild(e);const n=document.createElement("style");n.textContent='*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/*! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}:host,html{-webkit-text-size-adjust:100%;font-feature-settings:normal;-webkit-tap-highlight-color:transparent;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-variation-settings:normal;line-height:1.5;-moz-tab-size:4;tab-size:4}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-feature-settings:normal;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em;font-variation-settings:normal}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{font-feature-settings:inherit;color:inherit;font-family:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}@media (min-width:1536px){.container{max-width:1536px}}.sr-only{clip:rect(0,0,0,0);border-width:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.fixed{position:fixed}.bottom-3{bottom:.75rem}.left-3{left:.75rem}.right-3{right:.75rem}.z-\\[2147483647\\]{z-index:2147483647}.mx-auto{margin-left:auto;margin-right:auto}.ml-2{margin-left:.5rem}.ml-3{margin-left:.75rem}.mt-1{margin-top:.25rem}.flex{display:flex}.inline-flex{display:inline-flex}.h-10{height:2.5rem}.h-5{height:1.25rem}.w-10{width:2.5rem}.w-5{width:1.25rem}.max-w-sm{max-width:24rem}.grow{flex-grow:1}@keyframes slideUp{0%{transform:translateY(100%)}to{transform:translateY(0)}}.animate-slideUp{animation:slideUp .2s ease-out forwards}.self-start{align-self:flex-start}.self-center{align-self:center}.overflow-hidden{overflow:hidden}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.rounded-md{border-radius:.375rem}.border{border-width:1px}.border-gray-200{--tw-border-opacity:1;border-color:rgb(229 231 235/var(--tw-border-opacity,1))}.border-transparent{border-color:transparent}.bg-transparent{background-color:transparent}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity,1))}.p-0{padding:0}.p-2{padding:.5rem}.p-4{padding:1rem}.text-sm{font-size:.875rem;line-height:1.25rem}.font-medium{font-weight:500}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175/var(--tw-text-opacity,1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128/var(--tw-text-opacity,1))}.text-gray-900{--tw-text-opacity:1;color:rgb(17 24 39/var(--tw-text-opacity,1))}.shadow-lg{--tw-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -4px rgba(0,0,0,.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color),0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.hover\\:text-gray-500:hover{--tw-text-opacity:1;color:rgb(107 114 128/var(--tw-text-opacity,1))}.focus\\:border-transparent:focus{border-color:transparent}.focus\\:ring-0:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}.dark\\:border-gray-600:is(.dark *){--tw-border-opacity:1;border-color:rgb(75 85 99/var(--tw-border-opacity,1))}.dark\\:bg-gray-700:is(.dark *){--tw-bg-opacity:1;background-color:rgb(55 65 81/var(--tw-bg-opacity,1))}.dark\\:text-gray-100:is(.dark *){--tw-text-opacity:1;color:rgb(243 244 246/var(--tw-text-opacity,1))}.dark\\:text-gray-200:is(.dark *){--tw-text-opacity:1;color:rgb(229 231 235/var(--tw-text-opacity,1))}.dark\\:text-gray-300:is(.dark *){--tw-text-opacity:1;color:rgb(209 213 219/var(--tw-text-opacity,1))}.dark\\:hover\\:text-gray-300:hover:is(.dark *){--tw-text-opacity:1;color:rgb(209 213 219/var(--tw-text-opacity,1))}@media (min-width:768px){.md\\:bottom-4{bottom:1rem}.md\\:left-auto{left:auto}.md\\:right-4{right:1rem}.md\\:self-start{align-self:flex-start}}',t.appendChild(n);const i=window.matchMedia("(prefers-color-scheme: dark)"),o=()=>{r.classList.toggle("dark",i.matches)};return i.addEventListener("change",o),o(),r}());const a=!aL;function c(){oL&&J_(null,oL)}return aL&&(clearTimeout(aL),aL=null),J_(Q_(iL,{title:t,message:r,icon:n,onClick:i,onDismiss:()=>{o?.(),c()},animate:a},sL++),oL),{dismiss:()=>{aL=setTimeout(()=>{aL=null,c()},s)}}}var lL="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 384 512'%3e%3c!--!Font Awesome Free 6.7.1 by %40fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons%2c Inc.--%3e%3cpath d='M16 64C16 28.7 44.7 0 80 0L304 0c35.3 0 64 28.7 64 64l0 384c0 35.3-28.7 64-64 64L80 512c-35.3 0-64-28.7-64-64L16 64zM224 448a32 32 0 1 0 -64 0 32 32 0 1 0 64 0zM304 64L80 64l0 320 224 0 0-320z'/%3e%3c/svg%3e";let uL=function(e){const t=new Set;let r=e;return{subscribe:e=>(t.add(e),()=>{t.delete(e)}),setState:e=>{r=e,t.forEach(e=>e(r))},getState:()=>r}}({});const hL=(e,i,o)=>async i=>{let{service:s,body:a,opts:c,abortSignal:l,user:u,config:h}=i;!function(e){if(!e)return;(new Image).src=e}(s.provider?.icon);const{wcRequestHook:d,pairingModalOverride:f,disableNotifications:p}=h,g=s.params?.disableNotifications??p,m=await async function(e){let{provider:t,externalProviderOrTopic:r}=e;if(!r){const e=await t;return e?{provider:e,isExternal:!1}:null}if("string"!=typeof r){const e=r.session?.topic;if(!e)throw new Error("Cannot resolve provider: UniversalProvider is not initialized");return uL.setState({[e]:r}),{provider:r,isExternal:!0}}const n=r;if(n){let e=uL.getState()[n];if(!e){let t,r;e=await new Promise((e,i)=>{t=uL.subscribe(()=>{const t=uL.getState()[n];t&&e(t)}),r=setTimeout(()=>{i(new Error(`Provider for external topic ${n} not found after 5 seconds`))},5e3)}).finally(()=>{clearTimeout(r),t()})}return{provider:e,isExternal:!0}}const i=await t;return i?{provider:i,isExternal:!1}:null}({provider:e,externalProviderOrTopic:s.params?.externalProvider});n(!!m,"WalletConnect is not initialized");const{provider:y,isExternal:w}=m;let b=y.session??null;const v=s.endpoint,E=function(e){let{uid:n}=e;n&&/^(ftp|http|https):\/\/[^ "]+$/.test(n)||r({title:"WalletConnect Service Warning",message:`service.uid should be a valid universal link url. Found: ${n}`,level:t.warn});return n}(s);if(b?.topic&&b?.topic===s.params?.externalProvider&&v===ZB.FLOW_AUTHN)return u;null==b&&(b=await new Promise((e,i)=>{(function(e){return async i=>{let{service:o,onClose:s,appLink:a,provider:c,method:l,pairing:u,wcRequestHook:h,pairingModalOverride:d,abortSignal:f,network:p}=i;const g=c.providerOpts.projectId;n(!!g,"Cannot establish connection, WalletConnect projectId is undefined");let m=null,y=null;try{const{uri:t,approval:r}=await rL({provider:c,existingPairing:u,network:p});if(h&&h instanceof Function&&h({type:YB.SESSION_REQUEST,method:l,service:o,session:null,pairing:u??null,uri:t??null}),eL()){const e=new URLSearchParams({uri:t}).toString();tL(null==u?a+"?"+e:a)}else if(!u)if(d)d(t,s);else{y=new(await e)({projectId:g}),y.openModal({uri:t,onClose:s});const r=y.subscribeModal(e=>{!1===e.open&&(s?.(),r())})}const n=await Promise.race([r(),new Promise((e,t)=>{f?.aborted&&t(new Error("Session request aborted")),f?.addEventListener("abort",()=>{t(new Error("Session request aborted"))})})]);if(null==n)throw new Error("Session request failed");return n}catch(e){throw e instanceof Error&&r({title:`${e.name} Error establishing WalletConnect session`,message:`\n          ${e.message}\n          uri: ${m}\n        `,level:t.error}),s(),e}finally{y?.closeModal()}}})(o)({service:s,onClose:function(){i("Declined: Externally Halted")},appLink:E,provider:y,method:v,pairing:undefined,wcRequestHook:d,pairingModalOverride:f,abortSignal:l,network:h.client.network}).then(e,i)})),d&&d instanceof Function&&d({type:YB.SIGNING_REQUEST,method:v,service:s,session:b??null,pairing:null,uri:null}),function(e){let{service:t,user:r}=e;return!(!eL()||t.endpoint===ZB.FLOW_AUTHN||t.endpoint===ZB.FLOW_AUTHZ&&r?.services?.find(e=>e.method===XB&&"pre-authz"===e.type))}({service:s,user:u})&&tL(E);const x=g||"true"===b?.sessionProperties?.["fclWc.disableNotificationsOnMobile"]?null:function(e){let{service:t,user:r}=e;const n=r?.services?.find(e=>"authn"===e.type),i=n?.provider||t.provider;return cL({title:i?.name||"Mobile Wallet",message:eL()?"Tap to view request in app":"Pending request on your mobile device",icon:i?.icon||lL,onClick:eL()&&t.uid?()=>tL(t.uid):void 0,debounceDelay:"pre-authz"===t.type?500:0})}({user:u,service:s});return await nL({method:v,body:a,session:b,provider:y,abortSignal:l,isExternal:w,disableNotifications:s.params?.disableNotifications}).finally(()=>x?.dismiss())};let dL=Promise.resolve(null);const fL=e=>{if("undefined"==typeof window)throw new Error("FCL Wallet Connect Plugin can only be initialized in the browser");dL=dL.catch(()=>null).then(i=>i||(async e=>{let{projectId:i,metadata:o}=e;n(null!=i,"FCL Wallet Connect Error: WalletConnect projectId is required");try{return GB.init({logger:"debug",relayUrl:"wss://relay.walletconnect.com",projectId:i,metadata:o})}catch(e){throw e instanceof Error&&r({title:`${e.name} fcl-wc Init Client`,message:e.message,level:t.error}),e}})({projectId:e.projectId,metadata:e.metadata})).catch(e=>{throw r({title:"WalletConnect Client Initialization Error",message:e.message?e.message:e,level:t.error}),e});const i=function(e){return{name:JB,f_type:"ServicePlugin",type:"discovery-service",serviceStrategy:{method:XB,exec:hL(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},Promise.resolve().then(function(){return JD}).then(e=>e.WalletConnectModal))},services:[]}}(dL,e);return{FclWcServicePlugin:i,providerPromise:dL}};async function pL(){return dL.then(e=>{if(!e)throw new Error("WalletConnect client not initialized");return e})}let gL=function(e){return e[e.INVALID_REQUEST=-32600]="INVALID_REQUEST",e[e.METHOD_NOT_FOUND=-32601]="METHOD_NOT_FOUND",e[e.INVALID_PARAMS=-32602]="INVALID_PARAMS",e[e.INTERNAL_ERROR=-32603]="INTERNAL_ERROR",e[e.PARSE_ERROR=-32700]="PARSE_ERROR",e}({});class mL extends Error{constructor(e,t,r){super(t),this.code=e,this.message=t,this.data=r}}var yL=function(e){return e.HELLO="rpc_hello",e}(yL||{});class wL{id=0;setSend=()=>{};_send=(()=>new Promise(e=>{this.setSend=e}))();peerInfo=(()=>new Promise((e,t)=>{this.resolvePeerInfo=e,this.rejectPeerInfo=t}))();enabledNotifications=[];requestHandlers={};subscriptions={};messageListeners=[];constructor(e){let{notifications:t}=e;this.enabledNotifications=t||[],this.on(yL.HELLO,e=>(this.resolvePeerInfo(e),this.ownInfo()))}connect(e){let{send:t}=e;this.setSend(t),this.requestWithoutConnection(yL.HELLO,this.ownInfo()).then(e=>{this.resolvePeerInfo(e)}).catch(this.rejectPeerInfo)}ownInfo(){return{requests:Object.keys(this.requestHandlers),notifications:this.enabledNotifications}}async send(e){return(await this._send)(e)}receive(e){"2.0"===e?.jsonrpc&&("method"in e&&("id"in e?this.handleRequest(e):this.handleNotification(e)),this.messageListeners.forEach(t=>t(e)))}async handleRequest(e){const t=this.requestHandlers[e.method];if(t)try{const r=await t(e.params);this.send({jsonrpc:"2.0",id:e.id,result:r})}catch(t){t instanceof mL?this.send({jsonrpc:"2.0",id:e.id,error:{code:t.code,message:t.message,data:t.data}}):this.send({jsonrpc:"2.0",id:e.id,error:{code:gL.INTERNAL_ERROR,message:t?.message}})}else this.send({jsonrpc:"2.0",id:e.id,error:{code:gL.METHOD_NOT_FOUND,message:`Method not found: ${e.method}`}})}handleNotification(e){this.subscriptions[e.method]&&this.subscriptions[e.method].forEach(t=>t(e.params))}onMessage(e){return this.messageListeners.push(e),()=>{this.messageListeners=this.messageListeners.filter(t=>t!==e)}}async notify(e,t){await this.onceConnected(),this.send({jsonrpc:"2.0",method:e,params:t})}async request(e,t){return await this.onceConnected(),this.requestWithoutConnection(e,t)}async requestWithoutConnection(e,t){const r=this.id++;let n=()=>{};const i=new Promise((e,t)=>{n=this.onMessage(n=>{if(n.id===r&&("result"in n||"error"in n)){if(n.error){const e=new mL(n.error.code,n.error.message,n.error.data);t(e)}e(n.result)}})}).finally(n);return this.send({jsonrpc:"2.0",method:e,params:t,id:r}),i}on(e,t){this.requestHandlers[e]=t}subscribe(e,t){this.subscriptions[e]=this.subscriptions[e]||new Set,this.subscriptions[e].add(t)}unsubscribe(e,t){this.subscriptions[e]?.delete(t)}async onceConnected(){return this.peerInfo.then(()=>{})}async getAvailableRequests(){return this.peerInfo.then(e=>e.requests)}async getAvailableNotifications(){return this.peerInfo.then(e=>e.notifications)}}const bL=globalThis.AbortController||require("abort-controller");let vL=function(e){return e.NOTIFY_QRCODE_CONNECTING="notifyQrCodeConnecting",e.NOTIFY_QRCODE_CONNECTED="notifyQrCodeConnected",e.NOTIFY_QRCODE_ERROR="notifyQrCodeError",e}({}),EL=function(e){return e.REQUEST_WALLETCONNECT_QRCODE="requestWalletConnectQrCode",e.EXEC_SERVICE="execService",e}({});const xL="APPROVED",IL=e=>{let{rpc:t,network:r,onExecResult:n,authnBody:i,abortSignal:o}=e;const s=function(e){let{rpc:t,authnBody:r}=e;return e=>{let{uri:n,approval:i,onExecResult:o}=e;setTimeout(async()=>{try{const e=await pL(),s=await i();t.notify(vL.NOTIFY_QRCODE_CONNECTING,{uri:n});const a=await nL({method:ZB.FLOW_AUTHN,body:r,session:s,provider:e});t.notify(vL.NOTIFY_QRCODE_CONNECTED,{uri:n}),o(a)}catch(e){t.notify(vL.NOTIFY_QRCODE_ERROR,{uri:n,error:e?.message})}},0)}}({rpc:t,authnBody:i});return async e=>{if(o.aborted)throw new Error("Handler has been terminated");const t=await pL(),{uri:i,approval:a}=await rL({provider:t,network:r});return s({uri:i,approval:a,onExecResult:n}),{uri:i}}};function _L(e){let{onExecResult:t,body:r,opts:n,args:i,abortSignal:o}=e;const s=new wL({notifications:[]});return s.on(EL.REQUEST_WALLETCONNECT_QRCODE,IL({network:n.config.client.network,rpc:s,onExecResult:t,authnBody:r,abortSignal:o})),s.on(EL.EXEC_SERVICE,(e=>{let{onExecResult:t,execStrategyOpts:r,execStrategyArgs:n,abortSignal:i}=e;return async e=>{let{service:o}=e;try{const e=await va({...r,service:o,config:r.config,abortSignal:i},...n.slice(1));if((Fa(e)?.status||xL)===xL)return t(e),null;throw new Error(e?.reason||"Service was declined")}catch(e){throw new Error(e?.message||"Service execution failed")}}})({onExecResult:t,execStrategyOpts:n,execStrategyArgs:i,abortSignal:o})),{connect:s.connect.bind(s),receive:s.receive.bind(s)}}const SL="authn";const AL="undefined"==typeof window,OL=e=>{const t=e.appDetailTitle,r=e.appDetailIcon,n=e.appDetailDescription,i=e.appDetailUrl;return{name:t??document.title,description:n??"",url:i??window.location.origin,icons:r?[r]:[]}};let CL=null,PL=!1;const RL={execStrategy:async function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[n]=t,{body:i,abortSignal:o,service:s}=n;if(s?.type!==SL)return console.error(`ERROR: Invalid service type for FCL Discovery execStrategyHook, expected "${SL}" but got "${s?.type}"`),va(...t);const a=function(e){const t=new bL;return e?.aborted&&t.abort(),e?.addEventListener("abort",()=>t.abort()),t}(o);let c;const l=new Promise(async(e,r)=>{const o=_L({onExecResult:e,body:i,opts:n,args:t,abortSignal:a.signal});c=async function(e){let{customRpc:t,opts:r,args:n,abortSignal:i}=e;const o={...r.config,client:{...r.config.client,discoveryRpcEnabled:!0}};return va({...r,config:o,customRpc:t,abortSignal:i},...n.slice(1))}({customRpc:o,opts:n,args:t,abortSignal:a.signal}).then(e,r)});return await l.catch(()=>{}),await Promise.race([new Promise(e=>setTimeout(e,1e3)),c]).catch(()=>{}),a.abort(),l}},TL="FCL_IFRAME";function kL(e){n(!document.getElementById(TL),"Attempt at triggering multiple Frames",{src:e});const t=document.createElement("iframe");t.src=e,t.id=TL,t.allow="usb *; hid *; clipboard-write",t.frameBorder="0",t.style.cssText="\n  position:fixed;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n  height: 100%;\n  width: 100vw;\n  display:block;\n  background:rgba(0,0,0,0.25);\n  z-index: 2147483647;\n  box-sizing: border-box;\n  color-scheme: light;\n",document.body.append(t);return[t.contentWindow,()=>{document.getElementById(TL)&&document.getElementById(TL).remove()}]}let NL=null,UL=null;function BL(e){null==NL||NL?.closed?NL=function(e,t,r,n,i){const o=r.top.outerHeight/2+r.top.screenY-i/2,s=r.top.outerWidth/2+r.top.screenX-n/2,a=r.open(e,t,`toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=${n}, height=${i}, top=${o}, left=${s}`);if(!a)throw new Error("Popup failed to open (was it blocked by a popup blocker?)");return a}(e,"FCL_POP",window,640,770):UL!==e?(NL.location.replace(e),NL.focus()):NL.focus(),UL=e;return[NL,()=>{NL&&!NL.closed&&NL.close(),NL=null}]}let LL=null,DL=null;function $L(e){if(null==LL||LL?.closed){if(LL=window.open(e,"_blank"),!LL)throw new Error("Tab failed to open (was it blocked by the browser?)")}else DL!==e?(LL.location.replace(e),LL.focus()):LL.focus();DL=e;return[LL,()=>{LL&&!LL.closed&&LL.close(),LL=null}]}const ML=()=>{};const jL="1.20.0";const FL=()=>{};const HL=()=>{};const zL=()=>{};const qL=()=>{throw new Error("Strategy util has not been implemented on this platform")},WL={"VIEW/IFRAME":kL,"VIEW/POP":BL,"VIEW/TAB":$L,"VIEW/MOBILE_BROWSER":qL,"VIEW/DEEPLINK":qL};async function VL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{serviceEndpoint:()=>{}};const{serviceEndpoint:r}=t;try{return WL[e.method](r(e),t)}catch(r){throw console.error("execLocal({service, opts = {}})",r,{service:e,opts:t}),r}}const KL={[ls["HTTP/RPC"]]:Wa(VL),[ls["HTTP/POST"]]:Wa(VL),[ls["IFRAME/RPC"]]:function(e){let{service:t,body:r,config:n,customRpc:i,abortSignal:o,opts:s}=e;return new Promise((e,a)=>{const c=tc(),l=s.includeOlderJsonRpcCall,{close:u}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)return{send:ML,close:ML};const r=t.onClose||ML,n=t.onMessage||ML,i=t.onReady||ML,o=t.onResponse||ML,s=t.onCustomRpc||ML;let a,c;const l=Xa({close:u,send:h,onReady:i,onResponse:o,onMessage:n,onCustomRpc:s,getSource:()=>a});return window.addEventListener("message",l),[a,c]=kL(Ma(e)),{send:h,close:u};function u(){try{window.removeEventListener("message",l),c(),r()}catch(e){console.error("Frame Close Error",e)}}function h(e){try{a.postMessage(JSON.parse(JSON.stringify(e||{})),"*")}catch(t){console.error("Frame Send Error",e,t)}}}(t,{async onReady(e,o){let{send:s}=o;try{s({type:"FCL:VIEW:READY:RESPONSE",fclVersion:jL,body:r,service:{params:t.params,data:t.data,type:t.type},config:n}),s({fclVersion:jL,type:"FCL:FRAME:READY:RESPONSE",body:r,service:{params:t.params,data:t.data,type:t.type},config:n,deprecated:{message:"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE"}}),l&&s({jsonrpc:"2.0",id:c,method:"fcl:sign",params:[r,t.params],deprecated:{message:"jsonrpc is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE"}}),i?.connect({send:e=>{s({type:"FCL:VIEW:CUSTOM_RPC",payload:e})}})}catch(e){throw e}},onResponse(t,r){let{close:n}=r;try{if("object"!=typeof t.data)return;const r=Fa(t.data);switch(r.status){case"APPROVED":e(r.data),n();break;case"DECLINED":a(`Declined: ${r.reason||"No reason supplied"}`),n();break;case"REDIRECT":e(r),n();break;default:a("Declined: No reason supplied"),n()}}catch(e){throw console.error("execIframeRPC onResponse error",e),e}},onMessage(t,r){let{close:n}=r;try{if("object"!=typeof t.data)return;if("2.0"!==t.data.jsonrpc)return;if(t.data.id!==c)return;const r=Fa(t.data.result);switch(r.status){case"APPROVED":e(r.data),n();break;case"DECLINED":a(`Declined: ${r.reason||"No reason supplied"}`),n();break;case"REDIRECT":e(r),n();break;default:a("Declined: No reason supplied"),n()}}catch(e){throw console.error("execIframeRPC onMessage error",e),e}},onClose(){a("Declined: Externally Halted")},onCustomRpc(e){i?.receive(e)}});o&&(o.aborted&&(a("Declined: Aborted"),u()),o.addEventListener("abort",()=>{a("Declined: Aborted"),u()}))})},[ls["POP/RPC"]]:function(e){let{service:t,body:r,config:n,abortSignal:i,customRpc:o,opts:s}=e;return new Promise((e,a)=>{const c=tc(),{redir:l,includeOlderJsonRpcCall:u}=s,{close:h}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)return{send:FL,close:FL};const r=t.onClose||FL,n=t.onMessage||FL,i=t.onReady||FL,o=t.onResponse||FL,s=t.onCustomRpc||FL;let a,c;const l=Xa({close:h,send:d,onReady:i,onResponse:o,onMessage:n,onCustomRpc:s,getSource:()=>a});window.addEventListener("message",l),[a,c]=BL(Ma(e));const u=setInterval(function(){a&&a.closed&&h()},500);return{send:d,close:h};function h(){try{window.removeEventListener("message",l),clearInterval(u),c(),r()}catch(e){console.error("Popup Close Error",e)}}function d(e){try{a.postMessage(JSON.parse(JSON.stringify(e||{})),"*")}catch(t){console.error("Popup Send Error",e,t)}}}(t,{customRpc:o,async onReady(e,i){let{send:s}=i;try{s({fclVersion:jL,type:"FCL:VIEW:READY:RESPONSE",body:r,service:{params:t.params,data:t.data,type:t.type},config:n}),s({fclVersion:jL,type:"FCL:FRAME:READY:RESPONSE",body:r,service:{params:t.params,data:t.data,type:t.type},config:n,deprecated:{message:"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE"}}),u&&s({jsonrpc:"2.0",id:c,method:"fcl:sign",params:[r,t.params]}),o?.connect({send:e=>{s({type:"FCL:VIEW:CUSTOM_RPC",payload:e})}})}catch(e){throw e}},onResponse(t,r){let{close:n}=r;try{if("object"!=typeof t.data)return;const r=Fa(t.data);switch(r.status){case"APPROVED":e(r.data),!l&&n();break;case"DECLINED":a(`Declined: ${r.reason||"No reason supplied"}`),n();break;case"REDIRECT":e(r),n();break;default:a("Declined: No reason supplied"),n()}}catch(e){throw console.error("execPopRPC onResponse error",e),e}},onMessage(t,r){let{close:n}=r;try{if("object"!=typeof t.data)return;if("2.0"!==t.data.jsonrpc)return;if(t.data.id!==c)return;const r=Fa(t.data.result);switch(r.status){case"APPROVED":e(r.data),!l&&n();break;case"DECLINED":a(`Declined: ${r.reason||"No reason supplied"}`),n();break;case"REDIRECT":e(r),n();break;default:a("Declined: No reason supplied"),n()}}catch(e){throw console.error("execPopRPC onMessage error",e),e}},onClose(){a("Declined: Externally Halted")},onCustomRpc(e){o?.receive(e)}});i&&(i.aborted&&(a("Declined: Aborted"),h()),i.addEventListener("abort",()=>{a("Declined: Aborted"),h()}))})},[ls["TAB/RPC"]]:function(e){let{service:t,body:r,config:n,abortSignal:i,customRpc:o,opts:s}=e;return new Promise((e,a)=>{const c=tc(),{redir:l,includeOlderJsonRpcCall:u}=s,{close:h}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)return{send:HL,close:HL};const r=t.onClose||HL,n=t.onMessage||HL,i=t.onReady||HL,o=t.onResponse||HL,s=t.onCustomRpc||HL;let a,c;const l=Xa({close:h,send:d,onReady:i,onResponse:o,onMessage:n,onCustomRpc:s,getSource:()=>a});window.addEventListener("message",l),[a,c]=$L(Ma(e));const u=setInterval(function(){a&&a.closed&&h()},500);return{send:d,close:h};function h(){try{window.removeEventListener("message",l),clearInterval(u),c(),r()}catch(e){console.error("Tab Close Error",e)}}function d(e){try{a.postMessage(JSON.parse(JSON.stringify(e||{})),"*")}catch(t){console.error("Tab Send Error",e,t)}}}(t,{customRpc:o,async onReady(e,i){let{send:s}=i;try{s({fclVersion:jL,type:"FCL:VIEW:READY:RESPONSE",body:r,service:{params:t.params,data:t.data,type:t.type},config:n}),s({fclVersion:jL,type:"FCL:FRAME:READY:RESPONSE",body:r,service:{params:t.params,data:t.data,type:t.type},config:n,deprecated:{message:"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE"}}),u&&s({jsonrpc:"2.0",id:c,method:"fcl:sign",params:[r,t.params]}),o?.connect({send:e=>{s({type:"FCL:VIEW:CUSTOM_RPC",payload:e})}})}catch(e){throw e}},onResponse(t,r){let{close:n}=r;try{if("object"!=typeof t.data)return;const r=Fa(t.data);switch(r.status){case"APPROVED":e(r.data),!l&&n();break;case"DECLINED":a(`Declined: ${r.reason||"No reason supplied"}`),n();break;case"REDIRECT":e(r),n();break;default:a("Declined: No reason supplied"),n()}}catch(e){throw console.error("execPopRPC onResponse error",e),e}},onMessage(t,r){let{close:n}=r;try{if("object"!=typeof t.data)return;if("2.0"!==t.data.jsonrpc)return;if(t.data.id!==c)return;const r=Fa(t.data.result);switch(r.status){case"APPROVED":e(r.data),!l&&n();break;case"DECLINED":a(`Declined: ${r.reason||"No reason supplied"}`),n();break;case"REDIRECT":e(r),n();break;default:a("Declined: No reason supplied"),n()}}catch(e){throw console.error("execPopRPC onMessage error",e),e}},onClose(){a("Declined: Externally Halted")},onCustomRpc(e){o?.receive(e)}});i&&(i.aborted&&(h(),a("Declined: Aborted")),i.addEventListener("abort",()=>{h(),a("Declined: Aborted")}))})},[ls["EXT/RPC"]]:function(e){let{service:t,body:r,config:n,abortSignal:i,customRpc:o,opts:s}=e;return new Promise((e,s)=>{const{close:a}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)return{send:zL,close:zL};const r=t.onClose||zL,n=t.onMessage||zL,i=t.onReady||zL,o=t.onResponse||zL,s=t.onCustomRpc||zL,a=Xa({close:c,send:l,onReady:i,onResponse:o,onMessage:n,onCustomRpc:s});return window.addEventListener("message",a),l({service:e}),{send:l,close:c};function c(){try{window.removeEventListener("message",a),r()}catch(e){console.error("Ext Close Error",e)}}function l(e){try{window&&window.postMessage(JSON.parse(JSON.stringify(e||{})),"*")}catch(t){console.error("Ext Send Error",e,t)}}}(t,{async onReady(e,i){let{send:s}=i;try{s({fclVersion:jL,type:"FCL:VIEW:READY:RESPONSE",body:r,service:{params:t.params,data:t.data,type:t.type},config:n}),o?.connect({send:e=>{s({type:"FCL:VIEW:CUSTOM_RPC",body:e})}})}catch(e){throw e}},onResponse(t,r){let{close:n}=r;try{if("object"!=typeof t.data)return;const r=Fa(t.data);switch(r.status){case"APPROVED":e(r.data),n();break;case"DECLINED":s(`Declined: ${r.reason||"No reason supplied"}`),n();break;case"REDIRECT":e(r),n();break;default:s("Declined: No reason supplied"),n()}}catch(e){throw console.error("execExtRPC onResponse error",e),e}},onClose(){s("Declined: Externally Halted")},onCustomRpc(e){o?.receive(e)}});i&&(i.aborted&&(a(),s("Declined: Aborted")),i.addEventListener("abort",()=>{a(),s("Declined: Aborted")}))})}},GL={can:!("undefined"==typeof window||!window.localStorage),get:async e=>(e=>{if(null==e)return null;try{return JSON.parse(e)}catch(e){return null}})(localStorage.getItem(e)),put:async(e,t)=>localStorage.setItem(e,JSON.stringify(t))},ZL=(YL={platform:"web",discovery:RL,getStorageProvider:async()=>await le.get("fcl.storage")||GL},(e=>{const t={authenticate:Ta(e),unauthenticate:ka(e),authorization:Na(e),signUserMessage:$a(e),subscribe:Ua(e),snapshot:Ba(e),resolveArgument:La(e)};return Object.assign(()=>({...t}),{...t})})({...ts(),getStorageProvider:async()=>YL.getStorageProvider?await YL.getStorageProvider():await le.first(["fcl.storage","fcl.storage.default"],void 0),platform:YL.platform,actorName:xa,discovery:YL.discovery}));var YL;const JL=(e=>{const t={...ts(),currentUser:e};return ca(t)})(ZL),XL=ZL().authorization;le({"discovery.wallet.method.default":"IFRAME/RPC"}),Ks({coreStrategies:KL}),le.subscribe(async e=>{!function(e){if(AL)return;const t=e.walletConnectProjectId,r=e.walletConnectDisableNotifications,i=CL;if(CL=JSON.stringify(e,null,2),PL)return void(i!==CL&&console.warn(`FCL WalletConnect Plugin has been already loaded with different configuration. It is not possible to change the configuration after the plugin has been loaded.\n\nPrevious configuration:\n${i}\n\nCurrent configuration:\n${CL}`));if(!t)return;if(n(!!t,"FCL Configuration value for 'walletconnect.projectId' is required"),Zs.getPlugins().has(JB))return PL||console.warn("It seems like the FCL WalletConnect plugins has been already loaded manually. This is no longer necessary, please see the documentation for more information."),void(PL=!0);PL=!0;const{FclWcServicePlugin:o}=(e=>{const{FclWcServicePlugin:t,providerPromise:r}=fL(e);return aa.authn.update(),{FclWcServicePlugin:t,providerPromise:r}})({projectId:t,metadata:OL(e),disableNotifications:r??void 0});Zs.add([o])}({walletConnectProjectId:e["walletconnect.projectId"],walletConnectDisableNotifications:e["walletconnect.disableNotifications"],appDetailTitle:e["app.detail.title"],appDetailIcon:e["app.detail.icon"],appDetailDescription:e["app.detail.description"],appDetailUrl:e["app.detail.url"]})}),le().put("app.detail.title","Hero Game").put("flow.network","testnet").put("accessNode.api","https://rest-testnet.onflow.org").put("discovery.wallet","https://fcl-discovery.onflow.org/testnet/authn");let QL=null;function eD(e,t=""){try{QL?QL.SendMessage("Web3AuthManager",e,String(t??"")):console.log("[FlowBridge->Unity]",e,t)}catch(e){console.warn("SendMessage failed:",e)}}async function tD(){await function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ZL().authenticate(e)}();return await ZL().snapshot()}"undefined"!=typeof window&&(window.FlowBridge={setUnityInstance:function(e){QL=e},connectFlow:async function(){try{const e=await tD();eD("OnFlowWalletConnected",e?.addr??"")}catch(e){eD("OnFlowError",e?.message??String(e))}},disconnectFlow:async function(){try{await ZL().unauthenticate(),eD("OnWalletDisconnected","")}catch(e){eD("OnFlowError",e?.message??String(e))}},createHeroCollection:async function(){try{const e=await JL({cadence:"\n    import HeroNFT from 0x0095f13a82f1a835\n\n    transaction {\n      prepare(signer: auth(BorrowValue, IssueStorageCapabilityController, PublishCapability, SaveValue, UnpublishCapability) &Account) {\n        if signer.storage.borrow<&HeroNFT.Collection>(from: HeroNFT.CollectionStoragePath) != nil {\n          return\n        }\n        let collection <- HeroNFT.createEmptyCollection(nftType: Type<@HeroNFT.NFT>())\n        signer.storage.save(<-collection, to: HeroNFT.CollectionStoragePath)\n        let collectionCap = signer.capabilities.storage.issue<&HeroNFT.Collection>(HeroNFT.CollectionStoragePath)\n        signer.capabilities.publish(collectionCap, at: HeroNFT.CollectionPublicPath)\n      }\n    }\n  ",args:(e,t)=>[],proposer:XL,payer:XL,authorizations:[XL],limit:9999});console.log(e),eD("OnFlowTxSubmitted",e),await Ms(e).onceSealed(),eD("OnFlowTxSealed",e)}catch(e){eD("OnFlowError",e?.message??String(e))}},getFlowUser:async function(){try{const e=await ZL().snapshot();eD("OnFlowUser",JSON.stringify(e||{}))}catch(e){eD("OnFlowError",e?.message??String(e))}},initializeAuctionScheduler:async function(){try{const e=await JL({cadence:"\n    import AuctionCallbackHandler from 0x0095f13a82f1a835\n    import FlowTransactionScheduler from 0x8c5303eaa26202d6\n\n    transaction() {\n        prepare(signer: auth(Storage, Capabilities) &Account) {\n          \n            if signer.storage.borrow<&AnyResource>(from: /storage/AuctionCallbackHandler) == nil {\n                let handler <- AuctionCallbackHandler.createHandler()\n                signer.storage.save(<-handler, to: /storage/AuctionCallbackHandler)\n            }\n            let _ = signer.capabilities.storage\n                .issue<auth(FlowTransactionScheduler.Execute) &{FlowTransactionScheduler.TransactionHandler}>(/storage/AuctionCallbackHandler)\n        }\n    }\n  ",args:(e,t)=>[],proposer:XL,payer:XL,authorizations:[XL],limit:9999});console.log("Tx submitted:",e),eD("OnFlowTxSubmitted",e),await Ms(e).onceSealed(),eD("OnFlowTxSealed",e)}catch(e){console.error("Transaction failed:",e),eD("OnFlowError",e?.message??String(e))}},bidOnItem:async function(e,t){try{const r=await JL({cadence:'\n    import FungibleToken from 0x9a0766d93b6608b7\n    import FlowToken from 0x7e60df042a9c0868\n    import NonFungibleToken from 0x631e88ae7f1d7c20\n    import ItemManager from 0x0095f13a82f1a835   // replace if different\n    import AuctionHouse from 0x0095f13a82f1a835   // replace with marketplace address\n    transaction(listingID: UInt64, paymentAmount: UFix64) {\n        let vaultRef: auth(FungibleToken.Withdraw) &{FungibleToken.Vault}\n        let collectionRef: &ItemManager.Collection\n        prepare(buyer: auth(Storage, BorrowValue) &Account) {\n            self.vaultRef = buyer.storage.borrow<auth(FungibleToken.Withdraw) &{FungibleToken.Vault}>(from: /storage/flowTokenVault)\n            ?? panic("Missing FlowToken vault in buyer account. Please create & link one.")\n            // 3) Withdraw the paymentAmount (should be >= listing price; contract will refund any extra)\n            let payment <- self.vaultRef.withdraw(amount: paymentAmount)\n            self.collectionRef = buyer.storage.borrow<&ItemManager.Collection>(\n                from: ItemManager.CollectionStoragePath // Assuming this exists; if not, replace with the actual StoragePath, e.g., /storage/ItemManagerCollection\n            ) ?? panic("Missing ItemManager collection in buyer account. Please create & link one.")\n            // 4) Call marketplace purchase. Buyer address passed so contract can route refunds, deposits, etc.\n            AuctionHouse.placeBid(\n                listingID: listingID,\n                bidder: buyer.address,\n                payment: <-payment\n            )\n        }\n        execute {\n        log("Purchase transaction executed — check marketplace events for details.")\n        }\n    }\n  ',args:(r,n)=>[r(e.toString(),n.UInt64),r(t.toFixed(2),n.UFix64)],proposer:XL,payer:XL,authorizations:[XL],limit:9999});console.log("Tx submitted:",r),eD("OnFlowTxSubmitted",r),await Ms(r).onceSealed(),eD("OnFlowTxSealed",r)}catch(e){console.error("Transaction failed:",e),eD("OnFlowError",e?.message??String(e))}},buyItem:async function(e,t){try{const r=await JL({cadence:'\n    import FungibleToken from 0x9a0766d93b6608b7\n    import FlowToken from 0x7e60df042a9c0868\n    import NonFungibleToken from 0x631e88ae7f1d7c20 \n    import ItemManager from 0x0095f13a82f1a835   // replace if different\n    import MarketPlace2 from 0x0095f13a82f1a835   // replace with marketplace address\n    transaction(listingID: UInt64, paymentAmount: UFix64) {\n        let vaultRef: auth(FungibleToken.Withdraw) &{FungibleToken.Vault}\n        let collectionRef: &ItemManager.Collection\n        prepare(buyer: auth(Storage, BorrowValue) &Account) {\n            self.vaultRef = buyer.storage.borrow<auth(FungibleToken.Withdraw) &{FungibleToken.Vault}>(from: /storage/flowTokenVault)\n            ?? panic("Missing FlowToken vault in buyer account. Please create & link one.")\n            // 3) Withdraw the paymentAmount (should be >= listing price; contract will refund any extra)\n            let payment <- self.vaultRef.withdraw(amount: paymentAmount)\n            self.collectionRef = buyer.storage.borrow<&ItemManager.Collection>(\n                from: ItemManager.CollectionStoragePath // Assuming this exists; if not, replace with the actual StoragePath, e.g., /storage/ItemManagerCollection\n            ) ?? panic("Missing ItemManager collection in buyer account. Please create & link one.")\n            // 4) Call marketplace purchase. Buyer address passed so contract can route refunds, deposits, etc.\n            MarketPlace2.purchase(\n                listingID: listingID,\n                buyer: buyer.address,\n                buyerCollection: self.collectionRef,\n                payment: <-payment\n            )\n        }\n        execute {\n        log("Purchase transaction executed — check marketplace events for details.")\n        }\n    }\n  ',args:(r,n)=>[r(e.toString(),n.UInt64),r(t.toFixed(2),n.UFix64)],proposer:XL,payer:XL,authorizations:[XL],limit:9999});console.log("Tx submitted:",r),eD("OnFlowTxSubmitted",r),await Ms(r).onceSealed(),eD("OnFlowTxSealed",r)}catch(e){console.error("Transaction failed:",e),eD("OnFlowError",e?.message??String(e))}},setupArcaneTokenAccount:async function(){try{const e=await JL({cadence:"\n    import FungibleToken from 0x9a0766d93b6608b7\n    import Arcane from 0x0095f13a82f1a835\n\n    transaction () {\n\n        prepare(signer: auth(BorrowValue, IssueStorageCapabilityController, PublishCapability, SaveValue) &Account) {\n\n            // Return early if the account already stores a Arcane Vault\n            if signer.storage.borrow<&Arcane.Vault>(from: Arcane.VaultStoragePath) != nil {\n                return\n            }\n\n            let vault <- Arcane.createEmptyVault(vaultType: Type<@Arcane.Vault>())\n\n            // Create a new Arcane Vault and put it in storage\n            signer.storage.save(<-vault, to: Arcane.VaultStoragePath)\n\n            // Create a public capability to the Vault that exposes the Vault interfaces\n            let vaultCap = signer.capabilities.storage.issue<&Arcane.Vault>(\n                Arcane.VaultStoragePath\n            )\n            signer.capabilities.publish(vaultCap, at: Arcane.VaultPublicPath)\n        }\n    }\n  ",args:(e,t)=>[],proposer:XL,payer:XL,authorizations:[XL],limit:9999});console.log("Tx submitted:",e),eD("OnFlowTxSubmitted",e),await Ms(e).onceSealed(),eD("OnFlowTxSealed",e)}catch(e){console.error("Transaction failed:",e),eD("OnFlowError",e?.message??String(e))}},createNFTCollection:async function(){try{const e=await JL({cadence:"\n    import ItemManager from 0x0095f13a82f1a835\n    import NonFungibleToken from 0x631e88ae7f1d7c20\n\n    transaction {\n\n        prepare(signer: auth(BorrowValue, IssueStorageCapabilityController, PublishCapability, SaveValue, UnpublishCapability) &Account) {\n\n            // Return early if the account already has a collection\n            if signer.storage.borrow<&ItemManager.Collection>(from: ItemManager.CollectionStoragePath) != nil {\n                return\n            }\n\n            // Create a new empty collection\n            let collection <- ItemManager.createEmptyCollection(nftType: Type<@ItemManager.NFT>())\n\n            // save it to the account\n            signer.storage.save(<-collection, to: ItemManager.CollectionStoragePath)\n\n            let collectionCap = signer.capabilities.storage.issue<&ItemManager.Collection>(ItemManager.CollectionStoragePath)\n            signer.capabilities.publish(collectionCap, at: ItemManager.CollectionPublicPath)\n        }\n    }\n  ",args:(e,t)=>[],proposer:XL,payer:XL,authorizations:[XL],limit:9999});console.log("Tx submitted:",e),eD("OnFlowTxSubmitted",e),await Ms(e).onceSealed(),eD("OnFlowTxSealed",e)}catch(e){console.error("Transaction failed:",e),eD("OnFlowError",e?.message??String(e))}},listOnAuction:async function(e,t,r,n,i){try{const o=await JL({cadence:'\n    import FlowTransactionScheduler from 0x8c5303eaa26202d6\n    import FlowToken from 0x7e60df042a9c0868\n    import FungibleToken from 0x9a0766d93b6608b7\n    import AuctionHouse from 0x0095f13a82f1a835\n    import AuctionCallbackHandler from 0x0095f13a82f1a835\n    import NonFungibleToken from 0x631e88ae7f1d7c20\n    import ItemManager from 0x0095f13a82f1a835\n\n    /// Schedule an increment of the Counter with a relative delay in seconds\n    transaction(\n        delaySeconds: UFix64,\n        priority: UInt8,\n        executionEffort: UInt64,\n        tokenID: UInt64,\n        price: UFix64\n    ) {\n        let withdrawRef: auth(NonFungibleToken.Withdraw) &{NonFungibleToken.Collection}\n        prepare(signer: auth(Storage, Capabilities) &Account) {\n            self.withdrawRef = signer.storage.borrow<auth(NonFungibleToken.Withdraw) &{NonFungibleToken.Collection}>(from: ItemManager.CollectionStoragePath)\n                ?? panic("Missing ItemManager collection")\n\n            // Withdraw NFT from seller\'s collection (this requires signer\'s withdraw auth)\n            let nft <- self.withdrawRef.withdraw(withdrawID: tokenID)\n\n            // Pass the NFT resource and signer.address into contract\n            let future = getCurrentBlock().timestamp + delaySeconds\n            let listId: UInt64 = AuctionHouse.listItem(nft: <- nft, basePrice: price, seller: signer.address, endTime: future)\n            let transactionData = AuctionCallbackHandler.loradata(listingId: listId)\n\n            let pr = priority == 0\n                ? FlowTransactionScheduler.Priority.High\n                : priority == 1\n                    ? FlowTransactionScheduler.Priority.Medium\n                    : FlowTransactionScheduler.Priority.Low\n\n            let est = FlowTransactionScheduler.estimate(\n                data: transactionData,\n                timestamp: future,\n                priority: pr,\n                executionEffort: executionEffort\n            )\n\n            assert(\n                est.timestamp != nil || pr == FlowTransactionScheduler.Priority.Low,\n                message: est.error ?? "estimation failed"\n            )\n\n            let vaultRef = signer.storage\n                .borrow<auth(FungibleToken.Withdraw) &FlowToken.Vault>(from: /storage/flowTokenVault)\n                ?? panic("missing FlowToken vault")\n            let fees <- vaultRef.withdraw(amount: est.flowFee ?? 0.0) as! @FlowToken.Vault\n\n            let handlerCap = signer.capabilities.storage\n                .issue<auth(FlowTransactionScheduler.Execute) &{FlowTransactionScheduler.TransactionHandler}>(/storage/AuctionCallbackHandler)\n\n            let receipt <- FlowTransactionScheduler.schedule(\n                handlerCap: handlerCap,\n                data: transactionData,\n                timestamp: future,\n                priority: pr,\n                executionEffort: executionEffort,\n                fees: <-fees\n            )\n\n            log("Scheduled transaction id: ".concat(receipt.id.toString()).concat(" at ").concat(receipt.timestamp.toString()))\n            \n            destroy receipt\n        }\n    }\n  ',args:(o,s)=>[o(e.toFixed(2),s.UFix64),o(t.toString(),s.UInt8),o(r.toString(),s.UInt64),o(n.toString(),s.UInt64),o(i.toFixed(2),s.UFix64)],proposer:XL,payer:XL,authorizations:[XL],limit:9999});console.log("Tx submitted:",o),eD("OnFlowTxSubmitted",o),await Ms(o).onceSealed(),eD("OnFlowTxSealed",o)}catch(e){console.error("Transaction failed:",e),eD("OnFlowError",e?.message??String(e))}},listItemOnMarketplace:async function(e,t){try{const r=await JL({cadence:'\n    import ItemManager from 0x0095f13a82f1a835\n    import MarketPlace2 from 0x0095f13a82f1a835\n    import NonFungibleToken from 0x631e88ae7f1d7c20\n\n    transaction(tokenID: UInt64, price: UFix64) {\n        let withdrawRef: auth(NonFungibleToken.Withdraw) &{NonFungibleToken.Collection}\n        prepare(signer: auth(Storage , BorrowValue) &Account) {\n            self.withdrawRef = signer.storage.borrow<auth(NonFungibleToken.Withdraw) &{NonFungibleToken.Collection}>(from: ItemManager.CollectionStoragePath)\n                ?? panic("Missing ItemManager collection")\n\n            // Withdraw NFT from seller\'s collection\n            let nft <- self.withdrawRef.withdraw(withdrawID: tokenID)\n\n            // Pass the NFT resource and seller address to the marketplace\n            MarketPlace2.listItem(nft: <- nft, price: price, seller: signer.address)\n        }\n    }\n  ',args:(r,n)=>[r(e.toString(),n.UInt64),r(t.toFixed(2),n.UFix64)],proposer:XL,payer:XL,authorizations:[XL],limit:9999});console.log("Tx submitted:",r),eD("OnFlowTxSubmitted",r);const n=await Ms(r).onceSealed();eD("OnFlowTxSealed",JSON.stringify(n))}catch(e){console.error("Transaction failed:",e),eD("OnFlowError",e?.message??String(e))}},initializePlayerAccount:async function(){try{const e=await JL({cadence:"\n    import FungibleToken from 0x9a0766d93b6608b7\n    import Arcane from 0x0095f13a82f1a835\n    import HeroNFT from 0x0095f13a82f1a835\n    import AuctionCallbackHandler from 0x0095f13a82f1a835\n    import FlowTransactionScheduler from 0x8c5303eaa26202d6\n    import ItemManager from 0x0095f13a82f1a835\n\n    transaction() {\n\n        prepare(\n            signer: auth(\n                BorrowValue,\n                IssueStorageCapabilityController,\n                PublishCapability,\n                SaveValue,\n                UnpublishCapability,\n                Storage,\n                Capabilities\n            ) &Account\n        ) {\n\n            //\n            // 1. Initialize Arcane Vault\n            //\n            if signer.storage.borrow<&Arcane.Vault>(from: Arcane.VaultStoragePath) == nil {\n                let vault <- Arcane.createEmptyVault(vaultType: Type<@Arcane.Vault>())\n                signer.storage.save(<-vault, to: Arcane.VaultStoragePath)\n\n                let vaultCap = signer.capabilities.storage.issue<&Arcane.Vault>(\n                    Arcane.VaultStoragePath\n                )\n                signer.capabilities.publish(vaultCap, at: Arcane.VaultPublicPath)\n            }\n\n            //\n            // 2. Initialize HeroNFT Collection\n            //\n            if signer.storage.borrow<&HeroNFT.Collection>(from: HeroNFT.CollectionStoragePath) == nil {\n                let collection <- HeroNFT.createEmptyCollection(nftType: Type<@HeroNFT.NFT>())\n                signer.storage.save(<-collection, to: HeroNFT.CollectionStoragePath)\n\n                let collectionCap = signer.capabilities.storage.issue<&HeroNFT.Collection>(\n                    HeroNFT.CollectionStoragePath\n                )\n                signer.capabilities.publish(collectionCap, at: HeroNFT.CollectionPublicPath)\n            }\n\n            //\n            // 3. Initialize AuctionCallbackHandler\n            //\n            if signer.storage.borrow<&AnyResource>(from: /storage/AuctionCallbackHandler) == nil {\n                let handler <- AuctionCallbackHandler.createHandler()\n                signer.storage.save(<-handler, to: /storage/AuctionCallbackHandler)\n            }\n\n            let _ = signer.capabilities.storage.issue<\n                auth(FlowTransactionScheduler.Execute) &{FlowTransactionScheduler.TransactionHandler}\n            >(/storage/AuctionCallbackHandler)\n\n            //\n            // 4. Initialize ItemManager Collection\n            //\n            if signer.storage.borrow<&ItemManager.Collection>(from: ItemManager.CollectionStoragePath) == nil {\n                let collection <- ItemManager.createEmptyCollection(nftType: Type<@ItemManager.NFT>())\n                signer.storage.save(<-collection, to: ItemManager.CollectionStoragePath)\n\n                let collectionCap = signer.capabilities.storage.issue<&ItemManager.Collection>(ItemManager.CollectionStoragePath)\n                signer.capabilities.publish(collectionCap, at: ItemManager.CollectionPublicPath)\n            }\n        }\n    }\n  ",args:(e,t)=>[],proposer:XL,payer:XL,authorizations:[XL],limit:9999});console.log("Tx submitted:",e),eD("OnFlowTxSubmitted",e),await Ms(e).onceSealed(),eD("OnFlowTxSealed",e)}catch(e){console.error("Transaction failed:",e),eD("OnFlowError",e?.message??String(e))}}});const rD=Symbol(),nD=Object.getPrototypeOf,iD=new WeakMap,oD=e=>(e=>e&&(iD.has(e)?iD.get(e):nD(e)===Object.prototype||nD(e)===Array.prototype))(e)&&e[rD]||null,sD=(e,t=!0)=>{iD.set(e,t)},aD=e=>"object"==typeof e&&null!==e,cD=new WeakMap,lD=new WeakSet,[uD]=((e=Object.is,t=(e,t)=>new Proxy(e,t),r=e=>aD(e)&&!lD.has(e)&&(Array.isArray(e)||!(Symbol.iterator in e))&&!(e instanceof WeakMap)&&!(e instanceof WeakSet)&&!(e instanceof Error)&&!(e instanceof Number)&&!(e instanceof Date)&&!(e instanceof String)&&!(e instanceof RegExp)&&!(e instanceof ArrayBuffer),n=e=>{switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:throw e}},i=new WeakMap,o=(e,t,r=n)=>{const s=i.get(e);if((null==s?void 0:s[0])===t)return s[1];const a=Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e));return sD(a,!0),i.set(e,[t,a]),Reflect.ownKeys(e).forEach(t=>{if(Object.getOwnPropertyDescriptor(a,t))return;const n=Reflect.get(e,t),i={value:n,enumerable:!0,configurable:!0};if(lD.has(n))sD(n,!1);else if(n instanceof Promise)delete i.value,i.get=()=>r(n);else if(cD.has(n)){const[e,t]=cD.get(n);i.value=o(e,t(),r)}Object.defineProperty(a,t,i)}),Object.preventExtensions(a)},s=new WeakMap,a=[1,1],c=n=>{if(!aD(n))throw new Error("object required");const i=s.get(n);if(i)return i;let l=a[0];const u=new Set,h=(e,t=++a[0])=>{l!==t&&(l=t,u.forEach(r=>r(e,t)))};let d=a[1];const f=e=>(t,r)=>{const n=[...t];n[1]=[e,...n[1]],h(n,r)},p=new Map,g=e=>{var t;const r=p.get(e);r&&(p.delete(e),null==(t=r[1])||t.call(r))},m=Array.isArray(n)?[]:Object.create(Object.getPrototypeOf(n)),y={deleteProperty(e,t){const r=Reflect.get(e,t);g(t);const n=Reflect.deleteProperty(e,t);return n&&h(["delete",[t],r]),n},set(t,n,i,o){const a=Reflect.has(t,n),l=Reflect.get(t,n,o);if(a&&(e(l,i)||s.has(i)&&e(l,s.get(i))))return!0;g(n),aD(i)&&(i=oD(i)||i);let d=i;if(i instanceof Promise)i.then(e=>{i.status="fulfilled",i.value=e,h(["resolve",[n],e])}).catch(e=>{i.status="rejected",i.reason=e,h(["reject",[n],e])});else{!cD.has(i)&&r(i)&&(d=c(i));const e=!lD.has(d)&&cD.get(d);e&&((e,t)=>{if(p.has(e))throw new Error("prop listener already exists");if(u.size){const r=t[3](f(e));p.set(e,[t,r])}else p.set(e,[t])})(n,e)}return Reflect.set(t,n,d,o),h(["set",[n],i,l]),!0}},w=t(m,y);s.set(n,w);const b=[m,(e=++a[1])=>(d===e||u.size||(d=e,p.forEach(([t])=>{const r=t[1](e);r>l&&(l=r)})),l),o,e=>{u.add(e),1===u.size&&p.forEach(([e,t],r)=>{if(t)throw new Error("remove already exists");const n=e[3](f(r));p.set(r,[e,n])});return()=>{u.delete(e),0===u.size&&p.forEach(([e,t],r)=>{t&&(t(),p.set(r,[e]))})}}];return cD.set(w,b),Reflect.ownKeys(n).forEach(e=>{const t=Object.getOwnPropertyDescriptor(n,e);"value"in t&&(w[e]=n[e],delete t.value,delete t.writable),Object.defineProperty(m,e,t)}),w})=>[c,cD,lD,e,t,r,n,i,o,s,a])();function hD(e={}){return uD(e)}function dD(e,t,r){const n=cD.get(e);let i;n||console.warn("Please use proxy object");const o=[],s=n[3];let a=!1;const c=s(e=>{o.push(e),i||(i=Promise.resolve().then(()=>{i=void 0,a&&t(o.splice(0))}))});return a=!0,()=>{a=!1,c()}}const fD=hD({history:["ConnectWallet"],view:"ConnectWallet",data:void 0}),pD={state:fD,subscribe:e=>dD(fD,()=>e(fD)),push(e,t){e!==fD.view&&(fD.view=e,t&&(fD.data=t),fD.history.push(e))},reset(e){fD.view=e,fD.history=[e]},replace(e){fD.history.length>1&&(fD.history[fD.history.length-1]=e,fD.view=e)},goBack(){if(fD.history.length>1){fD.history.pop();const[e]=fD.history.slice(-1);fD.view=e}},setData(e){fD.data=e}},gD={WALLETCONNECT_DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",WCM_VERSION:"WCM_VERSION",RECOMMENDED_WALLET_AMOUNT:9,isMobile:()=>"undefined"!=typeof window&&Boolean(window.matchMedia("(pointer:coarse)").matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)),isAndroid:()=>gD.isMobile()&&navigator.userAgent.toLowerCase().includes("android"),isIos(){const e=navigator.userAgent.toLowerCase();return gD.isMobile()&&(e.includes("iphone")||e.includes("ipad"))},isHttpUrl:e=>e.startsWith("http://")||e.startsWith("https://"),isArray:e=>Array.isArray(e)&&e.length>0,isTelegram:()=>"undefined"!=typeof window&&(Boolean(window.TelegramWebviewProxy)||Boolean(window.Telegram)||Boolean(window.TelegramWebviewProxyProto)),formatNativeUrl(e,t,r){if(gD.isHttpUrl(e))return this.formatUniversalUrl(e,t,r);let n=e;n.includes("://")||(n=e.replaceAll("/","").replaceAll(":",""),n=`${n}://`),n.endsWith("/")||(n=`${n}/`),this.setWalletConnectDeepLink(n,r);return`${n}wc?uri=${encodeURIComponent(t)}`},formatUniversalUrl(e,t,r){if(!gD.isHttpUrl(e))return this.formatNativeUrl(e,t,r);let n=e;if(n.startsWith("https://t.me")){const e=Buffer.from(t).toString("base64").replace(/[=]/g,"");n.endsWith("/")&&(n=n.slice(0,-1)),this.setWalletConnectDeepLink(n,r);const i=new URL(n);i.searchParams.set("startapp",e);return i.toString()}n.endsWith("/")||(n=`${n}/`),this.setWalletConnectDeepLink(n,r);return`${n}wc?uri=${encodeURIComponent(t)}`},wait:async e=>new Promise(t=>{setTimeout(t,e)}),openHref(e,t){const r=this.isTelegram()?"_blank":t;window.open(e,r,"noreferrer noopener")},setWalletConnectDeepLink(e,t){try{localStorage.setItem(gD.WALLETCONNECT_DEEPLINK_CHOICE,JSON.stringify({href:e,name:t}))}catch(e){console.info("Unable to set WalletConnect deep link")}},setWalletConnectAndroidDeepLink(e){try{const[t]=e.split("?");localStorage.setItem(gD.WALLETCONNECT_DEEPLINK_CHOICE,JSON.stringify({href:t,name:"Android"}))}catch(e){console.info("Unable to set WalletConnect android deep link")}},removeWalletConnectDeepLink(){try{localStorage.removeItem(gD.WALLETCONNECT_DEEPLINK_CHOICE)}catch(e){console.info("Unable to remove WalletConnect deep link")}},setModalVersionInStorage(){try{"undefined"!=typeof localStorage&&localStorage.setItem(gD.WCM_VERSION,"2.7.0")}catch(e){console.info("Unable to set Web3Modal version in storage")}},getWalletRouterData(){var e;const t=null==(e=pD.state.data)?void 0:e.Wallet;if(!t)throw new Error('Missing "Wallet" view data');return t}},mD=hD({enabled:"undefined"!=typeof location&&(location.hostname.includes("localhost")||location.protocol.includes("https")),userSessionId:"",events:[],connectedWalletId:void 0}),yD={state:mD,subscribe:e=>dD(mD.events,()=>e(function(e,t){const r=cD.get(e);r||console.warn("Please use proxy object");const[n,i,o]=r;return o(n,i(),t)}(mD.events[mD.events.length-1]))),initialize(){mD.enabled&&void 0!==(null==crypto?void 0:crypto.randomUUID)&&(mD.userSessionId=crypto.randomUUID())},setConnectedWalletId(e){mD.connectedWalletId=e},click(e){if(mD.enabled){const t={type:"CLICK",name:e.name,userSessionId:mD.userSessionId,timestamp:Date.now(),data:e};mD.events.push(t)}},track(e){if(mD.enabled){const t={type:"TRACK",name:e.name,userSessionId:mD.userSessionId,timestamp:Date.now(),data:e};mD.events.push(t)}},view(e){if(mD.enabled){const t={type:"VIEW",name:e.name,userSessionId:mD.userSessionId,timestamp:Date.now(),data:e};mD.events.push(t)}}},wD=hD({chains:void 0,walletConnectUri:void 0,isAuth:!1,isCustomDesktop:!1,isCustomMobile:!1,isDataLoaded:!1,isUiLoaded:!1}),bD={state:wD,subscribe:e=>dD(wD,()=>e(wD)),setChains(e){wD.chains=e},setWalletConnectUri(e){wD.walletConnectUri=e},setIsCustomDesktop(e){wD.isCustomDesktop=e},setIsCustomMobile(e){wD.isCustomMobile=e},setIsDataLoaded(e){wD.isDataLoaded=e},setIsUiLoaded(e){wD.isUiLoaded=e},setIsAuth(e){wD.isAuth=e}},vD=hD({projectId:"",mobileWallets:void 0,desktopWallets:void 0,walletImages:void 0,chains:void 0,enableAuthMode:!1,enableExplorer:!0,explorerExcludedWalletIds:void 0,explorerRecommendedWalletIds:void 0,termsOfServiceUrl:void 0,privacyPolicyUrl:void 0}),ED={state:vD,subscribe:e=>dD(vD,()=>e(vD)),setConfig(e){var t,r;yD.initialize(),bD.setChains(e.chains),bD.setIsAuth(Boolean(e.enableAuthMode)),bD.setIsCustomMobile(Boolean(null==(t=e.mobileWallets)?void 0:t.length)),bD.setIsCustomDesktop(Boolean(null==(r=e.desktopWallets)?void 0:r.length)),gD.setModalVersionInStorage(),Object.assign(vD,e)}};var xD=Object.defineProperty,ID=Object.getOwnPropertySymbols,_D=Object.prototype.hasOwnProperty,SD=Object.prototype.propertyIsEnumerable,AD=(e,t,r)=>t in e?xD(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const OD="https://explorer-api.walletconnect.com",CD="wcm",PD="js-2.7.0";async function RD(e,t){const r=((e,t)=>{for(var r in t||(t={}))_D.call(t,r)&&AD(e,r,t[r]);if(ID)for(var r of ID(t))SD.call(t,r)&&AD(e,r,t[r]);return e})({sdkType:CD,sdkVersion:PD},t),n=new URL(e,OD);n.searchParams.append("projectId",ED.state.projectId),Object.entries(r).forEach(([e,t])=>{t&&n.searchParams.append(e,String(t))});return(await fetch(n)).json()}const TD={getDesktopListings:async e=>RD("/w3m/v1/getDesktopListings",e),getMobileListings:async e=>RD("/w3m/v1/getMobileListings",e),getInjectedListings:async e=>RD("/w3m/v1/getInjectedListings",e),getAllListings:async e=>RD("/w3m/v1/getAllListings",e),getWalletImageUrl:e=>`${OD}/w3m/v1/getWalletImage/${e}?projectId=${ED.state.projectId}&sdkType=${CD}&sdkVersion=${PD}`,getAssetImageUrl:e=>`${OD}/w3m/v1/getAssetImage/${e}?projectId=${ED.state.projectId}&sdkType=${CD}&sdkVersion=${PD}`};var kD=Object.defineProperty,ND=Object.getOwnPropertySymbols,UD=Object.prototype.hasOwnProperty,BD=Object.prototype.propertyIsEnumerable,LD=(e,t,r)=>t in e?kD(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const DD=gD.isMobile(),$D=hD({wallets:{listings:[],total:0,page:1},search:{listings:[],total:0,page:1},recomendedWallets:[]}),MD={state:$D,async getRecomendedWallets(){const{explorerRecommendedWalletIds:e,explorerExcludedWalletIds:t}=ED.state;if("NONE"===e||"ALL"===t&&!e)return $D.recomendedWallets;if(gD.isArray(e)){const t={recommendedIds:e.join(",")},{listings:r}=await TD.getAllListings(t),n=Object.values(r);n.sort((t,r)=>e.indexOf(t.id)-e.indexOf(r.id)),$D.recomendedWallets=n}else{const{chains:e,isAuth:r}=bD.state,n=null==e?void 0:e.join(","),i=gD.isArray(t),o={page:1,sdks:r?"auth_v1":void 0,entries:gD.RECOMMENDED_WALLET_AMOUNT,chains:n,version:2,excludedIds:i?t.join(","):void 0},{listings:s}=DD?await TD.getMobileListings(o):await TD.getDesktopListings(o);$D.recomendedWallets=Object.values(s)}return $D.recomendedWallets},async getWallets(e){const t=((e,t)=>{for(var r in t||(t={}))UD.call(t,r)&&LD(e,r,t[r]);if(ND)for(var r of ND(t))BD.call(t,r)&&LD(e,r,t[r]);return e})({},e),{explorerRecommendedWalletIds:r,explorerExcludedWalletIds:n}=ED.state,{recomendedWallets:i}=$D;if("ALL"===n)return $D.wallets;i.length?t.excludedIds=i.map(e=>e.id).join(","):gD.isArray(r)&&(t.excludedIds=r.join(",")),gD.isArray(n)&&(t.excludedIds=[t.excludedIds,n].filter(Boolean).join(",")),bD.state.isAuth&&(t.sdks="auth_v1");const{page:o,search:s}=e,{listings:a,total:c}=DD?await TD.getMobileListings(t):await TD.getDesktopListings(t),l=Object.values(a),u=s?"search":"wallets";return $D[u]={listings:[...$D[u].listings,...l],total:c,page:null!=o?o:1},{listings:l,total:c}},getWalletImageUrl:e=>TD.getWalletImageUrl(e),getAssetImageUrl:e=>TD.getAssetImageUrl(e),resetSearch(){$D.search={listings:[],total:0,page:1}}},jD=hD({open:!1}),FD={state:jD,subscribe:e=>dD(jD,()=>e(jD)),open:async e=>new Promise(t=>{const{isUiLoaded:r,isDataLoaded:n}=bD.state;if(gD.removeWalletConnectDeepLink(),bD.setWalletConnectUri(null==e?void 0:e.uri),bD.setChains(null==e?void 0:e.chains),pD.reset("ConnectWallet"),r&&n)jD.open=!0,t();else{const e=setInterval(()=>{const r=bD.state;r.isUiLoaded&&r.isDataLoaded&&(clearInterval(e),jD.open=!0,t())},200)}}),close(){jD.open=!1}};var HD=Object.defineProperty,zD=Object.getOwnPropertySymbols,qD=Object.prototype.hasOwnProperty,WD=Object.prototype.propertyIsEnumerable,VD=(e,t,r)=>t in e?HD(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const KD=hD({themeMode:"undefined"!=typeof matchMedia&&matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}),GD={state:KD,subscribe:e=>dD(KD,()=>e(KD)),setThemeConfig(e){const{themeMode:t,themeVariables:r}=e;t&&(KD.themeMode=t),r&&(KD.themeVariables=((e,t)=>{for(var r in t||(t={}))qD.call(t,r)&&VD(e,r,t[r]);if(zD)for(var r of zD(t))WD.call(t,r)&&VD(e,r,t[r]);return e})({},r))}},ZD=hD({open:!1,message:"",variant:"success"}),YD={state:ZD,subscribe:e=>dD(ZD,()=>e(ZD)),openToast(e,t){ZD.open=!0,ZD.message=e,ZD.variant=t},closeToast(){ZD.open=!1}};var JD=Object.freeze({__proto__:null,WalletConnectModal:class{constructor(e){this.openModal=FD.open,this.closeModal=FD.close,this.subscribeModal=FD.subscribe,this.setTheme=GD.setThemeConfig,GD.setThemeConfig(e),ED.setConfig(e),this.initUi()}async initUi(){if("undefined"!=typeof window){await Promise.resolve().then(function(){return Dq});const e=document.createElement("wcm-modal");document.body.insertAdjacentElement("beforeend",e),bD.setIsUiLoaded(!0)}}}});
/**
   * @license
   * Copyright 2019 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */const XD=window,QD=XD.ShadowRoot&&(void 0===XD.ShadyCSS||XD.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,e$=Symbol(),t$=new WeakMap;let r$=class{constructor(e,t,r){if(this._$cssResult$=!0,r!==e$)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(QD&&void 0===e){const r=void 0!==t&&1===t.length;r&&(e=t$.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&t$.set(t,e))}return e}toString(){return this.cssText}};const n$=(e,...t)=>{const r=1===e.length?e[0]:t.reduce((t,r,n)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(r)+e[n+1],e[0]);return new r$(r,e,e$)},i$=QD?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const r of e.cssRules)t+=r.cssText;return(e=>new r$("string"==typeof e?e:e+"",void 0,e$))(t)})(e):e;
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */var o$;const s$=window,a$=s$.trustedTypes,c$=a$?a$.emptyScript:"",l$=s$.reactiveElementPolyfillSupport,u$={toAttribute(e,t){switch(t){case Boolean:e=e?c$:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let r=e;switch(t){case Boolean:r=null!==e;break;case Number:r=null===e?null:Number(e);break;case Object:case Array:try{r=JSON.parse(e)}catch(e){r=null}}return r}},h$=(e,t)=>t!==e&&(t==t||e==e),d$={attribute:!0,type:String,converter:u$,reflect:!1,hasChanged:h$},f$="finalized";let p$=class extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this._$Eu()}static addInitializer(e){var t;this.finalize(),(null!==(t=this.h)&&void 0!==t?t:this.h=[]).push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach((t,r)=>{const n=this._$Ep(r,t);void 0!==n&&(this._$Ev.set(n,r),e.push(n))}),e}static createProperty(e,t=d$){if(t.state&&(t.attribute=!1),this.finalize(),this.elementProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){const r="symbol"==typeof e?Symbol():"__"+e,n=this.getPropertyDescriptor(e,r,t);void 0!==n&&Object.defineProperty(this.prototype,e,n)}}static getPropertyDescriptor(e,t,r){return{get(){return this[t]},set(n){const i=this[e];this[t]=n,this.requestUpdate(e,i,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||d$}static finalize(){if(this.hasOwnProperty(f$))return!1;this[f$]=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),void 0!==e.h&&(this.h=[...e.h]),this.elementProperties=new Map(e.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const e=this.properties,t=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const r of t)this.createProperty(r,e[r])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const e of r)t.unshift(i$(e))}else void 0!==e&&t.push(i$(e));return t}static _$Ep(e,t){const r=t.attribute;return!1===r?void 0:"string"==typeof r?r:"string"==typeof e?e.toLowerCase():void 0}_$Eu(){var e;this._$E_=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(e=this.constructor.h)||void 0===e||e.forEach(e=>e(this))}addController(e){var t,r;(null!==(t=this._$ES)&&void 0!==t?t:this._$ES=[]).push(e),void 0!==this.renderRoot&&this.isConnected&&(null===(r=e.hostConnected)||void 0===r||r.call(e))}removeController(e){var t;null===(t=this._$ES)||void 0===t||t.splice(this._$ES.indexOf(e)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach((e,t)=>{this.hasOwnProperty(t)&&(this._$Ei.set(t,this[t]),delete this[t])})}createRenderRoot(){var e;const t=null!==(e=this.shadowRoot)&&void 0!==e?e:this.attachShadow(this.constructor.shadowRootOptions);return((e,t)=>{QD?e.adoptedStyleSheets=t.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet):t.forEach(t=>{const r=document.createElement("style"),n=XD.litNonce;void 0!==n&&r.setAttribute("nonce",n),r.textContent=t.cssText,e.appendChild(r)})})(t,this.constructor.elementStyles),t}connectedCallback(){var e;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(e=this._$ES)||void 0===e||e.forEach(e=>{var t;return null===(t=e.hostConnected)||void 0===t?void 0:t.call(e)})}enableUpdating(e){}disconnectedCallback(){var e;null===(e=this._$ES)||void 0===e||e.forEach(e=>{var t;return null===(t=e.hostDisconnected)||void 0===t?void 0:t.call(e)})}attributeChangedCallback(e,t,r){this._$AK(e,r)}_$EO(e,t,r=d$){var n;const i=this.constructor._$Ep(e,r);if(void 0!==i&&!0===r.reflect){const o=(void 0!==(null===(n=r.converter)||void 0===n?void 0:n.toAttribute)?r.converter:u$).toAttribute(t,r.type);this._$El=e,null==o?this.removeAttribute(i):this.setAttribute(i,o),this._$El=null}}_$AK(e,t){var r;const n=this.constructor,i=n._$Ev.get(e);if(void 0!==i&&this._$El!==i){const e=n.getPropertyOptions(i),o="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==(null===(r=e.converter)||void 0===r?void 0:r.fromAttribute)?e.converter:u$;this._$El=i,this[i]=o.fromAttribute(t,e.type),this._$El=null}}requestUpdate(e,t,r){let n=!0;void 0!==e&&(((r=r||this.constructor.getPropertyOptions(e)).hasChanged||h$)(this[e],t)?(this._$AL.has(e)||this._$AL.set(e,t),!0===r.reflect&&this._$El!==e&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(e,r))):n=!1),!this.isUpdatePending&&n&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach((e,t)=>this[t]=e),this._$Ei=void 0);let t=!1;const r=this._$AL;try{t=this.shouldUpdate(r),t?(this.willUpdate(r),null===(e=this._$ES)||void 0===e||e.forEach(e=>{var t;return null===(t=e.hostUpdate)||void 0===t?void 0:t.call(e)}),this.update(r)):this._$Ek()}catch(e){throw t=!1,this._$Ek(),e}t&&this._$AE(r)}willUpdate(e){}_$AE(e){var t;null===(t=this._$ES)||void 0===t||t.forEach(e=>{var t;return null===(t=e.hostUpdated)||void 0===t?void 0:t.call(e)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(e){return!0}update(e){void 0!==this._$EC&&(this._$EC.forEach((e,t)=>this._$EO(t,this[t],e)),this._$EC=void 0),this._$Ek()}updated(e){}firstUpdated(e){}};
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */
var g$;p$[f$]=!0,p$.elementProperties=new Map,p$.elementStyles=[],p$.shadowRootOptions={mode:"open"},null==l$||l$({ReactiveElement:p$}),(null!==(o$=s$.reactiveElementVersions)&&void 0!==o$?o$:s$.reactiveElementVersions=[]).push("1.6.3");const m$=window,y$=m$.trustedTypes,w$=y$?y$.createPolicy("lit-html",{createHTML:e=>e}):void 0,b$="$lit$",v$=`lit$${(Math.random()+"").slice(9)}$`,E$="?"+v$,x$=`<${E$}>`,I$=document,_$=()=>I$.createComment(""),S$=e=>null===e||"object"!=typeof e&&"function"!=typeof e,A$=Array.isArray,O$="[ \t\n\f\r]",C$=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,P$=/-->/g,R$=/>/g,T$=RegExp(`>|${O$}(?:([^\\s"'>=/]+)(${O$}*=${O$}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),k$=/'/g,N$=/"/g,U$=/^(?:script|style|textarea|title)$/i,B$=e=>(t,...r)=>({_$litType$:e,strings:t,values:r}),L$=B$(1),D$=B$(2),$$=Symbol.for("lit-noChange"),M$=Symbol.for("lit-nothing"),j$=new WeakMap,F$=I$.createTreeWalker(I$,129,null,!1);function H$(e,t){if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==w$?w$.createHTML(t):t}const z$=(e,t)=>{const r=e.length-1,n=[];let i,o=2===t?"<svg>":"",s=C$;for(let t=0;t<r;t++){const r=e[t];let a,c,l=-1,u=0;for(;u<r.length&&(s.lastIndex=u,c=s.exec(r),null!==c);)u=s.lastIndex,s===C$?"!--"===c[1]?s=P$:void 0!==c[1]?s=R$:void 0!==c[2]?(U$.test(c[2])&&(i=RegExp("</"+c[2],"g")),s=T$):void 0!==c[3]&&(s=T$):s===T$?">"===c[0]?(s=null!=i?i:C$,l=-1):void 0===c[1]?l=-2:(l=s.lastIndex-c[2].length,a=c[1],s=void 0===c[3]?T$:'"'===c[3]?N$:k$):s===N$||s===k$?s=T$:s===P$||s===R$?s=C$:(s=T$,i=void 0);const h=s===T$&&e[t+1].startsWith("/>")?" ":"";o+=s===C$?r+x$:l>=0?(n.push(a),r.slice(0,l)+b$+r.slice(l)+v$+h):r+v$+(-2===l?(n.push(void 0),t):h)}return[H$(e,o+(e[r]||"<?>")+(2===t?"</svg>":"")),n]};class q${constructor({strings:e,_$litType$:t},r){let n;this.parts=[];let i=0,o=0;const s=e.length-1,a=this.parts,[c,l]=z$(e,t);if(this.el=q$.createElement(c,r),F$.currentNode=this.el.content,2===t){const e=this.el.content,t=e.firstChild;t.remove(),e.append(...t.childNodes)}for(;null!==(n=F$.nextNode())&&a.length<s;){if(1===n.nodeType){if(n.hasAttributes()){const e=[];for(const t of n.getAttributeNames())if(t.endsWith(b$)||t.startsWith(v$)){const r=l[o++];if(e.push(t),void 0!==r){const e=n.getAttribute(r.toLowerCase()+b$).split(v$),t=/([.?@])?(.*)/.exec(r);a.push({type:1,index:i,name:t[2],strings:e,ctor:"."===t[1]?Z$:"?"===t[1]?J$:"@"===t[1]?X$:G$})}else a.push({type:6,index:i})}for(const t of e)n.removeAttribute(t)}if(U$.test(n.tagName)){const e=n.textContent.split(v$),t=e.length-1;if(t>0){n.textContent=y$?y$.emptyScript:"";for(let r=0;r<t;r++)n.append(e[r],_$()),F$.nextNode(),a.push({type:2,index:++i});n.append(e[t],_$())}}}else if(8===n.nodeType)if(n.data===E$)a.push({type:2,index:i});else{let e=-1;for(;-1!==(e=n.data.indexOf(v$,e+1));)a.push({type:7,index:i}),e+=v$.length-1}i++}}static createElement(e,t){const r=I$.createElement("template");return r.innerHTML=e,r}}function W$(e,t,r=e,n){var i,o,s,a;if(t===$$)return t;let c=void 0!==n?null===(i=r._$Co)||void 0===i?void 0:i[n]:r._$Cl;const l=S$(t)?void 0:t._$litDirective$;return(null==c?void 0:c.constructor)!==l&&(null===(o=null==c?void 0:c._$AO)||void 0===o||o.call(c,!1),void 0===l?c=void 0:(c=new l(e),c._$AT(e,r,n)),void 0!==n?(null!==(s=(a=r)._$Co)&&void 0!==s?s:a._$Co=[])[n]=c:r._$Cl=c),void 0!==c&&(t=W$(e,c._$AS(e,t.values),c,n)),t}class V${constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){var t;const{el:{content:r},parts:n}=this._$AD,i=(null!==(t=null==e?void 0:e.creationScope)&&void 0!==t?t:I$).importNode(r,!0);F$.currentNode=i;let o=F$.nextNode(),s=0,a=0,c=n[0];for(;void 0!==c;){if(s===c.index){let t;2===c.type?t=new K$(o,o.nextSibling,this,e):1===c.type?t=new c.ctor(o,c.name,c.strings,this,e):6===c.type&&(t=new Q$(o,this,e)),this._$AV.push(t),c=n[++a]}s!==(null==c?void 0:c.index)&&(o=F$.nextNode(),s++)}return F$.currentNode=I$,i}v(e){let t=0;for(const r of this._$AV)void 0!==r&&(void 0!==r.strings?(r._$AI(e,r,t),t+=r.strings.length-2):r._$AI(e[t])),t++}}class K${constructor(e,t,r,n){var i;this.type=2,this._$AH=M$,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=r,this.options=n,this._$Cp=null===(i=null==n?void 0:n.isConnected)||void 0===i||i}get _$AU(){var e,t;return null!==(t=null===(e=this._$AM)||void 0===e?void 0:e._$AU)&&void 0!==t?t:this._$Cp}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===(null==e?void 0:e.nodeType)&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=W$(this,e,t),S$(e)?e===M$||null==e||""===e?(this._$AH!==M$&&this._$AR(),this._$AH=M$):e!==this._$AH&&e!==$$&&this._(e):void 0!==e._$litType$?this.g(e):void 0!==e.nodeType?this.$(e):(e=>A$(e)||"function"==typeof(null==e?void 0:e[Symbol.iterator]))(e)?this.T(e):this._(e)}k(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}$(e){this._$AH!==e&&(this._$AR(),this._$AH=this.k(e))}_(e){this._$AH!==M$&&S$(this._$AH)?this._$AA.nextSibling.data=e:this.$(I$.createTextNode(e)),this._$AH=e}g(e){var t;const{values:r,_$litType$:n}=e,i="number"==typeof n?this._$AC(e):(void 0===n.el&&(n.el=q$.createElement(H$(n.h,n.h[0]),this.options)),n);if((null===(t=this._$AH)||void 0===t?void 0:t._$AD)===i)this._$AH.v(r);else{const e=new V$(i,this),t=e.u(this.options);e.v(r),this.$(t),this._$AH=e}}_$AC(e){let t=j$.get(e.strings);return void 0===t&&j$.set(e.strings,t=new q$(e)),t}T(e){A$(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let r,n=0;for(const i of e)n===t.length?t.push(r=new K$(this.k(_$()),this.k(_$()),this,this.options)):r=t[n],r._$AI(i),n++;n<t.length&&(this._$AR(r&&r._$AB.nextSibling,n),t.length=n)}_$AR(e=this._$AA.nextSibling,t){var r;for(null===(r=this._$AP)||void 0===r||r.call(this,!1,!0,t);e&&e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){var t;void 0===this._$AM&&(this._$Cp=e,null===(t=this._$AP)||void 0===t||t.call(this,e))}}class G${constructor(e,t,r,n,i){this.type=1,this._$AH=M$,this._$AN=void 0,this.element=e,this.name=t,this._$AM=n,this.options=i,r.length>2||""!==r[0]||""!==r[1]?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=M$}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,t=this,r,n){const i=this.strings;let o=!1;if(void 0===i)e=W$(this,e,t,0),o=!S$(e)||e!==this._$AH&&e!==$$,o&&(this._$AH=e);else{const n=e;let s,a;for(e=i[0],s=0;s<i.length-1;s++)a=W$(this,n[r+s],t,s),a===$$&&(a=this._$AH[s]),o||(o=!S$(a)||a!==this._$AH[s]),a===M$?e=M$:e!==M$&&(e+=(null!=a?a:"")+i[s+1]),this._$AH[s]=a}o&&!n&&this.j(e)}j(e){e===M$?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=e?e:"")}}class Z$ extends G${constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===M$?void 0:e}}const Y$=y$?y$.emptyScript:"";class J$ extends G${constructor(){super(...arguments),this.type=4}j(e){e&&e!==M$?this.element.setAttribute(this.name,Y$):this.element.removeAttribute(this.name)}}class X$ extends G${constructor(e,t,r,n,i){super(e,t,r,n,i),this.type=5}_$AI(e,t=this){var r;if((e=null!==(r=W$(this,e,t,0))&&void 0!==r?r:M$)===$$)return;const n=this._$AH,i=e===M$&&n!==M$||e.capture!==n.capture||e.once!==n.once||e.passive!==n.passive,o=e!==M$&&(n===M$||i);i&&this.element.removeEventListener(this.name,this,n),o&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t,r;"function"==typeof this._$AH?this._$AH.call(null!==(r=null===(t=this.options)||void 0===t?void 0:t.host)&&void 0!==r?r:this.element,e):this._$AH.handleEvent(e)}}class Q${constructor(e,t,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){W$(this,e)}}const eM=m$.litHtmlPolyfillSupport;null==eM||eM(q$,K$),(null!==(g$=m$.litHtmlVersions)&&void 0!==g$?g$:m$.litHtmlVersions=[]).push("2.8.0");
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */
var tM,rM;class nM extends p${constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e,t;const r=super.createRenderRoot();return null!==(e=(t=this.renderOptions).renderBefore)&&void 0!==e||(t.renderBefore=r.firstChild),r}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=((e,t,r)=>{var n,i;const o=null!==(n=null==r?void 0:r.renderBefore)&&void 0!==n?n:t;let s=o._$litPart$;if(void 0===s){const e=null!==(i=null==r?void 0:r.renderBefore)&&void 0!==i?i:null;o._$litPart$=s=new K$(t.insertBefore(_$(),e),e,void 0,null!=r?r:{})}return s._$AI(e),s})(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!1)}render(){return $$}}nM.finalized=!0,nM._$litElement$=!0,null===(tM=globalThis.litElementHydrateSupport)||void 0===tM||tM.call(globalThis,{LitElement:nM});const iM=globalThis.litElementPolyfillSupport;null==iM||iM({LitElement:nM}),(null!==(rM=globalThis.litElementVersions)&&void 0!==rM?rM:globalThis.litElementVersions=[]).push("3.3.3");
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */
const oM=e=>t=>"function"==typeof t?((e,t)=>(customElements.define(e,t),t))(e,t):((e,t)=>{const{kind:r,elements:n}=t;return{kind:r,elements:n,finisher(t){customElements.define(e,t)}}})(e,t),sM=(e,t)=>"method"===t.kind&&t.descriptor&&!("value"in t.descriptor)?{...t,finisher(r){r.createProperty(t.key,e)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:t.key,initializer(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher(r){r.createProperty(t.key,e)}};
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */function aM(e){return(t,r)=>void 0!==r?((e,t,r)=>{t.constructor.createProperty(r,e)})(e,t,r):sM(e,t)}
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */function cM(e){return aM({...e,state:!0})}
/**
   * @license
   * Copyright 2021 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */var lM;null===(lM=window.HTMLSlotElement)||void 0===lM||lM.prototype.assignedElements;
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */
const uM=1,hM=e=>(...t)=>({_$litDirective$:e,values:t});class dM{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,r){this._$Ct=e,this._$AM=t,this._$Ci=r}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}}
/**
   * @license
   * Copyright 2018 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */const fM=(()=>{})(class extends dM{constructor(e){var t;if(super(e),e.type!==uM||"class"!==e.name||(null===(t=e.strings)||void 0===t?void 0:t.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(e){return" "+Object.keys(e).filter(t=>e[t]).join(" ")+" "}update(e,[t]){var r,n;if(void 0===this.it){this.it=new Set,void 0!==e.strings&&(this.nt=new Set(e.strings.join(" ").split(/\s/).filter(e=>""!==e)));for(const e in t)t[e]&&!(null===(r=this.nt)||void 0===r?void 0:r.has(e))&&this.it.add(e);return this.render(t)}const i=e.element.classList;this.it.forEach(e=>{e in t||(i.remove(e),this.it.delete(e))});for(const e in t){const r=!!t[e];r===this.it.has(e)||(null===(n=this.nt)||void 0===n?void 0:n.has(e))||(r?(i.add(e),this.it.add(e)):(i.remove(e),this.it.delete(e)))}return $$}});const pM=(e,t,r)=>Math.min(Math.max(r,e),t),gM={duration:.3,delay:0,endDelay:0,repeat:0,easing:"ease"},mM=e=>"number"==typeof e,yM=e=>Array.isArray(e)&&!mM(e[0]);const wM=(e,t,r)=>-r*e+r*t+e,bM=()=>{},vM=e=>e,EM=(e,t,r)=>t-e===0?1:(r-e)/(t-e);function xM(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const i=EM(0,t,n);e.push(wM(r,1,i))}}function IM(e,t=function(e){const t=[0];return xM(t,e-1),t}(e.length),r=vM){const n=e.length,i=n-t.length;return i>0&&xM(t,i),i=>{let o=0;for(;o<n-2&&!(i<t[o+1]);o++);let s=pM(0,1,EM(t[o],t[o+1],i));const a=function(e,t){return yM(e)?e[((e,t,r)=>{const n=t-e;return((r-e)%n+n)%n+e})(0,e.length,t)]:e}(r,o);return s=a(s),wM(e[o],e[o+1],s)}}const _M=e=>Array.isArray(e)&&mM(e[0]),SM=e=>"object"==typeof e&&Boolean(e.createAnimation),AM=e=>"function"==typeof e,OM=e=>1e3*e,CM=e=>e/1e3,PM=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e;function RM(e,t,r,n){if(e===t&&r===n)return vM;const i=t=>function(e,t,r,n,i){let o,s,a=0;do{s=t+(r-t)/2,o=PM(s,n,i)-e,o>0?r=s:t=s}while(Math.abs(o)>1e-7&&++a<12);return s}(t,0,1,e,r);return e=>0===e||1===e?e:PM(i(e),t,n)}const TM={ease:RM(.25,.1,.25,1),"ease-in":RM(.42,0,1,1),"ease-in-out":RM(.42,0,.58,1),"ease-out":RM(0,0,.58,1)},kM=/\((.*?)\)/;function NM(e){if(AM(e))return e;if(_M(e))return RM(...e);const t=TM[e];if(t)return t;if(e.startsWith("steps")){const t=kM.exec(e);if(t){const e=t[1].split(",");return((e,t="end")=>r=>{const n=(r="end"===t?Math.min(r,.999):Math.max(r,.001))*e,i="end"===t?Math.floor(n):Math.ceil(n);return pM(0,1,i/e)})(parseFloat(e[0]),e[1].trim())}}return vM}class UM{constructor(e,t=[0,1],{easing:r,duration:n=gM.duration,delay:i=gM.delay,endDelay:o=gM.endDelay,repeat:s=gM.repeat,offset:a,direction:c="normal",autoplay:l=!0}={}){if(this.startTime=null,this.rate=1,this.t=0,this.cancelTimestamp=null,this.easing=vM,this.duration=0,this.totalDuration=0,this.repeat=0,this.playState="idle",this.finished=new Promise((e,t)=>{this.resolve=e,this.reject=t}),r=r||gM.easing,SM(r)){const e=r.createAnimation(t);r=e.easing,t=e.keyframes||t,n=e.duration||n}this.repeat=s,this.easing=yM(r)?vM:NM(r),this.updateDuration(n);const u=IM(t,a,yM(r)?r.map(NM):vM);this.tick=t=>{var r;let n=0;n=void 0!==this.pauseTime?this.pauseTime:(t-this.startTime)*this.rate,this.t=n,n/=1e3,n=Math.max(n-i,0),"finished"===this.playState&&void 0===this.pauseTime&&(n=this.totalDuration);const s=n/this.duration;let a=Math.floor(s),l=s%1;!l&&s>=1&&(l=1),1===l&&a--;const h=a%2;("reverse"===c||"alternate"===c&&h||"alternate-reverse"===c&&!h)&&(l=1-l);const d=n>=this.totalDuration?1:Math.min(l,1),f=u(this.easing(d));e(f);void 0===this.pauseTime&&("finished"===this.playState||n>=this.totalDuration+o)?(this.playState="finished",null===(r=this.resolve)||void 0===r||r.call(this,f)):"idle"!==this.playState&&(this.frameRequestId=requestAnimationFrame(this.tick))},l&&this.play()}play(){const e=performance.now();this.playState="running",void 0!==this.pauseTime?this.startTime=e-this.pauseTime:this.startTime||(this.startTime=e),this.cancelTimestamp=this.startTime,this.pauseTime=void 0,this.frameRequestId=requestAnimationFrame(this.tick)}pause(){this.playState="paused",this.pauseTime=this.t}finish(){this.playState="finished",this.tick(0)}stop(){var e;this.playState="idle",void 0!==this.frameRequestId&&cancelAnimationFrame(this.frameRequestId),null===(e=this.reject)||void 0===e||e.call(this,!1)}cancel(){this.stop(),this.tick(this.cancelTimestamp)}reverse(){this.rate*=-1}commitStyles(){}updateDuration(e){this.duration=e,this.totalDuration=e*(this.repeat+1)}get currentTime(){return this.t}set currentTime(e){void 0!==this.pauseTime||0===this.rate?this.pauseTime=e:this.startTime=performance.now()-e/this.rate}get playbackRate(){return this.rate}set playbackRate(e){this.rate=e}}class BM{setAnimation(e){this.animation=e,null==e||e.finished.then(()=>this.clearAnimation()).catch(()=>{})}clearAnimation(){this.animation=this.generator=void 0}}const LM=new WeakMap;function DM(e){return LM.has(e)||LM.set(e,{transforms:[],values:new Map}),LM.get(e)}const $M=["","X","Y","Z"],MM={x:"translateX",y:"translateY",z:"translateZ"},jM={syntax:"<angle>",initialValue:"0deg",toDefaultUnit:e=>e+"deg"},FM={translate:{syntax:"<length-percentage>",initialValue:"0px",toDefaultUnit:e=>e+"px"},rotate:jM,scale:{syntax:"<number>",initialValue:1,toDefaultUnit:vM},skew:jM},HM=new Map,zM=e=>`--motion-${e}`,qM=["x","y","z"];["translate","scale","rotate","skew"].forEach(e=>{$M.forEach(t=>{qM.push(e+t),HM.set(zM(e+t),FM[e])})});const WM=(e,t)=>qM.indexOf(e)-qM.indexOf(t),VM=new Set(qM),KM=e=>VM.has(e),GM=e=>e.sort(WM).reduce(ZM,"").trim(),ZM=(e,t)=>`${e} ${t}(var(${zM(t)}))`,YM=e=>e.startsWith("--"),JM=new Set;const XM=(e,t)=>document.createElement("div").animate(e,t),QM={cssRegisterProperty:()=>"undefined"!=typeof CSS&&Object.hasOwnProperty.call(CSS,"registerProperty"),waapi:()=>Object.hasOwnProperty.call(Element.prototype,"animate"),partialKeyframes:()=>{try{XM({opacity:[1]})}catch(e){return!1}return!0},finished:()=>Boolean(XM({opacity:[0,1]},{duration:.001}).finished),linearEasing:()=>{try{XM({opacity:0},{easing:"linear(0, 1)"})}catch(e){return!1}return!0}},ej={},tj={};for(const e in QM)tj[e]=()=>(void 0===ej[e]&&(ej[e]=QM[e]()),ej[e]);const rj=(e,t)=>AM(e)?tj.linearEasing()?`linear(${((e,t)=>{let r="";const n=Math.round(t/.015);for(let t=0;t<n;t++)r+=e(EM(0,n-1,t))+", ";return r.substring(0,r.length-2)})(e,t)})`:gM.easing:_M(e)?nj(e):e,nj=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`;function ij(e){return MM[e]&&(e=MM[e]),KM(e)?zM(e):e}const oj=(e,t)=>{t=ij(t);let r=YM(t)?e.style.getPropertyValue(t):getComputedStyle(e)[t];if(!r&&0!==r){const e=HM.get(t);e&&(r=e.initialValue)}return r},sj=(e,t,r)=>{t=ij(t),YM(t)?e.style.setProperty(t,r):e.style[t]=r};function aj(e,t=!0){if(e&&"finished"!==e.playState)try{e.stop?e.stop():(t&&e.commitStyles(),e.cancel())}catch(e){}}function cj(e,t,r,n={},i){const o=window.__MOTION_DEV_TOOLS_RECORD,s=!1!==n.record&&o;let a,{duration:c=gM.duration,delay:l=gM.delay,endDelay:u=gM.endDelay,repeat:h=gM.repeat,easing:d=gM.easing,persist:f=!1,direction:p,offset:g,allowWebkitAcceleration:m=!1,autoplay:y=!0}=n;const w=DM(e),b=KM(t);let v=tj.waapi();b&&((e,t)=>{MM[t]&&(t=MM[t]);const{transforms:r}=DM(e);var n,i;i=t,-1===(n=r).indexOf(i)&&n.push(i),e.style.transform=GM(r)})(e,t);const E=ij(t),x=function(e,t){return e.has(t)||e.set(t,new BM),e.get(t)}(w.values,E),I=HM.get(E);return aj(x.animation,!(SM(d)&&x.generator)&&!1!==n.record),()=>{const w=()=>{var t,r;return null!==(r=null!==(t=oj(e,E))&&void 0!==t?t:null==I?void 0:I.initialValue)&&void 0!==r?r:0};let _=function(e,t){for(let r=0;r<e.length;r++)null===e[r]&&(e[r]=r?e[r-1]:t());return e}((e=>Array.isArray(e)?e:[e])(r),w);const S=function(e,t){var r;let n=(null==t?void 0:t.toDefaultUnit)||vM;const i=e[e.length-1];if("string"==typeof i){const e=(null===(r=i.match(/(-?[\d.]+)([a-z%]*)/))||void 0===r?void 0:r[2])||"";e&&(n=t=>t+e)}return n}(_,I);if(SM(d)){const e=d.createAnimation(_,"opacity"!==t,w,E,x);d=e.easing,_=e.keyframes||_,c=e.duration||c}if(YM(E)&&(tj.cssRegisterProperty()?function(e){if(!JM.has(e)){JM.add(e);try{const{syntax:t,initialValue:r}=HM.has(e)?HM.get(e):{};CSS.registerProperty({name:e,inherits:!1,syntax:t,initialValue:r})}catch(e){}}}(E):v=!1),b&&!tj.linearEasing()&&(AM(d)||yM(d)&&d.some(AM))&&(v=!1),v){I&&(_=_.map(e=>mM(e)?I.toDefaultUnit(e):e)),1!==_.length||tj.partialKeyframes()&&!s||_.unshift(w());const t={delay:OM(l),duration:OM(c),endDelay:OM(u),easing:yM(d)?void 0:rj(d,c),direction:p,iterations:h+1,fill:"both"};a=e.animate({[E]:_,offset:g,easing:yM(d)?d.map(e=>rj(e,c)):void 0},t),a.finished||(a.finished=new Promise((e,t)=>{a.onfinish=e,a.oncancel=t}));const r=_[_.length-1];a.finished.then(()=>{f||(sj(e,E,r),a.cancel())}).catch(bM),m||(a.playbackRate=1.000001)}else if(i&&b)_=_.map(e=>"string"==typeof e?parseFloat(e):e),1===_.length&&_.unshift(parseFloat(w())),a=new i(t=>{sj(e,E,S?S(t):t)},_,Object.assign(Object.assign({},n),{duration:c,easing:d}));else{const t=_[_.length-1];sj(e,E,I&&mM(t)?I.toDefaultUnit(t):t)}return s&&o(e,t,_,{duration:c,delay:l,easing:d,repeat:h,offset:g},"motion-one"),x.setAnimation(a),a&&!y&&a.pause(),a}}const lj=(e,t)=>e[t]?Object.assign(Object.assign({},e),e[t]):Object.assign({},e);const uj=e=>e(),hj=(e,t,r=gM.duration)=>new Proxy({animations:e.map(uj).filter(Boolean),duration:r,options:t},dj),dj={get:(e,t)=>{const r=(e=>e.animations[0])(e);switch(t){case"duration":return e.duration;case"currentTime":return CM((null==r?void 0:r[t])||0);case"playbackRate":case"playState":return null==r?void 0:r[t];case"finished":return e.finished||(e.finished=Promise.all(e.animations.map(fj)).catch(bM)),e.finished;case"stop":return()=>{e.animations.forEach(e=>aj(e))};case"forEachNative":return t=>{e.animations.forEach(r=>t(r,e))};default:return void 0===(null==r?void 0:r[t])?void 0:()=>e.animations.forEach(e=>e[t]())}},set:(e,t,r)=>{switch(t){case"currentTime":r=OM(r);case"playbackRate":for(let n=0;n<e.animations.length;n++)e.animations[n][t]=r;return!0}return!1}},fj=e=>e.finished;function pj(e,t,r){return AM(e)?e(t,r):e}const gj=(mj=UM,function(e,t,r={}){const n=(e=function(e){return"string"==typeof e?e=document.querySelectorAll(e):e instanceof Element&&(e=[e]),Array.from(e||[])}(e)).length,i=[];for(let o=0;o<n;o++){const s=e[o];for(const e in t){const a=lj(r,e);a.delay=pj(a.delay,o,n);const c=cj(s,e,t[e],a,mj);i.push(c)}}return hj(i,r,r.duration)});var mj;function yj(e,t={}){return hj([()=>{const r=new UM(e,[0,1],t);return r.finished.catch(()=>{}),r}],t,t.duration)}function wj(e,t,r){return(AM(e)?yj:gj)(e,t,r)}
/**
   * @license
   * Copyright 2018 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */const bj=e=>null!=e?e:M$;var vj={},Ej={},xj={};let Ij;const _j=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];xj.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return 4*e+17},xj.getSymbolTotalCodewords=function(e){return _j[e]},xj.getBCHDigit=function(e){let t=0;for(;0!==e;)t++,e>>>=1;return t},xj.setToSJISFunction=function(e){if("function"!=typeof e)throw new Error('"toSJISFunc" is not a valid function.');Ij=e},xj.isKanjiModeEnabled=function(){return void 0!==Ij},xj.toSJIS=function(e){return Ij(e)};var Sj,Aj={};function Oj(){this.buffer=[],this.length=0}(Sj=Aj).L={bit:1},Sj.M={bit:0},Sj.Q={bit:3},Sj.H={bit:2},Sj.isValid=function(e){return e&&void 0!==e.bit&&e.bit>=0&&e.bit<4},Sj.from=function(e,t){if(Sj.isValid(e))return e;try{return function(e){if("string"!=typeof e)throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return Sj.L;case"m":case"medium":return Sj.M;case"q":case"quartile":return Sj.Q;case"h":case"high":return Sj.H;default:throw new Error("Unknown EC Level: "+e)}}(e)}catch(e){return t}},Oj.prototype={get:function(e){const t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(let r=0;r<t;r++)this.putBit(1==(e>>>t-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var Cj=Oj;function Pj(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}Pj.prototype.set=function(e,t,r,n){const i=e*this.size+t;this.data[i]=r,n&&(this.reservedBit[i]=!0)},Pj.prototype.get=function(e,t){return this.data[e*this.size+t]},Pj.prototype.xor=function(e,t,r){this.data[e*this.size+t]^=r},Pj.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]};var Rj=Pj,Tj={};!function(e){const t=xj.getSymbolSize;e.getRowColCoords=function(e){if(1===e)return[];const r=Math.floor(e/7)+2,n=t(e),i=145===n?26:2*Math.ceil((n-13)/(2*r-2)),o=[n-7];for(let e=1;e<r-1;e++)o[e]=o[e-1]-i;return o.push(6),o.reverse()},e.getPositions=function(t){const r=[],n=e.getRowColCoords(t),i=n.length;for(let e=0;e<i;e++)for(let t=0;t<i;t++)0===e&&0===t||0===e&&t===i-1||e===i-1&&0===t||r.push([n[e],n[t]]);return r}}(Tj);var kj={};const Nj=xj.getSymbolSize;kj.getPositions=function(e){const t=Nj(e);return[[0,0],[t-7,0],[0,t-7]]};var Uj={};!function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t=3,r=3,n=40,i=10;function o(t,r,n){switch(t){case e.Patterns.PATTERN000:return(r+n)%2==0;case e.Patterns.PATTERN001:return r%2==0;case e.Patterns.PATTERN010:return n%3==0;case e.Patterns.PATTERN011:return(r+n)%3==0;case e.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(n/3))%2==0;case e.Patterns.PATTERN101:return r*n%2+r*n%3==0;case e.Patterns.PATTERN110:return(r*n%2+r*n%3)%2==0;case e.Patterns.PATTERN111:return(r*n%3+(r+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}}e.isValid=function(e){return null!=e&&""!==e&&!isNaN(e)&&e>=0&&e<=7},e.from=function(t){return e.isValid(t)?parseInt(t,10):void 0},e.getPenaltyN1=function(e){const r=e.size;let n=0,i=0,o=0,s=null,a=null;for(let c=0;c<r;c++){i=o=0,s=a=null;for(let l=0;l<r;l++){let r=e.get(c,l);r===s?i++:(i>=5&&(n+=t+(i-5)),s=r,i=1),r=e.get(l,c),r===a?o++:(o>=5&&(n+=t+(o-5)),a=r,o=1)}i>=5&&(n+=t+(i-5)),o>=5&&(n+=t+(o-5))}return n},e.getPenaltyN2=function(e){const t=e.size;let n=0;for(let r=0;r<t-1;r++)for(let i=0;i<t-1;i++){const t=e.get(r,i)+e.get(r,i+1)+e.get(r+1,i)+e.get(r+1,i+1);4!==t&&0!==t||n++}return n*r},e.getPenaltyN3=function(e){const t=e.size;let r=0,i=0,o=0;for(let n=0;n<t;n++){i=o=0;for(let s=0;s<t;s++)i=i<<1&2047|e.get(n,s),s>=10&&(1488===i||93===i)&&r++,o=o<<1&2047|e.get(s,n),s>=10&&(1488===o||93===o)&&r++}return r*n},e.getPenaltyN4=function(e){let t=0;const r=e.data.length;for(let n=0;n<r;n++)t+=e.data[n];return Math.abs(Math.ceil(100*t/r/5)-10)*i},e.applyMask=function(e,t){const r=t.size;for(let n=0;n<r;n++)for(let i=0;i<r;i++)t.isReserved(i,n)||t.xor(i,n,o(e,i,n))},e.getBestMask=function(t,r){const n=Object.keys(e.Patterns).length;let i=0,o=1/0;for(let s=0;s<n;s++){r(s),e.applyMask(s,t);const n=e.getPenaltyN1(t)+e.getPenaltyN2(t)+e.getPenaltyN3(t)+e.getPenaltyN4(t);e.applyMask(s,t),n<o&&(o=n,i=s)}return i}}(Uj);var Bj={};const Lj=Aj,Dj=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],$j=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Bj.getBlocksCount=function(e,t){switch(t){case Lj.L:return Dj[4*(e-1)+0];case Lj.M:return Dj[4*(e-1)+1];case Lj.Q:return Dj[4*(e-1)+2];case Lj.H:return Dj[4*(e-1)+3];default:return}},Bj.getTotalCodewordsCount=function(e,t){switch(t){case Lj.L:return $j[4*(e-1)+0];case Lj.M:return $j[4*(e-1)+1];case Lj.Q:return $j[4*(e-1)+2];case Lj.H:return $j[4*(e-1)+3];default:return}};var Mj={},jj={};const Fj=new Uint8Array(512),Hj=new Uint8Array(256);!function(){let e=1;for(let t=0;t<255;t++)Fj[t]=e,Hj[e]=t,e<<=1,256&e&&(e^=285);for(let e=255;e<512;e++)Fj[e]=Fj[e-255]}(),jj.log=function(e){if(e<1)throw new Error("log("+e+")");return Hj[e]},jj.exp=function(e){return Fj[e]},jj.mul=function(e,t){return 0===e||0===t?0:Fj[Hj[e]+Hj[t]]},function(e){const t=jj;e.mul=function(e,r){const n=new Uint8Array(e.length+r.length-1);for(let i=0;i<e.length;i++)for(let o=0;o<r.length;o++)n[i+o]^=t.mul(e[i],r[o]);return n},e.mod=function(e,r){let n=new Uint8Array(e);for(;n.length-r.length>=0;){const e=n[0];for(let i=0;i<r.length;i++)n[i]^=t.mul(r[i],e);let i=0;for(;i<n.length&&0===n[i];)i++;n=n.slice(i)}return n},e.generateECPolynomial=function(r){let n=new Uint8Array([1]);for(let i=0;i<r;i++)n=e.mul(n,new Uint8Array([1,t.exp(i)]));return n}}(Mj);const zj=Mj;function qj(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}qj.prototype.initialize=function(e){this.degree=e,this.genPoly=zj.generateECPolynomial(this.degree)},qj.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const t=new Uint8Array(e.length+this.degree);t.set(e);const r=zj.mod(t,this.genPoly),n=this.degree-r.length;if(n>0){const e=new Uint8Array(this.degree);return e.set(r,n),e}return r};var Wj=qj,Vj={},Kj={},Gj={isValid:function(e){return!isNaN(e)&&e>=1&&e<=40}},Zj={};const Yj="[0-9]+";let Jj="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Jj=Jj.replace(/u/g,"\\u");const Xj="(?:(?![A-Z0-9 $%*+\\-./:]|"+Jj+")(?:.|[\r\n]))+";Zj.KANJI=new RegExp(Jj,"g"),Zj.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Zj.BYTE=new RegExp(Xj,"g"),Zj.NUMERIC=new RegExp(Yj,"g"),Zj.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");const Qj=new RegExp("^"+Jj+"$"),eF=new RegExp("^"+Yj+"$"),tF=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Zj.testKanji=function(e){return Qj.test(e)},Zj.testNumeric=function(e){return eF.test(e)},Zj.testAlphanumeric=function(e){return tF.test(e)},function(e){const t=Gj,r=Zj;e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(e,r){if(!e.ccBits)throw new Error("Invalid mode: "+e);if(!t.isValid(r))throw new Error("Invalid version: "+r);return r>=1&&r<10?e.ccBits[0]:r<27?e.ccBits[1]:e.ccBits[2]},e.getBestModeForData=function(t){return r.testNumeric(t)?e.NUMERIC:r.testAlphanumeric(t)?e.ALPHANUMERIC:r.testKanji(t)?e.KANJI:e.BYTE},e.toString=function(e){if(e&&e.id)return e.id;throw new Error("Invalid mode")},e.isValid=function(e){return e&&e.bit&&e.ccBits},e.from=function(t,r){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+t)}}(t)}catch(e){return r}}}(Kj),function(e){const t=xj,r=Bj,n=Aj,i=Kj,o=Gj,s=t.getBCHDigit(7973);function a(e,t){return i.getCharCountIndicator(e,t)+4}function c(e,t){let r=0;return e.forEach(function(e){const n=a(e.mode,t);r+=n+e.getBitsLength()}),r}e.from=function(e,t){return o.isValid(e)?parseInt(e,10):t},e.getCapacity=function(e,n,s){if(!o.isValid(e))throw new Error("Invalid QR Code version");void 0===s&&(s=i.BYTE);const c=8*(t.getSymbolTotalCodewords(e)-r.getTotalCodewordsCount(e,n));if(s===i.MIXED)return c;const l=c-a(s,e);switch(s){case i.NUMERIC:return Math.floor(l/10*3);case i.ALPHANUMERIC:return Math.floor(l/11*2);case i.KANJI:return Math.floor(l/13);case i.BYTE:default:return Math.floor(l/8)}},e.getBestVersionForData=function(t,r){let o;const s=n.from(r,n.M);if(Array.isArray(t)){if(t.length>1)return function(t,r){for(let n=1;n<=40;n++)if(c(t,n)<=e.getCapacity(n,r,i.MIXED))return n}(t,s);if(0===t.length)return 1;o=t[0]}else o=t;return function(t,r,n){for(let i=1;i<=40;i++)if(r<=e.getCapacity(i,n,t))return i}(o.mode,o.getLength(),s)},e.getEncodedBits=function(e){if(!o.isValid(e)||e<7)throw new Error("Invalid QR Code version");let r=e<<12;for(;t.getBCHDigit(r)-s>=0;)r^=7973<<t.getBCHDigit(r)-s;return e<<12|r}}(Vj);var rF={};const nF=xj,iF=nF.getBCHDigit(1335);rF.getEncodedBits=function(e,t){const r=e.bit<<3|t;let n=r<<10;for(;nF.getBCHDigit(n)-iF>=0;)n^=1335<<nF.getBCHDigit(n)-iF;return 21522^(r<<10|n)};var oF={};const sF=Kj;function aF(e){this.mode=sF.NUMERIC,this.data=e.toString()}aF.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)},aF.prototype.getLength=function(){return this.data.length},aF.prototype.getBitsLength=function(){return aF.getBitsLength(this.data.length)},aF.prototype.write=function(e){let t,r,n;for(t=0;t+3<=this.data.length;t+=3)r=this.data.substr(t,3),n=parseInt(r,10),e.put(n,10);const i=this.data.length-t;i>0&&(r=this.data.substr(t),n=parseInt(r,10),e.put(n,3*i+1))};var cF=aF;const lF=Kj,uF=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function hF(e){this.mode=lF.ALPHANUMERIC,this.data=e}hF.getBitsLength=function(e){return 11*Math.floor(e/2)+e%2*6},hF.prototype.getLength=function(){return this.data.length},hF.prototype.getBitsLength=function(){return hF.getBitsLength(this.data.length)},hF.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let r=45*uF.indexOf(this.data[t]);r+=uF.indexOf(this.data[t+1]),e.put(r,11)}this.data.length%2&&e.put(uF.indexOf(this.data[t]),6)};var dF=hF;const fF=function(e){for(var t=[],r=e.length,n=0;n<r;n++){var i=e.charCodeAt(n);if(i>=55296&&i<=56319&&r>n+1){var o=e.charCodeAt(n+1);o>=56320&&o<=57343&&(i=1024*(i-55296)+o-56320+65536,n+=1)}i<128?t.push(i):i<2048?(t.push(i>>6|192),t.push(63&i|128)):i<55296||i>=57344&&i<65536?(t.push(i>>12|224),t.push(i>>6&63|128),t.push(63&i|128)):i>=65536&&i<=1114111?(t.push(i>>18|240),t.push(i>>12&63|128),t.push(i>>6&63|128),t.push(63&i|128)):t.push(239,191,189)}return new Uint8Array(t).buffer},pF=Kj;function gF(e){this.mode=pF.BYTE,"string"==typeof e&&(e=fF(e)),this.data=new Uint8Array(e)}gF.getBitsLength=function(e){return 8*e},gF.prototype.getLength=function(){return this.data.length},gF.prototype.getBitsLength=function(){return gF.getBitsLength(this.data.length)},gF.prototype.write=function(e){for(let t=0,r=this.data.length;t<r;t++)e.put(this.data[t],8)};var mF=gF;const yF=Kj,wF=xj;function bF(e){this.mode=yF.KANJI,this.data=e}bF.getBitsLength=function(e){return 13*e},bF.prototype.getLength=function(){return this.data.length},bF.prototype.getBitsLength=function(){return bF.getBitsLength(this.data.length)},bF.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let r=wF.toSJIS(this.data[t]);if(r>=33088&&r<=40956)r-=33088;else{if(!(r>=57408&&r<=60351))throw new Error("Invalid SJIS character: "+this.data[t]+"\nMake sure your charset is UTF-8");r-=49472}r=192*(r>>>8&255)+(255&r),e.put(r,13)}};var vF=bF,EF={exports:{}};!function(e){var t={single_source_shortest_paths:function(e,r,n){var i={},o={};o[r]=0;var s,a,c,l,u,h,d,f=t.PriorityQueue.make();for(f.push(r,0);!f.empty();)for(c in a=(s=f.pop()).value,l=s.cost,u=e[a]||{})u.hasOwnProperty(c)&&(h=l+u[c],d=o[c],(void 0===o[c]||d>h)&&(o[c]=h,f.push(c,h),i[c]=a));if(void 0!==n&&void 0===o[n]){var p=["Could not find a path from ",r," to ",n,"."].join("");throw new Error(p)}return i},extract_shortest_path_from_predecessor_list:function(e,t){for(var r=[],n=t;n;)r.push(n),e[n],n=e[n];return r.reverse(),r},find_path:function(e,r,n){var i=t.single_source_shortest_paths(e,r,n);return t.extract_shortest_path_from_predecessor_list(i,n)},PriorityQueue:{make:function(e){var r,n=t.PriorityQueue,i={};for(r in e=e||{},n)n.hasOwnProperty(r)&&(i[r]=n[r]);return i.queue=[],i.sorter=e.sorter||n.default_sorter,i},default_sorter:function(e,t){return e.cost-t.cost},push:function(e,t){var r={value:e,cost:t};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};e.exports=t}(EF);var xF=EF.exports;!function(e){const t=Kj,r=cF,n=dF,i=mF,o=vF,s=Zj,a=xj,c=xF;function l(e){return unescape(encodeURIComponent(e)).length}function u(e,t,r){const n=[];let i;for(;null!==(i=e.exec(r));)n.push({data:i[0],index:i.index,mode:t,length:i[0].length});return n}function h(e){const r=u(s.NUMERIC,t.NUMERIC,e),n=u(s.ALPHANUMERIC,t.ALPHANUMERIC,e);let i,o;a.isKanjiModeEnabled()?(i=u(s.BYTE,t.BYTE,e),o=u(s.KANJI,t.KANJI,e)):(i=u(s.BYTE_KANJI,t.BYTE,e),o=[]);return r.concat(n,i,o).sort(function(e,t){return e.index-t.index}).map(function(e){return{data:e.data,mode:e.mode,length:e.length}})}function d(e,s){switch(s){case t.NUMERIC:return r.getBitsLength(e);case t.ALPHANUMERIC:return n.getBitsLength(e);case t.KANJI:return o.getBitsLength(e);case t.BYTE:return i.getBitsLength(e)}}function f(e,s){let c;const l=t.getBestModeForData(e);if(c=t.from(s,l),c!==t.BYTE&&c.bit<l.bit)throw new Error('"'+e+'" cannot be encoded with mode '+t.toString(c)+".\n Suggested mode is: "+t.toString(l));switch(c!==t.KANJI||a.isKanjiModeEnabled()||(c=t.BYTE),c){case t.NUMERIC:return new r(e);case t.ALPHANUMERIC:return new n(e);case t.KANJI:return new o(e);case t.BYTE:return new i(e)}}e.fromArray=function(e){return e.reduce(function(e,t){return"string"==typeof t?e.push(f(t,null)):t.data&&e.push(f(t.data,t.mode)),e},[])},e.fromString=function(r,n){const i=function(e){const r=[];for(let n=0;n<e.length;n++){const i=e[n];switch(i.mode){case t.NUMERIC:r.push([i,{data:i.data,mode:t.ALPHANUMERIC,length:i.length},{data:i.data,mode:t.BYTE,length:i.length}]);break;case t.ALPHANUMERIC:r.push([i,{data:i.data,mode:t.BYTE,length:i.length}]);break;case t.KANJI:r.push([i,{data:i.data,mode:t.BYTE,length:l(i.data)}]);break;case t.BYTE:r.push([{data:i.data,mode:t.BYTE,length:l(i.data)}])}}return r}(h(r,a.isKanjiModeEnabled())),o=function(e,r){const n={},i={start:{}};let o=["start"];for(let s=0;s<e.length;s++){const a=e[s],c=[];for(let e=0;e<a.length;e++){const l=a[e],u=""+s+e;c.push(u),n[u]={node:l,lastCount:0},i[u]={};for(let e=0;e<o.length;e++){const s=o[e];n[s]&&n[s].node.mode===l.mode?(i[s][u]=d(n[s].lastCount+l.length,l.mode)-d(n[s].lastCount,l.mode),n[s].lastCount+=l.length):(n[s]&&(n[s].lastCount=l.length),i[s][u]=d(l.length,l.mode)+4+t.getCharCountIndicator(l.mode,r))}}o=c}for(let e=0;e<o.length;e++)i[o[e]].end=0;return{map:i,table:n}}(i,n),s=c.find_path(o.map,"start","end"),u=[];for(let e=1;e<s.length-1;e++)u.push(o.table[s[e]].node);return e.fromArray(function(e){return e.reduce(function(e,t){const r=e.length-1>=0?e[e.length-1]:null;return r&&r.mode===t.mode?(e[e.length-1].data+=t.data,e):(e.push(t),e)},[])}(u))},e.rawSplit=function(t){return e.fromArray(h(t,a.isKanjiModeEnabled()))}}(oF);const IF=xj,_F=Aj,SF=Cj,AF=Rj,OF=Tj,CF=kj,PF=Uj,RF=Bj,TF=Wj,kF=Vj,NF=rF,UF=Kj,BF=oF;function LF(e,t,r){const n=e.size,i=NF.getEncodedBits(t,r);let o,s;for(o=0;o<15;o++)s=1==(i>>o&1),o<6?e.set(o,8,s,!0):o<8?e.set(o+1,8,s,!0):e.set(n-15+o,8,s,!0),o<8?e.set(8,n-o-1,s,!0):o<9?e.set(8,15-o-1+1,s,!0):e.set(8,15-o-1,s,!0);e.set(n-8,8,1,!0)}function DF(e,t,r){const n=new SF;r.forEach(function(t){n.put(t.mode.bit,4),n.put(t.getLength(),UF.getCharCountIndicator(t.mode,e)),t.write(n)});const i=8*(IF.getSymbolTotalCodewords(e)-RF.getTotalCodewordsCount(e,t));for(n.getLengthInBits()+4<=i&&n.put(0,4);n.getLengthInBits()%8!=0;)n.putBit(0);const o=(i-n.getLengthInBits())/8;for(let e=0;e<o;e++)n.put(e%2?17:236,8);return function(e,t,r){const n=IF.getSymbolTotalCodewords(t),i=RF.getTotalCodewordsCount(t,r),o=n-i,s=RF.getBlocksCount(t,r),a=n%s,c=s-a,l=Math.floor(n/s),u=Math.floor(o/s),h=u+1,d=l-u,f=new TF(d);let p=0;const g=new Array(s),m=new Array(s);let y=0;const w=new Uint8Array(e.buffer);for(let e=0;e<s;e++){const t=e<c?u:h;g[e]=w.slice(p,p+t),m[e]=f.encode(g[e]),p+=t,y=Math.max(y,t)}const b=new Uint8Array(n);let v,E,x=0;for(v=0;v<y;v++)for(E=0;E<s;E++)v<g[E].length&&(b[x++]=g[E][v]);for(v=0;v<d;v++)for(E=0;E<s;E++)b[x++]=m[E][v];return b}(n,e,t)}function $F(e,t,r,n){let i;if(Array.isArray(e))i=BF.fromArray(e);else{if("string"!=typeof e)throw new Error("Invalid data");{let n=t;if(!n){const t=BF.rawSplit(e);n=kF.getBestVersionForData(t,r)}i=BF.fromString(e,n||40)}}const o=kF.getBestVersionForData(i,r);if(!o)throw new Error("The amount of data is too big to be stored in a QR Code");if(t){if(t<o)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+o+".\n")}else t=o;const s=DF(t,r,i),a=IF.getSymbolSize(t),c=new AF(a);return function(e,t){const r=e.size,n=CF.getPositions(t);for(let t=0;t<n.length;t++){const i=n[t][0],o=n[t][1];for(let t=-1;t<=7;t++)if(!(i+t<=-1||r<=i+t))for(let n=-1;n<=7;n++)o+n<=-1||r<=o+n||(t>=0&&t<=6&&(0===n||6===n)||n>=0&&n<=6&&(0===t||6===t)||t>=2&&t<=4&&n>=2&&n<=4?e.set(i+t,o+n,!0,!0):e.set(i+t,o+n,!1,!0))}}(c,t),function(e){const t=e.size;for(let r=8;r<t-8;r++){const t=r%2==0;e.set(r,6,t,!0),e.set(6,r,t,!0)}}(c),function(e,t){const r=OF.getPositions(t);for(let t=0;t<r.length;t++){const n=r[t][0],i=r[t][1];for(let t=-2;t<=2;t++)for(let r=-2;r<=2;r++)-2===t||2===t||-2===r||2===r||0===t&&0===r?e.set(n+t,i+r,!0,!0):e.set(n+t,i+r,!1,!0)}}(c,t),LF(c,r,0),t>=7&&function(e,t){const r=e.size,n=kF.getEncodedBits(t);let i,o,s;for(let t=0;t<18;t++)i=Math.floor(t/3),o=t%3+r-8-3,s=1==(n>>t&1),e.set(i,o,s,!0),e.set(o,i,s,!0)}(c,t),function(e,t){const r=e.size;let n=-1,i=r-1,o=7,s=0;for(let a=r-1;a>0;a-=2)for(6===a&&a--;;){for(let r=0;r<2;r++)if(!e.isReserved(i,a-r)){let n=!1;s<t.length&&(n=1==(t[s]>>>o&1)),e.set(i,a-r,n),o--,-1===o&&(s++,o=7)}if(i+=n,i<0||r<=i){i-=n,n=-n;break}}}(c,s),isNaN(n)&&(n=PF.getBestMask(c,LF.bind(null,c,r))),PF.applyMask(n,c),LF(c,r,n),{modules:c,version:t,errorCorrectionLevel:r,maskPattern:n,segments:i}}Ej.create=function(e,t){if(void 0===e||""===e)throw new Error("No input text");let r,n,i=_F.M;return void 0!==t&&(i=_F.from(t.errorCorrectionLevel,_F.M),r=kF.from(t.version),n=PF.from(t.maskPattern),t.toSJISFunc&&IF.setToSJISFunction(t.toSJISFunc)),$F(e,r,i,n)};var MF={},jF={};!function(e){function t(e){if("number"==typeof e&&(e=e.toString()),"string"!=typeof e)throw new Error("Color should be defined as hex string");let t=e.slice().replace("#","").split("");if(t.length<3||5===t.length||t.length>8)throw new Error("Invalid hex color: "+e);3!==t.length&&4!==t.length||(t=Array.prototype.concat.apply([],t.map(function(e){return[e,e]}))),6===t.length&&t.push("F","F");const r=parseInt(t.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:255&r,hex:"#"+t.slice(0,6).join("")}}e.getOptions=function(e){e||(e={}),e.color||(e.color={});const r=void 0===e.margin||null===e.margin||e.margin<0?4:e.margin,n=e.width&&e.width>=21?e.width:void 0,i=e.scale||4;return{width:n,scale:n?4:i,margin:r,color:{dark:t(e.color.dark||"#000000ff"),light:t(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}},e.getScale=function(e,t){return t.width&&t.width>=e+2*t.margin?t.width/(e+2*t.margin):t.scale},e.getImageWidth=function(t,r){const n=e.getScale(t,r);return Math.floor((t+2*r.margin)*n)},e.qrToImageData=function(t,r,n){const i=r.modules.size,o=r.modules.data,s=e.getScale(i,n),a=Math.floor((i+2*n.margin)*s),c=n.margin*s,l=[n.color.light,n.color.dark];for(let e=0;e<a;e++)for(let r=0;r<a;r++){let u=4*(e*a+r),h=n.color.light;if(e>=c&&r>=c&&e<a-c&&r<a-c){h=l[o[Math.floor((e-c)/s)*i+Math.floor((r-c)/s)]?1:0]}t[u++]=h.r,t[u++]=h.g,t[u++]=h.b,t[u]=h.a}}}(jF),function(e){const t=jF;e.render=function(e,r,n){let i=n,o=r;void 0!==i||r&&r.getContext||(i=r,r=void 0),r||(o=function(){try{return document.createElement("canvas")}catch(e){throw new Error("You need to specify a canvas element")}}()),i=t.getOptions(i);const s=t.getImageWidth(e.modules.size,i),a=o.getContext("2d"),c=a.createImageData(s,s);return t.qrToImageData(c.data,e,i),function(e,t,r){e.clearRect(0,0,t.width,t.height),t.style||(t.style={}),t.height=r,t.width=r,t.style.height=r+"px",t.style.width=r+"px"}(a,o,s),a.putImageData(c,0,0),o},e.renderToDataURL=function(t,r,n){let i=n;void 0!==i||r&&r.getContext||(i=r,r=void 0),i||(i={});const o=e.render(t,r,i),s=i.type||"image/png",a=i.rendererOpts||{};return o.toDataURL(s,a.quality)}}(MF);var FF={};const HF=jF;function zF(e,t){const r=e.a/255,n=t+'="'+e.hex+'"';return r<1?n+" "+t+'-opacity="'+r.toFixed(2).slice(1)+'"':n}function qF(e,t,r){let n=e+t;return void 0!==r&&(n+=" "+r),n}FF.render=function(e,t,r){const n=HF.getOptions(t),i=e.modules.size,o=e.modules.data,s=i+2*n.margin,a=n.color.light.a?"<path "+zF(n.color.light,"fill")+' d="M0 0h'+s+"v"+s+'H0z"/>':"",c="<path "+zF(n.color.dark,"stroke")+' d="'+function(e,t,r){let n="",i=0,o=!1,s=0;for(let a=0;a<e.length;a++){const c=Math.floor(a%t),l=Math.floor(a/t);c||o||(o=!0),e[a]?(s++,a>0&&c>0&&e[a-1]||(n+=o?qF("M",c+r,.5+l+r):qF("m",i,0),i=0,o=!1),c+1<t&&e[a+1]||(n+=qF("h",s),s=0)):i++}return n}(o,i,n.margin)+'"/>',l='viewBox="0 0 '+s+" "+s+'"',u='<svg xmlns="http://www.w3.org/2000/svg" '+(n.width?'width="'+n.width+'" height="'+n.width+'" ':"")+l+' shape-rendering="crispEdges">'+a+c+"</svg>\n";return"function"==typeof r&&r(null,u),u};const WF=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then},VF=Ej,KF=MF,GF=FF;function ZF(e,t,r,n,i){const o=[].slice.call(arguments,1),s=o.length,a="function"==typeof o[s-1];if(!a&&!WF())throw new Error("Callback required as last argument");if(!a){if(s<1)throw new Error("Too few arguments provided");return 1===s?(r=t,t=n=void 0):2!==s||t.getContext||(n=r,r=t,t=void 0),new Promise(function(i,o){try{const o=VF.create(r,n);i(e(o,t,n))}catch(e){o(e)}})}if(s<2)throw new Error("Too few arguments provided");2===s?(i=r,r=t,t=n=void 0):3===s&&(t.getContext&&void 0===i?(i=n,n=void 0):(i=n,n=r,r=t,t=void 0));try{const o=VF.create(r,n);i(null,e(o,t,n))}catch(e){i(e)}}vj.create=VF.create,vj.toCanvas=ZF.bind(null,KF.render),vj.toDataURL=ZF.bind(null,KF.renderToDataURL),vj.toString=ZF.bind(null,function(e,t,r){return GF.render(e,r)});var YF=Object.defineProperty,JF=Object.getOwnPropertySymbols,XF=Object.prototype.hasOwnProperty,QF=Object.prototype.propertyIsEnumerable,eH=(e,t,r)=>t in e?YF(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,tH=(e,t)=>{for(var r in t||(t={}))XF.call(t,r)&&eH(e,r,t[r]);if(JF)for(var r of JF(t))QF.call(t,r)&&eH(e,r,t[r]);return e};const rH={getPreset:e=>({"--wcm-accent-color":"#3396FF","--wcm-accent-fill-color":"#FFFFFF","--wcm-z-index":"89","--wcm-background-color":"#3396FF","--wcm-background-border-radius":"8px","--wcm-container-border-radius":"30px","--wcm-wallet-icon-border-radius":"15px","--wcm-wallet-icon-large-border-radius":"30px","--wcm-wallet-icon-small-border-radius":"7px","--wcm-input-border-radius":"28px","--wcm-button-border-radius":"10px","--wcm-notification-border-radius":"36px","--wcm-secondary-button-border-radius":"28px","--wcm-icon-button-border-radius":"50%","--wcm-button-hover-highlight-border-radius":"10px","--wcm-text-big-bold-size":"20px","--wcm-text-big-bold-weight":"600","--wcm-text-big-bold-line-height":"24px","--wcm-text-big-bold-letter-spacing":"-0.03em","--wcm-text-big-bold-text-transform":"none","--wcm-text-xsmall-bold-size":"10px","--wcm-text-xsmall-bold-weight":"700","--wcm-text-xsmall-bold-line-height":"12px","--wcm-text-xsmall-bold-letter-spacing":"0.02em","--wcm-text-xsmall-bold-text-transform":"uppercase","--wcm-text-xsmall-regular-size":"12px","--wcm-text-xsmall-regular-weight":"600","--wcm-text-xsmall-regular-line-height":"14px","--wcm-text-xsmall-regular-letter-spacing":"-0.03em","--wcm-text-xsmall-regular-text-transform":"none","--wcm-text-small-thin-size":"14px","--wcm-text-small-thin-weight":"500","--wcm-text-small-thin-line-height":"16px","--wcm-text-small-thin-letter-spacing":"-0.03em","--wcm-text-small-thin-text-transform":"none","--wcm-text-small-regular-size":"14px","--wcm-text-small-regular-weight":"600","--wcm-text-small-regular-line-height":"16px","--wcm-text-small-regular-letter-spacing":"-0.03em","--wcm-text-small-regular-text-transform":"none","--wcm-text-medium-regular-size":"16px","--wcm-text-medium-regular-weight":"600","--wcm-text-medium-regular-line-height":"20px","--wcm-text-medium-regular-letter-spacing":"-0.03em","--wcm-text-medium-regular-text-transform":"none","--wcm-font-family":"-apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Roboto, Ubuntu, 'Helvetica Neue', sans-serif","--wcm-font-feature-settings":"'tnum' on, 'lnum' on, 'case' on","--wcm-success-color":"rgb(38,181,98)","--wcm-error-color":"rgb(242, 90, 103)","--wcm-overlay-background-color":"rgba(0, 0, 0, 0.3)","--wcm-overlay-backdrop-filter":"none"}[e]),setTheme(){const e=document.querySelector(":root"),{themeVariables:t}=GD.state;if(e){const r=tH(tH(tH({},function(){var e;const t={light:{foreground:{1:"rgb(20,20,20)",2:"rgb(121,134,134)",3:"rgb(158,169,169)"},background:{1:"rgb(255,255,255)",2:"rgb(241,243,243)",3:"rgb(228,231,231)"},overlay:"rgba(0,0,0,0.1)"},dark:{foreground:{1:"rgb(228,231,231)",2:"rgb(148,158,158)",3:"rgb(110,119,119)"},background:{1:"rgb(20,20,20)",2:"rgb(39,42,42)",3:"rgb(59,64,64)"},overlay:"rgba(255,255,255,0.1)"}}[null!=(e=GD.state.themeMode)?e:"dark"];return{"--wcm-color-fg-1":t.foreground[1],"--wcm-color-fg-2":t.foreground[2],"--wcm-color-fg-3":t.foreground[3],"--wcm-color-bg-1":t.background[1],"--wcm-color-bg-2":t.background[2],"--wcm-color-bg-3":t.background[3],"--wcm-color-overlay":t.overlay}}()),{"--wcm-accent-color":"#3396FF","--wcm-accent-fill-color":"#FFFFFF","--wcm-z-index":"89","--wcm-background-color":"#3396FF","--wcm-background-border-radius":"8px","--wcm-container-border-radius":"30px","--wcm-wallet-icon-border-radius":"15px","--wcm-wallet-icon-large-border-radius":"30px","--wcm-wallet-icon-small-border-radius":"7px","--wcm-input-border-radius":"28px","--wcm-button-border-radius":"10px","--wcm-notification-border-radius":"36px","--wcm-secondary-button-border-radius":"28px","--wcm-icon-button-border-radius":"50%","--wcm-button-hover-highlight-border-radius":"10px","--wcm-text-big-bold-size":"20px","--wcm-text-big-bold-weight":"600","--wcm-text-big-bold-line-height":"24px","--wcm-text-big-bold-letter-spacing":"-0.03em","--wcm-text-big-bold-text-transform":"none","--wcm-text-xsmall-bold-size":"10px","--wcm-text-xsmall-bold-weight":"700","--wcm-text-xsmall-bold-line-height":"12px","--wcm-text-xsmall-bold-letter-spacing":"0.02em","--wcm-text-xsmall-bold-text-transform":"uppercase","--wcm-text-xsmall-regular-size":"12px","--wcm-text-xsmall-regular-weight":"600","--wcm-text-xsmall-regular-line-height":"14px","--wcm-text-xsmall-regular-letter-spacing":"-0.03em","--wcm-text-xsmall-regular-text-transform":"none","--wcm-text-small-thin-size":"14px","--wcm-text-small-thin-weight":"500","--wcm-text-small-thin-line-height":"16px","--wcm-text-small-thin-letter-spacing":"-0.03em","--wcm-text-small-thin-text-transform":"none","--wcm-text-small-regular-size":"14px","--wcm-text-small-regular-weight":"600","--wcm-text-small-regular-line-height":"16px","--wcm-text-small-regular-letter-spacing":"-0.03em","--wcm-text-small-regular-text-transform":"none","--wcm-text-medium-regular-size":"16px","--wcm-text-medium-regular-weight":"600","--wcm-text-medium-regular-line-height":"20px","--wcm-text-medium-regular-letter-spacing":"-0.03em","--wcm-text-medium-regular-text-transform":"none","--wcm-font-family":"-apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Roboto, Ubuntu, 'Helvetica Neue', sans-serif","--wcm-font-feature-settings":"'tnum' on, 'lnum' on, 'case' on","--wcm-success-color":"rgb(38,181,98)","--wcm-error-color":"rgb(242, 90, 103)","--wcm-overlay-background-color":"rgba(0, 0, 0, 0.3)","--wcm-overlay-backdrop-filter":"none"}),t);Object.entries(r).forEach(([t,r])=>e.style.setProperty(t,r))}},globalCss:n$`*,::after,::before{margin:0;padding:0;box-sizing:border-box;font-style:normal;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-tap-highlight-color:transparent;backface-visibility:hidden}button{cursor:pointer;display:flex;justify-content:center;align-items:center;position:relative;border:none;background-color:transparent;transition:all .2s ease}@media (hover:hover) and (pointer:fine){button:active{transition:all .1s ease;transform:scale(.93)}}button::after{content:'';position:absolute;top:0;bottom:0;left:0;right:0;transition:background-color,.2s ease}button:disabled{cursor:not-allowed}button svg,button wcm-text{position:relative;z-index:1}input{border:none;outline:0;appearance:none}img{display:block}::selection{color:var(--wcm-accent-fill-color);background:var(--wcm-accent-color)}`},nH=n$`button{border-radius:var(--wcm-secondary-button-border-radius);height:28px;padding:0 10px;background-color:var(--wcm-accent-color)}button path{fill:var(--wcm-accent-fill-color)}button::after{border-radius:inherit;border:1px solid var(--wcm-color-overlay)}button:disabled::after{background-color:transparent}.wcm-icon-left svg{margin-right:5px}.wcm-icon-right svg{margin-left:5px}button:active::after{background-color:var(--wcm-color-overlay)}.wcm-ghost,.wcm-ghost:active::after,.wcm-outline{background-color:transparent}.wcm-ghost:active{opacity:.5}@media(hover:hover){button:hover::after{background-color:var(--wcm-color-overlay)}.wcm-ghost:hover::after{background-color:transparent}.wcm-ghost:hover{opacity:.5}}button:disabled{background-color:var(--wcm-color-bg-3);pointer-events:none}.wcm-ghost::after{border-color:transparent}.wcm-ghost path{fill:var(--wcm-color-fg-2)}.wcm-outline path{fill:var(--wcm-accent-color)}.wcm-outline:disabled{background-color:transparent;opacity:.5}`;var iH=Object.defineProperty,oH=Object.getOwnPropertyDescriptor,sH=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?oH(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&iH(t,r,o),o};let aH=class extends nM{constructor(){super(...arguments),this.disabled=!1,this.iconLeft=void 0,this.iconRight=void 0,this.onClick=()=>null,this.variant="default"}render(){const e={"wcm-icon-left":void 0!==this.iconLeft,"wcm-icon-right":void 0!==this.iconRight,"wcm-ghost":"ghost"===this.variant,"wcm-outline":"outline"===this.variant};let t="inverse";return"ghost"===this.variant&&(t="secondary"),"outline"===this.variant&&(t="accent"),L$`<button class="${fM(e)}" ?disabled="${this.disabled}" @click="${this.onClick}">${this.iconLeft}<wcm-text variant="small-regular" color="${t}"><slot></slot></wcm-text>${this.iconRight}</button>`}};aH.styles=[rH.globalCss,nH],sH([aM({type:Boolean})],aH.prototype,"disabled",2),sH([aM()],aH.prototype,"iconLeft",2),sH([aM()],aH.prototype,"iconRight",2),sH([aM()],aH.prototype,"onClick",2),sH([aM()],aH.prototype,"variant",2),aH=sH([oM("wcm-button")],aH);const cH=n$`:host{display:inline-block}button{padding:0 15px 1px;height:40px;border-radius:var(--wcm-button-border-radius);color:var(--wcm-accent-fill-color);background-color:var(--wcm-accent-color)}button::after{content:'';top:0;bottom:0;left:0;right:0;position:absolute;background-color:transparent;border-radius:inherit;transition:background-color .2s ease;border:1px solid var(--wcm-color-overlay)}button:active::after{background-color:var(--wcm-color-overlay)}button:disabled{padding-bottom:0;background-color:var(--wcm-color-bg-3);color:var(--wcm-color-fg-3)}.wcm-secondary{color:var(--wcm-accent-color);background-color:transparent}.wcm-secondary::after{display:none}@media(hover:hover){button:hover::after{background-color:var(--wcm-color-overlay)}}`;var lH=Object.defineProperty,uH=Object.getOwnPropertyDescriptor,hH=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?uH(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&lH(t,r,o),o};let dH=class extends nM{constructor(){super(...arguments),this.disabled=!1,this.variant="primary"}render(){const e={"wcm-secondary":"secondary"===this.variant};return L$`<button ?disabled="${this.disabled}" class="${fM(e)}"><slot></slot></button>`}};dH.styles=[rH.globalCss,cH],hH([aM({type:Boolean})],dH.prototype,"disabled",2),hH([aM()],dH.prototype,"variant",2),dH=hH([oM("wcm-button-big")],dH);const fH=n$`:host{background-color:var(--wcm-color-bg-2);border-top:1px solid var(--wcm-color-bg-3)}div{padding:10px 20px;display:inherit;flex-direction:inherit;align-items:inherit;width:inherit;justify-content:inherit}`;var pH=Object.getOwnPropertyDescriptor;let gH=class extends nM{render(){return L$`<div><slot></slot></div>`}};gH.styles=[rH.globalCss,fH],gH=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?pH(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=i(o)||o);return o})([oM("wcm-info-footer")],gH);const mH={CROSS_ICON:D$`<svg width="12" height="12" viewBox="0 0 12 12"><path d="M9.94 11A.75.75 0 1 0 11 9.94L7.414 6.353a.5.5 0 0 1 0-.708L11 2.061A.75.75 0 1 0 9.94 1L6.353 4.586a.5.5 0 0 1-.708 0L2.061 1A.75.75 0 0 0 1 2.06l3.586 3.586a.5.5 0 0 1 0 .708L1 9.939A.75.75 0 1 0 2.06 11l3.586-3.586a.5.5 0 0 1 .708 0L9.939 11Z" fill="#fff"/></svg>`,WALLET_CONNECT_LOGO:D$`<svg width="178" height="29" viewBox="0 0 178 29" id="wcm-wc-logo"><path d="M10.683 7.926c5.284-5.17 13.85-5.17 19.134 0l.636.623a.652.652 0 0 1 0 .936l-2.176 2.129a.343.343 0 0 1-.478 0l-.875-.857c-3.686-3.607-9.662-3.607-13.348 0l-.937.918a.343.343 0 0 1-.479 0l-2.175-2.13a.652.652 0 0 1 0-.936l.698-.683Zm23.633 4.403 1.935 1.895a.652.652 0 0 1 0 .936l-8.73 8.543a.687.687 0 0 1-.956 0L20.37 17.64a.172.172 0 0 0-.239 0l-6.195 6.063a.687.687 0 0 1-.957 0l-8.73-8.543a.652.652 0 0 1 0-.936l1.936-1.895a.687.687 0 0 1 .957 0l6.196 6.064a.172.172 0 0 0 .239 0l6.195-6.064a.687.687 0 0 1 .957 0l6.196 6.064a.172.172 0 0 0 .24 0l6.195-6.064a.687.687 0 0 1 .956 0ZM48.093 20.948l2.338-9.355c.139-.515.258-1.07.416-1.942.12.872.258 1.427.357 1.942l2.022 9.355h4.181l3.528-13.874h-3.21l-1.943 8.523a24.825 24.825 0 0 0-.456 2.457c-.158-.931-.317-1.625-.495-2.438l-1.883-8.542h-4.201l-2.042 8.542a41.204 41.204 0 0 0-.475 2.438 41.208 41.208 0 0 0-.476-2.438l-1.903-8.542h-3.349l3.508 13.874h4.083ZM63.33 21.304c1.585 0 2.596-.654 3.11-1.605-.059.297-.078.595-.078.892v.357h2.655V15.22c0-2.735-1.248-4.32-4.3-4.32-2.636 0-4.36 1.466-4.52 3.487h2.914c.1-.891.734-1.426 1.705-1.426.911 0 1.407.515 1.407 1.11 0 .435-.258.693-1.03.792l-1.388.159c-2.061.257-3.825 1.01-3.825 3.19 0 1.982 1.645 3.092 3.35 3.092Zm.891-2.041c-.773 0-1.348-.436-1.348-1.19 0-.733.655-1.09 1.645-1.268l.674-.119c.575-.118.892-.218 1.09-.396v.912c0 1.228-.892 2.06-2.06 2.06ZM70.398 7.074v13.874h2.874V7.074h-2.874ZM74.934 7.074v13.874h2.874V7.074h-2.874ZM84.08 21.304c2.735 0 4.5-1.546 4.697-3.567h-2.893c-.139.892-.892 1.387-1.804 1.387-1.228 0-2.12-.99-2.14-2.358h6.897v-.555c0-3.21-1.764-5.312-4.816-5.312-2.933 0-4.994 2.062-4.994 5.173 0 3.37 2.12 5.232 5.053 5.232Zm-2.16-6.421c.119-1.11.932-1.922 2.081-1.922 1.11 0 1.883.772 1.903 1.922H81.92ZM94.92 21.146c.633 0 1.248-.1 1.525-.179v-2.18c-.218.04-.475.06-.693.06-1.05 0-1.427-.595-1.427-1.566v-3.805h2.338v-2.24h-2.338V7.788H91.47v3.448H89.37v2.24h2.1v4.201c0 2.3 1.15 3.469 3.45 3.469ZM104.62 21.304c3.924 0 6.302-2.299 6.599-5.608h-3.111c-.238 1.803-1.506 3.032-3.369 3.032-2.2 0-3.746-1.784-3.746-4.796 0-2.953 1.605-4.638 3.805-4.638 1.883 0 2.953 1.15 3.171 2.834h3.191c-.317-3.448-2.854-5.41-6.342-5.41-3.984 0-7.036 2.695-7.036 7.214 0 4.677 2.676 7.372 6.838 7.372ZM117.449 21.304c2.993 0 5.114-1.882 5.114-5.172 0-3.23-2.121-5.233-5.114-5.233-2.972 0-5.093 2.002-5.093 5.233 0 3.29 2.101 5.172 5.093 5.172Zm0-2.22c-1.327 0-2.18-1.09-2.18-2.952 0-1.903.892-2.973 2.18-2.973 1.308 0 2.2 1.07 2.2 2.973 0 1.862-.872 2.953-2.2 2.953ZM126.569 20.948v-5.689c0-1.208.753-2.1 1.823-2.1 1.011 0 1.606.773 1.606 2.06v5.729h2.873v-6.144c0-2.339-1.229-3.905-3.428-3.905-1.526 0-2.458.734-2.953 1.606a5.31 5.31 0 0 0 .079-.892v-.377h-2.874v9.712h2.874ZM137.464 20.948v-5.689c0-1.208.753-2.1 1.823-2.1 1.011 0 1.606.773 1.606 2.06v5.729h2.873v-6.144c0-2.339-1.228-3.905-3.428-3.905-1.526 0-2.458.734-2.953 1.606a5.31 5.31 0 0 0 .079-.892v-.377h-2.874v9.712h2.874ZM149.949 21.304c2.735 0 4.499-1.546 4.697-3.567h-2.893c-.139.892-.892 1.387-1.804 1.387-1.228 0-2.12-.99-2.14-2.358h6.897v-.555c0-3.21-1.764-5.312-4.816-5.312-2.933 0-4.994 2.062-4.994 5.173 0 3.37 2.12 5.232 5.053 5.232Zm-2.16-6.421c.119-1.11.932-1.922 2.081-1.922 1.11 0 1.883.772 1.903 1.922h-3.984ZM160.876 21.304c3.013 0 4.658-1.645 4.975-4.201h-2.874c-.099 1.07-.713 1.982-2.001 1.982-1.309 0-2.2-1.21-2.2-2.993 0-1.942 1.03-2.933 2.259-2.933 1.209 0 1.803.872 1.883 1.882h2.873c-.218-2.358-1.823-4.142-4.776-4.142-2.874 0-5.153 1.903-5.153 5.193 0 3.25 1.923 5.212 5.014 5.212ZM172.067 21.146c.634 0 1.248-.1 1.526-.179v-2.18c-.218.04-.476.06-.694.06-1.05 0-1.427-.595-1.427-1.566v-3.805h2.339v-2.24h-2.339V7.788h-2.854v3.448h-2.1v2.24h2.1v4.201c0 2.3 1.15 3.469 3.449 3.469Z" fill="#fff"/></svg>`,WALLET_CONNECT_ICON:D$`<svg width="28" height="20" viewBox="0 0 28 20"><g clip-path="url(#a)"><path d="M7.386 6.482c3.653-3.576 9.575-3.576 13.228 0l.44.43a.451.451 0 0 1 0 .648L19.55 9.033a.237.237 0 0 1-.33 0l-.606-.592c-2.548-2.496-6.68-2.496-9.228 0l-.648.634a.237.237 0 0 1-.33 0L6.902 7.602a.451.451 0 0 1 0-.647l.483-.473Zm16.338 3.046 1.339 1.31a.451.451 0 0 1 0 .648l-6.035 5.909a.475.475 0 0 1-.662 0L14.083 13.2a.119.119 0 0 0-.166 0l-4.283 4.194a.475.475 0 0 1-.662 0l-6.035-5.91a.451.451 0 0 1 0-.647l1.338-1.31a.475.475 0 0 1 .662 0l4.283 4.194c.046.044.12.044.166 0l4.283-4.194a.475.475 0 0 1 .662 0l4.283 4.194c.046.044.12.044.166 0l4.283-4.194a.475.475 0 0 1 .662 0Z" fill="#000000"/></g><defs><clipPath id="a"><path fill="#ffffff" d="M0 0h28v20H0z"/></clipPath></defs></svg>`,WALLET_CONNECT_ICON_COLORED:D$`<svg width="96" height="96" fill="none"><path fill="#fff" d="M25.322 33.597c12.525-12.263 32.83-12.263 45.355 0l1.507 1.476a1.547 1.547 0 0 1 0 2.22l-5.156 5.048a.814.814 0 0 1-1.134 0l-2.074-2.03c-8.737-8.555-22.903-8.555-31.64 0l-2.222 2.175a.814.814 0 0 1-1.134 0l-5.156-5.049a1.547 1.547 0 0 1 0-2.22l1.654-1.62Zm56.019 10.44 4.589 4.494a1.547 1.547 0 0 1 0 2.22l-20.693 20.26a1.628 1.628 0 0 1-2.267 0L48.283 56.632a.407.407 0 0 0-.567 0L33.03 71.012a1.628 1.628 0 0 1-2.268 0L10.07 50.75a1.547 1.547 0 0 1 0-2.22l4.59-4.494a1.628 1.628 0 0 1 2.267 0l14.687 14.38c.156.153.41.153.567 0l14.685-14.38a1.628 1.628 0 0 1 2.268 0l14.687 14.38c.156.153.41.153.567 0l14.686-14.38a1.628 1.628 0 0 1 2.268 0Z"/><path stroke="#000" d="M25.672 33.954c12.33-12.072 32.325-12.072 44.655 0l1.508 1.476a1.047 1.047 0 0 1 0 1.506l-5.157 5.048a.314.314 0 0 1-.434 0l-2.074-2.03c-8.932-8.746-23.409-8.746-32.34 0l-2.222 2.174a.314.314 0 0 1-.434 0l-5.157-5.048a1.047 1.047 0 0 1 0-1.506l1.655-1.62Zm55.319 10.44 4.59 4.494a1.047 1.047 0 0 1 0 1.506l-20.694 20.26a1.128 1.128 0 0 1-1.568 0l-14.686-14.38a.907.907 0 0 0-1.267 0L32.68 70.655a1.128 1.128 0 0 1-1.568 0L10.42 50.394a1.047 1.047 0 0 1 0-1.506l4.59-4.493a1.128 1.128 0 0 1 1.567 0l14.687 14.379a.907.907 0 0 0 1.266 0l-.35-.357.35.357 14.686-14.38a1.128 1.128 0 0 1 1.568 0l14.687 14.38a.907.907 0 0 0 1.267 0l14.686-14.38a1.128 1.128 0 0 1 1.568 0Z"/></svg>`,BACK_ICON:D$`<svg width="10" height="18" viewBox="0 0 10 18"><path fill-rule="evenodd" clip-rule="evenodd" d="M8.735.179a.75.75 0 0 1 .087 1.057L2.92 8.192a1.25 1.25 0 0 0 0 1.617l5.902 6.956a.75.75 0 1 1-1.144.97L1.776 10.78a2.75 2.75 0 0 1 0-3.559L7.678.265A.75.75 0 0 1 8.735.18Z" fill="#fff"/></svg>`,COPY_ICON:D$`<svg width="24" height="24" fill="none"><path fill="#fff" fill-rule="evenodd" d="M7.01 7.01c.03-1.545.138-2.5.535-3.28A5 5 0 0 1 9.73 1.545C10.8 1 12.2 1 15 1c2.8 0 4.2 0 5.27.545a5 5 0 0 1 2.185 2.185C23 4.8 23 6.2 23 9c0 2.8 0 4.2-.545 5.27a5 5 0 0 1-2.185 2.185c-.78.397-1.735.505-3.28.534l-.001.01c-.03 1.54-.138 2.493-.534 3.27a5 5 0 0 1-2.185 2.186C13.2 23 11.8 23 9 23c-2.8 0-4.2 0-5.27-.545a5 5 0 0 1-2.185-2.185C1 19.2 1 17.8 1 15c0-2.8 0-4.2.545-5.27A5 5 0 0 1 3.73 7.545C4.508 7.149 5.46 7.04 7 7.01h.01ZM15 15.5c-1.425 0-2.403-.001-3.162-.063-.74-.06-1.139-.172-1.427-.319a3.5 3.5 0 0 1-1.53-1.529c-.146-.288-.257-.686-.318-1.427C8.501 11.403 8.5 10.425 8.5 9c0-1.425.001-2.403.063-3.162.06-.74.172-1.139.318-1.427a3.5 3.5 0 0 1 1.53-1.53c.288-.146.686-.257 1.427-.318.759-.062 1.737-.063 3.162-.063 1.425 0 2.403.001 3.162.063.74.06 1.139.172 1.427.318a3.5 3.5 0 0 1 1.53 1.53c.146.288.257.686.318 1.427.062.759.063 1.737.063 3.162 0 1.425-.001 2.403-.063 3.162-.06.74-.172 1.139-.319 1.427a3.5 3.5 0 0 1-1.529 1.53c-.288.146-.686.257-1.427.318-.759.062-1.737.063-3.162.063ZM7 8.511c-.444.009-.825.025-1.162.052-.74.06-1.139.172-1.427.318a3.5 3.5 0 0 0-1.53 1.53c-.146.288-.257.686-.318 1.427-.062.759-.063 1.737-.063 3.162 0 1.425.001 2.403.063 3.162.06.74.172 1.139.318 1.427a3.5 3.5 0 0 0 1.53 1.53c.288.146.686.257 1.427.318.759.062 1.737.063 3.162.063 1.425 0 2.403-.001 3.162-.063.74-.06 1.139-.172 1.427-.319a3.5 3.5 0 0 0 1.53-1.53c.146-.287.257-.685.318-1.426.027-.337.043-.718.052-1.162H15c-2.8 0-4.2 0-5.27-.545a5 5 0 0 1-2.185-2.185C7 13.2 7 11.8 7 9v-.489Z" clip-rule="evenodd"/></svg>`,RETRY_ICON:D$`<svg width="15" height="16" viewBox="0 0 15 16"><path d="M6.464 2.03A.75.75 0 0 0 5.403.97L2.08 4.293a1 1 0 0 0 0 1.414L5.403 9.03a.75.75 0 0 0 1.06-1.06L4.672 6.177a.25.25 0 0 1 .177-.427h2.085a4 4 0 1 1-3.93 4.746c-.077-.407-.405-.746-.82-.746-.414 0-.755.338-.7.748a5.501 5.501 0 1 0 5.45-6.248H4.848a.25.25 0 0 1-.177-.427L6.464 2.03Z" fill="#fff"/></svg>`,DESKTOP_ICON:D$`<svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 5.98c0-1.85 0-2.775.394-3.466a3 3 0 0 1 1.12-1.12C2.204 1 3.13 1 4.98 1h6.04c1.85 0 2.775 0 3.466.394a3 3 0 0 1 1.12 1.12C16 3.204 16 4.13 16 5.98v1.04c0 1.85 0 2.775-.394 3.466a3 3 0 0 1-1.12 1.12C13.796 12 12.87 12 11.02 12H4.98c-1.85 0-2.775 0-3.466-.394a3 3 0 0 1-1.12-1.12C0 9.796 0 8.87 0 7.02V5.98ZM4.98 2.5h6.04c.953 0 1.568.001 2.034.043.446.04.608.108.69.154a1.5 1.5 0 0 1 .559.56c.046.08.114.243.154.69.042.465.043 1.08.043 2.033v1.04c0 .952-.001 1.568-.043 2.034-.04.446-.108.608-.154.69a1.499 1.499 0 0 1-.56.559c-.08.046-.243.114-.69.154-.466.042-1.08.043-2.033.043H4.98c-.952 0-1.568-.001-2.034-.043-.446-.04-.608-.108-.69-.154a1.5 1.5 0 0 1-.559-.56c-.046-.08-.114-.243-.154-.69-.042-.465-.043-1.08-.043-2.033V5.98c0-.952.001-1.568.043-2.034.04-.446.108-.608.154-.69a1.5 1.5 0 0 1 .56-.559c.08-.046.243-.114.69-.154.465-.042 1.08-.043 2.033-.043Z" fill="#fff"/><path d="M4 14.25a.75.75 0 0 1 .75-.75h6.5a.75.75 0 0 1 0 1.5h-6.5a.75.75 0 0 1-.75-.75Z" fill="#fff"/></svg>`,MOBILE_ICON:D$`<svg width="16" height="16" viewBox="0 0 16 16"><path d="M6.75 5a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5Z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M3 4.98c0-1.85 0-2.775.394-3.466a3 3 0 0 1 1.12-1.12C5.204 0 6.136 0 8 0s2.795 0 3.486.394a3 3 0 0 1 1.12 1.12C13 2.204 13 3.13 13 4.98v6.04c0 1.85 0 2.775-.394 3.466a3 3 0 0 1-1.12 1.12C10.796 16 9.864 16 8 16s-2.795 0-3.486-.394a3 3 0 0 1-1.12-1.12C3 13.796 3 12.87 3 11.02V4.98Zm8.5 0v6.04c0 .953-.001 1.568-.043 2.034-.04.446-.108.608-.154.69a1.499 1.499 0 0 1-.56.559c-.08.045-.242.113-.693.154-.47.042-1.091.043-2.05.043-.959 0-1.58-.001-2.05-.043-.45-.04-.613-.109-.693-.154a1.5 1.5 0 0 1-.56-.56c-.046-.08-.114-.243-.154-.69-.042-.466-.043-1.08-.043-2.033V4.98c0-.952.001-1.568.043-2.034.04-.446.108-.608.154-.69a1.5 1.5 0 0 1 .56-.559c.08-.045.243-.113.693-.154C6.42 1.501 7.041 1.5 8 1.5c.959 0 1.58.001 2.05.043.45.04.613.109.693.154a1.5 1.5 0 0 1 .56.56c.046.08.114.243.154.69.042.465.043 1.08.043 2.033Z" fill="#fff"/></svg>`,ARROW_DOWN_ICON:D$`<svg width="14" height="14" viewBox="0 0 14 14"><path d="M2.28 7.47a.75.75 0 0 0-1.06 1.06l5.25 5.25a.75.75 0 0 0 1.06 0l5.25-5.25a.75.75 0 0 0-1.06-1.06l-3.544 3.543a.25.25 0 0 1-.426-.177V.75a.75.75 0 0 0-1.5 0v10.086a.25.25 0 0 1-.427.176L2.28 7.47Z" fill="#fff"/></svg>`,ARROW_UP_RIGHT_ICON:D$`<svg width="15" height="14" fill="none"><path d="M4.5 1.75A.75.75 0 0 1 5.25 1H12a1.5 1.5 0 0 1 1.5 1.5v6.75a.75.75 0 0 1-1.5 0V4.164a.25.25 0 0 0-.427-.176L4.061 11.5A.75.75 0 0 1 3 10.44l7.513-7.513a.25.25 0 0 0-.177-.427H5.25a.75.75 0 0 1-.75-.75Z" fill="#fff"/></svg>`,ARROW_RIGHT_ICON:D$`<svg width="6" height="14" viewBox="0 0 6 14"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.181 1.099a.75.75 0 0 1 1.024.279l2.433 4.258a2.75 2.75 0 0 1 0 2.729l-2.433 4.257a.75.75 0 1 1-1.303-.744L4.335 7.62a1.25 1.25 0 0 0 0-1.24L1.902 2.122a.75.75 0 0 1 .28-1.023Z" fill="#fff"/></svg>`,QRCODE_ICON:D$`<svg width="25" height="24" viewBox="0 0 25 24"><path d="M23.748 9a.748.748 0 0 0 .748-.752c-.018-2.596-.128-4.07-.784-5.22a6 6 0 0 0-2.24-2.24c-1.15-.656-2.624-.766-5.22-.784a.748.748 0 0 0-.752.748c0 .414.335.749.748.752 1.015.007 1.82.028 2.494.088.995.09 1.561.256 1.988.5.7.398 1.28.978 1.679 1.678.243.427.41.993.498 1.988.061.675.082 1.479.09 2.493a.753.753 0 0 0 .75.749ZM3.527.788C4.677.132 6.152.022 8.747.004A.748.748 0 0 1 9.5.752a.753.753 0 0 1-.749.752c-1.014.007-1.818.028-2.493.088-.995.09-1.561.256-1.988.5-.7.398-1.28.978-1.679 1.678-.243.427-.41.993-.499 1.988-.06.675-.081 1.479-.088 2.493A.753.753 0 0 1 1.252 9a.748.748 0 0 1-.748-.752c.018-2.596.128-4.07.784-5.22a6 6 0 0 1 2.24-2.24ZM1.252 15a.748.748 0 0 0-.748.752c.018 2.596.128 4.07.784 5.22a6 6 0 0 0 2.24 2.24c1.15.656 2.624.766 5.22.784a.748.748 0 0 0 .752-.748.753.753 0 0 0-.749-.752c-1.014-.007-1.818-.028-2.493-.089-.995-.089-1.561-.255-1.988-.498a4.5 4.5 0 0 1-1.679-1.68c-.243-.426-.41-.992-.499-1.987-.06-.675-.081-1.479-.088-2.493A.753.753 0 0 0 1.252 15ZM22.996 15.749a.753.753 0 0 1 .752-.749c.415 0 .751.338.748.752-.018 2.596-.128 4.07-.784 5.22a6 6 0 0 1-2.24 2.24c-1.15.656-2.624.766-5.22.784a.748.748 0 0 1-.752-.748c0-.414.335-.749.748-.752 1.015-.007 1.82-.028 2.494-.089.995-.089 1.561-.255 1.988-.498a4.5 4.5 0 0 0 1.679-1.68c.243-.426.41-.992.498-1.987.061-.675.082-1.479.09-2.493Z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M7 4a2.5 2.5 0 0 0-2.5 2.5v2A2.5 2.5 0 0 0 7 11h2a2.5 2.5 0 0 0 2.5-2.5v-2A2.5 2.5 0 0 0 9 4H7Zm2 1.5H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1ZM13.5 6.5A2.5 2.5 0 0 1 16 4h2a2.5 2.5 0 0 1 2.5 2.5v2A2.5 2.5 0 0 1 18 11h-2a2.5 2.5 0 0 1-2.5-2.5v-2Zm2.5-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1ZM7 13a2.5 2.5 0 0 0-2.5 2.5v2A2.5 2.5 0 0 0 7 20h2a2.5 2.5 0 0 0 2.5-2.5v-2A2.5 2.5 0 0 0 9 13H7Zm2 1.5H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1Z" fill="#fff"/><path d="M13.5 15.5c0-.465 0-.697.038-.89a2 2 0 0 1 1.572-1.572C15.303 13 15.535 13 16 13v2.5h-2.5ZM18 13c.465 0 .697 0 .89.038a2 2 0 0 1 1.572 1.572c.038.193.038.425.038.89H18V13ZM18 17.5h2.5c0 .465 0 .697-.038.89a2 2 0 0 1-1.572 1.572C18.697 20 18.465 20 18 20v-2.5ZM13.5 17.5H16V20c-.465 0-.697 0-.89-.038a2 2 0 0 1-1.572-1.572c-.038-.193-.038-.425-.038-.89Z" fill="#fff"/></svg>`,SCAN_ICON:D$`<svg width="16" height="16" fill="none"><path fill="#fff" d="M10 15.216c0 .422.347.763.768.74 1.202-.064 2.025-.222 2.71-.613a5.001 5.001 0 0 0 1.865-1.866c.39-.684.549-1.507.613-2.709a.735.735 0 0 0-.74-.768.768.768 0 0 0-.76.732c-.009.157-.02.306-.032.447-.073.812-.206 1.244-.384 1.555-.31.545-.761.996-1.306 1.306-.311.178-.743.311-1.555.384-.141.013-.29.023-.447.032a.768.768 0 0 0-.732.76ZM10 .784c0 .407.325.737.732.76.157.009.306.02.447.032.812.073 1.244.206 1.555.384a3.5 3.5 0 0 1 1.306 1.306c.178.311.311.743.384 1.555.013.142.023.29.032.447a.768.768 0 0 0 .76.732.734.734 0 0 0 .74-.768c-.064-1.202-.222-2.025-.613-2.71A5 5 0 0 0 13.477.658c-.684-.39-1.507-.549-2.709-.613a.735.735 0 0 0-.768.74ZM5.232.044A.735.735 0 0 1 6 .784a.768.768 0 0 1-.732.76c-.157.009-.305.02-.447.032-.812.073-1.244.206-1.555.384A3.5 3.5 0 0 0 1.96 3.266c-.178.311-.311.743-.384 1.555-.013.142-.023.29-.032.447A.768.768 0 0 1 .784 6a.735.735 0 0 1-.74-.768c.064-1.202.222-2.025.613-2.71A5 5 0 0 1 2.523.658C3.207.267 4.03.108 5.233.044ZM5.268 14.456a.768.768 0 0 1 .732.76.734.734 0 0 1-.768.74c-1.202-.064-2.025-.222-2.71-.613a5 5 0 0 1-1.865-1.866c-.39-.684-.549-1.507-.613-2.709A.735.735 0 0 1 .784 10c.407 0 .737.325.76.732.009.157.02.306.032.447.073.812.206 1.244.384 1.555a3.5 3.5 0 0 0 1.306 1.306c.311.178.743.311 1.555.384.142.013.29.023.447.032Z"/></svg>`,CHECKMARK_ICON:D$`<svg width="13" height="12" viewBox="0 0 13 12"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.155.132a.75.75 0 0 1 .232 1.035L5.821 11.535a1 1 0 0 1-1.626.09L.665 7.21a.75.75 0 1 1 1.17-.937L4.71 9.867a.25.25 0 0 0 .406-.023L11.12.364a.75.75 0 0 1 1.035-.232Z" fill="#fff"/></svg>`,SEARCH_ICON:D$`<svg width="20" height="21"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.432 13.992c-.354-.353-.91-.382-1.35-.146a5.5 5.5 0 1 1 2.265-2.265c-.237.441-.208.997.145 1.35l3.296 3.296a.75.75 0 1 1-1.06 1.061l-3.296-3.296Zm.06-5a4 4 0 1 1-8 0 4 4 0 0 1 8 0Z" fill="#949E9E"/></svg>`,WALLET_PLACEHOLDER:D$`<svg width="60" height="60" fill="none" viewBox="0 0 60 60"><g clip-path="url(#q)"><path id="wallet-placeholder-fill" fill="#fff" d="M0 24.9c0-9.251 0-13.877 1.97-17.332a15 15 0 0 1 5.598-5.597C11.023 0 15.648 0 24.9 0h10.2c9.252 0 13.877 0 17.332 1.97a15 15 0 0 1 5.597 5.598C60 11.023 60 15.648 60 24.9v10.2c0 9.252 0 13.877-1.97 17.332a15.001 15.001 0 0 1-5.598 5.597C48.977 60 44.352 60 35.1 60H24.9c-9.251 0-13.877 0-17.332-1.97a15 15 0 0 1-5.597-5.598C0 48.977 0 44.352 0 35.1V24.9Z"/><path id="wallet-placeholder-dash" stroke="#000" stroke-dasharray="4 4" stroke-width="1.5" d="M.04 41.708a231.598 231.598 0 0 1-.039-4.403l.75-.001L.75 35.1v-2.55H0v-5.1h.75V24.9l.001-2.204h-.75c.003-1.617.011-3.077.039-4.404l.75.016c.034-1.65.099-3.08.218-4.343l-.746-.07c.158-1.678.412-3.083.82-4.316l.713.236c.224-.679.497-1.296.827-1.875a14.25 14.25 0 0 1 1.05-1.585L3.076 5.9A15 15 0 0 1 5.9 3.076l.455.596a14.25 14.25 0 0 1 1.585-1.05c.579-.33 1.196-.603 1.875-.827l-.236-.712C10.812.674 12.217.42 13.895.262l.07.746C15.23.89 16.66.824 18.308.79l-.016-.75C19.62.012 21.08.004 22.695.001l.001.75L24.9.75h2.55V0h5.1v.75h2.55l2.204.001v-.75c1.617.003 3.077.011 4.404.039l-.016.75c1.65.034 3.08.099 4.343.218l.07-.746c1.678.158 3.083.412 4.316.82l-.236.713c.679.224 1.296.497 1.875.827a14.24 14.24 0 0 1 1.585 1.05l.455-.596A14.999 14.999 0 0 1 56.924 5.9l-.596.455c.384.502.735 1.032 1.05 1.585.33.579.602 1.196.827 1.875l.712-.236c.409 1.233.663 2.638.822 4.316l-.747.07c.119 1.264.184 2.694.218 4.343l.75-.016c.028 1.327.036 2.787.039 4.403l-.75.001.001 2.204v2.55H60v5.1h-.75v2.55l-.001 2.204h.75a231.431 231.431 0 0 1-.039 4.404l-.75-.016c-.034 1.65-.099 3.08-.218 4.343l.747.07c-.159 1.678-.413 3.083-.822 4.316l-.712-.236a10.255 10.255 0 0 1-.827 1.875 14.242 14.242 0 0 1-1.05 1.585l.596.455a14.997 14.997 0 0 1-2.824 2.824l-.455-.596c-.502.384-1.032.735-1.585 1.05-.579.33-1.196.602-1.875.827l.236.712c-1.233.409-2.638.663-4.316.822l-.07-.747c-1.264.119-2.694.184-4.343.218l.016.75c-1.327.028-2.787.036-4.403.039l-.001-.75-2.204.001h-2.55V60h-5.1v-.75H24.9l-2.204-.001v.75a231.431 231.431 0 0 1-4.404-.039l.016-.75c-1.65-.034-3.08-.099-4.343-.218l-.07.747c-1.678-.159-3.083-.413-4.316-.822l.236-.712a10.258 10.258 0 0 1-1.875-.827 14.252 14.252 0 0 1-1.585-1.05l-.455.596A14.999 14.999 0 0 1 3.076 54.1l.596-.455a14.24 14.24 0 0 1-1.05-1.585 10.259 10.259 0 0 1-.827-1.875l-.712.236C.674 49.188.42 47.783.262 46.105l.746-.07C.89 44.77.824 43.34.79 41.692l-.75.016Z"/><path fill="#fff" fill-rule="evenodd" d="M35.643 32.145c-.297-.743-.445-1.114-.401-1.275a.42.42 0 0 1 .182-.27c.134-.1.463-.1 1.123-.1.742 0 1.499.046 2.236-.05a6 6 0 0 0 5.166-5.166c.051-.39.051-.855.051-1.784 0-.928 0-1.393-.051-1.783a6 6 0 0 0-5.166-5.165c-.39-.052-.854-.052-1.783-.052h-7.72c-4.934 0-7.401 0-9.244 1.051a8 8 0 0 0-2.985 2.986C16.057 22.28 16.003 24.58 16 29 15.998 31.075 16 33.15 16 35.224A7.778 7.778 0 0 0 23.778 43H28.5c1.394 0 2.09 0 2.67-.116a6 6 0 0 0 4.715-4.714c.115-.58.115-1.301.115-2.744 0-1.31 0-1.964-.114-2.49a4.998 4.998 0 0 0-.243-.792Z" clip-rule="evenodd"/><path fill="#9EA9A9" fill-rule="evenodd" d="M37 18h-7.72c-2.494 0-4.266.002-5.647.126-1.361.122-2.197.354-2.854.728a6.5 6.5 0 0 0-2.425 2.426c-.375.657-.607 1.492-.729 2.853-.11 1.233-.123 2.777-.125 4.867 0 .7 0 1.05.097 1.181.096.13.182.181.343.2.163.02.518-.18 1.229-.581a6.195 6.195 0 0 1 3.053-.8H37c.977 0 1.32-.003 1.587-.038a4.5 4.5 0 0 0 3.874-3.874c.036-.268.039-.611.039-1.588 0-.976-.003-1.319-.038-1.587a4.5 4.5 0 0 0-3.875-3.874C38.32 18.004 37.977 18 37 18Zm-7.364 12.5h-7.414a4.722 4.722 0 0 0-4.722 4.723 6.278 6.278 0 0 0 6.278 6.278H28.5c1.466 0 1.98-.008 2.378-.087a4.5 4.5 0 0 0 3.535-3.536c.08-.397.087-.933.087-2.451 0-1.391-.009-1.843-.08-2.17a3.5 3.5 0 0 0-2.676-2.676c-.328-.072-.762-.08-2.108-.08Z" clip-rule="evenodd"/></g><defs><clipPath id="q"><path fill="#fff" d="M0 0h60v60H0z"/></clipPath></defs></svg>`,GLOBE_ICON:D$`<svg width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="#fff" fill-rule="evenodd" d="M15.5 8a7.5 7.5 0 1 1-15 0 7.5 7.5 0 0 1 15 0Zm-2.113.75c.301 0 .535.264.47.558a6.01 6.01 0 0 1-2.867 3.896c-.203.116-.42-.103-.334-.32.409-1.018.691-2.274.797-3.657a.512.512 0 0 1 .507-.477h1.427Zm.47-2.058c.065.294-.169.558-.47.558H11.96a.512.512 0 0 1-.507-.477c-.106-1.383-.389-2.638-.797-3.656-.087-.217.13-.437.333-.32a6.01 6.01 0 0 1 2.868 3.895Zm-4.402.558c.286 0 .515-.24.49-.525-.121-1.361-.429-2.534-.83-3.393-.279-.6-.549-.93-.753-1.112a.535.535 0 0 0-.724 0c-.204.182-.474.513-.754 1.112-.4.859-.708 2.032-.828 3.393a.486.486 0 0 0 .49.525h2.909Zm-5.415 0c.267 0 .486-.21.507-.477.106-1.383.389-2.638.797-3.656.087-.217-.13-.437-.333-.32a6.01 6.01 0 0 0-2.868 3.895c-.065.294.169.558.47.558H4.04ZM2.143 9.308c-.065-.294.169-.558.47-.558H4.04c.267 0 .486.21.507.477.106 1.383.389 2.639.797 3.657.087.217-.13.436-.333.32a6.01 6.01 0 0 1-2.868-3.896Zm3.913-.033a.486.486 0 0 1 .49-.525h2.909c.286 0 .515.24.49.525-.121 1.361-.428 2.535-.83 3.394-.279.6-.549.93-.753 1.112a.535.535 0 0 1-.724 0c-.204-.182-.474-.513-.754-1.112-.4-.859-.708-2.033-.828-3.394Z" clip-rule="evenodd"/></svg>`},yH=n$`.wcm-toolbar-placeholder{top:0;bottom:0;left:0;right:0;width:100%;position:absolute;display:block;pointer-events:none;height:100px;border-radius:calc(var(--wcm-background-border-radius) * .9);background-color:var(--wcm-background-color);background-position:center;background-size:cover}.wcm-toolbar{height:38px;display:flex;position:relative;margin:5px 15px 5px 5px;justify-content:space-between;align-items:center}.wcm-toolbar img,.wcm-toolbar svg{height:28px;object-position:left center;object-fit:contain}#wcm-wc-logo path{fill:var(--wcm-accent-fill-color)}button{width:28px;height:28px;border-radius:var(--wcm-icon-button-border-radius);border:0;display:flex;justify-content:center;align-items:center;cursor:pointer;background-color:var(--wcm-color-bg-1);box-shadow:0 0 0 1px var(--wcm-color-overlay)}button:active{background-color:var(--wcm-color-bg-2)}button svg{display:block;object-position:center}button path{fill:var(--wcm-color-fg-1)}.wcm-toolbar div{display:flex}@media(hover:hover){button:hover{background-color:var(--wcm-color-bg-2)}}`;var wH=Object.getOwnPropertyDescriptor;let bH=class extends nM{render(){return L$`<div class="wcm-toolbar-placeholder"></div><div class="wcm-toolbar">${mH.WALLET_CONNECT_LOGO} <button @click="${FD.close}">${mH.CROSS_ICON}</button></div>`}};bH.styles=[rH.globalCss,yH],bH=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?wH(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=i(o)||o);return o})([oM("wcm-modal-backcard")],bH);const vH=n$`main{padding:20px;padding-top:0;width:100%}`;var EH=Object.getOwnPropertyDescriptor;let xH=class extends nM{render(){return L$`<main><slot></slot></main>`}};xH.styles=[rH.globalCss,vH],xH=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?EH(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=i(o)||o);return o})([oM("wcm-modal-content")],xH);const IH=n$`footer{padding:10px;display:flex;flex-direction:column;align-items:inherit;justify-content:inherit;border-top:1px solid var(--wcm-color-bg-2)}`;var _H=Object.getOwnPropertyDescriptor;let SH=class extends nM{render(){return L$`<footer><slot></slot></footer>`}};SH.styles=[rH.globalCss,IH],SH=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?_H(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=i(o)||o);return o})([oM("wcm-modal-footer")],SH);const AH=n$`header{display:flex;justify-content:center;align-items:center;padding:20px;position:relative}.wcm-border{border-bottom:1px solid var(--wcm-color-bg-2);margin-bottom:20px}header button{padding:15px 20px}header button:active{opacity:.5}@media(hover:hover){header button:hover{opacity:.5}}.wcm-back-btn{position:absolute;left:0}.wcm-action-btn{position:absolute;right:0}path{fill:var(--wcm-accent-color)}`;var OH=Object.defineProperty,CH=Object.getOwnPropertyDescriptor,PH=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?CH(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&OH(t,r,o),o};let RH=class extends nM{constructor(){super(...arguments),this.title="",this.onAction=void 0,this.actionIcon=void 0,this.border=!1}backBtnTemplate(){return L$`<button class="wcm-back-btn" @click="${pD.goBack}">${mH.BACK_ICON}</button>`}actionBtnTemplate(){return L$`<button class="wcm-action-btn" @click="${this.onAction}">${this.actionIcon}</button>`}render(){const e={"wcm-border":this.border},t=pD.state.history.length>1,r=this.title?L$`<wcm-text variant="big-bold">${this.title}</wcm-text>`:L$`<slot></slot>`;return L$`<header class="${fM(e)}">${t?this.backBtnTemplate():null} ${r} ${this.onAction?this.actionBtnTemplate():null}</header>`}};RH.styles=[rH.globalCss,AH],PH([aM()],RH.prototype,"title",2),PH([aM()],RH.prototype,"onAction",2),PH([aM()],RH.prototype,"actionIcon",2),PH([aM({type:Boolean})],RH.prototype,"border",2),RH=PH([oM("wcm-modal-header")],RH);const TH={MOBILE_BREAKPOINT:600,WCM_RECENT_WALLET_DATA:"WCM_RECENT_WALLET_DATA",EXPLORER_WALLET_URL:"https://explorer.walletconnect.com/?type=wallet",getShadowRootElement(e,t){const r=e.renderRoot.querySelector(t);if(!r)throw new Error(`${t} not found`);return r},getWalletIcon({id:e,image_id:t}){const{walletImages:r}=ED.state;return(null==r?void 0:r[e])?r[e]:t?MD.getWalletImageUrl(t):""},getWalletName:(e,t=!1)=>t&&e.length>8?`${e.substring(0,8)}..`:e,isMobileAnimation:()=>window.innerWidth<=TH.MOBILE_BREAKPOINT,async preloadImage(e){const t=new Promise((t,r)=>{const n=new Image;n.onload=t,n.onerror=r,n.crossOrigin="anonymous",n.src=e});return Promise.race([t,gD.wait(3e3)])},getErrorMessage:e=>e instanceof Error?e.message:"Unknown Error",debounce(e,t=500){let r;return(...n)=>{r&&clearTimeout(r),r=setTimeout(function(){e(...n)},t)}},handleMobileLinking(e,t="_self"){const{walletConnectUri:r}=bD.state,{mobile:n,name:i}=e,o=null==n?void 0:n.native,s=null==n?void 0:n.universal;TH.setRecentWallet(e),r&&function(e){if(o){const r=gD.formatNativeUrl(o,e,i);gD.openHref(r,t)}else if(s){const r=gD.formatUniversalUrl(s,e,i);gD.openHref(r,t)}}(r)},handleAndroidLinking(){const{walletConnectUri:e}=bD.state;e&&(gD.setWalletConnectAndroidDeepLink(e),gD.openHref(e,gD.isTelegram()?"_blank":"_self"))},async handleUriCopy(){const{walletConnectUri:e}=bD.state;if(e)try{await navigator.clipboard.writeText(e),YD.openToast("Link copied","success")}catch(e){YD.openToast("Failed to copy","error")}},getCustomImageUrls(){const{walletImages:e}=ED.state,t=Object.values(null!=e?e:{});return Object.values(t)},truncate:(e,t=8)=>e.length<=t?e:`${e.substring(0,4)}...${e.substring(e.length-4)}`,setRecentWallet(e){try{localStorage.setItem(TH.WCM_RECENT_WALLET_DATA,JSON.stringify(e))}catch(e){console.info("Unable to set recent wallet")}},getRecentWallet(){try{const e=localStorage.getItem(TH.WCM_RECENT_WALLET_DATA);if(e){return JSON.parse(e)}return}catch(e){console.info("Unable to get recent wallet")}},caseSafeIncludes:(e,t)=>e.toUpperCase().includes(t.toUpperCase()),openWalletExplorerUrl(){gD.openHref(TH.EXPLORER_WALLET_URL,"_blank")},getCachedRouterWalletPlatforms(){const{desktop:e,mobile:t}=gD.getWalletRouterData(),r=Boolean(null==e?void 0:e.native),n=Boolean(null==e?void 0:e.universal);return{isDesktop:r,isMobile:Boolean(null==t?void 0:t.native)||Boolean(null==t?void 0:t.universal),isWeb:n}},goToConnectingView(e){pD.setData({Wallet:e});const t=gD.isMobile(),{isDesktop:r,isWeb:n,isMobile:i}=TH.getCachedRouterWalletPlatforms();t?i?(pD.push("MobileConnecting"),!gD.isAndroid()&&gD.isTelegram()&&this.handleMobileLinking(e,"_blank")):n?pD.push("WebConnecting"):pD.push("InstallWallet"):r?pD.push("DesktopConnecting"):n?pD.push("WebConnecting"):i?pD.push("MobileQrcodeConnecting"):pD.push("InstallWallet")}},kH=n$`.wcm-router{overflow:hidden;will-change:transform}.wcm-content{display:flex;flex-direction:column}`;var NH=Object.defineProperty,UH=Object.getOwnPropertyDescriptor,BH=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?UH(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&NH(t,r,o),o};let LH=class extends nM{constructor(){super(),this.view=pD.state.view,this.prevView=pD.state.view,this.unsubscribe=void 0,this.oldHeight="0px",this.resizeObserver=void 0,this.unsubscribe=pD.subscribe(e=>{this.view!==e.view&&this.onChangeRoute()})}firstUpdated(){this.resizeObserver=new ResizeObserver(([e])=>{const t=`${e.contentRect.height}px`;"0px"!==this.oldHeight&&wj(this.routerEl,{height:[this.oldHeight,t]},{duration:.2}),this.oldHeight=t}),this.resizeObserver.observe(this.contentEl)}disconnectedCallback(){var e,t;null==(e=this.unsubscribe)||e.call(this),null==(t=this.resizeObserver)||t.disconnect()}get routerEl(){return TH.getShadowRootElement(this,".wcm-router")}get contentEl(){return TH.getShadowRootElement(this,".wcm-content")}viewTemplate(){switch(this.view){case"ConnectWallet":return L$`<wcm-connect-wallet-view></wcm-connect-wallet-view>`;case"DesktopConnecting":return L$`<wcm-desktop-connecting-view></wcm-desktop-connecting-view>`;case"MobileConnecting":return L$`<wcm-mobile-connecting-view></wcm-mobile-connecting-view>`;case"WebConnecting":return L$`<wcm-web-connecting-view></wcm-web-connecting-view>`;case"MobileQrcodeConnecting":return L$`<wcm-mobile-qr-connecting-view></wcm-mobile-qr-connecting-view>`;case"WalletExplorer":return L$`<wcm-wallet-explorer-view></wcm-wallet-explorer-view>`;case"Qrcode":return L$`<wcm-qrcode-view></wcm-qrcode-view>`;case"InstallWallet":return L$`<wcm-install-wallet-view></wcm-install-wallet-view>`;default:return L$`<div>Not Found</div>`}}async onChangeRoute(){await wj(this.routerEl,{opacity:[1,0],scale:[1,1.02]},{duration:.15,delay:.1}).finished,this.view=pD.state.view,wj(this.routerEl,{opacity:[0,1],scale:[.99,1]},{duration:.37,delay:.05})}render(){return L$`<div class="wcm-router"><div class="wcm-content">${this.viewTemplate()}</div></div>`}};LH.styles=[rH.globalCss,kH],BH([cM()],LH.prototype,"view",2),BH([cM()],LH.prototype,"prevView",2),LH=BH([oM("wcm-modal-router")],LH);const DH=n$`div{height:36px;width:max-content;display:flex;justify-content:center;align-items:center;padding:9px 15px 11px;position:absolute;top:12px;box-shadow:0 6px 14px -6px rgba(10,16,31,.3),0 10px 32px -4px rgba(10,16,31,.15);z-index:2;left:50%;transform:translateX(-50%);pointer-events:none;backdrop-filter:blur(20px) saturate(1.8);-webkit-backdrop-filter:blur(20px) saturate(1.8);border-radius:var(--wcm-notification-border-radius);border:1px solid var(--wcm-color-overlay);background-color:var(--wcm-color-overlay)}svg{margin-right:5px}@-moz-document url-prefix(){div{background-color:var(--wcm-color-bg-3)}}.wcm-success path{fill:var(--wcm-accent-color)}.wcm-error path{fill:var(--wcm-error-color)}`;var $H=Object.defineProperty,MH=Object.getOwnPropertyDescriptor,jH=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?MH(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&$H(t,r,o),o};let FH=class extends nM{constructor(){super(),this.open=!1,this.unsubscribe=void 0,this.timeout=void 0,this.unsubscribe=YD.subscribe(e=>{e.open?(this.open=!0,this.timeout=setTimeout(()=>YD.closeToast(),2200)):(this.open=!1,clearTimeout(this.timeout))})}disconnectedCallback(){var e;null==(e=this.unsubscribe)||e.call(this),clearTimeout(this.timeout),YD.closeToast()}render(){const{message:e,variant:t}=YD.state,r={"wcm-success":"success"===t,"wcm-error":"error"===t};return this.open?L$`<div class="${fM(r)}">${"success"===t?mH.CHECKMARK_ICON:null} ${"error"===t?mH.CROSS_ICON:null}<wcm-text variant="small-regular">${e}</wcm-text></div>`:null}};FH.styles=[rH.globalCss,DH],jH([cM()],FH.prototype,"open",2),FH=jH([oM("wcm-modal-toast")],FH);function HH(e,t,r){if(e===t)return!1;return(e-t<0?t-e:e-t)<=r+.1}const zH={generate(e,t,r){const n="#141414",i=[],o=function(e,t){const r=Array.prototype.slice.call(vj.create(e,{errorCorrectionLevel:t}).modules.data,0),n=Math.sqrt(r.length);return r.reduce((e,t,r)=>(r%n===0?e.push([t]):e[e.length-1].push(t))&&e,[])}(e,"Q"),s=t/o.length,a=[{x:0,y:0},{x:1,y:0},{x:0,y:1}];a.forEach(({x:e,y:t})=>{const r=(o.length-7)*s*e,c=(o.length-7)*s*t;for(let e=0;e<a.length;e+=1){const t=s*(7-2*e);i.push(D$`<rect fill="${e%2==0?n:"#ffffff"}" height="${t}" rx="${.45*t}" ry="${.45*t}" width="${t}" x="${r+s*e}" y="${c+s*e}">`)}});const c=Math.floor((r+25)/s),l=o.length/2-c/2,u=o.length/2+c/2-1,h=[];o.forEach((e,t)=>{e.forEach((e,r)=>{if(o[t][r]&&!(t<7&&r<7||t>o.length-8&&r<7||t<7&&r>o.length-8||t>l&&t<u&&r>l&&r<u)){const e=t*s+s/2,n=r*s+s/2;h.push([e,n])}})});const d={};return h.forEach(([e,t])=>{d[e]?d[e].push(t):d[e]=[t]}),Object.entries(d).map(([e,t])=>{const r=t.filter(e=>t.every(t=>!HH(e,t,s)));return[Number(e),r]}).forEach(([e,t])=>{t.forEach(t=>{i.push(D$`<circle cx="${e}" cy="${t}" fill="${n}" r="${s/2.5}">`)})}),Object.entries(d).filter(([e,t])=>t.length>1).map(([e,t])=>{const r=t.filter(e=>t.some(t=>HH(e,t,s)));return[Number(e),r]}).map(([e,t])=>{t.sort((e,t)=>e<t?-1:1);const r=[];for(const e of t){const t=r.find(t=>t.some(t=>HH(e,t,s)));t?t.push(e):r.push([e])}return[e,r.map(e=>[e[0],e[e.length-1]])]}).forEach(([e,t])=>{t.forEach(([t,r])=>{i.push(D$`<line x1="${e}" x2="${e}" y1="${t}" y2="${r}" stroke="${n}" stroke-width="${s/1.25}" stroke-linecap="round">`)})}),i}},qH=n$`@keyframes fadeIn{0%{opacity:0}100%{opacity:1}}div{position:relative;user-select:none;display:block;overflow:hidden;aspect-ratio:1/1;animation:fadeIn ease .2s}.wcm-dark{background-color:#fff;border-radius:var(--wcm-container-border-radius);padding:18px;box-shadow:0 2px 5px #000}svg:first-child,wcm-wallet-image{position:absolute;top:50%;left:50%;transform:translateY(-50%) translateX(-50%)}wcm-wallet-image{transform:translateY(-50%) translateX(-50%)}wcm-wallet-image{width:25%;height:25%;border-radius:var(--wcm-wallet-icon-border-radius)}svg:first-child{transform:translateY(-50%) translateX(-50%) scale(.9)}svg:first-child path:first-child{fill:var(--wcm-accent-color)}svg:first-child path:last-child{stroke:var(--wcm-color-overlay)}`;var WH=Object.defineProperty,VH=Object.getOwnPropertyDescriptor,KH=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?VH(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&WH(t,r,o),o};let GH=class extends nM{constructor(){super(...arguments),this.uri="",this.size=0,this.imageId=void 0,this.walletId=void 0,this.imageUrl=void 0}svgTemplate(){const e="light"===GD.state.themeMode?this.size:this.size-36;return D$`<svg height="${e}" width="${e}">${zH.generate(this.uri,e,e/4)}</svg>`}render(){const e={"wcm-dark":"dark"===GD.state.themeMode};return L$`<div style="${`width: ${this.size}px`}" class="${fM(e)}">${this.walletId||this.imageUrl?L$`<wcm-wallet-image walletId="${bj(this.walletId)}" imageId="${bj(this.imageId)}" imageUrl="${bj(this.imageUrl)}"></wcm-wallet-image>`:mH.WALLET_CONNECT_ICON_COLORED} ${this.svgTemplate()}</div>`}};GH.styles=[rH.globalCss,qH],KH([aM()],GH.prototype,"uri",2),KH([aM({type:Number})],GH.prototype,"size",2),KH([aM()],GH.prototype,"imageId",2),KH([aM()],GH.prototype,"walletId",2),KH([aM()],GH.prototype,"imageUrl",2),GH=KH([oM("wcm-qrcode")],GH);const ZH=n$`:host{position:relative;height:28px;width:80%}input{width:100%;height:100%;line-height:28px!important;border-radius:var(--wcm-input-border-radius);font-style:normal;font-family:-apple-system,system-ui,BlinkMacSystemFont,'Segoe UI',Roboto,Ubuntu,'Helvetica Neue',sans-serif;font-feature-settings:'case' on;font-weight:500;font-size:16px;letter-spacing:-.03em;padding:0 10px 0 34px;transition:.2s all ease;color:var(--wcm-color-fg-1);background-color:var(--wcm-color-bg-3);box-shadow:inset 0 0 0 1px var(--wcm-color-overlay);caret-color:var(--wcm-accent-color)}input::placeholder{color:var(--wcm-color-fg-2)}svg{left:10px;top:4px;pointer-events:none;position:absolute;width:20px;height:20px}input:focus-within{box-shadow:inset 0 0 0 1px var(--wcm-accent-color)}path{fill:var(--wcm-color-fg-2)}`;var YH=Object.defineProperty,JH=Object.getOwnPropertyDescriptor,XH=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?JH(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&YH(t,r,o),o};let QH=class extends nM{constructor(){super(...arguments),this.onChange=()=>null}render(){return L$`<input type="text" @input="${this.onChange}" placeholder="Search wallets"> ${mH.SEARCH_ICON}`}};QH.styles=[rH.globalCss,ZH],XH([aM()],QH.prototype,"onChange",2),QH=XH([oM("wcm-search-input")],QH);const ez=n$`@keyframes rotate{100%{transform:rotate(360deg)}}@keyframes dash{0%{stroke-dasharray:1,150;stroke-dashoffset:0}50%{stroke-dasharray:90,150;stroke-dashoffset:-35}100%{stroke-dasharray:90,150;stroke-dashoffset:-124}}svg{animation:rotate 2s linear infinite;display:flex;justify-content:center;align-items:center}svg circle{stroke-linecap:round;animation:dash 1.5s ease infinite;stroke:var(--wcm-accent-color)}`;var tz=Object.getOwnPropertyDescriptor;let rz=class extends nM{render(){return L$`<svg viewBox="0 0 50 50" width="24" height="24"><circle cx="25" cy="25" r="20" fill="none" stroke-width="4" stroke="#fff"/></svg>`}};rz.styles=[rH.globalCss,ez],rz=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?tz(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=i(o)||o);return o})([oM("wcm-spinner")],rz);const nz=n$`span{font-style:normal;font-family:var(--wcm-font-family);font-feature-settings:var(--wcm-font-feature-settings)}.wcm-xsmall-bold{font-family:var(--wcm-text-xsmall-bold-font-family);font-weight:var(--wcm-text-xsmall-bold-weight);font-size:var(--wcm-text-xsmall-bold-size);line-height:var(--wcm-text-xsmall-bold-line-height);letter-spacing:var(--wcm-text-xsmall-bold-letter-spacing);text-transform:var(--wcm-text-xsmall-bold-text-transform)}.wcm-xsmall-regular{font-family:var(--wcm-text-xsmall-regular-font-family);font-weight:var(--wcm-text-xsmall-regular-weight);font-size:var(--wcm-text-xsmall-regular-size);line-height:var(--wcm-text-xsmall-regular-line-height);letter-spacing:var(--wcm-text-xsmall-regular-letter-spacing);text-transform:var(--wcm-text-xsmall-regular-text-transform)}.wcm-small-thin{font-family:var(--wcm-text-small-thin-font-family);font-weight:var(--wcm-text-small-thin-weight);font-size:var(--wcm-text-small-thin-size);line-height:var(--wcm-text-small-thin-line-height);letter-spacing:var(--wcm-text-small-thin-letter-spacing);text-transform:var(--wcm-text-small-thin-text-transform)}.wcm-small-regular{font-family:var(--wcm-text-small-regular-font-family);font-weight:var(--wcm-text-small-regular-weight);font-size:var(--wcm-text-small-regular-size);line-height:var(--wcm-text-small-regular-line-height);letter-spacing:var(--wcm-text-small-regular-letter-spacing);text-transform:var(--wcm-text-small-regular-text-transform)}.wcm-medium-regular{font-family:var(--wcm-text-medium-regular-font-family);font-weight:var(--wcm-text-medium-regular-weight);font-size:var(--wcm-text-medium-regular-size);line-height:var(--wcm-text-medium-regular-line-height);letter-spacing:var(--wcm-text-medium-regular-letter-spacing);text-transform:var(--wcm-text-medium-regular-text-transform)}.wcm-big-bold{font-family:var(--wcm-text-big-bold-font-family);font-weight:var(--wcm-text-big-bold-weight);font-size:var(--wcm-text-big-bold-size);line-height:var(--wcm-text-big-bold-line-height);letter-spacing:var(--wcm-text-big-bold-letter-spacing);text-transform:var(--wcm-text-big-bold-text-transform)}:host(*){color:var(--wcm-color-fg-1)}.wcm-color-primary{color:var(--wcm-color-fg-1)}.wcm-color-secondary{color:var(--wcm-color-fg-2)}.wcm-color-tertiary{color:var(--wcm-color-fg-3)}.wcm-color-inverse{color:var(--wcm-accent-fill-color)}.wcm-color-accnt{color:var(--wcm-accent-color)}.wcm-color-error{color:var(--wcm-error-color)}`;var iz=Object.defineProperty,oz=Object.getOwnPropertyDescriptor,sz=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?oz(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&iz(t,r,o),o};let az=class extends nM{constructor(){super(...arguments),this.variant="medium-regular",this.color="primary"}render(){const e={"wcm-big-bold":"big-bold"===this.variant,"wcm-medium-regular":"medium-regular"===this.variant,"wcm-small-regular":"small-regular"===this.variant,"wcm-small-thin":"small-thin"===this.variant,"wcm-xsmall-regular":"xsmall-regular"===this.variant,"wcm-xsmall-bold":"xsmall-bold"===this.variant,"wcm-color-primary":"primary"===this.color,"wcm-color-secondary":"secondary"===this.color,"wcm-color-tertiary":"tertiary"===this.color,"wcm-color-inverse":"inverse"===this.color,"wcm-color-accnt":"accent"===this.color,"wcm-color-error":"error"===this.color};return L$`<span><slot class="${fM(e)}"></slot></span>`}};az.styles=[rH.globalCss,nz],sz([aM()],az.prototype,"variant",2),sz([aM()],az.prototype,"color",2),az=sz([oM("wcm-text")],az);const cz=n$`button{width:100%;height:100%;border-radius:var(--wcm-button-hover-highlight-border-radius);display:flex;align-items:flex-start}button:active{background-color:var(--wcm-color-overlay)}@media(hover:hover){button:hover{background-color:var(--wcm-color-overlay)}}button>div{width:80px;padding:5px 0;display:flex;flex-direction:column;align-items:center}wcm-text{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center}wcm-wallet-image{height:60px;width:60px;transition:all .2s ease;border-radius:var(--wcm-wallet-icon-border-radius);margin-bottom:5px}.wcm-sublabel{margin-top:2px}`;var lz=Object.defineProperty,uz=Object.getOwnPropertyDescriptor,hz=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?uz(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&lz(t,r,o),o};let dz=class extends nM{constructor(){super(...arguments),this.onClick=()=>null,this.name="",this.walletId="",this.label=void 0,this.imageId=void 0,this.installed=!1,this.recent=!1}sublabelTemplate(){return this.recent?L$`<wcm-text class="wcm-sublabel" variant="xsmall-bold" color="tertiary">RECENT</wcm-text>`:this.installed?L$`<wcm-text class="wcm-sublabel" variant="xsmall-bold" color="tertiary">INSTALLED</wcm-text>`:null}handleClick(){yD.click({name:"WALLET_BUTTON",walletId:this.walletId}),this.onClick()}render(){var e;return L$`<button @click="${this.handleClick.bind(this)}"><div><wcm-wallet-image walletId="${this.walletId}" imageId="${bj(this.imageId)}"></wcm-wallet-image><wcm-text variant="xsmall-regular">${null!=(e=this.label)?e:TH.getWalletName(this.name,!0)}</wcm-text>${this.sublabelTemplate()}</div></button>`}};dz.styles=[rH.globalCss,cz],hz([aM()],dz.prototype,"onClick",2),hz([aM()],dz.prototype,"name",2),hz([aM()],dz.prototype,"walletId",2),hz([aM()],dz.prototype,"label",2),hz([aM()],dz.prototype,"imageId",2),hz([aM({type:Boolean})],dz.prototype,"installed",2),hz([aM({type:Boolean})],dz.prototype,"recent",2),dz=hz([oM("wcm-wallet-button")],dz);const fz=n$`:host{display:block}div{overflow:hidden;position:relative;border-radius:inherit;width:100%;height:100%;background-color:var(--wcm-color-overlay)}svg{position:relative;width:100%;height:100%}div::after{content:'';position:absolute;top:0;bottom:0;left:0;right:0;border-radius:inherit;border:1px solid var(--wcm-color-overlay)}div img{width:100%;height:100%;object-fit:cover;object-position:center}#wallet-placeholder-fill{fill:var(--wcm-color-bg-3)}#wallet-placeholder-dash{stroke:var(--wcm-color-overlay)}`;var pz=Object.defineProperty,gz=Object.getOwnPropertyDescriptor,mz=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?gz(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&pz(t,r,o),o};let yz=class extends nM{constructor(){super(...arguments),this.walletId="",this.imageId=void 0,this.imageUrl=void 0}render(){var e;const t=(null==(e=this.imageUrl)?void 0:e.length)?this.imageUrl:TH.getWalletIcon({id:this.walletId,image_id:this.imageId});return L$`${t.length?L$`<div><img crossorigin="anonymous" src="${t}" alt="${this.id}"></div>`:mH.WALLET_PLACEHOLDER}`}};yz.styles=[rH.globalCss,fz],mz([aM()],yz.prototype,"walletId",2),mz([aM()],yz.prototype,"imageId",2),mz([aM()],yz.prototype,"imageUrl",2),yz=mz([oM("wcm-wallet-image")],yz);var wz=Object.defineProperty,bz=Object.getOwnPropertyDescriptor,vz=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?bz(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&wz(t,r,o),o};let Ez=class extends nM{constructor(){super(),this.preload=!0,this.preloadData()}async loadImages(e){try{(null==e?void 0:e.length)&&await Promise.all(e.map(async e=>TH.preloadImage(e)))}catch(t){console.info("Unsuccessful attempt at preloading some images",e)}}async preloadListings(){if(ED.state.enableExplorer){await MD.getRecomendedWallets(),bD.setIsDataLoaded(!0);const{recomendedWallets:e}=MD.state,t=e.map(e=>TH.getWalletIcon(e));await this.loadImages(t)}else bD.setIsDataLoaded(!0)}async preloadCustomImages(){const e=TH.getCustomImageUrls();await this.loadImages(e)}async preloadData(){try{this.preload&&(this.preload=!1,await Promise.all([this.preloadListings(),this.preloadCustomImages()]))}catch(e){console.error(e),YD.openToast("Failed preloading","error")}}};vz([cM()],Ez.prototype,"preload",2),Ez=vz([oM("wcm-explorer-context")],Ez);var xz=Object.getOwnPropertyDescriptor;let Iz=class extends nM{constructor(){super(),this.unsubscribeTheme=void 0,rH.setTheme(),this.unsubscribeTheme=GD.subscribe(rH.setTheme)}disconnectedCallback(){var e;null==(e=this.unsubscribeTheme)||e.call(this)}};Iz=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?xz(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=i(o)||o);return o})([oM("wcm-theme-context")],Iz);const _z=n$`@keyframes scroll{0%{transform:translate3d(0,0,0)}100%{transform:translate3d(calc(-70px * 9),0,0)}}.wcm-slider{position:relative;overflow-x:hidden;padding:10px 0;margin:0 -20px;width:calc(100% + 40px)}.wcm-track{display:flex;width:calc(70px * 18);animation:scroll 20s linear infinite;opacity:.7}.wcm-track svg{margin:0 5px}wcm-wallet-image{width:60px;height:60px;margin:0 5px;border-radius:var(--wcm-wallet-icon-border-radius)}.wcm-grid{display:grid;grid-template-columns:repeat(4,80px);justify-content:space-between}.wcm-title{display:flex;align-items:center;margin-bottom:10px}.wcm-title svg{margin-right:6px}.wcm-title path{fill:var(--wcm-accent-color)}wcm-modal-footer .wcm-title{padding:0 10px}wcm-button-big{position:absolute;top:50%;left:50%;transform:translateY(-50%) translateX(-50%);filter:drop-shadow(0 0 17px var(--wcm-color-bg-1))}wcm-info-footer{flex-direction:column;align-items:center;display:flex;width:100%;padding:5px 0}wcm-info-footer wcm-text{text-align:center;margin-bottom:15px}#wallet-placeholder-fill{fill:var(--wcm-color-bg-3)}#wallet-placeholder-dash{stroke:var(--wcm-color-overlay)}`;var Sz=Object.getOwnPropertyDescriptor;let Az=class extends nM{onGoToQrcode(){pD.push("Qrcode")}render(){const{recomendedWallets:e}=MD.state,t=[...e,...e],r=2*gD.RECOMMENDED_WALLET_AMOUNT;return L$`<wcm-modal-header title="Connect your wallet" .onAction="${this.onGoToQrcode}" .actionIcon="${mH.QRCODE_ICON}"></wcm-modal-header><wcm-modal-content><div class="wcm-title">${mH.MOBILE_ICON}<wcm-text variant="small-regular" color="accent">WalletConnect</wcm-text></div><div class="wcm-slider"><div class="wcm-track">${[...Array(r)].map((e,r)=>{const n=t[r%t.length];return n?L$`<wcm-wallet-image walletId="${n.id}" imageId="${n.image_id}"></wcm-wallet-image>`:mH.WALLET_PLACEHOLDER})}</div><wcm-button-big @click="${TH.handleAndroidLinking}"><wcm-text variant="medium-regular" color="inverse">Select Wallet</wcm-text></wcm-button-big></div></wcm-modal-content><wcm-info-footer><wcm-text color="secondary" variant="small-thin">Choose WalletConnect to see supported apps on your device</wcm-text></wcm-info-footer>`}};Az.styles=[rH.globalCss,_z],Az=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Sz(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=i(o)||o);return o})([oM("wcm-android-wallet-selection")],Az);const Oz=n$`@keyframes loading{to{stroke-dashoffset:0}}@keyframes shake{10%,90%{transform:translate3d(-1px,0,0)}20%,80%{transform:translate3d(1px,0,0)}30%,50%,70%{transform:translate3d(-2px,0,0)}40%,60%{transform:translate3d(2px,0,0)}}:host{display:flex;flex-direction:column;align-items:center}div{position:relative;width:110px;height:110px;display:flex;justify-content:center;align-items:center;margin:40px 0 20px 0;transform:translate3d(0,0,0)}svg{position:absolute;width:110px;height:110px;fill:none;stroke:transparent;stroke-linecap:round;stroke-width:2px;top:0;left:0}use{stroke:var(--wcm-accent-color);animation:loading 1s linear infinite}wcm-wallet-image{border-radius:var(--wcm-wallet-icon-large-border-radius);width:90px;height:90px}wcm-text{margin-bottom:40px}.wcm-error svg{stroke:var(--wcm-error-color)}.wcm-error use{display:none}.wcm-error{animation:shake .4s cubic-bezier(.36,.07,.19,.97) both}.wcm-stale svg,.wcm-stale use{display:none}`;var Cz=Object.defineProperty,Pz=Object.getOwnPropertyDescriptor,Rz=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Pz(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Cz(t,r,o),o};let Tz=class extends nM{constructor(){super(...arguments),this.walletId=void 0,this.imageId=void 0,this.isError=!1,this.isStale=!1,this.label=""}svgLoaderTemplate(){var e,t;const r=null!=(t=null==(e=GD.state.themeVariables)?void 0:e["--wcm-wallet-icon-large-border-radius"])?t:rH.getPreset("--wcm-wallet-icon-large-border-radius");let n=0;n=r.includes("%")?.88*parseInt(r,10):parseInt(r,10),n*=1.17;return L$`<svg viewBox="0 0 110 110" width="110" height="110"><rect id="wcm-loader" x="2" y="2" width="106" height="106" rx="${n}"/><use xlink:href="#wcm-loader" stroke-dasharray="106 ${317-1.57*n}" stroke-dashoffset="${425-1.8*n}"></use></svg>`}render(){const e={"wcm-error":this.isError,"wcm-stale":this.isStale};return L$`<div class="${fM(e)}">${this.svgLoaderTemplate()}<wcm-wallet-image walletId="${bj(this.walletId)}" imageId="${bj(this.imageId)}"></wcm-wallet-image></div><wcm-text variant="medium-regular" color="${this.isError?"error":"primary"}">${this.isError?"Connection declined":this.label}</wcm-text>`}};Tz.styles=[rH.globalCss,Oz],Rz([aM()],Tz.prototype,"walletId",2),Rz([aM()],Tz.prototype,"imageId",2),Rz([aM({type:Boolean})],Tz.prototype,"isError",2),Rz([aM({type:Boolean})],Tz.prototype,"isStale",2),Rz([aM()],Tz.prototype,"label",2),Tz=Rz([oM("wcm-connector-waiting")],Tz);const kz={manualWallets(){var e,t;const{mobileWallets:r,desktopWallets:n}=ED.state,i=null==(e=kz.recentWallet())?void 0:e.id,o=gD.isMobile()?r:n,s=null==o?void 0:o.filter(e=>i!==e.id);return null!=(t=gD.isMobile()?null==s?void 0:s.map(({id:e,name:t,links:r})=>({id:e,name:t,mobile:r,links:r})):null==s?void 0:s.map(({id:e,name:t,links:r})=>({id:e,name:t,desktop:r,links:r})))?t:[]},recentWallet:()=>TH.getRecentWallet(),recomendedWallets(e=!1){var t;const r=e||null==(t=kz.recentWallet())?void 0:t.id,{recomendedWallets:n}=MD.state;return n.filter(e=>r!==e.id)}},Nz={onConnecting(e){TH.goToConnectingView(e)},manualWalletsTemplate(){return kz.manualWallets().map(e=>L$`<wcm-wallet-button walletId="${e.id}" name="${e.name}" .onClick="${()=>this.onConnecting(e)}"></wcm-wallet-button>`)},recomendedWalletsTemplate(e=!1){return kz.recomendedWallets(e).map(e=>L$`<wcm-wallet-button name="${e.name}" walletId="${e.id}" imageId="${e.image_id}" .onClick="${()=>this.onConnecting(e)}"></wcm-wallet-button>`)},recentWalletTemplate(){const e=kz.recentWallet();if(e)return L$`<wcm-wallet-button name="${e.name}" walletId="${e.id}" imageId="${bj(e.image_id)}" .recent="${!0}" .onClick="${()=>this.onConnecting(e)}"></wcm-wallet-button>`}},Uz=n$`.wcm-grid{display:grid;grid-template-columns:repeat(4,80px);justify-content:space-between}.wcm-desktop-title,.wcm-mobile-title{display:flex;align-items:center}.wcm-mobile-title{justify-content:space-between;margin-bottom:20px;margin-top:-10px}.wcm-desktop-title{margin-bottom:10px;padding:0 10px}.wcm-subtitle{display:flex;align-items:center}.wcm-subtitle:last-child path{fill:var(--wcm-color-fg-3)}.wcm-desktop-title svg,.wcm-mobile-title svg{margin-right:6px}.wcm-desktop-title path,.wcm-mobile-title path{fill:var(--wcm-accent-color)}`;var Bz=Object.getOwnPropertyDescriptor;let Lz=class extends nM{render(){const{explorerExcludedWalletIds:e,enableExplorer:t}=ED.state,r="ALL"!==e&&t,n=Nz.manualWalletsTemplate(),i=Nz.recomendedWalletsTemplate();let o=[Nz.recentWalletTemplate(),...n,...i];o=o.filter(Boolean);const s=o.length>4||r;let a=[];a=s?o.slice(0,3):o;const c=Boolean(a.length);return L$`<wcm-modal-header .border="${!0}" title="Connect your wallet" .onAction="${TH.handleUriCopy}" .actionIcon="${mH.COPY_ICON}"></wcm-modal-header><wcm-modal-content><div class="wcm-mobile-title"><div class="wcm-subtitle">${mH.MOBILE_ICON}<wcm-text variant="small-regular" color="accent">Mobile</wcm-text></div><div class="wcm-subtitle">${mH.SCAN_ICON}<wcm-text variant="small-regular" color="secondary">Scan with your wallet</wcm-text></div></div><wcm-walletconnect-qr></wcm-walletconnect-qr></wcm-modal-content>${c?L$`<wcm-modal-footer><div class="wcm-desktop-title">${mH.DESKTOP_ICON}<wcm-text variant="small-regular" color="accent">Desktop</wcm-text></div><div class="wcm-grid">${a} ${s?L$`<wcm-view-all-wallets-button></wcm-view-all-wallets-button>`:null}</div></wcm-modal-footer>`:null}`}};Lz.styles=[rH.globalCss,Uz],Lz=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Bz(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=i(o)||o);return o})([oM("wcm-desktop-wallet-selection")],Lz);const Dz=n$`div{background-color:var(--wcm-color-bg-2);padding:10px 20px 15px 20px;border-top:1px solid var(--wcm-color-bg-3);text-align:center}a{color:var(--wcm-accent-color);text-decoration:none;transition:opacity .2s ease-in-out;display:inline}a:active{opacity:.8}@media(hover:hover){a:hover{opacity:.8}}`;var $z=Object.getOwnPropertyDescriptor;let Mz=class extends nM{render(){const{termsOfServiceUrl:e,privacyPolicyUrl:t}=ED.state;return(null!=e?e:t)?L$`<div><wcm-text variant="small-regular" color="secondary">By connecting your wallet to this app, you agree to the app's ${e?L$`<a href="${e}" target="_blank" rel="noopener noreferrer">Terms of Service</a>`:null} ${e&&t?"and":null} ${t?L$`<a href="${t}" target="_blank" rel="noopener noreferrer">Privacy Policy</a>`:null}</wcm-text></div>`:null}};Mz.styles=[rH.globalCss,Dz],Mz=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?$z(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=i(o)||o);return o})([oM("wcm-legal-notice")],Mz);const jz=n$`div{display:grid;grid-template-columns:repeat(4,80px);margin:0 -10px;justify-content:space-between;row-gap:10px}`;var Fz=Object.getOwnPropertyDescriptor;let Hz=class extends nM{onQrcode(){pD.push("Qrcode")}render(){const{explorerExcludedWalletIds:e,enableExplorer:t}=ED.state,r="ALL"!==e&&t,n=Nz.manualWalletsTemplate(),i=Nz.recomendedWalletsTemplate();let o=[Nz.recentWalletTemplate(),...n,...i];o=o.filter(Boolean);const s=o.length>8||r;let a=[];a=s?o.slice(0,7):o;const c=Boolean(a.length);return L$`<wcm-modal-header title="Connect your wallet" .onAction="${this.onQrcode}" .actionIcon="${mH.QRCODE_ICON}"></wcm-modal-header>${c?L$`<wcm-modal-content><div>${a} ${s?L$`<wcm-view-all-wallets-button></wcm-view-all-wallets-button>`:null}</div></wcm-modal-content>`:null}`}};Hz.styles=[rH.globalCss,jz],Hz=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Fz(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=i(o)||o);return o})([oM("wcm-mobile-wallet-selection")],Hz);const zz=n$`:host{all:initial}.wcm-overlay{top:0;bottom:0;left:0;right:0;position:fixed;z-index:var(--wcm-z-index);overflow:hidden;display:flex;justify-content:center;align-items:center;opacity:0;pointer-events:none;background-color:var(--wcm-overlay-background-color);backdrop-filter:var(--wcm-overlay-backdrop-filter)}@media(max-height:720px) and (orientation:landscape){.wcm-overlay{overflow:scroll;align-items:flex-start;padding:20px 0}}.wcm-active{pointer-events:auto}.wcm-container{position:relative;max-width:360px;width:100%;outline:0;border-radius:var(--wcm-background-border-radius) var(--wcm-background-border-radius) var(--wcm-container-border-radius) var(--wcm-container-border-radius);border:1px solid var(--wcm-color-overlay);overflow:hidden}.wcm-card{width:100%;position:relative;border-radius:var(--wcm-container-border-radius);overflow:hidden;box-shadow:0 6px 14px -6px rgba(10,16,31,.12),0 10px 32px -4px rgba(10,16,31,.1),0 0 0 1px var(--wcm-color-overlay);background-color:var(--wcm-color-bg-1);color:var(--wcm-color-fg-1)}@media(max-width:600px){.wcm-container{max-width:440px;border-radius:var(--wcm-background-border-radius) var(--wcm-background-border-radius) 0 0}.wcm-card{border-radius:var(--wcm-container-border-radius) var(--wcm-container-border-radius) 0 0}.wcm-overlay{align-items:flex-end}}@media(max-width:440px){.wcm-container{border:0}}`;var qz=Object.defineProperty,Wz=Object.getOwnPropertyDescriptor,Vz=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Wz(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&qz(t,r,o),o};let Kz=class extends nM{constructor(){super(),this.open=!1,this.active=!1,this.unsubscribeModal=void 0,this.abortController=void 0,this.unsubscribeModal=FD.subscribe(e=>{e.open?this.onOpenModalEvent():this.onCloseModalEvent()})}disconnectedCallback(){var e;null==(e=this.unsubscribeModal)||e.call(this)}get overlayEl(){return TH.getShadowRootElement(this,".wcm-overlay")}get containerEl(){return TH.getShadowRootElement(this,".wcm-container")}toggleBodyScroll(e){if(document.querySelector("body"))if(e){const e=document.getElementById("wcm-styles");null==e||e.remove()}else document.head.insertAdjacentHTML("beforeend",'<style id="wcm-styles">html,body{touch-action:none;overflow:hidden;overscroll-behavior:contain;}</style>')}onCloseModal(e){e.target===e.currentTarget&&FD.close()}onOpenModalEvent(){this.toggleBodyScroll(!1),this.addKeyboardEvents(),this.open=!0,setTimeout(async()=>{const e=TH.isMobileAnimation()?{y:["50vh","0vh"]}:{scale:[.98,1]};await Promise.all([wj(this.overlayEl,{opacity:[0,1]},{delay:.1,duration:.2}).finished,wj(this.containerEl,e,{delay:.1,duration:.2}).finished]),this.active=!0},0)}async onCloseModalEvent(){this.toggleBodyScroll(!0),this.removeKeyboardEvents();const e=TH.isMobileAnimation()?{y:["0vh","50vh"]}:{scale:[1,.98]};await Promise.all([wj(this.overlayEl,{opacity:[1,0]},{duration:.2}).finished,wj(this.containerEl,e,{duration:.2}).finished]),this.containerEl.removeAttribute("style"),this.active=!1,this.open=!1}addKeyboardEvents(){this.abortController=new AbortController,window.addEventListener("keydown",e=>{var t;"Escape"===e.key?FD.close():"Tab"===e.key&&((null==(t=e.target)?void 0:t.tagName.includes("wcm-"))||this.containerEl.focus())},this.abortController),this.containerEl.focus()}removeKeyboardEvents(){var e;null==(e=this.abortController)||e.abort(),this.abortController=void 0}render(){const e={"wcm-overlay":!0,"wcm-active":this.active};return L$`<wcm-explorer-context></wcm-explorer-context><wcm-theme-context></wcm-theme-context><div id="wcm-modal" class="${fM(e)}" @click="${this.onCloseModal}" role="alertdialog" aria-modal="true"><div class="wcm-container" tabindex="0">${this.open?L$`<wcm-modal-backcard></wcm-modal-backcard><div class="wcm-card"><wcm-modal-router></wcm-modal-router><wcm-modal-toast></wcm-modal-toast></div>`:null}</div></div>`}};Kz.styles=[rH.globalCss,zz],Vz([cM()],Kz.prototype,"open",2),Vz([cM()],Kz.prototype,"active",2),Kz=Vz([oM("wcm-modal")],Kz);const Gz=n$`div{display:flex;margin-top:15px}slot{display:inline-block;margin:0 5px}wcm-button{margin:0 5px}`;var Zz=Object.defineProperty,Yz=Object.getOwnPropertyDescriptor,Jz=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Yz(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Zz(t,r,o),o};let Xz=class extends nM{constructor(){super(...arguments),this.isMobile=!1,this.isDesktop=!1,this.isWeb=!1,this.isRetry=!1}onMobile(){gD.isMobile()?pD.replace("MobileConnecting"):pD.replace("MobileQrcodeConnecting")}onDesktop(){pD.replace("DesktopConnecting")}onWeb(){pD.replace("WebConnecting")}render(){return L$`<div>${this.isRetry?L$`<slot></slot>`:null} ${this.isMobile?L$`<wcm-button .onClick="${this.onMobile}" .iconLeft="${mH.MOBILE_ICON}" variant="outline">Mobile</wcm-button>`:null} ${this.isDesktop?L$`<wcm-button .onClick="${this.onDesktop}" .iconLeft="${mH.DESKTOP_ICON}" variant="outline">Desktop</wcm-button>`:null} ${this.isWeb?L$`<wcm-button .onClick="${this.onWeb}" .iconLeft="${mH.GLOBE_ICON}" variant="outline">Web</wcm-button>`:null}</div>`}};Xz.styles=[rH.globalCss,Gz],Jz([aM({type:Boolean})],Xz.prototype,"isMobile",2),Jz([aM({type:Boolean})],Xz.prototype,"isDesktop",2),Jz([aM({type:Boolean})],Xz.prototype,"isWeb",2),Jz([aM({type:Boolean})],Xz.prototype,"isRetry",2),Xz=Jz([oM("wcm-platform-selection")],Xz);const Qz=n$`button{display:flex;flex-direction:column;padding:5px 10px;border-radius:var(--wcm-button-hover-highlight-border-radius);height:100%;justify-content:flex-start}.wcm-icons{width:60px;height:60px;display:flex;flex-wrap:wrap;padding:7px;border-radius:var(--wcm-wallet-icon-border-radius);justify-content:space-between;align-items:center;margin-bottom:5px;background-color:var(--wcm-color-bg-2);box-shadow:inset 0 0 0 1px var(--wcm-color-overlay)}button:active{background-color:var(--wcm-color-overlay)}@media(hover:hover){button:hover{background-color:var(--wcm-color-overlay)}}.wcm-icons img{width:21px;height:21px;object-fit:cover;object-position:center;border-radius:calc(var(--wcm-wallet-icon-border-radius)/ 2);border:1px solid var(--wcm-color-overlay)}.wcm-icons svg{width:21px;height:21px}.wcm-icons img:nth-child(1),.wcm-icons img:nth-child(2),.wcm-icons svg:nth-child(1),.wcm-icons svg:nth-child(2){margin-bottom:4px}wcm-text{width:100%;text-align:center}#wallet-placeholder-fill{fill:var(--wcm-color-bg-3)}#wallet-placeholder-dash{stroke:var(--wcm-color-overlay)}`;var eq=Object.getOwnPropertyDescriptor;let tq=class extends nM{onClick(){pD.push("WalletExplorer")}render(){const{recomendedWallets:e}=MD.state,t=[...e,...kz.manualWallets()].reverse().slice(0,4);return L$`<button @click="${this.onClick}"><div class="wcm-icons">${t.map(e=>{const t=TH.getWalletIcon(e);if(t)return L$`<img crossorigin="anonymous" src="${t}">`;const r=TH.getWalletIcon({id:e.id});return r?L$`<img crossorigin="anonymous" src="${r}">`:mH.WALLET_PLACEHOLDER})} ${[...Array(4-t.length)].map(()=>mH.WALLET_PLACEHOLDER)}</div><wcm-text variant="xsmall-regular">View All</wcm-text></button>`}};tq.styles=[rH.globalCss,Qz],tq=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?eq(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=i(o)||o);return o})([oM("wcm-view-all-wallets-button")],tq);const rq=n$`.wcm-qr-container{width:100%;display:flex;justify-content:center;align-items:center;aspect-ratio:1/1}`;var nq=Object.defineProperty,iq=Object.getOwnPropertyDescriptor,oq=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?iq(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&nq(t,r,o),o};let sq=class extends nM{constructor(){super(),this.walletId="",this.imageId="",this.uri="",setTimeout(()=>{const{walletConnectUri:e}=bD.state;this.uri=e},0)}get overlayEl(){return TH.getShadowRootElement(this,".wcm-qr-container")}render(){return L$`<div class="wcm-qr-container">${this.uri?L$`<wcm-qrcode size="${this.overlayEl.offsetWidth}" uri="${this.uri}" walletId="${bj(this.walletId)}" imageId="${bj(this.imageId)}"></wcm-qrcode>`:L$`<wcm-spinner></wcm-spinner>`}</div>`}};sq.styles=[rH.globalCss,rq],oq([aM()],sq.prototype,"walletId",2),oq([aM()],sq.prototype,"imageId",2),oq([cM()],sq.prototype,"uri",2),sq=oq([oM("wcm-walletconnect-qr")],sq);var aq=Object.getOwnPropertyDescriptor;let cq=class extends nM{viewTemplate(){return gD.isAndroid()&&!gD.isTelegram()?L$`<wcm-android-wallet-selection></wcm-android-wallet-selection>`:gD.isMobile()?L$`<wcm-mobile-wallet-selection></wcm-mobile-wallet-selection>`:L$`<wcm-desktop-wallet-selection></wcm-desktop-wallet-selection>`}render(){return L$`${this.viewTemplate()}<wcm-legal-notice></wcm-legal-notice>`}};cq.styles=[rH.globalCss],cq=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?aq(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=i(o)||o);return o})([oM("wcm-connect-wallet-view")],cq);const lq=n$`wcm-info-footer{flex-direction:column;align-items:center;display:flex;width:100%;padding:5px 0}wcm-text{text-align:center}`;var uq=Object.defineProperty,hq=Object.getOwnPropertyDescriptor,dq=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?hq(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&uq(t,r,o),o};let fq=class extends nM{constructor(){super(),this.isError=!1,this.openDesktopApp()}onFormatAndRedirect(e){const{desktop:t,name:r}=gD.getWalletRouterData(),n=null==t?void 0:t.native,i=null==t?void 0:t.universal;if(n){const t=gD.formatNativeUrl(n,e,r);gD.openHref(t,"_self")}else if(i){const t=gD.formatUniversalUrl(i,e,r);gD.openHref(t,"_blank")}}openDesktopApp(){const{walletConnectUri:e}=bD.state,t=gD.getWalletRouterData();TH.setRecentWallet(t),e&&this.onFormatAndRedirect(e)}render(){const{name:e,id:t,image_id:r}=gD.getWalletRouterData(),{isMobile:n,isWeb:i}=TH.getCachedRouterWalletPlatforms();return L$`<wcm-modal-header title="${e}" .onAction="${TH.handleUriCopy}" .actionIcon="${mH.COPY_ICON}"></wcm-modal-header><wcm-modal-content><wcm-connector-waiting walletId="${t}" imageId="${bj(r)}" label="${`Continue in ${e}...`}" .isError="${this.isError}"></wcm-connector-waiting></wcm-modal-content><wcm-info-footer><wcm-text color="secondary" variant="small-thin">${`Connection can continue loading if ${e} is not installed on your device`}</wcm-text><wcm-platform-selection .isMobile="${n}" .isWeb="${i}" .isRetry="${!0}"><wcm-button .onClick="${this.openDesktopApp.bind(this)}" .iconRight="${mH.RETRY_ICON}">Retry</wcm-button></wcm-platform-selection></wcm-info-footer>`}};fq.styles=[rH.globalCss,lq],dq([cM()],fq.prototype,"isError",2),fq=dq([oM("wcm-desktop-connecting-view")],fq);const pq=n$`wcm-info-footer{flex-direction:column;align-items:center;display:flex;width:100%;padding:5px 0}wcm-text{text-align:center}wcm-button{margin-top:15px}`;var gq=Object.getOwnPropertyDescriptor;let mq=class extends nM{onInstall(e){e&&gD.openHref(e,"_blank")}render(){const{name:e,id:t,image_id:r,homepage:n}=gD.getWalletRouterData();return L$`<wcm-modal-header title="${e}"></wcm-modal-header><wcm-modal-content><wcm-connector-waiting walletId="${t}" imageId="${bj(r)}" label="Not Detected" .isStale="${!0}"></wcm-connector-waiting></wcm-modal-content><wcm-info-footer><wcm-text color="secondary" variant="small-thin">${`Download ${e} to continue. If multiple browser extensions are installed, disable non ${e} ones and try again`}</wcm-text><wcm-button .onClick="${()=>this.onInstall(n)}" .iconLeft="${mH.ARROW_DOWN_ICON}">Download</wcm-button></wcm-info-footer>`}};mq.styles=[rH.globalCss,pq],mq=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?gq(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=i(o)||o);return o})([oM("wcm-install-wallet-view")],mq);const yq=n$`wcm-wallet-image{border-radius:var(--wcm-wallet-icon-large-border-radius);width:96px;height:96px;margin-bottom:20px}wcm-info-footer{display:flex;width:100%}.wcm-app-store{justify-content:space-between}.wcm-app-store wcm-wallet-image{margin-right:10px;margin-bottom:0;width:28px;height:28px;border-radius:var(--wcm-wallet-icon-small-border-radius)}.wcm-app-store div{display:flex;align-items:center}.wcm-app-store wcm-button{margin-right:-10px}.wcm-note{flex-direction:column;align-items:center;padding:5px 0}.wcm-note wcm-text{text-align:center}wcm-platform-selection{margin-top:-15px}.wcm-note wcm-text{margin-top:15px}.wcm-note wcm-text span{color:var(--wcm-accent-color)}`;var wq=Object.defineProperty,bq=Object.getOwnPropertyDescriptor,vq=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?bq(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&wq(t,r,o),o};let Eq=class extends nM{constructor(){super(),this.isError=!1,this.openMobileApp()}onFormatAndRedirect(e,t=!1){const{mobile:r,name:n}=gD.getWalletRouterData(),i=null==r?void 0:r.native,o=null==r?void 0:r.universal,s=gD.isTelegram()?"_blank":"_self";if(e=gD.isTelegram()&&gD.isAndroid()?encodeURIComponent(e):e,i&&!t){const t=gD.formatNativeUrl(i,e,n);gD.openHref(t,s)}else if(o){const t=gD.formatUniversalUrl(o,e,n);gD.openHref(t,s)}}openMobileApp(e=!1){const{walletConnectUri:t}=bD.state,r=gD.getWalletRouterData();t&&this.onFormatAndRedirect(t,e),TH.setRecentWallet(r)}onGoToAppStore(e){e&&gD.openHref(e,"_blank")}render(){const{name:e,id:t,image_id:r,app:n,mobile:i}=gD.getWalletRouterData(),{isWeb:o}=TH.getCachedRouterWalletPlatforms(),s=null==n?void 0:n.ios,a=null==i?void 0:i.universal;return L$`<wcm-modal-header title="${e}"></wcm-modal-header><wcm-modal-content><wcm-connector-waiting walletId="${t}" imageId="${bj(r)}" label="Tap 'Open' to continue…" .isError="${this.isError}"></wcm-connector-waiting></wcm-modal-content><wcm-info-footer class="wcm-note"><wcm-platform-selection .isWeb="${o}" .isRetry="${!0}"><wcm-button .onClick="${()=>this.openMobileApp(!1)}" .iconRight="${mH.RETRY_ICON}">Retry</wcm-button></wcm-platform-selection>${a?L$`<wcm-text color="secondary" variant="small-thin">Still doesn't work? <span tabindex="0" @click="${()=>this.openMobileApp(!0)}">Try this alternate link</span></wcm-text>`:null}</wcm-info-footer><wcm-info-footer class="wcm-app-store"><div><wcm-wallet-image walletId="${t}" imageId="${bj(r)}"></wcm-wallet-image><wcm-text>${`Get ${e}`}</wcm-text></div><wcm-button .iconRight="${mH.ARROW_RIGHT_ICON}" .onClick="${()=>this.onGoToAppStore(s)}" variant="ghost">App Store</wcm-button></wcm-info-footer>`}};Eq.styles=[rH.globalCss,yq],vq([cM()],Eq.prototype,"isError",2),Eq=vq([oM("wcm-mobile-connecting-view")],Eq);const xq=n$`wcm-info-footer{flex-direction:column;align-items:center;display:flex;width:100%;padding:5px 0}wcm-text{text-align:center}`;var Iq=Object.getOwnPropertyDescriptor;let _q=class extends nM{render(){const{name:e,id:t,image_id:r}=gD.getWalletRouterData(),{isDesktop:n,isWeb:i}=TH.getCachedRouterWalletPlatforms();return L$`<wcm-modal-header title="${e}" .onAction="${TH.handleUriCopy}" .actionIcon="${mH.COPY_ICON}"></wcm-modal-header><wcm-modal-content><wcm-walletconnect-qr walletId="${t}" imageId="${bj(r)}"></wcm-walletconnect-qr></wcm-modal-content><wcm-info-footer><wcm-text color="secondary" variant="small-thin">${`Scan this QR Code with your phone's camera or inside ${e} app`}</wcm-text><wcm-platform-selection .isDesktop="${n}" .isWeb="${i}"></wcm-platform-selection></wcm-info-footer>`}};_q.styles=[rH.globalCss,xq],_q=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Iq(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=i(o)||o);return o})([oM("wcm-mobile-qr-connecting-view")],_q);var Sq=Object.getOwnPropertyDescriptor;let Aq=class extends nM{render(){return L$`<wcm-modal-header title="Scan the code" .onAction="${TH.handleUriCopy}" .actionIcon="${mH.COPY_ICON}"></wcm-modal-header><wcm-modal-content><wcm-walletconnect-qr></wcm-walletconnect-qr></wcm-modal-content>`}};Aq.styles=[rH.globalCss],Aq=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Sq(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=i(o)||o);return o})([oM("wcm-qrcode-view")],Aq);const Oq=n$`wcm-modal-content{height:clamp(200px,60vh,600px);display:block;overflow:scroll;scrollbar-width:none;position:relative;margin-top:1px}.wcm-grid{display:grid;grid-template-columns:repeat(4,80px);justify-content:space-between;margin:-15px -10px;padding-top:20px}wcm-modal-content::after,wcm-modal-content::before{content:'';position:fixed;pointer-events:none;z-index:1;width:100%;height:20px;opacity:1}wcm-modal-content::before{box-shadow:0 -1px 0 0 var(--wcm-color-bg-1);background:linear-gradient(var(--wcm-color-bg-1),rgba(255,255,255,0))}wcm-modal-content::after{box-shadow:0 1px 0 0 var(--wcm-color-bg-1);background:linear-gradient(rgba(255,255,255,0),var(--wcm-color-bg-1));top:calc(100% - 20px)}wcm-modal-content::-webkit-scrollbar{display:none}.wcm-placeholder-block{display:flex;justify-content:center;align-items:center;height:100px;overflow:hidden}.wcm-empty,.wcm-loading{display:flex}.wcm-loading .wcm-placeholder-block{height:100%}.wcm-end-reached .wcm-placeholder-block{height:0;opacity:0}.wcm-empty .wcm-placeholder-block{opacity:1;height:100%}wcm-wallet-button{margin:calc((100% - 60px)/ 3) 0}`;var Cq=Object.defineProperty,Pq=Object.getOwnPropertyDescriptor,Rq=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Pq(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Cq(t,r,o),o};let Tq=class extends nM{constructor(){super(...arguments),this.loading=!MD.state.wallets.listings.length,this.firstFetch=!MD.state.wallets.listings.length,this.search="",this.endReached=!1,this.intersectionObserver=void 0,this.searchDebounce=TH.debounce(e=>{e.length>=1?(this.firstFetch=!0,this.endReached=!1,this.search=e,MD.resetSearch(),this.fetchWallets()):this.search&&(this.search="",this.endReached=this.isLastPage(),MD.resetSearch())})}firstUpdated(){this.createPaginationObserver()}disconnectedCallback(){var e;null==(e=this.intersectionObserver)||e.disconnect()}get placeholderEl(){return TH.getShadowRootElement(this,".wcm-placeholder-block")}createPaginationObserver(){this.intersectionObserver=new IntersectionObserver(([e])=>{!e.isIntersecting||this.search&&this.firstFetch||this.fetchWallets()}),this.intersectionObserver.observe(this.placeholderEl)}isLastPage(){const{wallets:e,search:t}=MD.state,{listings:r,total:n}=this.search?t:e;return n<=40||r.length>=n}async fetchWallets(){var e;const{wallets:t,search:r}=MD.state,{listings:n,total:i,page:o}=this.search?r:t;if(!this.endReached&&(this.firstFetch||i>40&&n.length<i))try{this.loading=!0;const t=null==(e=bD.state.chains)?void 0:e.join(","),{listings:r}=await MD.getWallets({page:this.firstFetch?1:o+1,entries:40,search:this.search,version:2,chains:t}),n=r.map(e=>TH.getWalletIcon(e));await Promise.all([...n.map(async e=>TH.preloadImage(e)),gD.wait(300)]),this.endReached=this.isLastPage()}catch(e){console.error(e),YD.openToast(TH.getErrorMessage(e),"error")}finally{this.loading=!1,this.firstFetch=!1}}onConnect(e){gD.isAndroid()?TH.handleMobileLinking(e):TH.goToConnectingView(e)}onSearchChange(e){const{value:t}=e.target;this.searchDebounce(t)}render(){const{wallets:e,search:t}=MD.state,{listings:r}=this.search?t:e,n=this.loading&&!r.length,i=this.search.length>=3;let o=Nz.manualWalletsTemplate(),s=Nz.recomendedWalletsTemplate(!0);i&&(o=o.filter(({values:e})=>TH.caseSafeIncludes(e[0],this.search)),s=s.filter(({values:e})=>TH.caseSafeIncludes(e[0],this.search)));const a=!this.loading&&!r.length&&!s.length,c={"wcm-loading":n,"wcm-end-reached":this.endReached||!this.loading,"wcm-empty":a};return L$`<wcm-modal-header><wcm-search-input .onChange="${this.onSearchChange.bind(this)}"></wcm-search-input></wcm-modal-header><wcm-modal-content class="${fM(c)}"><div class="wcm-grid">${n?null:o} ${n?null:s} ${n?null:r.map(e=>L$`${e?L$`<wcm-wallet-button imageId="${e.image_id}" name="${e.name}" walletId="${e.id}" .onClick="${()=>this.onConnect(e)}"></wcm-wallet-button>`:null}`)}</div><div class="wcm-placeholder-block">${a?L$`<wcm-text variant="big-bold" color="secondary">No results found</wcm-text>`:null} ${!a&&this.loading?L$`<wcm-spinner></wcm-spinner>`:null}</div></wcm-modal-content>`}};Tq.styles=[rH.globalCss,Oq],Rq([cM()],Tq.prototype,"loading",2),Rq([cM()],Tq.prototype,"firstFetch",2),Rq([cM()],Tq.prototype,"search",2),Rq([cM()],Tq.prototype,"endReached",2),Tq=Rq([oM("wcm-wallet-explorer-view")],Tq);const kq=n$`wcm-info-footer{flex-direction:column;align-items:center;display:flex;width:100%;padding:5px 0}wcm-text{text-align:center}`;var Nq=Object.defineProperty,Uq=Object.getOwnPropertyDescriptor,Bq=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Uq(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Nq(t,r,o),o};let Lq=class extends nM{constructor(){super(),this.isError=!1,this.openWebWallet()}onFormatAndRedirect(e){const{desktop:t,name:r}=gD.getWalletRouterData(),n=null==t?void 0:t.universal;if(n){const t=gD.formatUniversalUrl(n,e,r);gD.openHref(t,"_blank")}}openWebWallet(){const{walletConnectUri:e}=bD.state,t=gD.getWalletRouterData();TH.setRecentWallet(t),e&&this.onFormatAndRedirect(e)}render(){const{name:e,id:t,image_id:r}=gD.getWalletRouterData(),{isMobile:n,isDesktop:i}=TH.getCachedRouterWalletPlatforms(),o=gD.isMobile();return L$`<wcm-modal-header title="${e}" .onAction="${TH.handleUriCopy}" .actionIcon="${mH.COPY_ICON}"></wcm-modal-header><wcm-modal-content><wcm-connector-waiting walletId="${t}" imageId="${bj(r)}" label="${`Continue in ${e}...`}" .isError="${this.isError}"></wcm-connector-waiting></wcm-modal-content><wcm-info-footer><wcm-text color="secondary" variant="small-thin">${`${e} web app has opened in a new tab. Go there, accept the connection, and come back`}</wcm-text><wcm-platform-selection .isMobile="${n}" .isDesktop="${!o&&i}" .isRetry="${!0}"><wcm-button .onClick="${this.openWebWallet.bind(this)}" .iconRight="${mH.RETRY_ICON}">Retry</wcm-button></wcm-platform-selection></wcm-info-footer>`}};Lq.styles=[rH.globalCss,kq],Bq([cM()],Lq.prototype,"isError",2),Lq=Bq([oM("wcm-web-connecting-view")],Lq);var Dq=Object.freeze({__proto__:null,get WcmModal(){return Kz},get WcmQrCode(){return GH}})});
//# sourceMappingURL=flowBridge.bundle.js.map
